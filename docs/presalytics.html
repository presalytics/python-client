<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>presalytics API documentation</title>
    <meta name="description" content="Presalytics python client
https://presalytics.io" />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">
    <li class="set"><h3><a href="#header-variables">Module variables</a></h3>
      
  <ul>
    <li class="mono"><a href="#presalytics.COMPONENTS">COMPONENTS</a></li>
    <li class="mono"><a href="#presalytics.CONFIG">CONFIG</a></li>
    <li class="mono"><a href="#presalytics.PLUGINS">PLUGINS</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-functions">Functions</a></h3>
      
  <ul>
    <li class="mono"><a href="#presalytics.create_outline_from_ooxml_document">create_outline_from_ooxml_document</a></li>
    <li class="mono"><a href="#presalytics.create_pages_from_ooxml_document">create_pages_from_ooxml_document</a></li>
    <li class="mono"><a href="#presalytics.create_story_from_ooxml_file">create_story_from_ooxml_file</a></li>
    <li class="mono"><a href="#presalytics.create_theme_from_ooxml_document">create_theme_from_ooxml_document</a></li>
    <li class="mono"><a href="#presalytics.get_mime_type_from_filename">get_mime_type_from_filename</a></li>
    <li class="mono"><a href="#presalytics.story_post_file_bytes">story_post_file_bytes</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#presalytics.ApprovedExternalLinks">ApprovedExternalLinks</a></span>
        
          
  <ul>
    <li class="mono"><a href="#presalytics.ApprovedExternalLinks.__init__">__init__</a></li>
    <li class="mono"><a href="#presalytics.ApprovedExternalLinks.get_tag">get_tag</a></li>
    <li class="mono"><a href="#presalytics.ApprovedExternalLinks.to_style">to_style</a></li>
    <li class="mono"><a href="#presalytics.ApprovedExternalLinks.validate_metadata">validate_metadata</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#presalytics.ApprovedExternalScripts">ApprovedExternalScripts</a></span>
        
          
  <ul>
    <li class="mono"><a href="#presalytics.ApprovedExternalScripts.__init__">__init__</a></li>
    <li class="mono"><a href="#presalytics.ApprovedExternalScripts.get_tag">get_tag</a></li>
    <li class="mono"><a href="#presalytics.ApprovedExternalScripts.to_script">to_script</a></li>
    <li class="mono"><a href="#presalytics.ApprovedExternalScripts.validate_metadata">validate_metadata</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#presalytics.ChangeShapeColor">ChangeShapeColor</a></span>
        
          
  <ul>
    <li class="mono"><a href="#presalytics.ChangeShapeColor.__init__">__init__</a></li>
    <li class="mono"><a href="#presalytics.ChangeShapeColor.execute">execute</a></li>
    <li class="mono"><a href="#presalytics.ChangeShapeColor.replace_color_on_target_shape">replace_color_on_target_shape</a></li>
    <li class="mono"><a href="#presalytics.ChangeShapeColor.transform_function">transform_function</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#presalytics.Client">Client</a></span>
        
          
  <ul>
    <li class="mono"><a href="#presalytics.Client.__init__">__init__</a></li>
    <li class="mono"><a href="#presalytics.Client.download_file">download_file</a></li>
    <li class="mono"><a href="#presalytics.Client.exchange_token">exchange_token</a></li>
    <li class="mono"><a href="#presalytics.Client.get_auth_header">get_auth_header</a></li>
    <li class="mono"><a href="#presalytics.Client.get_request_id_header">get_request_id_header</a></li>
    <li class="mono"><a href="#presalytics.Client.login">login</a></li>
    <li class="mono"><a href="#presalytics.Client.refresh_token">refresh_token</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#presalytics.JinjaPluginMakerMixin">JinjaPluginMakerMixin</a></span>
        
          
  <ul>
    <li class="mono"><a href="#presalytics.JinjaPluginMakerMixin.__init__">__init__</a></li>
    <li class="mono"><a href="#presalytics.JinjaPluginMakerMixin.get_template">get_template</a></li>
    <li class="mono"><a href="#presalytics.JinjaPluginMakerMixin.render">render</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#presalytics.JinjaTemplateBuilder">JinjaTemplateBuilder</a></span>
        
          
  <ul>
    <li class="mono"><a href="#presalytics.JinjaTemplateBuilder.__init__">__init__</a></li>
    <li class="mono"><a href="#presalytics.JinjaTemplateBuilder.get_client">get_client</a></li>
    <li class="mono"><a href="#presalytics.JinjaTemplateBuilder.get_page_widgets">get_page_widgets</a></li>
    <li class="mono"><a href="#presalytics.JinjaTemplateBuilder.get_template_name">get_template_name</a></li>
    <li class="mono"><a href="#presalytics.JinjaTemplateBuilder.load_jinja_template">load_jinja_template</a></li>
    <li class="mono"><a href="#presalytics.JinjaTemplateBuilder.load_widget">load_widget</a></li>
    <li class="mono"><a href="#presalytics.JinjaTemplateBuilder.render">render</a></li>
    <li class="mono"><a href="#presalytics.JinjaTemplateBuilder.serialize">serialize</a></li>
    <li class="mono"><a href="#presalytics.JinjaTemplateBuilder.deseriailize">deseriailize</a></li>
    <li class="mono"><a href="#presalytics.JinjaTemplateBuilder.deserialize">deserialize</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#presalytics.LocalStylesPlugin">LocalStylesPlugin</a></span>
        
          
  <ul>
    <li class="mono"><a href="#presalytics.LocalStylesPlugin.__init__">__init__</a></li>
    <li class="mono"><a href="#presalytics.LocalStylesPlugin.get_tag">get_tag</a></li>
    <li class="mono"><a href="#presalytics.LocalStylesPlugin.to_style">to_style</a></li>
    <li class="mono"><a href="#presalytics.LocalStylesPlugin.validate_metadata">validate_metadata</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#presalytics.MatplotlibFigure">MatplotlibFigure</a></span>
        
          
  <ul>
    <li class="mono"><a href="#presalytics.MatplotlibFigure.__init__">__init__</a></li>
    <li class="mono"><a href="#presalytics.MatplotlibFigure.get_client">get_client</a></li>
    <li class="mono"><a href="#presalytics.MatplotlibFigure.render">render</a></li>
    <li class="mono"><a href="#presalytics.MatplotlibFigure.serialize">serialize</a></li>
    <li class="mono"><a href="#presalytics.MatplotlibFigure.to_html">to_html</a></li>
    <li class="mono"><a href="#presalytics.MatplotlibFigure.deserialize">deserialize</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#presalytics.Mpld3Plugin">Mpld3Plugin</a></span>
        
          
  <ul>
    <li class="mono"><a href="#presalytics.Mpld3Plugin.__init__">__init__</a></li>
    <li class="mono"><a href="#presalytics.Mpld3Plugin.get_tag">get_tag</a></li>
    <li class="mono"><a href="#presalytics.Mpld3Plugin.get_template">get_template</a></li>
    <li class="mono"><a href="#presalytics.Mpld3Plugin.render">render</a></li>
    <li class="mono"><a href="#presalytics.Mpld3Plugin.to_script">to_script</a></li>
    <li class="mono"><a href="#presalytics.Mpld3Plugin.validate_metadata">validate_metadata</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#presalytics.OoxmlEditorWidget">OoxmlEditorWidget</a></span>
        
          
  <ul>
    <li class="mono"><a href="#presalytics.OoxmlEditorWidget.__init__">__init__</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEditorWidget.create_container">create_container</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEditorWidget.get_client">get_client</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEditorWidget.get_svg">get_svg</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEditorWidget.render">render</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEditorWidget.serialize">serialize</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEditorWidget.to_html">to_html</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEditorWidget.update">update</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEditorWidget.update_xml">update_xml</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEditorWidget.deseriailize">deseriailize</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEditorWidget.deserialize">deserialize</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#presalytics.OoxmlEndpointMap">OoxmlEndpointMap</a></span>
        
          
  <ul>
    <li class="mono"><a href="#presalytics.OoxmlEndpointMap.__init__">__init__</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEndpointMap.get_id_url">get_id_url</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEndpointMap.get_object_type">get_object_type</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEndpointMap.get_svg_url">get_svg_url</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEndpointMap.get_xml_url">get_xml_url</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEndpointMap.chart">chart</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEndpointMap.connection_shape">connection_shape</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEndpointMap.document">document</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEndpointMap.group">group</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEndpointMap.image">image</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEndpointMap.shape">shape</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEndpointMap.shapetree">shapetree</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEndpointMap.slide">slide</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEndpointMap.table">table</a></li>
    <li class="mono"><a href="#presalytics.OoxmlEndpointMap.theme">theme</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#presalytics.OoxmlFileWidget">OoxmlFileWidget</a></span>
        
          
  <ul>
    <li class="mono"><a href="#presalytics.OoxmlFileWidget.__init__">__init__</a></li>
    <li class="mono"><a href="#presalytics.OoxmlFileWidget.create_container">create_container</a></li>
    <li class="mono"><a href="#presalytics.OoxmlFileWidget.get_client">get_client</a></li>
    <li class="mono"><a href="#presalytics.OoxmlFileWidget.get_svg">get_svg</a></li>
    <li class="mono"><a href="#presalytics.OoxmlFileWidget.render">render</a></li>
    <li class="mono"><a href="#presalytics.OoxmlFileWidget.serialize">serialize</a></li>
    <li class="mono"><a href="#presalytics.OoxmlFileWidget.to_html">to_html</a></li>
    <li class="mono"><a href="#presalytics.OoxmlFileWidget.update">update</a></li>
    <li class="mono"><a href="#presalytics.OoxmlFileWidget.deserialize">deserialize</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#presalytics.OoxmlTheme">OoxmlTheme</a></span>
        
          
  <ul>
    <li class="mono"><a href="#presalytics.OoxmlTheme.__init__">__init__</a></li>
    <li class="mono"><a href="#presalytics.OoxmlTheme.get_base_scss">get_base_scss</a></li>
    <li class="mono"><a href="#presalytics.OoxmlTheme.get_font_link">get_font_link</a></li>
    <li class="mono"><a href="#presalytics.OoxmlTheme.get_fonts">get_fonts</a></li>
    <li class="mono"><a href="#presalytics.OoxmlTheme.get_tag">get_tag</a></li>
    <li class="mono"><a href="#presalytics.OoxmlTheme.to_style">to_style</a></li>
    <li class="mono"><a href="#presalytics.OoxmlTheme.validate_metadata">validate_metadata</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#presalytics.PageTemplateBase">PageTemplateBase</a></span>
        
          
  <ul>
    <li class="mono"><a href="#presalytics.PageTemplateBase.__init__">__init__</a></li>
    <li class="mono"><a href="#presalytics.PageTemplateBase.get_client">get_client</a></li>
    <li class="mono"><a href="#presalytics.PageTemplateBase.get_page_widgets">get_page_widgets</a></li>
    <li class="mono"><a href="#presalytics.PageTemplateBase.load_widget">load_widget</a></li>
    <li class="mono"><a href="#presalytics.PageTemplateBase.render">render</a></li>
    <li class="mono"><a href="#presalytics.PageTemplateBase.serialize">serialize</a></li>
    <li class="mono"><a href="#presalytics.PageTemplateBase.deseriailize">deseriailize</a></li>
    <li class="mono"><a href="#presalytics.PageTemplateBase.deserialize">deserialize</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#presalytics.PluginBase">PluginBase</a></span>
        
          
  <ul>
    <li class="mono"><a href="#presalytics.PluginBase.__init__">__init__</a></li>
    <li class="mono"><a href="#presalytics.PluginBase.get_tag">get_tag</a></li>
    <li class="mono"><a href="#presalytics.PluginBase.validate_metadata">validate_metadata</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#presalytics.Renderer">Renderer</a></span>
        
          
  <ul>
    <li class="mono"><a href="#presalytics.Renderer.__init__">__init__</a></li>
    <li class="mono"><a href="#presalytics.Renderer.get_client">get_client</a></li>
    <li class="mono"><a href="#presalytics.Renderer.render">render</a></li>
    <li class="mono"><a href="#presalytics.Renderer.serialize">serialize</a></li>
    <li class="mono"><a href="#presalytics.Renderer.deserialize">deserialize</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#presalytics.RevealConfigPlugin">RevealConfigPlugin</a></span>
        
          
  <ul>
    <li class="mono"><a href="#presalytics.RevealConfigPlugin.__init__">__init__</a></li>
    <li class="mono"><a href="#presalytics.RevealConfigPlugin.get_tag">get_tag</a></li>
    <li class="mono"><a href="#presalytics.RevealConfigPlugin.get_template">get_template</a></li>
    <li class="mono"><a href="#presalytics.RevealConfigPlugin.render">render</a></li>
    <li class="mono"><a href="#presalytics.RevealConfigPlugin.to_script">to_script</a></li>
    <li class="mono"><a href="#presalytics.RevealConfigPlugin.validate_metadata">validate_metadata</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#presalytics.RevealCustomTheme">RevealCustomTheme</a></span>
        
          
  <ul>
    <li class="mono"><a href="#presalytics.RevealCustomTheme.__init__">__init__</a></li>
    <li class="mono"><a href="#presalytics.RevealCustomTheme.get_base_scss">get_base_scss</a></li>
    <li class="mono"><a href="#presalytics.RevealCustomTheme.get_font_link">get_font_link</a></li>
    <li class="mono"><a href="#presalytics.RevealCustomTheme.get_fonts">get_fonts</a></li>
    <li class="mono"><a href="#presalytics.RevealCustomTheme.get_tag">get_tag</a></li>
    <li class="mono"><a href="#presalytics.RevealCustomTheme.to_style">to_style</a></li>
    <li class="mono"><a href="#presalytics.RevealCustomTheme.validate_metadata">validate_metadata</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#presalytics.Revealer">Revealer</a></span>
        
          
  <ul>
    <li class="mono"><a href="#presalytics.Revealer.__init__">__init__</a></li>
    <li class="mono"><a href="#presalytics.Revealer.get_client">get_client</a></li>
    <li class="mono"><a href="#presalytics.Revealer.get_component_implicit_plugins">get_component_implicit_plugins</a></li>
    <li class="mono"><a href="#presalytics.Revealer.make_base">make_base</a></li>
    <li class="mono"><a href="#presalytics.Revealer.package_as_standalone">package_as_standalone</a></li>
    <li class="mono"><a href="#presalytics.Revealer.present">present</a></li>
    <li class="mono"><a href="#presalytics.Revealer.render">render</a></li>
    <li class="mono"><a href="#presalytics.Revealer.render_page">render_page</a></li>
    <li class="mono"><a href="#presalytics.Revealer.serialize">serialize</a></li>
    <li class="mono"><a href="#presalytics.Revealer.set_outline_data_from_instance">set_outline_data_from_instance</a></li>
    <li class="mono"><a href="#presalytics.Revealer.set_page_outline_data">set_page_outline_data</a></li>
    <li class="mono"><a href="#presalytics.Revealer.set_theme_outline_data">set_theme_outline_data</a></li>
    <li class="mono"><a href="#presalytics.Revealer.set_widget_outline_data">set_widget_outline_data</a></li>
    <li class="mono"><a href="#presalytics.Revealer.strip_unauthorized_scripts">strip_unauthorized_scripts</a></li>
    <li class="mono"><a href="#presalytics.Revealer.update_info">update_info</a></li>
    <li class="mono"><a href="#presalytics.Revealer.update_outline">update_outline</a></li>
    <li class="mono"><a href="#presalytics.Revealer.update_outline_from_instances">update_outline_from_instances</a></li>
    <li class="mono"><a href="#presalytics.Revealer.deserialize">deserialize</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#presalytics.StoryOutline">StoryOutline</a></span>
        
          
  <ul>
    <li class="mono"><a href="#presalytics.StoryOutline.__init__">__init__</a></li>
    <li class="mono"><a href="#presalytics.StoryOutline.dump">dump</a></li>
    <li class="mono"><a href="#presalytics.StoryOutline.export_yaml">export_yaml</a></li>
    <li class="mono"><a href="#presalytics.StoryOutline.to_dict">to_dict</a></li>
    <li class="mono"><a href="#presalytics.StoryOutline.validate">validate</a></li>
    <li class="mono"><a href="#presalytics.StoryOutline.deserialize">deserialize</a></li>
    <li class="mono"><a href="#presalytics.StoryOutline.import_yaml">import_yaml</a></li>
    <li class="mono"><a href="#presalytics.StoryOutline.load">load</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#presalytics.ThemeBase">ThemeBase</a></span>
        
          
  <ul>
    <li class="mono"><a href="#presalytics.ThemeBase.__init__">__init__</a></li>
    <li class="mono"><a href="#presalytics.ThemeBase.get_client">get_client</a></li>
    <li class="mono"><a href="#presalytics.ThemeBase.render">render</a></li>
    <li class="mono"><a href="#presalytics.ThemeBase.serialize">serialize</a></li>
    <li class="mono"><a href="#presalytics.ThemeBase.deserialize">deserialize</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#presalytics.WidgetBase">WidgetBase</a></span>
        
          
  <ul>
    <li class="mono"><a href="#presalytics.WidgetBase.__init__">__init__</a></li>
    <li class="mono"><a href="#presalytics.WidgetBase.get_client">get_client</a></li>
    <li class="mono"><a href="#presalytics.WidgetBase.render">render</a></li>
    <li class="mono"><a href="#presalytics.WidgetBase.serialize">serialize</a></li>
    <li class="mono"><a href="#presalytics.WidgetBase.to_html">to_html</a></li>
    <li class="mono"><a href="#presalytics.WidgetBase.deserialize">deserialize</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#presalytics.XmlTransformBase">XmlTransformBase</a></span>
        
          
  <ul>
    <li class="mono"><a href="#presalytics.XmlTransformBase.__init__">__init__</a></li>
    <li class="mono"><a href="#presalytics.XmlTransformBase.execute">execute</a></li>
    <li class="mono"><a href="#presalytics.XmlTransformBase.transform_function">transform_function</a></li>
  </ul>

        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">presalytics</span> module</h1>
  <p>Presalytics python client
https://presalytics.io</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics', this);">Show source &equiv;</a></p>
  <div id="source-presalytics" class="source">
    <div class="codehilite"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Presalytics python client</span>
<span class="sd">https://presalytics.io</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">environs</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">presalytics.lib</span>
<span class="kn">import</span> <span class="nn">presalytics.lib.logger</span>
<span class="kn">import</span> <span class="nn">presalytics.lib.plugins</span>
<span class="kn">import</span> <span class="nn">presalytics.lib.plugins.base</span>
<span class="kn">import</span> <span class="nn">presalytics.lib.config_loader</span>
<span class="kn">import</span> <span class="nn">presalytics.story</span>
<span class="kn">import</span> <span class="nn">presalytics.story.components</span>

<span class="n">env</span> <span class="o">=</span> <span class="n">environs</span><span class="o">.</span><span class="n">Env</span><span class="p">()</span>
<span class="n">env</span><span class="o">.</span><span class="n">read_env</span><span class="p">()</span>

<span class="c1"># A comma-separated list of paths to search of config.py, plugin classes, and component classes</span>
<span class="n">autodiscover_paths</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="s1">&#39;AUTODISCOVER_PATHS&#39;</span><span class="p">,</span> <span class="p">[])</span>

<span class="n">CONFIG</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">config_loader</span><span class="o">.</span><span class="n">load_config</span><span class="p">(</span><span class="n">additional_paths</span><span class="o">=</span><span class="n">autodiscover_paths</span><span class="p">)</span>

<span class="n">file_logger</span> <span class="o">=</span> <span class="n">CONFIG</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;USE_LOGGER&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">log_level</span> <span class="o">=</span> <span class="n">CONFIG</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;LOG_LEVEL&quot;</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

<span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">configure_logger</span><span class="p">(</span><span class="n">log_level</span><span class="o">=</span><span class="n">log_level</span><span class="p">,</span> <span class="n">file_logger</span><span class="o">=</span><span class="n">file_logger</span><span class="p">)</span>

<span class="n">registry_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;show_errors&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
    <span class="s1">&#39;autodiscover_paths&#39;</span><span class="p">:</span> <span class="n">autodiscover_paths</span>
<span class="p">}</span>

<span class="n">PLUGINS</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">plugins</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">PluginRegistry</span><span class="p">(</span><span class="o">**</span><span class="n">registry_kwargs</span><span class="p">)</span>

<span class="n">COMPONENTS</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">ComponentRegistry</span><span class="p">(</span><span class="o">**</span><span class="n">registry_kwargs</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">presalytics.client.api</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="kn">from</span> <span class="nn">presalytics.lib.plugins.base</span> <span class="kn">import</span> <span class="n">PluginBase</span>
<span class="kn">from</span> <span class="nn">presalytics.lib.plugins.external</span> <span class="kn">import</span> <span class="n">ApprovedExternalLinks</span><span class="p">,</span> <span class="n">ApprovedExternalScripts</span>
<span class="kn">from</span> <span class="nn">presalytics.lib.plugins.jinja</span> <span class="kn">import</span> <span class="n">JinjaPluginMakerMixin</span>
<span class="kn">from</span> <span class="nn">presalytics.lib.plugins.local</span> <span class="kn">import</span> <span class="n">LocalStylesPlugin</span>
<span class="kn">from</span> <span class="nn">presalytics.lib.plugins.matplotlib</span> <span class="kn">import</span> <span class="n">Mpld3Plugin</span>
<span class="kn">from</span> <span class="nn">presalytics.lib.plugins.ooxml</span> <span class="kn">import</span> <span class="n">OoxmlTheme</span>
<span class="kn">from</span> <span class="nn">presalytics.lib.plugins.reveal</span> <span class="kn">import</span> <span class="n">RevealConfigPlugin</span>
<span class="kn">from</span> <span class="nn">presalytics.lib.plugins.reveal_theme</span> <span class="kn">import</span> <span class="n">RevealCustomTheme</span>
<span class="kn">from</span> <span class="nn">presalytics.lib.templates.base</span> <span class="kn">import</span> <span class="n">JinjaTemplateBuilder</span>
<span class="kn">from</span> <span class="nn">presalytics.lib.widgets.matplotlib</span> <span class="kn">import</span> <span class="n">MatplotlibFigure</span>
<span class="kn">from</span> <span class="nn">presalytics.lib.widgets.ooxml</span> <span class="kn">import</span> <span class="n">OoxmlFileWidget</span><span class="p">,</span> <span class="n">OoxmlEndpointMap</span>
<span class="kn">from</span> <span class="nn">presalytics.story.outline</span> <span class="kn">import</span> <span class="n">StoryOutline</span>
<span class="kn">from</span> <span class="nn">presalytics.story.revealer</span> <span class="kn">import</span> <span class="n">Revealer</span>
<span class="kn">from</span> <span class="nn">presalytics.story.components</span> <span class="kn">import</span> <span class="n">WidgetBase</span><span class="p">,</span> <span class="n">PageTemplateBase</span><span class="p">,</span> <span class="n">Renderer</span><span class="p">,</span> <span class="n">ThemeBase</span>
<span class="kn">from</span> <span class="nn">presalytics.lib.tools.ooxml_tools</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">create_theme_from_ooxml_document</span><span class="p">,</span>
    <span class="n">create_pages_from_ooxml_document</span><span class="p">,</span>
    <span class="n">create_story_from_ooxml_file</span><span class="p">,</span>
    <span class="n">create_outline_from_ooxml_document</span><span class="p">,</span>
    <span class="n">get_mime_type_from_filename</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">presalytics.lib.tools.story_tools</span> <span class="kn">import</span> <span class="n">story_post_file_bytes</span>
<span class="kn">from</span> <span class="nn">presalytics.lib.widgets.ooxml_editors</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">OoxmlEditorWidget</span><span class="p">,</span>
    <span class="n">XmlTransformBase</span><span class="p">,</span>
    <span class="n">ChangeShapeColor</span>
<span class="p">)</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;CONFIG&#39;</span><span class="p">,</span>
    <span class="s1">&#39;COMPONENTS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PLUGINS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Client&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PluginBase&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ApprovedExternalLinks&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ApprovedExternalScripts&#39;</span><span class="p">,</span>
    <span class="s1">&#39;JinjaPluginMakerMixin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;LocalStylesPlugin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Mpld3Plugin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;OoxmlTheme&#39;</span><span class="p">,</span>
    <span class="s1">&#39;RevealConfigPlugin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;RevealCustomTheme&#39;</span><span class="p">,</span>
    <span class="s1">&#39;JinjaTemplateBuilder&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MatplotlibFigure&#39;</span><span class="p">,</span>
    <span class="s1">&#39;OoxmlFileWidget&#39;</span><span class="p">,</span>
    <span class="s1">&#39;OoxmlEndpointMap&#39;</span><span class="p">,</span>
    <span class="s1">&#39;StoryOutline&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Revealer&#39;</span><span class="p">,</span>
    <span class="s1">&#39;WidgetBase&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PageTemplateBase&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Renderer&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ThemeBase&#39;</span><span class="p">,</span>
    <span class="s1">&#39;create_theme_from_ooxml_document&#39;</span><span class="p">,</span>
    <span class="s1">&#39;create_pages_from_ooxml_document&#39;</span><span class="p">,</span>
    <span class="s1">&#39;create_story_from_ooxml_file&#39;</span><span class="p">,</span>
    <span class="s1">&#39;create_outline_from_ooxml_document&#39;</span><span class="p">,</span>
    <span class="s1">&#39;get_mime_type_from_filename&#39;</span><span class="p">,</span>
    <span class="s1">&#39;OoxmlEditorWidget&#39;</span><span class="p">,</span>
    <span class="s1">&#39;XmlTransformBase&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ChangeShapeColor&#39;</span><span class="p">,</span>
    <span class="s1">&#39;story_post_file_bytes&#39;</span>
<span class="p">]</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">
    <h2 class="section-title" id="header-variables">Module variables</h2>
      <div class="item">
      <p id="presalytics.COMPONENTS" class="name">var <span class="ident">COMPONENTS</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="presalytics.CONFIG" class="name">var <span class="ident">CONFIG</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="presalytics.PLUGINS" class="name">var <span class="ident">PLUGINS</span></p>
      
  
  <div class="source_cont">
</div>

      </div>

    <h2 class="section-title" id="header-functions">Functions</h2>
      
  <div class="item">
    <div class="name def" id="presalytics.create_outline_from_ooxml_document">
    <p>def <span class="ident">create_outline_from_ooxml_document</span>(</p><p>story, ooxml_document, title=None, description=None, themes=None, client_info={})</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.create_outline_from_ooxml_document', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.create_outline_from_ooxml_document" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_outline_from_ooxml_document</span><span class="p">(</span><span class="n">story</span><span class="p">:</span> <span class="s1">&#39;Story&#39;</span><span class="p">,</span>
                                       <span class="n">ooxml_document</span><span class="p">:</span> <span class="s1">&#39;Document&#39;</span><span class="p">,</span>
                                       <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
                                       <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
                                       <span class="n">themes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="s1">&#39;ThemeBase&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
                                       <span class="n">client_info</span><span class="o">=</span><span class="p">{}):</span>

    <span class="n">info</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">Info</span><span class="p">(</span>
        <span class="n">revision</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">date_created</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
        <span class="n">date_modified</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
        <span class="n">created_by</span><span class="o">=</span><span class="n">presalytics</span><span class="o">.</span><span class="n">CONFIG</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;USERNAME&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
        <span class="n">modified_by</span><span class="o">=</span><span class="n">presalytics</span><span class="o">.</span><span class="n">CONFIG</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;USERNAME&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
        <span class="n">revision_notes</span><span class="o">=</span><span class="s1">&#39;Created by via &quot;create_outline_from_ooxml_file&quot; method&#39;</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
        <span class="n">_description</span> <span class="o">=</span> <span class="n">description</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_description</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="n">pages</span> <span class="o">=</span> <span class="n">create_pages_from_ooxml_document</span><span class="p">(</span><span class="n">story</span><span class="p">,</span> <span class="n">ooxml_document</span><span class="p">,</span> <span class="n">client_info</span><span class="o">=</span><span class="n">client_info</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">themes</span><span class="p">:</span>
        <span class="n">_themes</span> <span class="o">=</span> <span class="n">themes</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ooxml_id</span> <span class="o">=</span> <span class="n">pages</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;document_ooxml_id&quot;</span><span class="p">]</span>
        <span class="n">_themes</span> <span class="o">=</span> <span class="p">[</span><span class="n">create_theme_from_ooxml_document</span><span class="p">(</span><span class="n">ooxml_id</span><span class="p">,</span> <span class="n">client_info</span><span class="o">=</span><span class="n">client_info</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">_title</span> <span class="o">=</span> <span class="n">title</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_title</span> <span class="o">=</span> <span class="n">pages</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>

    <span class="n">outline</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">StoryOutline</span><span class="p">(</span>
        <span class="n">presalytics_story</span><span class="o">=</span><span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">get_current_spec_version</span><span class="p">(),</span>
        <span class="n">info</span><span class="o">=</span><span class="n">info</span><span class="p">,</span>
        <span class="n">pages</span><span class="o">=</span><span class="n">pages</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="n">_description</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="n">_title</span><span class="p">,</span>
        <span class="n">themes</span><span class="o">=</span><span class="n">_themes</span><span class="p">,</span>
        <span class="n">plugins</span><span class="o">=</span><span class="p">[]</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">outline</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="presalytics.create_pages_from_ooxml_document">
    <p>def <span class="ident">create_pages_from_ooxml_document</span>(</p><p>story, ooxml_document, client_info={})</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.create_pages_from_ooxml_document', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.create_pages_from_ooxml_document" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_pages_from_ooxml_document</span><span class="p">(</span><span class="n">story</span><span class="p">:</span> <span class="s1">&#39;Story&#39;</span><span class="p">,</span> 
                                     <span class="n">ooxml_document</span><span class="p">:</span> <span class="s1">&#39;Document&#39;</span><span class="p">,</span>
                                     <span class="n">client_info</span><span class="o">=</span><span class="p">{}):</span>
    <span class="n">pages</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="n">client_info</span><span class="p">)</span>
    <span class="n">child_objects</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">ooxml_automation</span><span class="o">.</span><span class="n">documents_childobjects_get_id</span><span class="p">(</span><span class="n">ooxml_document</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
    <span class="n">document_type</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">ooxml_automation</span><span class="o">.</span><span class="n">documents_documenttype_typeid_get_type_id</span><span class="p">(</span><span class="n">ooxml_document</span><span class="o">.</span><span class="n">document_type_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">document_type</span><span class="o">.</span><span class="n">file_extension</span> <span class="o">==</span> <span class="s2">&quot;pptx&quot;</span><span class="p">:</span>
        <span class="n">slides_meta</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">child_objects</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">object_type</span> <span class="o">==</span> <span class="s2">&quot;Slide.Slides&quot;</span><span class="p">]</span>
        <span class="n">ep_map</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">OoxmlEndpointMap</span><span class="p">(</span><span class="n">presalytics</span><span class="o">.</span><span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">SLIDE</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">slide</span> <span class="ow">in</span> <span class="n">slides_meta</span><span class="p">:</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">OoxmlFileWidget</span><span class="p">(</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">ooxml_document</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">slide</span><span class="o">.</span><span class="n">entity_name</span><span class="p">,</span>
                <span class="n">endpoint_map</span><span class="o">=</span><span class="n">ep_map</span><span class="p">,</span>
                <span class="n">object_name</span><span class="o">=</span><span class="n">slide</span><span class="o">.</span><span class="n">entity_name</span><span class="p">,</span>
                <span class="n">object_ooxml_id</span><span class="o">=</span><span class="n">slide</span><span class="o">.</span><span class="n">entity_id</span><span class="p">,</span>
                <span class="n">document_ooxml_id</span><span class="o">=</span><span class="n">ooxml_document</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="n">story_id</span><span class="o">=</span><span class="n">story</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="n">client_info</span><span class="o">=</span><span class="n">client_info</span>
            <span class="p">)</span>
            <span class="n">widget_kind</span> <span class="o">=</span> <span class="s2">&quot;widget-page&quot;</span>
            <span class="n">widget_name</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">entity_name</span>
            <span class="n">widgets</span> <span class="o">=</span> <span class="p">[</span><span class="n">widget</span><span class="o">.</span><span class="n">serialize</span><span class="p">()]</span>
            <span class="n">page</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">Page</span><span class="p">(</span>
                <span class="n">kind</span><span class="o">=</span><span class="n">widget_kind</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">widget_name</span><span class="p">,</span>
                <span class="n">widgets</span><span class="o">=</span><span class="n">widgets</span>
            <span class="p">)</span>
            <span class="n">pages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
    <span class="c1"># TODO: insert excel chart handling here</span>
    <span class="k">return</span> <span class="n">pages</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="presalytics.create_story_from_ooxml_file">
    <p>def <span class="ident">create_story_from_ooxml_file</span>(</p><p>filename, client_info={})</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.create_story_from_ooxml_file', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.create_story_from_ooxml_file" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_story_from_ooxml_file</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">client_info</span><span class="o">=</span><span class="p">{})</span> <span class="o">-&gt;</span> <span class="s1">&#39;Story&#39;</span><span class="p">:</span>
    <span class="n">story</span><span class="p">:</span> <span class="s1">&#39;Story&#39;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting presalytics tool: create_story_from_ooxml_file&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Intializing presalytics client.&quot;</span><span class="p">)</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="n">client_info</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Sending file to presaltyics server for document processing and base story creation&quot;</span><span class="p">)</span>
    <span class="n">story</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">story_post_file</span><span class="p">(</span><span class="nb">file</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Creating local instances of file widgets&quot;</span><span class="p">)</span>
    <span class="n">outline</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">StoryOutline</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">story</span><span class="o">.</span><span class="n">outline</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">outline</span><span class="o">.</span><span class="n">pages</span><span class="p">)):</span>
        <span class="n">page</span> <span class="o">=</span> <span class="n">outline</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">widgets</span><span class="p">)):</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Creating OoxmlFileWidget with name &quot;{}&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">widget</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            <span class="n">inst</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">OoxmlFileWidget</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="o">**</span><span class="n">client_info</span><span class="p">)</span>
            <span class="n">presalytics</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Rewriting outline with widget: &quot;{}&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">widget</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            <span class="n">outline</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">inst</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
    <span class="n">story</span><span class="o">.</span><span class="n">outline</span> <span class="o">=</span> <span class="n">outline</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">story</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="presalytics.create_theme_from_ooxml_document">
    <p>def <span class="ident">create_theme_from_ooxml_document</span>(</p><p>document_id, client_info={})</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.create_theme_from_ooxml_document', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.create_theme_from_ooxml_document" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_theme_from_ooxml_document</span><span class="p">(</span><span class="n">document_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">client_info</span><span class="o">=</span><span class="p">{}):</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="n">client_info</span><span class="p">)</span>
    <span class="n">child_objects</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">ooxml_automation</span><span class="o">.</span><span class="n">documents_childobjects_get_id</span><span class="p">(</span><span class="n">document_id</span><span class="p">)</span>
    <span class="n">themes</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">child_objects</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">object_type</span> <span class="o">==</span> <span class="s2">&quot;Theme.Themes&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">themes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">slide_no</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">theme_data</span> <span class="ow">in</span> <span class="n">themes</span><span class="p">:</span>
            <span class="n">theme_info</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">ooxml_automation</span><span class="o">.</span><span class="n">theme_themes_get_id</span><span class="p">(</span><span class="n">theme_data</span><span class="o">.</span><span class="n">entity_id</span><span class="p">)</span>
            <span class="n">parent_slide</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">ooxml_automation</span><span class="o">.</span><span class="n">slides_slides_get_id</span><span class="p">(</span><span class="n">theme_info</span><span class="o">.</span><span class="n">slide_id</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">slide_no</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">slide_no</span> <span class="o">=</span> <span class="n">parent_slide</span><span class="o">.</span><span class="n">number</span>
                <span class="n">theme_meta</span> <span class="o">=</span> <span class="n">theme_info</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">parent_slide</span><span class="o">.</span><span class="n">number</span> <span class="o">&lt;</span> <span class="n">slide_no</span><span class="p">:</span>
                    <span class="n">theme_meta</span> <span class="o">=</span> <span class="n">theme_info</span>
                    <span class="k">if</span> <span class="n">parent_slide</span><span class="o">.</span><span class="n">number</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">break</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">theme_meta</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">ooxml_automation</span><span class="o">.</span><span class="n">theme_themes_get_id</span><span class="p">(</span><span class="n">themes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">entity_id</span><span class="p">)</span>
    <span class="n">theme</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">themes</span><span class="o">.</span><span class="n">ooxml</span><span class="o">.</span><span class="n">OoxmlTheme</span><span class="p">(</span>
        <span class="n">theme_meta</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> 
        <span class="n">theme_meta</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> 
        <span class="n">client_info</span><span class="o">=</span><span class="n">client_info</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">theme</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="presalytics.get_mime_type_from_filename">
    <p>def <span class="ident">get_mime_type_from_filename</span>(</p><p>client, filename)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.get_mime_type_from_filename', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.get_mime_type_from_filename" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_mime_type_from_filename</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="n">doc_types</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">ooxml_automation</span><span class="o">.</span><span class="n">documents_documenttype_get</span><span class="p">()</span>
    <span class="n">file_extension</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mime_type</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">doc_types</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">file_extension</span> <span class="o">==</span> <span class="n">file_extension</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="presalytics.story_post_file_bytes">
    <p>def <span class="ident">story_post_file_bytes</span>(</p><p>client, binary_obj, filename, mime_type=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.story_post_file_bytes', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.story_post_file_bytes" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">story_post_file_bytes</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="s1">&#39;Client&#39;</span><span class="p">,</span> <span class="n">binary_obj</span><span class="p">:</span> <span class="s1">&#39;BytesIO&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mime_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">mime_type</span><span class="p">:</span>
        <span class="n">mime_type</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">ooxml_tools</span><span class="o">.</span><span class="n">get_mime_type_from_filename</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="n">_file</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">binary_obj</span><span class="p">,</span> <span class="n">mime_type</span><span class="p">,)}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_auth_header</span><span class="p">()</span>
    <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">client</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">api_client</span><span class="o">.</span><span class="n">user_agent</span><span class="p">,</span>
        <span class="s1">&#39;Accept&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span>
    <span class="p">})</span>
    <span class="n">endpoint</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urljoin</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">api_client</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="s1">&#39;story/file&#39;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">_file</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;An error occured in the presalytics API client&quot;</span>
        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ApiError</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">message</span><span class="p">,</span> <span class="n">status_code</span><span class="o">=</span><span class="n">resp</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status_code</span> <span class="o">&gt;</span> <span class="mi">299</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;detail&#39;</span><span class="p">])</span>
        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ApiError</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;detail&quot;</span><span class="p">],</span> <span class="n">status_code</span><span class="o">=</span><span class="n">resp</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">story</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">api_client</span><span class="o">.</span><span class="n">_ApiClient__deserialize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;Story&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">story</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Story object could not be deserialized.&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  

    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="presalytics.ApprovedExternalLinks" class="name">class <span class="ident">ApprovedExternalLinks</span></p>
      
  
    <div class="desc"><p>A script plugin render configures templated scripts to append to the body
tag of an html document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.ApprovedExternalLinks', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.ApprovedExternalLinks" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ApprovedExternalLinks</span><span class="p">(</span><span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">plugins</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">StylePlugin</span><span class="p">):</span>
    <span class="n">__plugin_name__</span> <span class="o">=</span> <span class="s1">&#39;external_links&#39;</span>

    <span class="k">def</span> <span class="nf">to_style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s1">&#39;approved_styles_key&#39;</span><span class="p">]</span>
        <span class="n">link</span> <span class="o">=</span> <span class="n">ALLOWED_STYLES</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">link</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Key {0} does not reference a link in the APPROVED_LINKS dictionary&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">MissingConfigException</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;link rel=&quot;stylesheet&quot; href=&quot;{0}&quot;/&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#presalytics.ApprovedExternalLinks">ApprovedExternalLinks</a></li>
          <li>presalytics.lib.plugins.base.StylePlugin</li>
          <li><a href="#presalytics.PluginBase">PluginBase</a></li>
          <li>abc.ABC</li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.ApprovedExternalLinks.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#presalytics.PluginBase">PluginBase</a></code>.<code><a href="#presalytics.PluginBase.__init__">__init__</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.ApprovedExternalLinks.__init__', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.ApprovedExternalLinks.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">validate_metadata</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.ApprovedExternalLinks.get_tag">
    <p>def <span class="ident">get_tag</span>(</p><p>self, config, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Generic method to be implemented by all inheriting classes. Allow plugin
to be render without knowledge of the underlying plugin kind.</p>
<h2>Parameters:</h2>
<p>config: Dict
    A set configuration values for the plugin.  Required keys should be
    specified by the docstring of the inheriting classes.
    Can be implemented via a mypy_extensions.TypedDict object if warranted.
    The presalytics.story.outline.Plugin's config element should be passed
    as this value to render the script.</p>
<h2>Returns:</h2>
<p>A string carrying a html script that can be embedded in a html document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.ApprovedExternalLinks.get_tag', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.ApprovedExternalLinks.get_tag" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_style</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.ApprovedExternalLinks.to_style">
    <p>def <span class="ident">to_style</span>(</p><p>self, config, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>The to_style method maps a dictionary to an html style tag.</p>
<h2>Parameters:</h2>
<p>config: Dict
    A set configuration values for the plugin.  Required keys should be
    specified by the docstring of the inheriting classes.
    Can be implemented via a mypy_extensions.TypedDict object if warranted.
    The presalytics.story.outline.Plugin's config element should be passed
    as this value to render the script.</p>
<h2>Returns:</h2>
<p>A string carrying a html script that can be embedded in a html document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.ApprovedExternalLinks.to_style', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.ApprovedExternalLinks.to_style" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">to_style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s1">&#39;approved_styles_key&#39;</span><span class="p">]</span>
    <span class="n">link</span> <span class="o">=</span> <span class="n">ALLOWED_STYLES</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">key</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">link</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Key {0} does not reference a link in the APPROVED_LINKS dictionary&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">MissingConfigException</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;&lt;link rel=&quot;stylesheet&quot; href=&quot;{0}&quot;/&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.ApprovedExternalLinks.validate_metadata">
    <p>def <span class="ident">validate_metadata</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.ApprovedExternalLinks.validate_metadata', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.ApprovedExternalLinks.validate_metadata" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">validate_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plugin_kind__</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plugin_name__</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Plugin class {0} has not defined either __plugin_kind__ or __plugin_name__ metadata&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="presalytics.ApprovedExternalScripts" class="name">class <span class="ident">ApprovedExternalScripts</span></p>
      
  
    <div class="desc"><p>A script plugin render configures templated scripts to append to the body
tag of an html document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.ApprovedExternalScripts', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.ApprovedExternalScripts" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ApprovedExternalScripts</span><span class="p">(</span><span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">plugins</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">ScriptPlugin</span><span class="p">):</span>
    <span class="n">__plugin_name__</span> <span class="o">=</span> <span class="s1">&#39;external_scripts&#39;</span>

    <span class="k">def</span> <span class="nf">to_script</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s1">&#39;approved_scripts_key&#39;</span><span class="p">]</span>
        <span class="n">link</span> <span class="o">=</span> <span class="n">ALLOWED_SCRIPTS</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">link</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Key {0} does not reference a link in the APPROVED_SCRIPTS dictionary&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">MissingConfigException</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;script type=&quot;text/javascript&quot; src=&quot;{0}&quot;&gt;&lt;/script&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#presalytics.ApprovedExternalScripts">ApprovedExternalScripts</a></li>
          <li>presalytics.lib.plugins.base.ScriptPlugin</li>
          <li><a href="#presalytics.PluginBase">PluginBase</a></li>
          <li>abc.ABC</li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.ApprovedExternalScripts.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#presalytics.PluginBase">PluginBase</a></code>.<code><a href="#presalytics.PluginBase.__init__">__init__</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.ApprovedExternalScripts.__init__', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.ApprovedExternalScripts.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">validate_metadata</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.ApprovedExternalScripts.get_tag">
    <p>def <span class="ident">get_tag</span>(</p><p>self, config, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Generic method to be implemented by all inheriting classes. Allow plugin
to be render without knowledge of the underlying plugin kind.</p>
<h2>Parameters:</h2>
<p>config: Dict
    A set configuration values for the plugin.  Required keys should be
    specified by the docstring of the inheriting classes.
    Can be implemented via a mypy_extensions.TypedDict object if warranted.
    The presalytics.story.outline.Plugin's config element should be passed
    as this value to render the script.</p>
<h2>Returns:</h2>
<p>A string carrying a html script that can be embedded in a html document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.ApprovedExternalScripts.get_tag', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.ApprovedExternalScripts.get_tag" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_script</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.ApprovedExternalScripts.to_script">
    <p>def <span class="ident">to_script</span>(</p><p>self, config, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>The to_script method maps a dictionary to an html script tag.</p>
<h2>Parameters:</h2>
<p>config: Dict
    A set configuration values for the plugin.  Required keys should be
    specified by the docstring of the inheriting classes.
    Can be implemented via a mypy_extensions.TypedDict object if warranted.
    The presalytics.story.outline.Plugin's config element should be passed
    as this value to render the script.</p>
<h2>Returns:</h2>
<p>A string carrying a html script that can be embedded in a html document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.ApprovedExternalScripts.to_script', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.ApprovedExternalScripts.to_script" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">to_script</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s1">&#39;approved_scripts_key&#39;</span><span class="p">]</span>
    <span class="n">link</span> <span class="o">=</span> <span class="n">ALLOWED_SCRIPTS</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">key</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">link</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Key {0} does not reference a link in the APPROVED_SCRIPTS dictionary&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">MissingConfigException</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;&lt;script type=&quot;text/javascript&quot; src=&quot;{0}&quot;&gt;&lt;/script&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.ApprovedExternalScripts.validate_metadata">
    <p>def <span class="ident">validate_metadata</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.ApprovedExternalScripts.validate_metadata', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.ApprovedExternalScripts.validate_metadata" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">validate_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plugin_kind__</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plugin_name__</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Plugin class {0} has not defined either __plugin_kind__ or __plugin_name__ metadata&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="presalytics.ChangeShapeColor" class="name">class <span class="ident">ChangeShapeColor</span></p>
      
  
    <div class="desc"><p>Helper class that provides a standard way to create an ABC using
inheritance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.ChangeShapeColor', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.ChangeShapeColor" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ChangeShapeColor</span><span class="p">(</span><span class="n">XmlTransformBase</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">replace_color_on_target_shape</span><span class="p">(</span><span class="n">shape_xml</span><span class="p">:</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">,</span> <span class="n">new_color</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">:</span>
        <span class="n">new_fill</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s2">&quot;solidFill&quot;</span><span class="p">)</span>
        <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">new_fill</span><span class="p">,</span> <span class="s2">&quot;srbgClr&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;val&quot;</span><span class="p">:</span> <span class="n">new_color</span><span class="p">})</span>
        <span class="n">fill_tags</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;noFill&#39;</span><span class="p">,</span>
            <span class="s1">&#39;blipFill&#39;</span><span class="p">,</span>
            <span class="s1">&#39;gradFill&#39;</span><span class="p">,</span>
            <span class="s1">&#39;pattFill&#39;</span><span class="p">,</span>
            <span class="s1">&#39;solidFill&#39;</span>
        <span class="p">]</span>
        <span class="n">props</span> <span class="o">=</span> <span class="n">shape_xml</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//{*}spPr&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">props</span><span class="o">.</span><span class="n">getchildren</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;{*}&#39;</span> <span class="o">+</span> <span class="n">r</span><span class="p">,</span> <span class="n">child</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">fill_tags</span><span class="p">):</span>
                <span class="n">current_nsmap</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">nsmap</span>
                <span class="n">current_index</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
                <span class="n">current_prefix</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">prefix</span>
                <span class="n">current_ns</span> <span class="o">=</span> <span class="n">current_nsmap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">current_prefix</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
                <span class="n">new_fill</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">QName</span><span class="p">(</span><span class="n">current_ns</span><span class="p">,</span> <span class="s2">&quot;solidFill&quot;</span><span class="p">),</span> <span class="n">nsmap</span><span class="o">=</span><span class="n">current_nsmap</span><span class="p">)</span>
                <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">new_fill</span><span class="p">,</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">QName</span><span class="p">(</span><span class="n">current_ns</span><span class="p">,</span> <span class="s2">&quot;srgbClr&quot;</span><span class="p">),</span> <span class="p">{</span><span class="s2">&quot;val&quot;</span><span class="p">:</span> <span class="n">new_color</span><span class="p">},</span> <span class="n">nsmap</span><span class="o">=</span><span class="n">current_nsmap</span><span class="p">)</span>
                <span class="n">child</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
                <span class="n">props</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">current_index</span><span class="p">,</span> <span class="n">new_fill</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">shape_xml</span>

    <span class="k">def</span> <span class="nf">transform_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lxml_element</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;{.*}sp&#39;</span><span class="p">,</span> <span class="n">lxml_element</span><span class="o">.</span><span class="n">tag</span><span class="p">):</span>
            <span class="n">shapes</span> <span class="o">=</span> <span class="p">[</span><span class="n">lxml_element</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">shapes</span> <span class="o">=</span> <span class="n">lxml_element</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.//{*}sp&#39;</span><span class="p">)</span>
        <span class="n">object_name</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;object_name&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;hex_color&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">object_name</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">shape</span> <span class="ow">in</span> <span class="n">shapes</span><span class="p">:</span>
                <span class="n">is_target</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="n">nvprops</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//{*}nvSpPr&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nvprops</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="n">nvprops</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//*[@name]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">object_name</span><span class="p">:</span>
                        <span class="n">is_target</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">if</span> <span class="n">is_target</span><span class="p">:</span>
                    <span class="n">shape</span> <span class="o">=</span> <span class="n">ChangeShapeColor</span><span class="o">.</span><span class="n">replace_color_on_target_shape</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">shape</span> <span class="ow">in</span> <span class="n">shapes</span><span class="p">:</span>
                <span class="n">shape</span> <span class="o">=</span> <span class="n">ChangeShapeColor</span><span class="o">.</span><span class="n">replace_color_on_target_shape</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lxml_element</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#presalytics.ChangeShapeColor">ChangeShapeColor</a></li>
          <li><a href="#presalytics.XmlTransformBase">XmlTransformBase</a></li>
          <li>abc.ABC</li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.ChangeShapeColor.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, function_params, *args, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#presalytics.XmlTransformBase">XmlTransformBase</a></code>.<code><a href="#presalytics.XmlTransformBase.__init__">__init__</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.ChangeShapeColor.__init__', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.ChangeShapeColor.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function_params</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">function_params</span> <span class="o">=</span> <span class="n">function_params</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.ChangeShapeColor.execute">
    <p>def <span class="ident">execute</span>(</p><p>self, lxml_element)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.ChangeShapeColor.execute', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.ChangeShapeColor.execute" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lxml_element</span><span class="p">:</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform_function</span><span class="p">(</span><span class="n">lxml_element</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">function_params</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.ChangeShapeColor.replace_color_on_target_shape">
    <p>def <span class="ident">replace_color_on_target_shape</span>(</p><p>shape_xml, new_color)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.ChangeShapeColor.replace_color_on_target_shape', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.ChangeShapeColor.replace_color_on_target_shape" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">replace_color_on_target_shape</span><span class="p">(</span><span class="n">shape_xml</span><span class="p">:</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">,</span> <span class="n">new_color</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">:</span>
    <span class="n">new_fill</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s2">&quot;solidFill&quot;</span><span class="p">)</span>
    <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">new_fill</span><span class="p">,</span> <span class="s2">&quot;srbgClr&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;val&quot;</span><span class="p">:</span> <span class="n">new_color</span><span class="p">})</span>
    <span class="n">fill_tags</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;noFill&#39;</span><span class="p">,</span>
        <span class="s1">&#39;blipFill&#39;</span><span class="p">,</span>
        <span class="s1">&#39;gradFill&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pattFill&#39;</span><span class="p">,</span>
        <span class="s1">&#39;solidFill&#39;</span>
    <span class="p">]</span>
    <span class="n">props</span> <span class="o">=</span> <span class="n">shape_xml</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//{*}spPr&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">props</span><span class="o">.</span><span class="n">getchildren</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;{*}&#39;</span> <span class="o">+</span> <span class="n">r</span><span class="p">,</span> <span class="n">child</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">fill_tags</span><span class="p">):</span>
            <span class="n">current_nsmap</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">nsmap</span>
            <span class="n">current_index</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
            <span class="n">current_prefix</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">prefix</span>
            <span class="n">current_ns</span> <span class="o">=</span> <span class="n">current_nsmap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">current_prefix</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="n">new_fill</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">QName</span><span class="p">(</span><span class="n">current_ns</span><span class="p">,</span> <span class="s2">&quot;solidFill&quot;</span><span class="p">),</span> <span class="n">nsmap</span><span class="o">=</span><span class="n">current_nsmap</span><span class="p">)</span>
            <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">new_fill</span><span class="p">,</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">QName</span><span class="p">(</span><span class="n">current_ns</span><span class="p">,</span> <span class="s2">&quot;srgbClr&quot;</span><span class="p">),</span> <span class="p">{</span><span class="s2">&quot;val&quot;</span><span class="p">:</span> <span class="n">new_color</span><span class="p">},</span> <span class="n">nsmap</span><span class="o">=</span><span class="n">current_nsmap</span><span class="p">)</span>
            <span class="n">child</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
            <span class="n">props</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">current_index</span><span class="p">,</span> <span class="n">new_fill</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">shape_xml</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.ChangeShapeColor.transform_function">
    <p>def <span class="ident">transform_function</span>(</p><p>self, lxml_element, params)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.ChangeShapeColor.transform_function', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.ChangeShapeColor.transform_function" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">transform_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lxml_element</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;{.*}sp&#39;</span><span class="p">,</span> <span class="n">lxml_element</span><span class="o">.</span><span class="n">tag</span><span class="p">):</span>
        <span class="n">shapes</span> <span class="o">=</span> <span class="p">[</span><span class="n">lxml_element</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">shapes</span> <span class="o">=</span> <span class="n">lxml_element</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.//{*}sp&#39;</span><span class="p">)</span>
    <span class="n">object_name</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;object_name&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;hex_color&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">object_name</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">shape</span> <span class="ow">in</span> <span class="n">shapes</span><span class="p">:</span>
            <span class="n">is_target</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">nvprops</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//{*}nvSpPr&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nvprops</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">nvprops</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//*[@name]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">object_name</span><span class="p">:</span>
                    <span class="n">is_target</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">if</span> <span class="n">is_target</span><span class="p">:</span>
                <span class="n">shape</span> <span class="o">=</span> <span class="n">ChangeShapeColor</span><span class="o">.</span><span class="n">replace_color_on_target_shape</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">shape</span> <span class="ow">in</span> <span class="n">shapes</span><span class="p">:</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="n">ChangeShapeColor</span><span class="o">.</span><span class="n">replace_color_on_target_shape</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lxml_element</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="presalytics.Client" class="name">class <span class="ident">Client</span></p>
      
  
    <div class="desc"><p>Class for interacting with Presalytics API endpoints</p>
<p>The Client class creates a simple interface for user to interactive with the 
Presaltyics API and is the primary building block user-built tools, stories, 
dashboards and interactive presentations.</p>
<p>A client instance wraps python functions around Presalytics API endpoints and
manages user authentication. On initialization, he client checks the status of 
a user authentication the expiry of their refresh an access tokens.  When needed,
the client will prompt (or raise a )</p>
<p>After authenication, users can the methods bound to the story, ooxml_automation, 
and doc_converter attributes to make calls in into the Presalytics API.</p>
<p>A note for server-side development:</p>
<p>By default, the client class automatically caches tokens in a file called 
"token.json", located in the python's current working directory.  If building a
client to operate in a multi-user environment, this behavior should be turned off.
To do this, ensure the following parameters are pass to the configuration: </p>
<div class="codehilite"><pre><span></span><span class="n">cache_tokens</span> <span class="o">=</span> <span class="k">False</span><span class="p">,</span>
<span class="n">delegate_login</span> <span class="o">=</span> <span class="k">True</span>
</pre></div>


<p>When delegate login is True, the client assumes that the application creating 
instances of the client object will handle user authentication.  The simplest way
to do this is to pass a token to the client via the "token" keyword argument.</p>
<h2>Parameters:</h2>
<h2>Attributes:</h2></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Client', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Client" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Client</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Class for interacting with Presalytics API endpoints</span>

<span class="sd">    The Client class creates a simple interface for user to interactive with the </span>
<span class="sd">    Presaltyics API and is the primary building block user-built tools, stories, </span>
<span class="sd">    dashboards and interactive presentations.</span>

<span class="sd">    A client instance wraps python functions around Presalytics API endpoints and</span>
<span class="sd">    manages user authentication. On initialization, he client checks the status of </span>
<span class="sd">    a user authentication the expiry of their refresh an access tokens.  When needed,</span>
<span class="sd">    the client will prompt (or raise a )</span>

<span class="sd">    After authenication, users can the methods bound to the story, ooxml_automation, </span>
<span class="sd">    and doc_converter attributes to make calls in into the Presalytics API.</span>


<span class="sd">    A note for server-side development:</span>

<span class="sd">    By default, the client class automatically caches tokens in a file called </span>
<span class="sd">    &quot;token.json&quot;, located in the python&#39;s current working directory.  If building a</span>
<span class="sd">    client to operate in a multi-user environment, this behavior should be turned off.</span>
<span class="sd">    To do this, ensure the following parameters are pass to the configuration: </span>
<span class="sd">    </span>
<span class="sd">        cache_tokens = False,</span>
<span class="sd">        delegate_login = True</span>
<span class="sd">    </span>
<span class="sd">    When delegate login is True, the client assumes that the application creating </span>
<span class="sd">    instances of the client object will handle user authentication.  The simplest way</span>
<span class="sd">    to do this is to pass a token to the client via the &quot;token&quot; keyword argument.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ----------</span>

<span class="sd">    Attributes:</span>
<span class="sd">    ----------</span>
<span class="sd">      </span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">delegate_login</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
            <span class="n">token</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
            <span class="n">cache_tokens</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
            <span class="n">username</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    
        <span class="k">if</span> <span class="n">username</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">username</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">CONFIG</span><span class="p">[</span><span class="s1">&#39;USERNAME&#39;</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">token</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">MissingConfigException</span><span class="p">(</span><span class="s2">&quot;Configuration variable PRESALYTICS_USERNAME is required when client is not initalized with an API token.  Please reconfigure and retry.&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">password</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="n">password</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">CONFIG</span><span class="p">[</span><span class="s1">&#39;PASSWORD&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">direct_grant</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">direct_grant</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">CONFIG</span><span class="p">[</span><span class="s1">&#39;CLIENT_ID&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span> <span class="o">=</span> <span class="n">cnst</span><span class="o">.</span><span class="n">DEFAULT_CLIENT_ID</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client_secret</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">CONFIG</span><span class="p">[</span><span class="s1">&#39;CLIENT_SECRET&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">confidential_client</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client_secret</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">confidential_client</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verify_https</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">bool</span><span class="p">(</span><span class="s2">&quot;VERIFY_HTTPS&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">site_host</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">CONFIG</span><span class="p">[</span><span class="s2">&quot;HOSTS&quot;</span><span class="p">][</span><span class="s2">&quot;SITE&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">site_host</span> <span class="o">=</span> <span class="n">cnst</span><span class="o">.</span><span class="n">SITE_HOST</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">login_sleep_interval</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># seconds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">login_timeout</span> <span class="o">=</span> <span class="mi">60</span>  <span class="c1"># seconds</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">redirect_uri</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">CONFIG</span><span class="p">[</span><span class="s2">&quot;REDIRECT_URI&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">redirect_uri</span> <span class="o">=</span> <span class="n">cnst</span><span class="o">.</span><span class="n">REDIRECT_URI</span>
        <span class="k">if</span> <span class="n">delegate_login</span> <span class="ow">or</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">CONFIG</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;DELEGATE_LOGIN&quot;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_delegate_login</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_delegate_login</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oidc</span> <span class="o">=</span> <span class="n">keycloak</span><span class="o">.</span><span class="n">KeycloakOpenID</span><span class="p">(</span>
            <span class="n">server_url</span><span class="o">=</span><span class="n">cnst</span><span class="o">.</span><span class="n">OIDC_AUTH_HOST</span><span class="p">,</span>
            <span class="n">realm_name</span><span class="o">=</span><span class="n">cnst</span><span class="o">.</span><span class="n">OIDC_REALM</span><span class="p">,</span>
            <span class="n">client_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span>
            <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verify_https</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">TokenUtil</span><span class="p">(</span><span class="n">token_cache</span><span class="o">=</span><span class="n">cache_tokens</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">token</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;access_token_expire_time&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="n">token</span>
            <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;expires_in&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">process_keycloak_token</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">InvalidTokenException</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;Unknown token format.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">token_cache</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">_put_token_file</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delegate_login</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">()</span>

        <span class="n">doc_converter_api_client</span> <span class="o">=</span> <span class="n">DocConverterApiClientWithAuth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doc_converter</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">presalytics_doc_converter</span><span class="o">.</span><span class="n">DefaultApi</span><span class="p">(</span><span class="n">api_client</span><span class="o">=</span><span class="n">doc_converter_api_client</span><span class="p">)</span>
        <span class="n">ooxml_automation_api_client</span> <span class="o">=</span> <span class="n">OoxmlAutomationApiClientWithAuth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ooxml_automation</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">presalytics_ooxml_automation</span><span class="o">.</span><span class="n">DefaultApi</span><span class="p">(</span><span class="n">api_client</span><span class="o">=</span><span class="n">ooxml_automation_api_client</span><span class="p">)</span>
        <span class="n">story_api_client</span> <span class="o">=</span> <span class="n">StoryApiClientWithAuth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">story</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">presalytics_story</span><span class="o">.</span><span class="n">DefaultApi</span><span class="p">(</span><span class="n">api_client</span><span class="o">=</span><span class="n">story_api_client</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">login</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direct_grant</span><span class="p">:</span>
                <span class="n">keycloak_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oidc</span><span class="o">.</span><span class="n">token</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">password</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">keycloak_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_new_token_browser</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">keycloak</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">KeycloakGetError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">response_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Received reponse code 404 from api authentication.  Indicates username does not exist.  Please recheck config and try again.&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">e</span><span class="o">.</span><span class="n">response_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Received 401 response code from api authentication.  This user&#39;s access to this resource is unauthorized&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">e</span><span class="o">.</span><span class="n">response_code</span> <span class="o">&gt;=</span> <span class="mi">500</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Server error.  Please try again later.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">error_message</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">MissingConfigException</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">error_message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">process_keycloak_token</span><span class="p">(</span><span class="n">keycloak_token</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">token</span>

    <span class="k">def</span> <span class="nf">exchange_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">original_token</span><span class="p">,</span> <span class="n">audience</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Requires developer account and authorized client credentials &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oidc</span><span class="o">.</span><span class="n">decode_token</span><span class="p">(</span><span class="n">original_token</span><span class="p">,</span> <span class="n">cnst</span><span class="o">.</span><span class="n">JWT_KEY</span><span class="p">)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;client_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span>
            <span class="s2">&quot;client_secret&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_secret</span><span class="p">,</span>
            <span class="s2">&quot;grant_type&quot;</span><span class="p">:</span> <span class="s2">&quot;urn:ietf:params:oauth:grant-type:token-exchange&quot;</span><span class="p">,</span>
            <span class="s2">&quot;subject_token&quot;</span><span class="p">:</span> <span class="n">original_token</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">audience</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;audience&quot;</span><span class="p">:</span> <span class="n">audience</span>
                <span class="p">}</span>
            <span class="p">)</span>
        <span class="n">keycloak_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oidc</span><span class="o">.</span><span class="n">token</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">process_keycloak_token</span><span class="p">(</span><span class="n">keycloak_token</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">token</span><span class="p">[</span><span class="s2">&quot;access_token&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_get_new_token_browser</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Opens browser in on presalytics.io and prompts for user login.</span>
<span class="sd">        Retrieves authorization code from website and obtains api token</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Opening new browser tab.  Please input login credentials...&quot;</span><span class="p">)</span>
        <span class="n">api_otp</span> <span class="o">=</span> <span class="n">uuid4</span><span class="p">()</span>
        <span class="n">query</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;api_otp&quot;</span><span class="p">:</span> <span class="n">api_otp</span><span class="p">,</span>
            <span class="s2">&quot;client_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span>
            <span class="s2">&quot;next&quot;</span><span class="p">:</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlparse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">redirect_uri</span><span class="p">)</span><span class="o">.</span><span class="n">path</span>
        <span class="p">}</span>
        <span class="n">query_string</span> <span class="o">=</span> <span class="s1">&#39;?{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">query</span><span class="p">))</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urljoin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">site_host</span><span class="p">,</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urljoin</span><span class="p">(</span><span class="n">cnst</span><span class="o">.</span><span class="n">LOGIN_PATH</span><span class="p">,</span> <span class="n">query_string</span><span class="p">))</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open_new_tab</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">auth_code</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span>
            <span class="s2">&quot;api_otp&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">api_otp</span><span class="p">),</span>
            <span class="s2">&quot;client_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span>
        <span class="p">}</span>

        <span class="n">auth_code_url</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urljoin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">site_host</span><span class="p">,</span> <span class="n">cnst</span><span class="o">.</span><span class="n">API_CODE_URL</span><span class="p">)</span>
        <span class="n">interval</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">auth_code_url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verify_https</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">interval</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">login_timeout</span><span class="p">:</span>
                    <span class="n">interval</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">login_sleep_interval</span>
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">login_sleep_interval</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">LoginTimeout</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;token&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>
            <span class="c1">#  pick up otp token off presalytics backend</span>
            <span class="n">token</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;token&quot;</span><span class="p">)</span> 
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># support oidc authorization code flow</span>
            <span class="n">auth_code</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;authorization_code&quot;</span><span class="p">]</span>
            <span class="n">token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oidc</span><span class="o">.</span><span class="n">token</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="n">grant_type</span><span class="o">=</span><span class="s2">&quot;authorization_code&quot;</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="n">auth_code</span><span class="p">,</span> <span class="n">redirect_uri</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">redirect_uri</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">token</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Login Succeeded.  Proceeding.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">token</span>

    <span class="k">def</span> <span class="nf">refresh_token</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">is_api_access_token_expired</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">is_api_refresh_token_expired</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delegate_login</span><span class="p">:</span>  <span class="c1"># do not automatically log in at init</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">login</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">InvalidTokenException</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;This token has expired.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">refresh_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">token</span><span class="p">[</span><span class="s2">&quot;refresh_token&quot;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oidc</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">(</span><span class="n">refresh_token</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">keycloak</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">KeycloakGetError</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delegate_login</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">login</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">token_cache</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">_put_token_file</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">token</span>

    <span class="k">def</span> <span class="nf">get_auth_header</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">()</span>
        <span class="n">auth_header</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="s2">&quot;Bearer &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">token</span><span class="p">[</span><span class="s2">&quot;access_token&quot;</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">auth_header</span>

    <span class="k">def</span> <span class="nf">get_request_id_header</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;X-Request-Id&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid4</span><span class="p">())</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">download_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">story_id</span><span class="p">,</span> <span class="n">ooxml_automation_id</span><span class="p">,</span> <span class="n">download_folder</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">response</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">story_id_file_ooxmlautomationid_get_with_http_info</span><span class="p">(</span><span class="n">story_id</span><span class="p">,</span> <span class="n">ooxml_automation_id</span><span class="p">,</span> <span class="n">_preload_content</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">download_folder</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">download_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">cd_header</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">)</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="n">cgi</span><span class="o">.</span><span class="n">parse_header</span><span class="p">(</span><span class="n">cd_header</span><span class="p">)</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span>
        <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#presalytics.Client">Client</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.Client.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, delegate_login=False, token=None, cache_tokens=True, username=None, password=None, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Client.__init__', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Client.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">delegate_login</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
        <span class="n">token</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">cache_tokens</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">username</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">password</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">username</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">username</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">CONFIG</span><span class="p">[</span><span class="s1">&#39;USERNAME&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">token</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">MissingConfigException</span><span class="p">(</span><span class="s2">&quot;Configuration variable PRESALYTICS_USERNAME is required when client is not initalized with an API token.  Please reconfigure and retry.&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">password</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="n">password</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">CONFIG</span><span class="p">[</span><span class="s1">&#39;PASSWORD&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">direct_grant</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">direct_grant</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">CONFIG</span><span class="p">[</span><span class="s1">&#39;CLIENT_ID&#39;</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span> <span class="o">=</span> <span class="n">cnst</span><span class="o">.</span><span class="n">DEFAULT_CLIENT_ID</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_secret</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">CONFIG</span><span class="p">[</span><span class="s1">&#39;CLIENT_SECRET&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confidential_client</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_secret</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confidential_client</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">verify_https</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">bool</span><span class="p">(</span><span class="s2">&quot;VERIFY_HTTPS&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">site_host</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">CONFIG</span><span class="p">[</span><span class="s2">&quot;HOSTS&quot;</span><span class="p">][</span><span class="s2">&quot;SITE&quot;</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">site_host</span> <span class="o">=</span> <span class="n">cnst</span><span class="o">.</span><span class="n">SITE_HOST</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">login_sleep_interval</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># seconds</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">login_timeout</span> <span class="o">=</span> <span class="mi">60</span>  <span class="c1"># seconds</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redirect_uri</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">CONFIG</span><span class="p">[</span><span class="s2">&quot;REDIRECT_URI&quot;</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redirect_uri</span> <span class="o">=</span> <span class="n">cnst</span><span class="o">.</span><span class="n">REDIRECT_URI</span>
    <span class="k">if</span> <span class="n">delegate_login</span> <span class="ow">or</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">CONFIG</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;DELEGATE_LOGIN&quot;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_delegate_login</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_delegate_login</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">oidc</span> <span class="o">=</span> <span class="n">keycloak</span><span class="o">.</span><span class="n">KeycloakOpenID</span><span class="p">(</span>
        <span class="n">server_url</span><span class="o">=</span><span class="n">cnst</span><span class="o">.</span><span class="n">OIDC_AUTH_HOST</span><span class="p">,</span>
        <span class="n">realm_name</span><span class="o">=</span><span class="n">cnst</span><span class="o">.</span><span class="n">OIDC_REALM</span><span class="p">,</span>
        <span class="n">client_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span>
        <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verify_https</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">TokenUtil</span><span class="p">(</span><span class="n">token_cache</span><span class="o">=</span><span class="n">cache_tokens</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">token</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;access_token_expire_time&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="n">token</span>
        <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;expires_in&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">process_keycloak_token</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">InvalidTokenException</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;Unknown token format.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">token_cache</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">_put_token_file</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delegate_login</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">()</span>
    <span class="n">doc_converter_api_client</span> <span class="o">=</span> <span class="n">DocConverterApiClientWithAuth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">doc_converter</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">presalytics_doc_converter</span><span class="o">.</span><span class="n">DefaultApi</span><span class="p">(</span><span class="n">api_client</span><span class="o">=</span><span class="n">doc_converter_api_client</span><span class="p">)</span>
    <span class="n">ooxml_automation_api_client</span> <span class="o">=</span> <span class="n">OoxmlAutomationApiClientWithAuth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ooxml_automation</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">presalytics_ooxml_automation</span><span class="o">.</span><span class="n">DefaultApi</span><span class="p">(</span><span class="n">api_client</span><span class="o">=</span><span class="n">ooxml_automation_api_client</span><span class="p">)</span>
    <span class="n">story_api_client</span> <span class="o">=</span> <span class="n">StoryApiClientWithAuth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">story</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">presalytics_story</span><span class="o">.</span><span class="n">DefaultApi</span><span class="p">(</span><span class="n">api_client</span><span class="o">=</span><span class="n">story_api_client</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Client.download_file">
    <p>def <span class="ident">download_file</span>(</p><p>self, story_id, ooxml_automation_id, download_folder=None, filename=None, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Client.download_file', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Client.download_file" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">download_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">story_id</span><span class="p">,</span> <span class="n">ooxml_automation_id</span><span class="p">,</span> <span class="n">download_folder</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">response</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">story_id_file_ooxmlautomationid_get_with_http_info</span><span class="p">(</span><span class="n">story_id</span><span class="p">,</span> <span class="n">ooxml_automation_id</span><span class="p">,</span> <span class="n">_preload_content</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">download_folder</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">download_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">cd_header</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="n">cgi</span><span class="o">.</span><span class="n">parse_header</span><span class="p">(</span><span class="n">cd_header</span><span class="p">)</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Client.exchange_token">
    <p>def <span class="ident">exchange_token</span>(</p><p>self, original_token, audience=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Requires developer account and authorized client credentials</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Client.exchange_token', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Client.exchange_token" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">exchange_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">original_token</span><span class="p">,</span> <span class="n">audience</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Requires developer account and authorized client credentials &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">oidc</span><span class="o">.</span><span class="n">decode_token</span><span class="p">(</span><span class="n">original_token</span><span class="p">,</span> <span class="n">cnst</span><span class="o">.</span><span class="n">JWT_KEY</span><span class="p">)</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;client_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span>
        <span class="s2">&quot;client_secret&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_secret</span><span class="p">,</span>
        <span class="s2">&quot;grant_type&quot;</span><span class="p">:</span> <span class="s2">&quot;urn:ietf:params:oauth:grant-type:token-exchange&quot;</span><span class="p">,</span>
        <span class="s2">&quot;subject_token&quot;</span><span class="p">:</span> <span class="n">original_token</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">audience</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;audience&quot;</span><span class="p">:</span> <span class="n">audience</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="n">keycloak_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oidc</span><span class="o">.</span><span class="n">token</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">process_keycloak_token</span><span class="p">(</span><span class="n">keycloak_token</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">token</span><span class="p">[</span><span class="s2">&quot;access_token&quot;</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Client.get_auth_header">
    <p>def <span class="ident">get_auth_header</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Client.get_auth_header', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Client.get_auth_header" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_auth_header</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">()</span>
    <span class="n">auth_header</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="s2">&quot;Bearer &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">token</span><span class="p">[</span><span class="s2">&quot;access_token&quot;</span><span class="p">]</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">auth_header</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Client.get_request_id_header">
    <p>def <span class="ident">get_request_id_header</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Client.get_request_id_header', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Client.get_request_id_header" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_request_id_header</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;X-Request-Id&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid4</span><span class="p">())</span>
    <span class="p">}</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Client.login">
    <p>def <span class="ident">login</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Client.login', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Client.login" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">login</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direct_grant</span><span class="p">:</span>
            <span class="n">keycloak_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oidc</span><span class="o">.</span><span class="n">token</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">password</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">keycloak_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_new_token_browser</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">keycloak</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">KeycloakGetError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">response_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Received reponse code 404 from api authentication.  Indicates username does not exist.  Please recheck config and try again.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">e</span><span class="o">.</span><span class="n">response_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Received 401 response code from api authentication.  This user&#39;s access to this resource is unauthorized&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">e</span><span class="o">.</span><span class="n">response_code</span> <span class="o">&gt;=</span> <span class="mi">500</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Server error.  Please try again later.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">error_message</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">MissingConfigException</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">error_message</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">process_keycloak_token</span><span class="p">(</span><span class="n">keycloak_token</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">token</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Client.refresh_token">
    <p>def <span class="ident">refresh_token</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Client.refresh_token', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Client.refresh_token" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">refresh_token</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">is_api_access_token_expired</span><span class="p">():</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">is_api_refresh_token_expired</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delegate_login</span><span class="p">:</span>  <span class="c1"># do not automatically log in at init</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">login</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">InvalidTokenException</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;This token has expired.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">refresh_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">token</span><span class="p">[</span><span class="s2">&quot;refresh_token&quot;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oidc</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">(</span><span class="n">refresh_token</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">keycloak</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">KeycloakGetError</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delegate_login</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">login</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">token_cache</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">_put_token_file</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">token</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="presalytics.Client.doc_converter" class="name">var <span class="ident">doc_converter</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.Client.login_sleep_interval" class="name">var <span class="ident">login_sleep_interval</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.Client.login_timeout" class="name">var <span class="ident">login_timeout</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.Client.oidc" class="name">var <span class="ident">oidc</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.Client.ooxml_automation" class="name">var <span class="ident">ooxml_automation</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.Client.story" class="name">var <span class="ident">story</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.Client.token_util" class="name">var <span class="ident">token_util</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.Client.verify_https" class="name">var <span class="ident">verify_https</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="presalytics.JinjaPluginMakerMixin" class="name">class <span class="ident">JinjaPluginMakerMixin</span></p>
      
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.JinjaPluginMakerMixin', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.JinjaPluginMakerMixin" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">JinjaPluginMakerMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">template</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">template</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">JinjaPluginMakerMixin</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">*</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;loader&quot;</span><span class="p">:</span> <span class="n">jinja2</span><span class="o">.</span><span class="n">BaseLoader</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;jinja_options&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>
            <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;jinja_options&quot;</span><span class="p">))</span>
        <span class="n">template</span> <span class="o">=</span> <span class="n">jinja2</span><span class="o">.</span><span class="n">Environment</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_template</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_template</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;Plugins the use the JinjaPluginMakerMixin must have a defiined template attribute.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#presalytics.JinjaPluginMakerMixin">JinjaPluginMakerMixin</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="presalytics.JinjaPluginMakerMixin.template" class="name">var <span class="ident">template</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.JinjaPluginMakerMixin.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.JinjaPluginMakerMixin.__init__', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.JinjaPluginMakerMixin.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">JinjaPluginMakerMixin</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">*</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.JinjaPluginMakerMixin.get_template">
    <p>def <span class="ident">get_template</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.JinjaPluginMakerMixin.get_template', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.JinjaPluginMakerMixin.get_template" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_template</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;Plugins the use the JinjaPluginMakerMixin must have a defiined template attribute.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.JinjaPluginMakerMixin.render">
    <p>def <span class="ident">render</span>(</p><p>self, config)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.JinjaPluginMakerMixin.render', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.JinjaPluginMakerMixin.render" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;loader&quot;</span><span class="p">:</span> <span class="n">jinja2</span><span class="o">.</span><span class="n">BaseLoader</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;jinja_options&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;jinja_options&quot;</span><span class="p">))</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">jinja2</span><span class="o">.</span><span class="n">Environment</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_template</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="presalytics.JinjaTemplateBuilder" class="name">class <span class="ident">JinjaTemplateBuilder</span></p>
      
  
    <div class="desc"><p>Inherit from this base class to render templates to html via the
presalytics.story.revealer.Revealer class.</p>
<h2>Parameters:</h2>
<p>page: Page
    A presalytics.story.outline.Page object for instalizing the class</p>
<h2>Attributes:</h2>
<p>outline_page: Page
    A presalytics.story.outline.Page object</p>
<p>widgets: List[WidgetComponentBase]
    A list widget that will be loaded into templates and rendered via placeholders.
    These widgets must have a "to_html(self, data, **kwargs)" method.</p>
<p>css: List[str]
    A list of keys in dot notation that point to links in the ALLOWED_STYLES dictionary
    in the presalytics.lib.templates.base module.</p>
<p>js: List[str]
    A list of keys in dot notation that point to links in the ALLOWED_SCRIPTS dictionary
    in the presalytics.lib.templates.base module.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.JinjaTemplateBuilder', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.JinjaTemplateBuilder" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">JinjaTemplateBuilder</span><span class="p">(</span><span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">PageTemplateBase</span><span class="p">):</span>
    <span class="n">__css__</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">__template_file__</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">__template_paths__</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">template_paths</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>

    <span class="n">__template_paths__</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">__css__</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="s1">&#39;Page&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">page</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pkg_templates</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s2">&quot;html&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">template_paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">pkg_templates</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__template_paths__</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">template_paths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__template_paths__</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@util.classproperty</span>
    <span class="k">def</span> <span class="nf">__plugins__</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">plugin_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__css__</span><span class="p">:</span>
            <span class="n">new_item</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;kind&#39;</span><span class="p">:</span> <span class="s1">&#39;style&#39;</span><span class="p">,</span>
                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;local&#39;</span><span class="p">,</span>
                <span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;css_file_id&#39;</span><span class="p">:</span> <span class="nb">id</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="n">plugin_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_item</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plugin_list</span>

    <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">updated_plugins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">plugin_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plugins__</span><span class="p">:</span>
            <span class="n">updated_plugins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">Plugin</span><span class="p">(</span><span class="o">**</span><span class="n">plugin_data</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outline_page</span><span class="o">.</span><span class="n">plugins</span> <span class="o">=</span> <span class="n">updated_plugins</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">outline_page</span>

    <span class="k">def</span> <span class="nf">get_template_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Requires subclasses have either a &quot;__template___&quot; property or override this method</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__template_file__</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__template_file__</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">template</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_jinja_template</span><span class="p">()</span>
        <span class="n">context</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;widgets&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">widgets</span><span class="p">,</span>
            <span class="s2">&quot;widget_index&quot;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">outline_page</span><span class="o">.</span><span class="n">additional_properties</span><span class="p">:</span>
            <span class="n">context</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outline_page</span><span class="o">.</span><span class="n">additional_properties</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="o">**</span><span class="n">context</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_jinja_template</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jinja2</span><span class="o">.</span><span class="n">Template</span><span class="p">:</span>
        <span class="n">loader</span> <span class="o">=</span> <span class="n">jinja2</span><span class="o">.</span><span class="n">FileSystemLoader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">template_paths</span><span class="p">)</span>
        <span class="n">env</span> <span class="o">=</span> <span class="n">jinja2</span><span class="o">.</span><span class="n">Environment</span><span class="p">(</span><span class="n">loader</span><span class="o">=</span><span class="n">loader</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_template_name</span><span class="p">())</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#presalytics.JinjaTemplateBuilder">JinjaTemplateBuilder</a></li>
          <li><a href="#presalytics.PageTemplateBase">PageTemplateBase</a></li>
          <li>presalytics.story.components.ComponentBase</li>
          <li>abc.ABC</li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.JinjaTemplateBuilder.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, page, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.JinjaTemplateBuilder.__init__', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.JinjaTemplateBuilder.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="s1">&#39;Page&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">page</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">pkg_templates</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s2">&quot;html&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">template_paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">pkg_templates</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__template_paths__</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">template_paths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__template_paths__</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.JinjaTemplateBuilder.get_client">
    <p>def <span class="ident">get_client</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.JinjaTemplateBuilder.get_client', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.JinjaTemplateBuilder.get_client" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">client_info</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.JinjaTemplateBuilder.get_page_widgets">
    <p>def <span class="ident">get_page_widgets</span>(</p><p>self, page)</p>
    </div>
    

    
  
    <div class="desc"><p>Converts the widgets within a presaltytics.story.outline.Page object to a list
of widgets subclassed from WidgetComponentBase</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.JinjaTemplateBuilder.get_page_widgets', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.JinjaTemplateBuilder.get_page_widgets" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_page_widgets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="s1">&#39;Page&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the widgets within a presaltytics.story.outline.Page object to a list</span>
<span class="sd">    of widgets subclassed from WidgetComponentBase</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">widget_instances</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">widget_outline</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">widgets</span><span class="p">:</span>
        <span class="n">next_widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_widget</span><span class="p">(</span><span class="n">widget_outline</span><span class="p">)</span>
        <span class="n">widget_instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_widget</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">widget_instances</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.JinjaTemplateBuilder.get_template_name">
    <p>def <span class="ident">get_template_name</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Requires subclasses have either a "<strong>template</strong>_" property or override this method</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.JinjaTemplateBuilder.get_template_name', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.JinjaTemplateBuilder.get_template_name" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_template_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Requires subclasses have either a &quot;__template___&quot; property or override this method</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__template_file__</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__template_file__</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.JinjaTemplateBuilder.load_jinja_template">
    <p>def <span class="ident">load_jinja_template</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.JinjaTemplateBuilder.load_jinja_template', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.JinjaTemplateBuilder.load_jinja_template" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">load_jinja_template</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jinja2</span><span class="o">.</span><span class="n">Template</span><span class="p">:</span>
    <span class="n">loader</span> <span class="o">=</span> <span class="n">jinja2</span><span class="o">.</span><span class="n">FileSystemLoader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">template_paths</span><span class="p">)</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">jinja2</span><span class="o">.</span><span class="n">Environment</span><span class="p">(</span><span class="n">loader</span><span class="o">=</span><span class="n">loader</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_template_name</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.JinjaTemplateBuilder.load_widget">
    <p>def <span class="ident">load_widget</span>(</p><p>self, widget)</p>
    </div>
    

    
  
    <div class="desc"><p>Converts a presalytics.story.outline.Widget object to a subclass of WidgetComponentBase
via a presalytics.story.loaders.WidgetLoaderBase object.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.JinjaTemplateBuilder.load_widget', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.JinjaTemplateBuilder.load_widget" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">load_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">:</span> <span class="s1">&#39;Widget&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a presalytics.story.outline.Widget object to a subclass of WidgetComponentBase</span>
<span class="sd">    via a presalytics.story.loaders.WidgetLoaderBase object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">class_key</span> <span class="o">=</span> <span class="s2">&quot;widget.&quot;</span> <span class="o">+</span> <span class="n">widget</span><span class="o">.</span><span class="n">kind</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">class_key</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">widget</span><span class="o">.</span><span class="n">name</span>
    <span class="k">if</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="n">widget_instance</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">klass</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">class_key</span><span class="p">)</span>
        <span class="n">deserialize_method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">klass</span><span class="p">,</span> <span class="s2">&quot;deserialize&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">deserialize_method</span><span class="p">):</span>
            <span class="n">widget_instance</span> <span class="o">=</span> <span class="n">deserialize_method</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="n">client_info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client_info</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Widget component instance or class (kind) {0} unavailable in component registry&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">MissingConfigException</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">widget_instance</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.JinjaTemplateBuilder.render">
    <p>def <span class="ident">render</span>(</p><p>self, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns valid html that renders the template in a broswer with data loaded from widgets.</p>
<h2>Parameters:</h2>
<p>widgets: Sequence[WidgetComponentBase]
    List of widget instances a one to many different class that inhereit from the WidgetComponentBase
    abstract class. Defaults tot he widget list that the class as initilazed with.</p>
<p>**kwargs:
    Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.
    these keyword arguments should be geinvariant through successive updates to the chart.  For example,
    keycloak argument should control the styling of the widget, which should not change as the data in
    the object (e.g., a chart) is updated.  Keyword arguments are loaded via additional_properties
    parameter in in the presalytics.story.outline.Widget object.</p>
<h2>Returns</h2>
<p>A string of containing an html fragment that will be loaded into a template in successive operations</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.JinjaTemplateBuilder.render', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.JinjaTemplateBuilder.render" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">template</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_jinja_template</span><span class="p">()</span>
    <span class="n">context</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;widgets&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">widgets</span><span class="p">,</span>
        <span class="s2">&quot;widget_index&quot;</span><span class="p">:</span> <span class="mi">0</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">outline_page</span><span class="o">.</span><span class="n">additional_properties</span><span class="p">:</span>
        <span class="n">context</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outline_page</span><span class="o">.</span><span class="n">additional_properties</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="o">**</span><span class="n">context</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.JinjaTemplateBuilder.serialize">
    <p>def <span class="ident">serialize</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.JinjaTemplateBuilder.serialize', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.JinjaTemplateBuilder.serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">updated_plugins</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">plugin_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plugins__</span><span class="p">:</span>
        <span class="n">updated_plugins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">Plugin</span><span class="p">(</span><span class="o">**</span><span class="n">plugin_data</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">outline_page</span><span class="o">.</span><span class="n">plugins</span> <span class="o">=</span> <span class="n">updated_plugins</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">outline_page</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="presalytics.JinjaTemplateBuilder.template_paths" class="name">var <span class="ident">template_paths</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.JinjaTemplateBuilder.deseriailize">
    <p>def <span class="ident">deseriailize</span>(</p><p>cls, component, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.JinjaTemplateBuilder.deseriailize', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.JinjaTemplateBuilder.deseriailize" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">deseriailize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">page</span><span class="o">=</span><span class="n">component</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.JinjaTemplateBuilder.deserialize">
    <p>def <span class="ident">deserialize</span>(</p><p>cls, component, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.JinjaTemplateBuilder.deserialize', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.JinjaTemplateBuilder.deserialize" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="presalytics.LocalStylesPlugin" class="name">class <span class="ident">LocalStylesPlugin</span></p>
      
  
    <div class="desc"><p>A script plugin render configures templated scripts to append to the body
tag of an html document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.LocalStylesPlugin', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.LocalStylesPlugin" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">LocalStylesPlugin</span><span class="p">(</span><span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">plugins</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">StylePlugin</span><span class="p">):</span>
    <span class="n">__plugin_name__</span> <span class="o">=</span> <span class="s1">&#39;local&#39;</span>

    <span class="k">def</span> <span class="nf">to_style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;css_file_id&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">id</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;css_file_path&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">file_path</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;Plugin requires &quot;css_file_id&quot; or &quot;css_file_path&quot; in its configuration dictionary&#39;</span>
                <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">MissingConfigException</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
                <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;Path {0} in plugin configuration does not exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">MissingConfigException</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">local_styles_map</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">style_data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="s2">&quot;&lt;style&gt;{0}&lt;/style&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">style_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tag</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#presalytics.LocalStylesPlugin">LocalStylesPlugin</a></li>
          <li>presalytics.lib.plugins.base.StylePlugin</li>
          <li><a href="#presalytics.PluginBase">PluginBase</a></li>
          <li>abc.ABC</li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.LocalStylesPlugin.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#presalytics.PluginBase">PluginBase</a></code>.<code><a href="#presalytics.PluginBase.__init__">__init__</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.LocalStylesPlugin.__init__', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.LocalStylesPlugin.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">validate_metadata</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.LocalStylesPlugin.get_tag">
    <p>def <span class="ident">get_tag</span>(</p><p>self, config, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Generic method to be implemented by all inheriting classes. Allow plugin
to be render without knowledge of the underlying plugin kind.</p>
<h2>Parameters:</h2>
<p>config: Dict
    A set configuration values for the plugin.  Required keys should be
    specified by the docstring of the inheriting classes.
    Can be implemented via a mypy_extensions.TypedDict object if warranted.
    The presalytics.story.outline.Plugin's config element should be passed
    as this value to render the script.</p>
<h2>Returns:</h2>
<p>A string carrying a html script that can be embedded in a html document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.LocalStylesPlugin.get_tag', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.LocalStylesPlugin.get_tag" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_style</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.LocalStylesPlugin.to_style">
    <p>def <span class="ident">to_style</span>(</p><p>self, config, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>The to_style method maps a dictionary to an html style tag.</p>
<h2>Parameters:</h2>
<p>config: Dict
    A set configuration values for the plugin.  Required keys should be
    specified by the docstring of the inheriting classes.
    Can be implemented via a mypy_extensions.TypedDict object if warranted.
    The presalytics.story.outline.Plugin's config element should be passed
    as this value to render the script.</p>
<h2>Returns:</h2>
<p>A string carrying a html script that can be embedded in a html document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.LocalStylesPlugin.to_style', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.LocalStylesPlugin.to_style" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">to_style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;css_file_id&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">id</span><span class="p">:</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;css_file_path&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">file_path</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;Plugin requires &quot;css_file_id&quot; or &quot;css_file_path&quot; in its configuration dictionary&#39;</span>
            <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">MissingConfigException</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;Path {0} in plugin configuration does not exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">MissingConfigException</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">local_styles_map</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">style_data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="s2">&quot;&lt;style&gt;{0}&lt;/style&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">style_data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tag</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.LocalStylesPlugin.validate_metadata">
    <p>def <span class="ident">validate_metadata</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.LocalStylesPlugin.validate_metadata', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.LocalStylesPlugin.validate_metadata" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">validate_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plugin_kind__</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plugin_name__</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Plugin class {0} has not defined either __plugin_kind__ or __plugin_name__ metadata&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="presalytics.MatplotlibFigure" class="name">class <span class="ident">MatplotlibFigure</span></p>
      
  
    <div class="desc"><p>Inherit from this base class to create widget components that can be rendered to html via the
presalytics.story.revealer.Revealer class.  This component also need to build a method
that allows the widget to be serialzed into a presalytics.story.outline.Widget object.</p>
<h2>Parameters:</h2>
<p>widget: Widget
    A presalytics.story.outline.Widget object use for initialized the component class.</p>
<h2>Attributes:</h2>
<p>outline_widget: Widget
    A presalytics.story.outline.Widget object</p>
<p>css: List[str]
    A list of keys in dot notation that point to links in the ALLOWED_STYLES dictionary
    in the presalytics.lib.templates.base module.</p>
<p>js: List[str]
    A list of keys in dot notation that point to links in the ALLOWED_SCRIPTS dictionary
    in the presalytics.lib.templates.base module.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.MatplotlibFigure', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.MatplotlibFigure" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">MatplotlibFigure</span><span class="p">(</span><span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">WidgetBase</span><span class="p">):</span>
    <span class="n">__component_kind__</span> <span class="o">=</span> <span class="s1">&#39;matplotlib_figure&#39;</span>
    <span class="n">additional_properties</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figure</span><span class="p">:</span> <span class="s1">&#39;Figure&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">figure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span> <span class="o">=</span> <span class="n">mpld3</span><span class="o">.</span><span class="n">fig_to_dict</span><span class="p">(</span><span class="n">figure</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">figure_dict</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;figure_dict&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">figure_dict</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span> <span class="o">=</span> <span class="n">figure_dict</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;MatplotlibFigure requires a figure_dict attribute.  Please supply either a valid figure_dict or matplotlib.pyplot.Figure object to __init__&quot;</span>
            <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">additional_properties</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">additional_properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outline_widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">to_html</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;div id=&quot;{0}&quot; class=&quot;mpld3&quot;&gt;&lt;/div&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure_id</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">outline</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">figure_dict</span> <span class="o">=</span> <span class="n">outline</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;figure_dict&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">outline</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">figure_dict</span><span class="o">=</span><span class="n">figure_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">outline</span><span class="o">.</span><span class="n">additional_properties</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;figure_dict&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">,</span>
            <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_id</span>
        <span class="p">}</span>
        <span class="n">plugin_obj</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">Plugin</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mpld3&#39;</span><span class="p">,</span>
            <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;script&#39;</span><span class="p">,</span>
            <span class="n">config</span><span class="o">=</span><span class="n">data</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">Widget</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">kind</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__component_kind__</span><span class="p">,</span>
            <span class="n">plugins</span><span class="o">=</span><span class="p">[</span><span class="n">plugin_obj</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()],</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">additional_properties</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">additional_properties</span>
        <span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#presalytics.MatplotlibFigure">MatplotlibFigure</a></li>
          <li><a href="#presalytics.WidgetBase">WidgetBase</a></li>
          <li>presalytics.story.components.ComponentBase</li>
          <li>abc.ABC</li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.MatplotlibFigure.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, figure, name, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Note: When inheriting from this base class, call "super().<strong>init</strong>(self, <em>args, </em>*kwargs)" before add your
own custom initialization.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.MatplotlibFigure.__init__', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.MatplotlibFigure.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figure</span><span class="p">:</span> <span class="s1">&#39;Figure&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">figure</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span> <span class="o">=</span> <span class="n">mpld3</span><span class="o">.</span><span class="n">fig_to_dict</span><span class="p">(</span><span class="n">figure</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">figure_dict</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;figure_dict&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">figure_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span> <span class="o">=</span> <span class="n">figure_dict</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;MatplotlibFigure requires a figure_dict attribute.  Please supply either a valid figure_dict or matplotlib.pyplot.Figure object to __init__&quot;</span>
        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">figure_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">additional_properties</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">additional_properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">outline_widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.MatplotlibFigure.get_client">
    <p>def <span class="ident">get_client</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.MatplotlibFigure.get_client', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.MatplotlibFigure.get_client" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">client_info</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.MatplotlibFigure.render">
    <p>def <span class="ident">render</span>(</p><p>self, component, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.MatplotlibFigure.render', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.MatplotlibFigure.render" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.MatplotlibFigure.serialize">
    <p>def <span class="ident">serialize</span>(</p><p>self, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates presalytics.story.outline.Widget object from instance data. This widget should
have the correct name, data and additional_properties so the same widget can be reconstituted
via the to_html method, given the same set of data.</p>
<p>Typically, this method will call an update method that run a local script with updates this
Widget's data Dictionary prior being loading into the Widget outline object for serialization.</p>
<h2>Parameters:</h2>
<p>**kwargs:
    Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.
    these keyword arguments should be be invariant through successive updates to the chart. Overrides
    for this widgets default additional_properties shoudl be loaded via these keyword argments.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.MatplotlibFigure.serialize', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.MatplotlibFigure.serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;figure_dict&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">,</span>
        <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_id</span>
    <span class="p">}</span>
    <span class="n">plugin_obj</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">Plugin</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mpld3&#39;</span><span class="p">,</span>
        <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;script&#39;</span><span class="p">,</span>
        <span class="n">config</span><span class="o">=</span><span class="n">data</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">Widget</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">kind</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__component_kind__</span><span class="p">,</span>
        <span class="n">plugins</span><span class="o">=</span><span class="p">[</span><span class="n">plugin_obj</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()],</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">additional_properties</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">additional_properties</span>
    <span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.MatplotlibFigure.to_html">
    <p>def <span class="ident">to_html</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns valid html that renders the widget in a broswer.</p>
<h2>Parameters:</h2>
<p>data: Dict
    The data parameter is a dictionary should contain the minimum amount of that is required to
    successfully render the object.  As the widget is update, data control how the disply of
    information changes.
**kwargs:
    Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.
    these keyword arguments should be geinvariant through successive updates to the chart.  For example,
    keycloak argument should control the styling of the widget, which should not change as the data in
    the object (e.g., a chart) is updated.  Keyword arguments are loaded via additional_properties
    parameter in in the presalytics.story.outline.Widget object.</p>
<h2>Returns</h2>
<p>A string of containing an html fragment that will be loaded into a template in successive operations</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.MatplotlibFigure.to_html', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.MatplotlibFigure.to_html" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">to_html</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">&#39;&lt;div id=&quot;{0}&quot; class=&quot;mpld3&quot;&gt;&lt;/div&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure_id</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="presalytics.MatplotlibFigure.additional_properties" class="name">var <span class="ident">additional_properties</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.MatplotlibFigure.fig" class="name">var <span class="ident">fig</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.MatplotlibFigure.figure_dict" class="name">var <span class="ident">figure_dict</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.MatplotlibFigure.figure_id" class="name">var <span class="ident">figure_id</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.MatplotlibFigure.name" class="name">var <span class="ident">name</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.MatplotlibFigure.outline_widget" class="name">var <span class="ident">outline_widget</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.MatplotlibFigure.deserialize">
    <p>def <span class="ident">deserialize</span>(</p><p>cls, outline, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.MatplotlibFigure.deserialize', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.MatplotlibFigure.deserialize" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">outline</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">figure_dict</span> <span class="o">=</span> <span class="n">outline</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;figure_dict&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">outline</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">figure_dict</span><span class="o">=</span><span class="n">figure_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">outline</span><span class="o">.</span><span class="n">additional_properties</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="presalytics.Mpld3Plugin" class="name">class <span class="ident">Mpld3Plugin</span></p>
      
  
    <div class="desc"><p>A script plugin render configures templated scripts to append to the body
tag of an html document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Mpld3Plugin', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Mpld3Plugin" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Mpld3Plugin</span><span class="p">(</span><span class="n">ext</span><span class="o">.</span><span class="n">ScriptPlugin</span><span class="p">,</span> <span class="n">jinja</span><span class="o">.</span><span class="n">JinjaPluginMakerMixin</span><span class="p">):</span>
    <span class="n">__plugin_name__</span> <span class="o">=</span> <span class="s1">&#39;mpld3&#39;</span>

    <span class="n">__dependencies__</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;kind&#39;</span><span class="p">:</span> <span class="s1">&#39;script&#39;</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;external_scripts&#39;</span><span class="p">,</span>
            <span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;approved_scripts_key&#39;</span><span class="p">:</span> <span class="s1">&#39;reveal.base&#39;</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;kind&#39;</span><span class="p">:</span> <span class="s1">&#39;script&#39;</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;external_scripts&#39;</span><span class="p">,</span>
            <span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;approved_scripts_key&#39;</span><span class="p">:</span> <span class="s1">&#39;d3v3&#39;</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;kind&#39;</span><span class="p">:</span> <span class="s1">&#39;script&#39;</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;external_scripts&#39;</span><span class="p">,</span>
            <span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;approved_scripts_key&#39;</span><span class="p">:</span> <span class="s1">&#39;mpld3&#39;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">]</span>

    <span class="n">template</span> <span class="o">=</span> <span class="s1">&#39;&lt;script type=&quot;text/javascript&quot;&gt;mpld3.draw_figure(&quot;{{ id|safe }}&quot;,{{ fig_json|tojson }});&lt;/script&gt;&#39;</span>

    <span class="k">def</span> <span class="nf">to_script</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">render_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
            <span class="s1">&#39;fig_json&#39;</span><span class="p">:</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;figure_dict&quot;</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">render_config</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#presalytics.Mpld3Plugin">Mpld3Plugin</a></li>
          <li>presalytics.lib.plugins.base.ScriptPlugin</li>
          <li><a href="#presalytics.PluginBase">PluginBase</a></li>
          <li>abc.ABC</li>
          <li><a href="#presalytics.JinjaPluginMakerMixin">JinjaPluginMakerMixin</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="presalytics.Mpld3Plugin.template" class="name">var <span class="ident">template</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#presalytics.JinjaPluginMakerMixin">JinjaPluginMakerMixin</a></code>.<code><a href="#presalytics.JinjaPluginMakerMixin.template">template</a></code>
    </p>

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.Mpld3Plugin.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Mpld3Plugin.__init__', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Mpld3Plugin.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">validate_metadata</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Mpld3Plugin.get_tag">
    <p>def <span class="ident">get_tag</span>(</p><p>self, config, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Generic method to be implemented by all inheriting classes. Allow plugin
to be render without knowledge of the underlying plugin kind.</p>
<h2>Parameters:</h2>
<p>config: Dict
    A set configuration values for the plugin.  Required keys should be
    specified by the docstring of the inheriting classes.
    Can be implemented via a mypy_extensions.TypedDict object if warranted.
    The presalytics.story.outline.Plugin's config element should be passed
    as this value to render the script.</p>
<h2>Returns:</h2>
<p>A string carrying a html script that can be embedded in a html document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Mpld3Plugin.get_tag', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Mpld3Plugin.get_tag" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_script</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Mpld3Plugin.get_template">
    <p>def <span class="ident">get_template</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Mpld3Plugin.get_template', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Mpld3Plugin.get_template" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_template</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;Plugins the use the JinjaPluginMakerMixin must have a defiined template attribute.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Mpld3Plugin.render">
    <p>def <span class="ident">render</span>(</p><p>self, config)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Mpld3Plugin.render', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Mpld3Plugin.render" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;loader&quot;</span><span class="p">:</span> <span class="n">jinja2</span><span class="o">.</span><span class="n">BaseLoader</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;jinja_options&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;jinja_options&quot;</span><span class="p">))</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">jinja2</span><span class="o">.</span><span class="n">Environment</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_template</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Mpld3Plugin.to_script">
    <p>def <span class="ident">to_script</span>(</p><p>self, config, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>The to_script method maps a dictionary to an html script tag.</p>
<h2>Parameters:</h2>
<p>config: Dict
    A set configuration values for the plugin.  Required keys should be
    specified by the docstring of the inheriting classes.
    Can be implemented via a mypy_extensions.TypedDict object if warranted.
    The presalytics.story.outline.Plugin's config element should be passed
    as this value to render the script.</p>
<h2>Returns:</h2>
<p>A string carrying a html script that can be embedded in a html document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Mpld3Plugin.to_script', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Mpld3Plugin.to_script" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">to_script</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">render_config</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
        <span class="s1">&#39;fig_json&#39;</span><span class="p">:</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;figure_dict&quot;</span><span class="p">]</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">render_config</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Mpld3Plugin.validate_metadata">
    <p>def <span class="ident">validate_metadata</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Mpld3Plugin.validate_metadata', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Mpld3Plugin.validate_metadata" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">validate_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plugin_kind__</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plugin_name__</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Plugin class {0} has not defined either __plugin_kind__ or __plugin_name__ metadata&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="presalytics.OoxmlEditorWidget" class="name">class <span class="ident">OoxmlEditorWidget</span></p>
      
  
    <div class="desc"><p>Inherit from this base class to create widget components that can be rendered to html via the
presalytics.story.revealer.Revealer class.  This component also need to build a method
that allows the widget to be serialzed into a presalytics.story.outline.Widget object.</p>
<h2>Parameters:</h2>
<p>widget: Widget
    A presalytics.story.outline.Widget object use for initialized the component class.</p>
<h2>Attributes:</h2>
<p>outline_widget: Widget
    A presalytics.story.outline.Widget object</p>
<p>css: List[str]
    A list of keys in dot notation that point to links in the ALLOWED_STYLES dictionary
    in the presalytics.lib.templates.base module.</p>
<p>js: List[str]
    A list of keys in dot notation that point to links in the ALLOWED_SCRIPTS dictionary
    in the presalytics.lib.templates.base module.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEditorWidget', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEditorWidget" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">OoxmlEditorWidget</span><span class="p">(</span><span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">ooxml</span><span class="o">.</span><span class="n">OoxmlWidgetBase</span><span class="p">):</span>
    <span class="n">transform</span><span class="p">:</span> <span class="n">XmlTransformBase</span>

    <span class="n">__component_kind__</span> <span class="o">=</span> <span class="s1">&#39;ooxml-xml-editor&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                 <span class="n">story_id</span><span class="p">,</span>
                 <span class="n">object_ooxml_id</span><span class="p">,</span>
                 <span class="n">endpoint_map</span><span class="p">,</span>
                 <span class="n">transform_class</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">transform_params</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">OoxmlEditorWidget</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">story_id</span><span class="o">=</span><span class="n">story_id</span><span class="p">,</span> <span class="n">object_ooxml_id</span><span class="o">=</span><span class="n">object_ooxml_id</span><span class="p">,</span> <span class="n">endpoint_map</span><span class="o">=</span><span class="n">endpoint_map</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span> <span class="n">transform_class</span><span class="p">(</span><span class="n">transform_params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">svg_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">svg_html</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_container</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">client_info</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outline_widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">update_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xml_str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">xml</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">xml_str</span><span class="p">)</span>
        <span class="n">new_xml</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">xml</span><span class="p">)</span>
        <span class="n">new_xml_str</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">new_xml</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_xml_str</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_client</span><span class="p">()</span>
        <span class="n">auth_header</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_auth_header</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">:</span>
            <span class="n">xml_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_map</span><span class="o">.</span><span class="n">get_xml_url</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object_ooxml_id</span><span class="p">)</span>
            <span class="n">xml_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xml_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xml_response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ApiError</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">xml_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="n">dto</span> <span class="o">=</span> <span class="n">xml_response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="n">new_xml</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_xml</span><span class="p">(</span><span class="n">dto</span><span class="p">[</span><span class="s2">&quot;openOfficeXml&quot;</span><span class="p">])</span>
            <span class="n">dto</span><span class="p">[</span><span class="s2">&quot;openOfficeXml&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_xml</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
            <span class="n">xml_update_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">xml_url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">dto</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xml_response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ApiError</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">xml_update_response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">svg_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_svg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object_ooxml_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">svg_data</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">deseriailize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">endpoint_map</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">ooxml</span><span class="o">.</span><span class="n">OoxmlEndpointMap</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;endpoint_id&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                   <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;story_id&quot;</span><span class="p">],</span>
                   <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;object_ooxml_id&quot;</span><span class="p">],</span>
                   <span class="n">endpoint_map</span>
                   <span class="p">)</span>

    <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;story_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">story_id</span><span class="p">,</span>
            <span class="s2">&quot;object_ooxml_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_ooxml_id</span><span class="p">,</span>
            <span class="s2">&quot;endpoint_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_map</span><span class="o">.</span><span class="n">endpoint_id</span>
        <span class="p">}</span>
        <span class="n">widget</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">Widget</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">kind</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__component_kind__</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">widget</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#presalytics.OoxmlEditorWidget">OoxmlEditorWidget</a></li>
          <li>presalytics.lib.widgets.ooxml.OoxmlWidgetBase</li>
          <li><a href="#presalytics.WidgetBase">WidgetBase</a></li>
          <li>presalytics.story.components.ComponentBase</li>
          <li>abc.ABC</li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEditorWidget.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, name, story_id, object_ooxml_id, endpoint_map, transform_class=None, transform_params=None, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Note: When inheriting from this base class, call "super().<strong>init</strong>(self, <em>args, </em>*kwargs)" before add your
own custom initialization.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEditorWidget.__init__', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEditorWidget.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
             <span class="n">story_id</span><span class="p">,</span>
             <span class="n">object_ooxml_id</span><span class="p">,</span>
             <span class="n">endpoint_map</span><span class="p">,</span>
             <span class="n">transform_class</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">transform_params</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">OoxmlEditorWidget</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">story_id</span><span class="o">=</span><span class="n">story_id</span><span class="p">,</span> <span class="n">object_ooxml_id</span><span class="o">=</span><span class="n">object_ooxml_id</span><span class="p">,</span> <span class="n">endpoint_map</span><span class="o">=</span><span class="n">endpoint_map</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span> <span class="n">transform_class</span><span class="p">(</span><span class="n">transform_params</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">svg_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">svg_html</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_container</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">client_info</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">outline_widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEditorWidget.create_container">
    <p>def <span class="ident">create_container</span>(</p><p>self, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEditorWidget.create_container', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEditorWidget.create_container" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    
    <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_client</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">token</span><span class="p">[</span><span class="s2">&quot;access_token&quot;</span><span class="p">]</span>
    <span class="n">svg_container_div</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="p">{</span>
        <span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;svg-container&#39;</span><span class="p">,</span>
        <span class="s1">&#39;data-jwt&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">,</span>
        <span class="s1">&#39;data-object-type&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_map</span><span class="o">.</span><span class="n">endpoint_id</span><span class="p">,</span>
        <span class="s1">&#39;data-object-id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_ooxml_id</span>
    <span class="p">})</span>
    <span class="n">preloader_container_div</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">svg_container_div</span><span class="p">,</span> <span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="n">attrib</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span><span class="s2">&quot;preloader-container&quot;</span><span class="p">})</span>
    <span class="n">preloader_row_div</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">preloader_container_div</span><span class="p">,</span> <span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="n">attrib</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span><span class="s2">&quot;preloader-row&quot;</span><span class="p">})</span>
    <span class="n">preloader_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s2">&quot;img&quot;</span><span class="p">,</span> <span class="s2">&quot;preloader.svg&quot;</span><span class="p">)</span>
    <span class="n">svg</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">preloader_file</span><span class="p">)</span>
    <span class="n">preloader_row_div</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">svg</span><span class="o">.</span><span class="n">getroot</span><span class="p">())</span>
    <span class="n">empty_parent_div</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="p">{</span>
        <span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;empty-parent bg-light&#39;</span>
    <span class="p">})</span>
    <span class="n">empty_parent_div</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">svg_container_div</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lxml</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">empty_parent_div</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEditorWidget.get_client">
    <p>def <span class="ident">get_client</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEditorWidget.get_client', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEditorWidget.get_client" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">client_info</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEditorWidget.get_svg">
    <p>def <span class="ident">get_svg</span>(</p><p>self, id, timeout_iterator=0)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEditorWidget.get_svg', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEditorWidget.get_svg" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_svg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">timeout_iterator</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">svg_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_map</span><span class="o">.</span><span class="n">get_svg_url</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_client</span><span class="p">()</span>
    <span class="n">auth_header</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_auth_header</span><span class="p">()</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">svg_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
    <span class="n">svg_data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ApiError</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">status_code</span><span class="o">=</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Temp data&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">timeout_iterator</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ApiError</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;Unable to download svg.  Please check for upstream processing errors.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">svg_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_svg</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">timeout_iterator</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEditorWidget.render">
    <p>def <span class="ident">render</span>(</p><p>self, component, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEditorWidget.render', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEditorWidget.render" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEditorWidget.serialize">
    <p>def <span class="ident">serialize</span>(</p><p>self, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates presalytics.story.outline.Widget object from instance data. This widget should
have the correct name, data and additional_properties so the same widget can be reconstituted
via the to_html method, given the same set of data.</p>
<p>Typically, this method will call an update method that run a local script with updates this
Widget's data Dictionary prior being loading into the Widget outline object for serialization.</p>
<h2>Parameters:</h2>
<p>**kwargs:
    Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.
    these keyword arguments should be be invariant through successive updates to the chart. Overrides
    for this widgets default additional_properties shoudl be loaded via these keyword argments.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEditorWidget.serialize', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEditorWidget.serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;story_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">story_id</span><span class="p">,</span>
        <span class="s2">&quot;object_ooxml_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_ooxml_id</span><span class="p">,</span>
        <span class="s2">&quot;endpoint_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_map</span><span class="o">.</span><span class="n">endpoint_id</span>
    <span class="p">}</span>
    <span class="n">widget</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">Widget</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">kind</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__component_kind__</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">widget</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEditorWidget.to_html">
    <p>def <span class="ident">to_html</span>(</p><p>self, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns valid html that renders the widget in a broswer.</p>
<h2>Parameters:</h2>
<p>data: Dict
    The data parameter is a dictionary should contain the minimum amount of that is required to
    successfully render the object.  As the widget is update, data control how the disply of
    information changes.
**kwargs:
    Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.
    these keyword arguments should be geinvariant through successive updates to the chart.  For example,
    keycloak argument should control the styling of the widget, which should not change as the data in
    the object (e.g., a chart) is updated.  Keyword arguments are loaded via additional_properties
    parameter in in the presalytics.story.outline.Widget object.</p>
<h2>Returns</h2>
<p>A string of containing an html fragment that will be loaded into a template in successive operations</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEditorWidget.to_html', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEditorWidget.to_html" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">to_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">svg_html</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEditorWidget.update">
    <p>def <span class="ident">update</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEditorWidget.update', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEditorWidget.update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_client</span><span class="p">()</span>
    <span class="n">auth_header</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_auth_header</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">:</span>
        <span class="n">xml_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_map</span><span class="o">.</span><span class="n">get_xml_url</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object_ooxml_id</span><span class="p">)</span>
        <span class="n">xml_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xml_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xml_response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ApiError</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">xml_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="n">dto</span> <span class="o">=</span> <span class="n">xml_response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="n">new_xml</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_xml</span><span class="p">(</span><span class="n">dto</span><span class="p">[</span><span class="s2">&quot;openOfficeXml&quot;</span><span class="p">])</span>
        <span class="n">dto</span><span class="p">[</span><span class="s2">&quot;openOfficeXml&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_xml</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="n">xml_update_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">xml_url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">dto</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xml_response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ApiError</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">xml_update_response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
    <span class="n">svg_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_svg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object_ooxml_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEditorWidget.update_xml">
    <p>def <span class="ident">update_xml</span>(</p><p>self, xml_str)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEditorWidget.update_xml', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEditorWidget.update_xml" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">update_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xml_str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">xml</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">xml_str</span><span class="p">)</span>
    <span class="n">new_xml</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">xml</span><span class="p">)</span>
    <span class="n">new_xml_str</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">new_xml</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_xml_str</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="presalytics.OoxmlEditorWidget.name" class="name">var <span class="ident">name</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#presalytics.WidgetBase">WidgetBase</a></code>.<code><a href="#presalytics.WidgetBase.name">name</a></code>
    </p>

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.OoxmlEditorWidget.outline_widget" class="name">var <span class="ident">outline_widget</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.OoxmlEditorWidget.svg_data" class="name">var <span class="ident">svg_data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.OoxmlEditorWidget.svg_html" class="name">var <span class="ident">svg_html</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.OoxmlEditorWidget.transform" class="name">var <span class="ident">transform</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEditorWidget.deseriailize">
    <p>def <span class="ident">deseriailize</span>(</p><p>cls, component, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEditorWidget.deseriailize', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEditorWidget.deseriailize" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">deseriailize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">endpoint_map</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">ooxml</span><span class="o">.</span><span class="n">OoxmlEndpointMap</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;endpoint_id&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
               <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;story_id&quot;</span><span class="p">],</span>
               <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;object_ooxml_id&quot;</span><span class="p">],</span>
               <span class="n">endpoint_map</span>
               <span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEditorWidget.deserialize">
    <p>def <span class="ident">deserialize</span>(</p><p>cls, widget, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates an instance of the widget from the data object in the presalytics.story.outline.Widget
object. This method exists to ensure widgets can be portable across environments.  To clarify,
widgets built on the client-side via the <strong>init</strong> method can be reconstructed server-side via
the deserialize method.  This allows decoupling of the widget generation/updating of data and
the rendering of the widget in a UI.  Renderers (e.g., presalytics.story.revealer.Revealer object)
need not know about how the data get updated, but can update the graphic with data generated by
the widget when the serialize method is called.</p>
<h2>Parameters:</h2>
<p>widget: Widget
    A prealytics.story.outline.Widget object</p>
<h2>Returns:</h2>
<p>An instance the widget class</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEditorWidget.deserialize', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEditorWidget.deserialize" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">widget</span><span class="p">:</span> <span class="s1">&#39;Widget&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;WidgetBase&#39;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates an instance of the widget from the data object in the presalytics.story.outline.Widget</span>
<span class="sd">    object. This method exists to ensure widgets can be portable across environments.  To clarify,</span>
<span class="sd">    widgets built on the client-side via the __init__ method can be reconstructed server-side via</span>
<span class="sd">    the deserialize method.  This allows decoupling of the widget generation/updating of data and</span>
<span class="sd">    the rendering of the widget in a UI.  Renderers (e.g., presalytics.story.revealer.Revealer object)</span>
<span class="sd">    need not know about how the data get updated, but can update the graphic with data generated by</span>
<span class="sd">    the widget when the serialize method is called.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    ----------</span>
<span class="sd">    widget: Widget</span>
<span class="sd">        A prealytics.story.outline.Widget object</span>
<span class="sd">    Returns:</span>
<span class="sd">    ----------</span>
<span class="sd">    An instance the widget class</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="presalytics.OoxmlEndpointMap" class="name">class <span class="ident">OoxmlEndpointMap</span></p>
      
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEndpointMap', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEndpointMap" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">OoxmlEndpointMap</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">BASE_URL</span> <span class="o">=</span> <span class="s2">&quot;https://api.presalytics.io/ooxml-automation&quot;</span>

    <span class="n">CHART</span> <span class="o">=</span> <span class="s2">&quot;Charts&quot;</span>
    <span class="n">CONNECTION_SHAPE</span> <span class="o">=</span> <span class="s2">&quot;ConnectionShapes&quot;</span>
    <span class="n">DOCUMENT</span> <span class="o">=</span> <span class="s2">&quot;Documents&quot;</span>
    <span class="n">GROUP</span> <span class="o">=</span> <span class="s2">&quot;Groups&quot;</span>
    <span class="n">IMAGE</span> <span class="o">=</span> <span class="s2">&quot;Images&quot;</span>
    <span class="n">SHAPE</span> <span class="o">=</span> <span class="s2">&quot;Shapes&quot;</span>
    <span class="n">SHAPETREE</span> <span class="o">=</span> <span class="s2">&quot;ShapeTrees&quot;</span>
    <span class="n">SLIDE</span> <span class="o">=</span> <span class="s2">&quot;Slides&quot;</span>
    <span class="n">TABLE</span> <span class="o">=</span> <span class="s2">&quot;Tables&quot;</span>
    <span class="n">THEME</span> <span class="o">=</span> <span class="s2">&quot;Themes&quot;</span>


    <span class="k">def</span> <span class="nf">_build_object_type_map</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Chart&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">CHART</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="s2">&quot;Slide&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">GROUP</span><span class="p">,</span>
                <span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">SHAPE</span><span class="p">,</span>
                <span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">SHAPETREE</span><span class="p">,</span> 
                <span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">CONNECTION_SHAPE</span><span class="p">,</span>
                <span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">SLIDE</span>
            <span class="p">],</span>
            <span class="s2">&quot;Table&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">TABLE</span>
            <span class="p">],</span>
            <span class="s2">&quot;Theme&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">THEME</span>
            <span class="p">],</span>
            <span class="s2">&quot;Shared&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">IMAGE</span>
            <span class="p">],</span>
            <span class="s2">&quot;EMPTY&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">DOCUMENT</span>
            <span class="p">]</span>
        <span class="p">}</span>
    
    

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint_id</span><span class="p">,</span> <span class="n">baseurl</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">endpoint_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;{0} is not a valid endpoint ID&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">endpoint</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_id</span> <span class="o">=</span> <span class="n">endpoint_id</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">baseurl</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">baseurl</span> <span class="o">=</span> <span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">BASE_URL</span>
            <span class="n">custom_hosts</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">CONFIG</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;HOSTS&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">custom_hosts</span><span class="p">:</span>
                <span class="n">ooxml_host</span> <span class="o">=</span> <span class="n">custom_hosts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;OOXML_AUTOMATION&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ooxml_host</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">baseurl</span> <span class="o">=</span> <span class="n">ooxml_host</span>
                
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">baseurl</span> <span class="o">=</span> <span class="n">baseurl</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root_url</span> <span class="o">=</span> <span class="n">posixpath</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseurl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">OBJECT_TYPE_MAP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_object_type_map</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">get_object_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">OBJECT_TYPE_MAP</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">test_ep</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">test_ep</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_id</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;EMPTY&quot;</span><span class="p">:</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_id</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">return</span> <span class="s2">&quot;{0}.{1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_id</span><span class="p">)</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Invalid EndpointMap configuration: {0} is not in OBJECT_TYPE_MAP&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoint_id</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_id_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">posixpath</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_svg_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">posixpath</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="p">,</span> <span class="s2">&quot;Svg&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_xml_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">posixpath</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="p">,</span> <span class="s2">&quot;OpenOfficeXml&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">connection_shape</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">CONNECTION_SHAPE</span><span class="p">,</span> <span class="n">baseurl</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">chart</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">CHART</span><span class="p">,</span> <span class="n">baseurl</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">document</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">DOCUMENT</span><span class="p">,</span> <span class="n">baseurl</span><span class="p">)</span>
    
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">group</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">GROUP</span><span class="p">,</span> <span class="n">baseurl</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">image</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">IMAGE</span><span class="p">,</span> <span class="n">baseurl</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">SHAPE</span><span class="p">,</span> <span class="n">baseurl</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">shapetree</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">SHAPETREE</span><span class="p">,</span> <span class="n">baseurl</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">slide</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">SLIDE</span><span class="p">,</span> <span class="n">baseurl</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">table</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">table</span><span class="p">,</span> <span class="n">baseurl</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">theme</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">THEME</span><span class="p">,</span> <span class="n">baseurl</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#presalytics.OoxmlEndpointMap">OoxmlEndpointMap</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="presalytics.OoxmlEndpointMap.BASE_URL" class="name">var <span class="ident">BASE_URL</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.OoxmlEndpointMap.CHART" class="name">var <span class="ident">CHART</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.OoxmlEndpointMap.CONNECTION_SHAPE" class="name">var <span class="ident">CONNECTION_SHAPE</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.OoxmlEndpointMap.DOCUMENT" class="name">var <span class="ident">DOCUMENT</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.OoxmlEndpointMap.GROUP" class="name">var <span class="ident">GROUP</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.OoxmlEndpointMap.IMAGE" class="name">var <span class="ident">IMAGE</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.OoxmlEndpointMap.SHAPE" class="name">var <span class="ident">SHAPE</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.OoxmlEndpointMap.SHAPETREE" class="name">var <span class="ident">SHAPETREE</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.OoxmlEndpointMap.SLIDE" class="name">var <span class="ident">SLIDE</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.OoxmlEndpointMap.TABLE" class="name">var <span class="ident">TABLE</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.OoxmlEndpointMap.THEME" class="name">var <span class="ident">THEME</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEndpointMap.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, endpoint_id, baseurl=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEndpointMap.__init__', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEndpointMap.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint_id</span><span class="p">,</span> <span class="n">baseurl</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">endpoint_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;{0} is not a valid endpoint ID&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">endpoint</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_id</span> <span class="o">=</span> <span class="n">endpoint_id</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">baseurl</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">baseurl</span> <span class="o">=</span> <span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">BASE_URL</span>
        <span class="n">custom_hosts</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">CONFIG</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;HOSTS&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">custom_hosts</span><span class="p">:</span>
            <span class="n">ooxml_host</span> <span class="o">=</span> <span class="n">custom_hosts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;OOXML_AUTOMATION&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ooxml_host</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">baseurl</span> <span class="o">=</span> <span class="n">ooxml_host</span>
            
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">baseurl</span> <span class="o">=</span> <span class="n">baseurl</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">root_url</span> <span class="o">=</span> <span class="n">posixpath</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseurl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_id</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">OBJECT_TYPE_MAP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_object_type_map</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEndpointMap.get_id_url">
    <p>def <span class="ident">get_id_url</span>(</p><p>self, id)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEndpointMap.get_id_url', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEndpointMap.get_id_url" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_id_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">posixpath</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEndpointMap.get_object_type">
    <p>def <span class="ident">get_object_type</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEndpointMap.get_object_type', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEndpointMap.get_object_type" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_object_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">OBJECT_TYPE_MAP</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">test_ep</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">test_ep</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_id</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;EMPTY&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_id</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s2">&quot;{0}.{1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_id</span><span class="p">)</span>
    <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Invalid EndpointMap configuration: {0} is not in OBJECT_TYPE_MAP&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoint_id</span><span class="p">)</span>
    <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEndpointMap.get_svg_url">
    <p>def <span class="ident">get_svg_url</span>(</p><p>self, id)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEndpointMap.get_svg_url', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEndpointMap.get_svg_url" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_svg_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">posixpath</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="p">,</span> <span class="s2">&quot;Svg&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEndpointMap.get_xml_url">
    <p>def <span class="ident">get_xml_url</span>(</p><p>self, id)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEndpointMap.get_xml_url', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEndpointMap.get_xml_url" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_xml_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">posixpath</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="p">,</span> <span class="s2">&quot;OpenOfficeXml&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="presalytics.OoxmlEndpointMap.OBJECT_TYPE_MAP" class="name">var <span class="ident">OBJECT_TYPE_MAP</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.OoxmlEndpointMap.endpoint_id" class="name">var <span class="ident">endpoint_id</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.OoxmlEndpointMap.root_url" class="name">var <span class="ident">root_url</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEndpointMap.chart">
    <p>def <span class="ident">chart</span>(</p><p>cls, baseurl=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEndpointMap.chart', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEndpointMap.chart" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">chart</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">CHART</span><span class="p">,</span> <span class="n">baseurl</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEndpointMap.connection_shape">
    <p>def <span class="ident">connection_shape</span>(</p><p>cls, baseurl=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEndpointMap.connection_shape', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEndpointMap.connection_shape" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">connection_shape</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">CONNECTION_SHAPE</span><span class="p">,</span> <span class="n">baseurl</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEndpointMap.document">
    <p>def <span class="ident">document</span>(</p><p>cls, baseurl=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEndpointMap.document', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEndpointMap.document" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">document</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">DOCUMENT</span><span class="p">,</span> <span class="n">baseurl</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEndpointMap.group">
    <p>def <span class="ident">group</span>(</p><p>cls, baseurl=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEndpointMap.group', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEndpointMap.group" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">group</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">GROUP</span><span class="p">,</span> <span class="n">baseurl</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEndpointMap.image">
    <p>def <span class="ident">image</span>(</p><p>cls, baseurl=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEndpointMap.image', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEndpointMap.image" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">image</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">IMAGE</span><span class="p">,</span> <span class="n">baseurl</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEndpointMap.shape">
    <p>def <span class="ident">shape</span>(</p><p>cls, baseurl=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEndpointMap.shape', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEndpointMap.shape" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">SHAPE</span><span class="p">,</span> <span class="n">baseurl</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEndpointMap.shapetree">
    <p>def <span class="ident">shapetree</span>(</p><p>cls, baseurl=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEndpointMap.shapetree', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEndpointMap.shapetree" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">shapetree</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">SHAPETREE</span><span class="p">,</span> <span class="n">baseurl</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEndpointMap.slide">
    <p>def <span class="ident">slide</span>(</p><p>cls, baseurl=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEndpointMap.slide', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEndpointMap.slide" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">slide</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">SLIDE</span><span class="p">,</span> <span class="n">baseurl</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEndpointMap.table">
    <p>def <span class="ident">table</span>(</p><p>cls, baseurl=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEndpointMap.table', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEndpointMap.table" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">table</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">table</span><span class="p">,</span> <span class="n">baseurl</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlEndpointMap.theme">
    <p>def <span class="ident">theme</span>(</p><p>cls, baseurl=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlEndpointMap.theme', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlEndpointMap.theme" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">theme</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">THEME</span><span class="p">,</span> <span class="n">baseurl</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="presalytics.OoxmlFileWidget" class="name">class <span class="ident">OoxmlFileWidget</span></p>
      
  
    <div class="desc"><p>Inherit from this base class to create widget components that can be rendered to html via the
presalytics.story.revealer.Revealer class.  This component also need to build a method
that allows the widget to be serialzed into a presalytics.story.outline.Widget object.</p>
<h2>Parameters:</h2>
<p>widget: Widget
    A presalytics.story.outline.Widget object use for initialized the component class.</p>
<h2>Attributes:</h2>
<p>outline_widget: Widget
    A presalytics.story.outline.Widget object</p>
<p>css: List[str]
    A list of keys in dot notation that point to links in the ALLOWED_STYLES dictionary
    in the presalytics.lib.templates.base module.</p>
<p>js: List[str]
    A list of keys in dot notation that point to links in the ALLOWED_SCRIPTS dictionary
    in the presalytics.lib.templates.base module.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlFileWidget', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlFileWidget" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">OoxmlFileWidget</span><span class="p">(</span><span class="n">OoxmlWidgetBase</span><span class="p">):</span>
    <span class="n">object_name</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">ooxml_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">file_last_modified</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span>
    <span class="n">previous_ooxml_version</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>

    <span class="n">__component_kind__</span> <span class="o">=</span> <span class="s1">&#39;ooxml-file-object&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">filename</span><span class="p">,</span>
                 <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">story_id</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">object_ooxml_id</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">endpoint_map</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">object_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">previous_ooxml_version</span><span class="o">=</span><span class="p">{},</span>
                 <span class="n">file_last_modified</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">document_ooxml_id</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">object_name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object_name</span> <span class="o">=</span> <span class="n">object_name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object_name</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_name</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_name</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">OoxmlFileWidget</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">story_id</span><span class="p">,</span> <span class="n">object_ooxml_id</span><span class="p">,</span> <span class="n">endpoint_map</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_map</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;pptx&quot;</span><span class="p">,</span> <span class="s2">&quot;ppt&quot;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_map</span> <span class="o">=</span> <span class="n">OoxmlEndpointMap</span><span class="p">(</span><span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">SLIDE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">previous_ooxml_version</span> <span class="o">=</span> <span class="n">previous_ooxml_version</span>
        <span class="k">if</span> <span class="n">file_last_modified</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_last_modified</span> <span class="o">=</span> <span class="n">file_last_modified</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_last_modified</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">document_ooxml_id</span> <span class="o">=</span> <span class="n">document_ooxml_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">svg_html</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_container</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If the file is available locally, this renders that updated file and pushes</span>
<span class="sd">        the updated rendering data to the server</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">story</span><span class="p">:</span> <span class="s1">&#39;ApiStory&#39;</span>
        <span class="n">page</span><span class="p">:</span> <span class="s1">&#39;Page&#39;</span>
        <span class="n">widget</span><span class="p">:</span> <span class="s1">&#39;Widget&#39;</span>

        <span class="n">search_paths</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">presalytics</span><span class="o">.</span><span class="n">autodiscover_paths</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">search_paths</span><span class="p">:</span>
            <span class="n">search_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">search_paths</span><span class="p">:</span>
            <span class="n">fpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">fpath</span><span class="p">):</span>
                <span class="c1"># update only the file has been modified sine last time</span>
                <span class="n">this_file_last_modified</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcfromtimestamp</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">fpath</span><span class="p">))</span><span class="o">.</span><span class="n">astimezone</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_last_modified</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_last_modified</span> <span class="o">&lt;=</span> <span class="n">this_file_last_modified</span><span class="p">:</span>
                    <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_client</span><span class="p">()</span>
                    <span class="n">story</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">story_id_file_post_with_http_info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">story_id</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">fpath</span><span class="p">,</span> <span class="n">replace_existing</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">obsolete_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">document_ooxml_id</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">status</span> <span class="o">&gt;=</span> <span class="mi">299</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ApiError</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">previous_ooxml_version</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s2">&quot;document_ooxml_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">document_ooxml_id</span><span class="p">,</span>
                        <span class="s2">&quot;object_ooxml_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_ooxml_id</span>
                    <span class="p">}</span>
                    <span class="n">new_outline</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">StoryOutline</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">story</span><span class="o">.</span><span class="n">outline</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">new_outline</span><span class="o">.</span><span class="n">pages</span><span class="p">:</span>
                        <span class="n">found</span> <span class="o">=</span> <span class="bp">False</span>
                        <span class="k">for</span> <span class="n">widget</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">widgets</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">widget</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_name</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">document_ooxml_id</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;document_ooxml_id&quot;</span><span class="p">]</span>
                                <span class="n">found</span> <span class="o">=</span> <span class="bp">True</span>
                                <span class="k">break</span>
                        <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
                            <span class="k">break</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
                        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Unable to find widget object name {0} in new story outline.  Has this widget been deleted?&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object_name</span><span class="p">)</span>
                        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

                    <span class="c1"># Get object tree, compare to object name</span>
                    <span class="n">child_tree</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">ooxml_automation</span><span class="o">.</span><span class="n">documents_childobjects_get_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">document_ooxml_id</span><span class="p">)</span>
                    <span class="n">target_dto</span> <span class="o">=</span> <span class="bp">None</span>

                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">target_dto</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">child_tree</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">entity_name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_name</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                        <span class="k">pass</span>
                    <span class="c1"># if name not in object or _object_name is none, get first item of type in end_point id</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">target_dto</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">target_dto</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">child_tree</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">object_type</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_map</span><span class="o">.</span><span class="n">endpoint_id</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Child tree of document {0} does not have a child object of type {1} or name {2}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ooxml_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_map</span><span class="o">.</span><span class="n">endpoint_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_name</span><span class="p">)</span>
                            <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">InvalidConfigurationError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
                    <span class="c1"># set widget parameters for recreation server-side (without file)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object_ooxml_id</span> <span class="o">=</span> <span class="n">target_dto</span><span class="o">.</span><span class="n">entity_id</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">file_last_modified</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">roundup_date_modified</span><span class="p">(</span><span class="n">this_file_last_modified</span><span class="p">)</span>


    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">init_args</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">],</span>
            <span class="s2">&quot;endpoint_map&quot;</span><span class="p">:</span> <span class="n">OoxmlEndpointMap</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;endpoint_id&quot;</span><span class="p">]),</span>
            <span class="s2">&quot;object_name&quot;</span><span class="p">:</span> <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;object_name&quot;</span><span class="p">],</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="s2">&quot;document_ooxml_id&quot;</span> <span class="ow">in</span> <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="n">init_args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;document_ooxml_id&quot;</span><span class="p">:</span> <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;document_ooxml_id&quot;</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;object_ooxml_id&quot;</span> <span class="ow">in</span> <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="n">init_args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;object_ooxml_id&quot;</span><span class="p">:</span> <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;object_ooxml_id&quot;</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;file_last_modified&quot;</span> <span class="ow">in</span> <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="n">init_args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;file_last_modified&quot;</span><span class="p">:</span> <span class="n">dateutil</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;file_last_modified&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;previous_ooxml_version&quot;</span> <span class="ow">in</span> <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="n">init_args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;previous_ooxml_version&quot;</span><span class="p">:</span> <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;previous_ooxml_version&quot;</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;story_id&quot;</span> <span class="ow">in</span> <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="n">init_args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;story_id&quot;</span><span class="p">:</span> <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;story_id&quot;</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">init_args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">init_args</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
            <span class="s2">&quot;object_name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_name</span><span class="p">,</span>
            <span class="s2">&quot;endpoint_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_map</span><span class="o">.</span><span class="n">endpoint_id</span><span class="p">,</span>
            <span class="s2">&quot;document_ooxml_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">document_ooxml_id</span><span class="p">,</span>
            <span class="s2">&quot;object_ooxml_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_ooxml_id</span><span class="p">,</span>
            <span class="s2">&quot;story_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">story_id</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_last_modified</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;file_last_modified&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_last_modified</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
                <span class="p">}</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous_ooxml_version</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;previous_ooxml_version&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous_ooxml_version</span>
                <span class="p">}</span>
            <span class="p">)</span>
        <span class="n">widget</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">Widget</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">kind</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__component_kind__</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">plugins</span><span class="o">=</span><span class="bp">None</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">widget</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#presalytics.OoxmlFileWidget">OoxmlFileWidget</a></li>
          <li>presalytics.lib.widgets.ooxml.OoxmlWidgetBase</li>
          <li><a href="#presalytics.WidgetBase">WidgetBase</a></li>
          <li>presalytics.story.components.ComponentBase</li>
          <li>abc.ABC</li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlFileWidget.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, filename, name=None, story_id=None, object_ooxml_id=None, endpoint_map=None, object_name=None, previous_ooxml_version={}, file_last_modified=None, document_ooxml_id=None, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Note: When inheriting from this base class, call "super().<strong>init</strong>(self, <em>args, </em>*kwargs)" before add your
own custom initialization.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlFileWidget.__init__', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlFileWidget.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">filename</span><span class="p">,</span>
             <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">story_id</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">object_ooxml_id</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">endpoint_map</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">object_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">previous_ooxml_version</span><span class="o">=</span><span class="p">{},</span>
             <span class="n">file_last_modified</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">document_ooxml_id</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">object_name</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">object_name</span> <span class="o">=</span> <span class="n">object_name</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">object_name</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_name</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">filename</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">OoxmlFileWidget</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">story_id</span><span class="p">,</span> <span class="n">object_ooxml_id</span><span class="p">,</span> <span class="n">endpoint_map</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_map</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;pptx&quot;</span><span class="p">,</span> <span class="s2">&quot;ppt&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_map</span> <span class="o">=</span> <span class="n">OoxmlEndpointMap</span><span class="p">(</span><span class="n">OoxmlEndpointMap</span><span class="o">.</span><span class="n">SLIDE</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">previous_ooxml_version</span> <span class="o">=</span> <span class="n">previous_ooxml_version</span>
    <span class="k">if</span> <span class="n">file_last_modified</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_last_modified</span> <span class="o">=</span> <span class="n">file_last_modified</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_last_modified</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">document_ooxml_id</span> <span class="o">=</span> <span class="n">document_ooxml_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">svg_html</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_container</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlFileWidget.create_container">
    <p>def <span class="ident">create_container</span>(</p><p>self, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlFileWidget.create_container', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlFileWidget.create_container" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    
    <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_client</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">token_util</span><span class="o">.</span><span class="n">token</span><span class="p">[</span><span class="s2">&quot;access_token&quot;</span><span class="p">]</span>
    <span class="n">svg_container_div</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="p">{</span>
        <span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;svg-container&#39;</span><span class="p">,</span>
        <span class="s1">&#39;data-jwt&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">,</span>
        <span class="s1">&#39;data-object-type&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_map</span><span class="o">.</span><span class="n">endpoint_id</span><span class="p">,</span>
        <span class="s1">&#39;data-object-id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_ooxml_id</span>
    <span class="p">})</span>
    <span class="n">preloader_container_div</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">svg_container_div</span><span class="p">,</span> <span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="n">attrib</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span><span class="s2">&quot;preloader-container&quot;</span><span class="p">})</span>
    <span class="n">preloader_row_div</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">preloader_container_div</span><span class="p">,</span> <span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="n">attrib</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span><span class="s2">&quot;preloader-row&quot;</span><span class="p">})</span>
    <span class="n">preloader_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s2">&quot;img&quot;</span><span class="p">,</span> <span class="s2">&quot;preloader.svg&quot;</span><span class="p">)</span>
    <span class="n">svg</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">preloader_file</span><span class="p">)</span>
    <span class="n">preloader_row_div</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">svg</span><span class="o">.</span><span class="n">getroot</span><span class="p">())</span>
    <span class="n">empty_parent_div</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="p">{</span>
        <span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;empty-parent bg-light&#39;</span>
    <span class="p">})</span>
    <span class="n">empty_parent_div</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">svg_container_div</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lxml</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">empty_parent_div</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlFileWidget.get_client">
    <p>def <span class="ident">get_client</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlFileWidget.get_client', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlFileWidget.get_client" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">client_info</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlFileWidget.get_svg">
    <p>def <span class="ident">get_svg</span>(</p><p>self, id, timeout_iterator=0)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlFileWidget.get_svg', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlFileWidget.get_svg" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_svg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">timeout_iterator</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">svg_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_map</span><span class="o">.</span><span class="n">get_svg_url</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_client</span><span class="p">()</span>
    <span class="n">auth_header</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_auth_header</span><span class="p">()</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">svg_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
    <span class="n">svg_data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ApiError</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">status_code</span><span class="o">=</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Temp data&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">timeout_iterator</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ApiError</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;Unable to download svg.  Please check for upstream processing errors.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">svg_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_svg</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">timeout_iterator</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlFileWidget.render">
    <p>def <span class="ident">render</span>(</p><p>self, component, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlFileWidget.render', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlFileWidget.render" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlFileWidget.serialize">
    <p>def <span class="ident">serialize</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates presalytics.story.outline.Widget object from instance data. This widget should
have the correct name, data and additional_properties so the same widget can be reconstituted
via the to_html method, given the same set of data.</p>
<p>Typically, this method will call an update method that run a local script with updates this
Widget's data Dictionary prior being loading into the Widget outline object for serialization.</p>
<h2>Parameters:</h2>
<p>**kwargs:
    Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.
    these keyword arguments should be be invariant through successive updates to the chart. Overrides
    for this widgets default additional_properties shoudl be loaded via these keyword argments.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlFileWidget.serialize', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlFileWidget.serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
        <span class="s2">&quot;object_name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_name</span><span class="p">,</span>
        <span class="s2">&quot;endpoint_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_map</span><span class="o">.</span><span class="n">endpoint_id</span><span class="p">,</span>
        <span class="s2">&quot;document_ooxml_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">document_ooxml_id</span><span class="p">,</span>
        <span class="s2">&quot;object_ooxml_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_ooxml_id</span><span class="p">,</span>
        <span class="s2">&quot;story_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">story_id</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_last_modified</span><span class="p">:</span>
        <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;file_last_modified&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_last_modified</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous_ooxml_version</span><span class="p">:</span>
        <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;previous_ooxml_version&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous_ooxml_version</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="n">widget</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">Widget</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">kind</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__component_kind__</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">plugins</span><span class="o">=</span><span class="bp">None</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">widget</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlFileWidget.to_html">
    <p>def <span class="ident">to_html</span>(</p><p>self, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns valid html that renders the widget in a broswer.</p>
<h2>Parameters:</h2>
<p>data: Dict
    The data parameter is a dictionary should contain the minimum amount of that is required to
    successfully render the object.  As the widget is update, data control how the disply of
    information changes.
**kwargs:
    Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.
    these keyword arguments should be geinvariant through successive updates to the chart.  For example,
    keycloak argument should control the styling of the widget, which should not change as the data in
    the object (e.g., a chart) is updated.  Keyword arguments are loaded via additional_properties
    parameter in in the presalytics.story.outline.Widget object.</p>
<h2>Returns</h2>
<p>A string of containing an html fragment that will be loaded into a template in successive operations</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlFileWidget.to_html', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlFileWidget.to_html" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">to_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">svg_html</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlFileWidget.update">
    <p>def <span class="ident">update</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>If the file is available locally, this renders that updated file and pushes
the updated rendering data to the server</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlFileWidget.update', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlFileWidget.update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    If the file is available locally, this renders that updated file and pushes</span>
<span class="sd">    the updated rendering data to the server</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">story</span><span class="p">:</span> <span class="s1">&#39;ApiStory&#39;</span>
    <span class="n">page</span><span class="p">:</span> <span class="s1">&#39;Page&#39;</span>
    <span class="n">widget</span><span class="p">:</span> <span class="s1">&#39;Widget&#39;</span>
    <span class="n">search_paths</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">presalytics</span><span class="o">.</span><span class="n">autodiscover_paths</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">search_paths</span><span class="p">:</span>
        <span class="n">search_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">search_paths</span><span class="p">:</span>
        <span class="n">fpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">fpath</span><span class="p">):</span>
            <span class="c1"># update only the file has been modified sine last time</span>
            <span class="n">this_file_last_modified</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcfromtimestamp</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">fpath</span><span class="p">))</span><span class="o">.</span><span class="n">astimezone</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_last_modified</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_last_modified</span> <span class="o">&lt;=</span> <span class="n">this_file_last_modified</span><span class="p">:</span>
                <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_client</span><span class="p">()</span>
                <span class="n">story</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">story_id_file_post_with_http_info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">story_id</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">fpath</span><span class="p">,</span> <span class="n">replace_existing</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">obsolete_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">document_ooxml_id</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">status</span> <span class="o">&gt;=</span> <span class="mi">299</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ApiError</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">previous_ooxml_version</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;document_ooxml_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">document_ooxml_id</span><span class="p">,</span>
                    <span class="s2">&quot;object_ooxml_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_ooxml_id</span>
                <span class="p">}</span>
                <span class="n">new_outline</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">StoryOutline</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">story</span><span class="o">.</span><span class="n">outline</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">new_outline</span><span class="o">.</span><span class="n">pages</span><span class="p">:</span>
                    <span class="n">found</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="k">for</span> <span class="n">widget</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">widgets</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">widget</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_name</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">document_ooxml_id</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;document_ooxml_id&quot;</span><span class="p">]</span>
                            <span class="n">found</span> <span class="o">=</span> <span class="bp">True</span>
                            <span class="k">break</span>
                    <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
                    <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Unable to find widget object name {0} in new story outline.  Has this widget been deleted?&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object_name</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
                <span class="c1"># Get object tree, compare to object name</span>
                <span class="n">child_tree</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">ooxml_automation</span><span class="o">.</span><span class="n">documents_childobjects_get_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">document_ooxml_id</span><span class="p">)</span>
                <span class="n">target_dto</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">target_dto</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">child_tree</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">entity_name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_name</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="c1"># if name not in object or _object_name is none, get first item of type in end_point id</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">target_dto</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">target_dto</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">child_tree</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">object_type</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_map</span><span class="o">.</span><span class="n">endpoint_id</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Child tree of document {0} does not have a child object of type {1} or name {2}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ooxml_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_map</span><span class="o">.</span><span class="n">endpoint_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_name</span><span class="p">)</span>
                        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">InvalidConfigurationError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
                <span class="c1"># set widget parameters for recreation server-side (without file)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object_ooxml_id</span> <span class="o">=</span> <span class="n">target_dto</span><span class="o">.</span><span class="n">entity_id</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">file_last_modified</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">roundup_date_modified</span><span class="p">(</span><span class="n">this_file_last_modified</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="presalytics.OoxmlFileWidget.document_ooxml_id" class="name">var <span class="ident">document_ooxml_id</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.OoxmlFileWidget.filename" class="name">var <span class="ident">filename</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.OoxmlFileWidget.previous_ooxml_version" class="name">var <span class="ident">previous_ooxml_version</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.OoxmlFileWidget.svg_html" class="name">var <span class="ident">svg_html</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlFileWidget.deserialize">
    <p>def <span class="ident">deserialize</span>(</p><p>cls, component, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlFileWidget.deserialize', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlFileWidget.deserialize" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">init_args</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">],</span>
        <span class="s2">&quot;endpoint_map&quot;</span><span class="p">:</span> <span class="n">OoxmlEndpointMap</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;endpoint_id&quot;</span><span class="p">]),</span>
        <span class="s2">&quot;object_name&quot;</span><span class="p">:</span> <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;object_name&quot;</span><span class="p">],</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="s2">&quot;document_ooxml_id&quot;</span> <span class="ow">in</span> <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
        <span class="n">init_args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;document_ooxml_id&quot;</span><span class="p">:</span> <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;document_ooxml_id&quot;</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;object_ooxml_id&quot;</span> <span class="ow">in</span> <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
        <span class="n">init_args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;object_ooxml_id&quot;</span><span class="p">:</span> <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;object_ooxml_id&quot;</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;file_last_modified&quot;</span> <span class="ow">in</span> <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
        <span class="n">init_args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;file_last_modified&quot;</span><span class="p">:</span> <span class="n">dateutil</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;file_last_modified&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;previous_ooxml_version&quot;</span> <span class="ow">in</span> <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
        <span class="n">init_args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;previous_ooxml_version&quot;</span><span class="p">:</span> <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;previous_ooxml_version&quot;</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;story_id&quot;</span> <span class="ow">in</span> <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
        <span class="n">init_args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;story_id&quot;</span><span class="p">:</span> <span class="n">component</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;story_id&quot;</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">init_args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">init_args</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="presalytics.OoxmlTheme" class="name">class <span class="ident">OoxmlTheme</span></p>
      
  
    <div class="desc"><p>A script plugin render configures templated scripts to append to the body
tag of an html document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlTheme', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlTheme" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">OoxmlTheme</span><span class="p">(</span><span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">plugins</span><span class="o">.</span><span class="n">reveal_theme</span><span class="o">.</span><span class="n">RevealCustomTheme</span><span class="p">):</span>
    <span class="n">__plugin_name__</span> <span class="o">=</span> <span class="s1">&#39;ooxml-theme&#39;</span>

    <span class="k">def</span> <span class="nf">to_style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">base_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;scss&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;nt&quot;</span><span class="p">:</span>
            <span class="n">import_path</span> <span class="o">=</span> <span class="n">posixpath</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="o">*</span><span class="n">base_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">import_path</span> <span class="o">=</span> <span class="n">base_path</span>
        <span class="n">scss_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_path</span><span class="p">,</span> <span class="s1">&#39;overrides.tmpl&#39;</span><span class="p">)</span>
        <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">import_path</span><span class="p">})</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">scss_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
            <span class="n">scss_template_string</span> <span class="o">=</span> <span class="nb">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">scss_string</span> <span class="o">=</span> <span class="n">scss_template_string</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">)</span>
        <span class="n">new_css</span> <span class="o">=</span> <span class="n">sass</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">scss_string</span><span class="p">)</span>
        <span class="n">style_string</span> <span class="o">=</span> <span class="s2">&quot;&lt;style&gt;</span><span class="se">\n</span><span class="s2">{0}</span><span class="se">\n</span><span class="s2">&lt;/style&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">new_css</span><span class="p">)</span>
        <span class="n">font_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;headingFont&quot;</span><span class="p">],</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;bodyFont&quot;</span><span class="p">]]</span>
        <span class="n">links</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fonts</span><span class="p">(</span><span class="n">font_names</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">links</span> <span class="o">+</span> <span class="n">style_string</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#presalytics.OoxmlTheme">OoxmlTheme</a></li>
          <li><a href="#presalytics.RevealCustomTheme">RevealCustomTheme</a></li>
          <li>presalytics.lib.plugins.base.StylePlugin</li>
          <li><a href="#presalytics.PluginBase">PluginBase</a></li>
          <li>abc.ABC</li>
          <li>builtins.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="presalytics.OoxmlTheme.defaults" class="name">var <span class="ident">defaults</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.OoxmlTheme.fonts_base_url" class="name">var <span class="ident">fonts_base_url</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlTheme.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#presalytics.RevealCustomTheme">RevealCustomTheme</a></code>.<code><a href="#presalytics.RevealCustomTheme.__init__">__init__</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlTheme.__init__', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlTheme.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">validate_metadata</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlTheme.get_base_scss">
    <p>def <span class="ident">get_base_scss</span>(</p><p>self, scss_variables)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlTheme.get_base_scss', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlTheme.get_base_scss" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_base_scss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scss_variables</span><span class="p">):</span>
    <span class="n">scss_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s2">&quot;scss&quot;</span><span class="p">)</span>
    <span class="n">mixins_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">scss_folder</span><span class="p">,</span> <span class="s2">&quot;reveal-mixins.scss&quot;</span><span class="p">)</span>
    <span class="n">settings_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">scss_folder</span><span class="p">,</span> <span class="s2">&quot;reveal-settings.scss&quot;</span><span class="p">)</span>
    <span class="n">theme_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">scss_folder</span><span class="p">,</span> <span class="s2">&quot;reveal-theme.scss&quot;</span><span class="p">)</span>
    <span class="n">overrides_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">scss_folder</span><span class="p">,</span> <span class="s2">&quot;overrides.scss.tmpl&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">mixins_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">m</span><span class="p">:</span>
        <span class="n">mixins</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">settings_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">theme_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">t</span><span class="p">:</span>
        <span class="n">theme</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">overrides_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">o</span><span class="p">:</span>
        <span class="n">overrides_template</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">overrides</span> <span class="o">=</span> <span class="n">overrides_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">scss_variables</span><span class="p">)</span>
    <span class="n">scss_string</span> <span class="o">=</span> <span class="s2">&quot;{0}</span><span class="se">\n</span><span class="s2">{1}</span><span class="se">\n</span><span class="s2">{2}</span><span class="se">\n</span><span class="s2">{3}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mixins</span><span class="p">,</span> <span class="n">settings</span><span class="p">,</span> <span class="n">overrides</span><span class="p">,</span> <span class="n">theme</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">scss_string</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlTheme.get_font_link">
    <p>def <span class="ident">get_font_link</span>(</p><p>self, font_name)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlTheme.get_font_link', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlTheme.get_font_link" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_font_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">font_name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="n">test_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fonts_base_url</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">font_name</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">test_url</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;link href=&quot;{0}&quot; rel=&quot;stylesheet&quot;&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">test_url</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlTheme.get_fonts">
    <p>def <span class="ident">get_fonts</span>(</p><p>self, fonts)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlTheme.get_fonts', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlTheme.get_fonts" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_fonts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fonts</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
    <span class="n">links</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">font</span> <span class="ow">in</span> <span class="n">fonts</span><span class="p">:</span>
        <span class="n">link</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_font_link</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">link</span><span class="p">:</span>
            <span class="n">links</span> <span class="o">=</span> <span class="n">links</span> <span class="o">+</span> <span class="n">link</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">links</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlTheme.get_tag">
    <p>def <span class="ident">get_tag</span>(</p><p>self, config, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Generic method to be implemented by all inheriting classes. Allow plugin
to be render without knowledge of the underlying plugin kind.</p>
<h2>Parameters:</h2>
<p>config: Dict
    A set configuration values for the plugin.  Required keys should be
    specified by the docstring of the inheriting classes.
    Can be implemented via a mypy_extensions.TypedDict object if warranted.
    The presalytics.story.outline.Plugin's config element should be passed
    as this value to render the script.</p>
<h2>Returns:</h2>
<p>A string carrying a html script that can be embedded in a html document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlTheme.get_tag', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlTheme.get_tag" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_style</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlTheme.to_style">
    <p>def <span class="ident">to_style</span>(</p><p>self, config, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>The to_style method maps a dictionary to an html style tag.</p>
<h2>Parameters:</h2>
<p>config: Dict
    A set configuration values for the plugin.  Required keys should be
    specified by the docstring of the inheriting classes.
    Can be implemented via a mypy_extensions.TypedDict object if warranted.
    The presalytics.story.outline.Plugin's config element should be passed
    as this value to render the script.</p>
<h2>Returns:</h2>
<p>A string carrying a html script that can be embedded in a html document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlTheme.to_style', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlTheme.to_style" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">to_style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">base_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;scss&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;nt&quot;</span><span class="p">:</span>
        <span class="n">import_path</span> <span class="o">=</span> <span class="n">posixpath</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="o">*</span><span class="n">base_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">import_path</span> <span class="o">=</span> <span class="n">base_path</span>
    <span class="n">scss_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_path</span><span class="p">,</span> <span class="s1">&#39;overrides.tmpl&#39;</span><span class="p">)</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">import_path</span><span class="p">})</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">scss_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
        <span class="n">scss_template_string</span> <span class="o">=</span> <span class="nb">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">scss_string</span> <span class="o">=</span> <span class="n">scss_template_string</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">)</span>
    <span class="n">new_css</span> <span class="o">=</span> <span class="n">sass</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">scss_string</span><span class="p">)</span>
    <span class="n">style_string</span> <span class="o">=</span> <span class="s2">&quot;&lt;style&gt;</span><span class="se">\n</span><span class="s2">{0}</span><span class="se">\n</span><span class="s2">&lt;/style&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">new_css</span><span class="p">)</span>
    <span class="n">font_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;headingFont&quot;</span><span class="p">],</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;bodyFont&quot;</span><span class="p">]]</span>
    <span class="n">links</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fonts</span><span class="p">(</span><span class="n">font_names</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">links</span> <span class="o">+</span> <span class="n">style_string</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.OoxmlTheme.validate_metadata">
    <p>def <span class="ident">validate_metadata</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.OoxmlTheme.validate_metadata', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.OoxmlTheme.validate_metadata" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">validate_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plugin_kind__</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plugin_name__</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Plugin class {0} has not defined either __plugin_kind__ or __plugin_name__ metadata&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="presalytics.PageTemplateBase" class="name">class <span class="ident">PageTemplateBase</span></p>
      
  
    <div class="desc"><p>Inherit from this base class to render templates to html via the
presalytics.story.revealer.Revealer class.</p>
<h2>Parameters:</h2>
<p>page: Page
    A presalytics.story.outline.Page object for instalizing the class</p>
<h2>Attributes:</h2>
<p>outline_page: Page
    A presalytics.story.outline.Page object</p>
<p>widgets: List[WidgetComponentBase]
    A list widget that will be loaded into templates and rendered via placeholders.
    These widgets must have a "to_html(self, data, **kwargs)" method.</p>
<p>css: List[str]
    A list of keys in dot notation that point to links in the ALLOWED_STYLES dictionary
    in the presalytics.lib.templates.base module.</p>
<p>js: List[str]
    A list of keys in dot notation that point to links in the ALLOWED_SCRIPTS dictionary
    in the presalytics.lib.templates.base module.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.PageTemplateBase', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.PageTemplateBase" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">PageTemplateBase</span><span class="p">(</span><span class="n">ComponentBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Inherit from this base class to render templates to html via the</span>
<span class="sd">    presalytics.story.revealer.Revealer class.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ----------</span>
<span class="sd">    page: Page</span>
<span class="sd">        A presalytics.story.outline.Page object for instalizing the class</span>

<span class="sd">    Attributes:</span>
<span class="sd">    ----------</span>
<span class="sd">    outline_page: Page</span>
<span class="sd">        A presalytics.story.outline.Page object</span>

<span class="sd">    widgets: List[WidgetComponentBase]</span>
<span class="sd">        A list widget that will be loaded into templates and rendered via placeholders.</span>
<span class="sd">        These widgets must have a &quot;to_html(self, data, **kwargs)&quot; method.</span>

<span class="sd">    css: List[str]</span>
<span class="sd">        A list of keys in dot notation that point to links in the ALLOWED_STYLES dictionary</span>
<span class="sd">        in the presalytics.lib.templates.base module.</span>

<span class="sd">    js: List[str]</span>
<span class="sd">        A list of keys in dot notation that point to links in the ALLOWED_SCRIPTS dictionary</span>
<span class="sd">        in the presalytics.lib.templates.base module.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outline_page</span><span class="p">:</span> <span class="s1">&#39;Page&#39;</span>
    <span class="n">widgets</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="s1">&#39;WidgetBase&#39;</span><span class="p">]</span>
    <span class="n">plugins</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">]</span>

    <span class="n">__component_type__</span> <span class="o">=</span> <span class="s1">&#39;page&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="s1">&#39;Page&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PageTemplateBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outline_page</span> <span class="o">=</span> <span class="n">page</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widgets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_page_widgets</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outline_page</span><span class="p">)</span>
        

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns valid html that renders the template in a broswer with data loaded from widgets.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        ----------</span>
<span class="sd">        widgets: Sequence[WidgetComponentBase]</span>
<span class="sd">            List of widget instances a one to many different class that inhereit from the WidgetComponentBase</span>
<span class="sd">            abstract class. Defaults tot he widget list that the class as initilazed with.</span>

<span class="sd">        **kwargs:</span>
<span class="sd">            Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.</span>
<span class="sd">            these keyword arguments should be geinvariant through successive updates to the chart.  For example,</span>
<span class="sd">            keycloak argument should control the styling of the widget, which should not change as the data in</span>
<span class="sd">            the object (e.g., a chart) is updated.  Keyword arguments are loaded via additional_properties</span>
<span class="sd">            parameter in in the presalytics.story.outline.Widget object.</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        A string of containing an html fragment that will be loaded into a template in successive operations</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">load_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">:</span> <span class="s1">&#39;Widget&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts a presalytics.story.outline.Widget object to a subclass of WidgetComponentBase</span>
<span class="sd">        via a presalytics.story.loaders.WidgetLoaderBase object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">class_key</span> <span class="o">=</span> <span class="s2">&quot;widget.&quot;</span> <span class="o">+</span> <span class="n">widget</span><span class="o">.</span><span class="n">kind</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">class_key</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">widget</span><span class="o">.</span><span class="n">name</span>
        <span class="k">if</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
            <span class="n">widget_instance</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">klass</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">class_key</span><span class="p">)</span>
            <span class="n">deserialize_method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">klass</span><span class="p">,</span> <span class="s2">&quot;deserialize&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">deserialize_method</span><span class="p">):</span>
                <span class="n">widget_instance</span> <span class="o">=</span> <span class="n">deserialize_method</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="n">client_info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client_info</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Widget component instance or class (kind) {0} unavailable in component registry&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">MissingConfigException</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">widget_instance</span>

    <span class="k">def</span> <span class="nf">get_page_widgets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="s1">&#39;Page&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts the widgets within a presaltytics.story.outline.Page object to a list</span>
<span class="sd">        of widgets subclassed from WidgetComponentBase</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">widget_instances</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">widget_outline</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">widgets</span><span class="p">:</span>
            <span class="n">next_widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_widget</span><span class="p">(</span><span class="n">widget_outline</span><span class="p">)</span>
            <span class="n">widget_instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_widget</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">widget_instances</span>
    
    <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">outline_page</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">deseriailize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">page</span><span class="o">=</span><span class="n">component</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#presalytics.PageTemplateBase">PageTemplateBase</a></li>
          <li>presalytics.story.components.ComponentBase</li>
          <li>abc.ABC</li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.PageTemplateBase.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, page, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.PageTemplateBase.__init__', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.PageTemplateBase.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="s1">&#39;Page&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">PageTemplateBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">outline_page</span> <span class="o">=</span> <span class="n">page</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">widgets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_page_widgets</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outline_page</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.PageTemplateBase.get_client">
    <p>def <span class="ident">get_client</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.PageTemplateBase.get_client', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.PageTemplateBase.get_client" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">client_info</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.PageTemplateBase.get_page_widgets">
    <p>def <span class="ident">get_page_widgets</span>(</p><p>self, page)</p>
    </div>
    

    
  
    <div class="desc"><p>Converts the widgets within a presaltytics.story.outline.Page object to a list
of widgets subclassed from WidgetComponentBase</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.PageTemplateBase.get_page_widgets', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.PageTemplateBase.get_page_widgets" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_page_widgets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="s1">&#39;Page&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the widgets within a presaltytics.story.outline.Page object to a list</span>
<span class="sd">    of widgets subclassed from WidgetComponentBase</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">widget_instances</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">widget_outline</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">widgets</span><span class="p">:</span>
        <span class="n">next_widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_widget</span><span class="p">(</span><span class="n">widget_outline</span><span class="p">)</span>
        <span class="n">widget_instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_widget</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">widget_instances</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.PageTemplateBase.load_widget">
    <p>def <span class="ident">load_widget</span>(</p><p>self, widget)</p>
    </div>
    

    
  
    <div class="desc"><p>Converts a presalytics.story.outline.Widget object to a subclass of WidgetComponentBase
via a presalytics.story.loaders.WidgetLoaderBase object.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.PageTemplateBase.load_widget', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.PageTemplateBase.load_widget" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">load_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">:</span> <span class="s1">&#39;Widget&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a presalytics.story.outline.Widget object to a subclass of WidgetComponentBase</span>
<span class="sd">    via a presalytics.story.loaders.WidgetLoaderBase object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">class_key</span> <span class="o">=</span> <span class="s2">&quot;widget.&quot;</span> <span class="o">+</span> <span class="n">widget</span><span class="o">.</span><span class="n">kind</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">class_key</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">widget</span><span class="o">.</span><span class="n">name</span>
    <span class="k">if</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="n">widget_instance</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">klass</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">class_key</span><span class="p">)</span>
        <span class="n">deserialize_method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">klass</span><span class="p">,</span> <span class="s2">&quot;deserialize&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">deserialize_method</span><span class="p">):</span>
            <span class="n">widget_instance</span> <span class="o">=</span> <span class="n">deserialize_method</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="n">client_info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client_info</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Widget component instance or class (kind) {0} unavailable in component registry&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">MissingConfigException</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">widget_instance</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.PageTemplateBase.render">
    <p>def <span class="ident">render</span>(</p><p>self, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns valid html that renders the template in a broswer with data loaded from widgets.</p>
<h2>Parameters:</h2>
<p>widgets: Sequence[WidgetComponentBase]
    List of widget instances a one to many different class that inhereit from the WidgetComponentBase
    abstract class. Defaults tot he widget list that the class as initilazed with.</p>
<p>**kwargs:
    Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.
    these keyword arguments should be geinvariant through successive updates to the chart.  For example,
    keycloak argument should control the styling of the widget, which should not change as the data in
    the object (e.g., a chart) is updated.  Keyword arguments are loaded via additional_properties
    parameter in in the presalytics.story.outline.Widget object.</p>
<h2>Returns</h2>
<p>A string of containing an html fragment that will be loaded into a template in successive operations</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.PageTemplateBase.render', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.PageTemplateBase.render" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@abc.abstractmethod</span>
<span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns valid html that renders the template in a broswer with data loaded from widgets.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    ----------</span>
<span class="sd">    widgets: Sequence[WidgetComponentBase]</span>
<span class="sd">        List of widget instances a one to many different class that inhereit from the WidgetComponentBase</span>
<span class="sd">        abstract class. Defaults tot he widget list that the class as initilazed with.</span>
<span class="sd">    **kwargs:</span>
<span class="sd">        Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.</span>
<span class="sd">        these keyword arguments should be geinvariant through successive updates to the chart.  For example,</span>
<span class="sd">        keycloak argument should control the styling of the widget, which should not change as the data in</span>
<span class="sd">        the object (e.g., a chart) is updated.  Keyword arguments are loaded via additional_properties</span>
<span class="sd">        parameter in in the presalytics.story.outline.Widget object.</span>
<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    A string of containing an html fragment that will be loaded into a template in successive operations</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.PageTemplateBase.serialize">
    <p>def <span class="ident">serialize</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.PageTemplateBase.serialize', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.PageTemplateBase.serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">outline_page</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="presalytics.PageTemplateBase.outline_page" class="name">var <span class="ident">outline_page</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.PageTemplateBase.widgets" class="name">var <span class="ident">widgets</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.PageTemplateBase.deseriailize">
    <p>def <span class="ident">deseriailize</span>(</p><p>cls, component, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.PageTemplateBase.deseriailize', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.PageTemplateBase.deseriailize" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">deseriailize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">page</span><span class="o">=</span><span class="n">component</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.PageTemplateBase.deserialize">
    <p>def <span class="ident">deserialize</span>(</p><p>cls, component, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.PageTemplateBase.deserialize', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.PageTemplateBase.deserialize" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Type</span><span class="p">[</span><span class="s1">&#39;OutlineBase&#39;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="presalytics.PluginBase" class="name">class <span class="ident">PluginBase</span></p>
      
  
    <div class="desc"><p>A plugin converts a dictionary of configuration values into an html script.
Typically plugins are are used as reable mapping classes to add script tags to
to a rendered html body.</p>
<h2>Attributes:</h2>
<p><strong>plugin_kind</strong>: str
    The <strong>plugin_kind</strong> is a static string that uniquely identifies this plugin to classes
    the render story outlines (e.g., presalytics.story.revealer.Revealer).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.PluginBase', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.PluginBase" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">PluginBase</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A plugin converts a dictionary of configuration values into an html script.</span>
<span class="sd">    Typically plugins are are used as reable mapping classes to add script tags to</span>
<span class="sd">    to a rendered html body.</span>

<span class="sd">    Attributes:</span>
<span class="sd">    ----------</span>

<span class="sd">    __plugin_kind__: str</span>
<span class="sd">        The __plugin_kind__ is a static string that uniquely identifies this plugin to classes</span>
<span class="sd">        the render story outlines (e.g., presalytics.story.revealer.Revealer).</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__plugin_kind__</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">__plugin_name__</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">__dependencies__</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">]</span>

    <span class="n">__dependencies__</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">config</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_metadata</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">validate_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plugin_kind__</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plugin_name__</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Plugin class {0} has not defined either __plugin_kind__ or __plugin_name__ metadata&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generic method to be implemented by all inheriting classes. Allow plugin</span>
<span class="sd">        to be render without knowledge of the underlying plugin kind.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        ----------</span>

<span class="sd">        config: Dict</span>
<span class="sd">            A set configuration values for the plugin.  Required keys should be</span>
<span class="sd">            specified by the docstring of the inheriting classes.</span>
<span class="sd">            Can be implemented via a mypy_extensions.TypedDict object if warranted.</span>
<span class="sd">            The presalytics.story.outline.Plugin&#39;s config element should be passed</span>
<span class="sd">            as this value to render the script.</span>

<span class="sd">        Returns:</span>
<span class="sd">        ----------</span>

<span class="sd">        A string carrying a html script that can be embedded in a html document</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#presalytics.PluginBase">PluginBase</a></li>
          <li>abc.ABC</li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.PluginBase.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.PluginBase.__init__', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.PluginBase.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">validate_metadata</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.PluginBase.get_tag">
    <p>def <span class="ident">get_tag</span>(</p><p>self, config, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Generic method to be implemented by all inheriting classes. Allow plugin
to be render without knowledge of the underlying plugin kind.</p>
<h2>Parameters:</h2>
<p>config: Dict
    A set configuration values for the plugin.  Required keys should be
    specified by the docstring of the inheriting classes.
    Can be implemented via a mypy_extensions.TypedDict object if warranted.
    The presalytics.story.outline.Plugin's config element should be passed
    as this value to render the script.</p>
<h2>Returns:</h2>
<p>A string carrying a html script that can be embedded in a html document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.PluginBase.get_tag', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.PluginBase.get_tag" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@abc.abstractmethod</span>
<span class="k">def</span> <span class="nf">get_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generic method to be implemented by all inheriting classes. Allow plugin</span>
<span class="sd">    to be render without knowledge of the underlying plugin kind.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    ----------</span>
<span class="sd">    config: Dict</span>
<span class="sd">        A set configuration values for the plugin.  Required keys should be</span>
<span class="sd">        specified by the docstring of the inheriting classes.</span>
<span class="sd">        Can be implemented via a mypy_extensions.TypedDict object if warranted.</span>
<span class="sd">        The presalytics.story.outline.Plugin&#39;s config element should be passed</span>
<span class="sd">        as this value to render the script.</span>
<span class="sd">    Returns:</span>
<span class="sd">    ----------</span>
<span class="sd">    A string carrying a html script that can be embedded in a html document</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.PluginBase.validate_metadata">
    <p>def <span class="ident">validate_metadata</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.PluginBase.validate_metadata', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.PluginBase.validate_metadata" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">validate_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plugin_kind__</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plugin_name__</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Plugin class {0} has not defined either __plugin_kind__ or __plugin_name__ metadata&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="presalytics.Renderer" class="name">class <span class="ident">Renderer</span></p>
      
  
    <div class="desc"><p>This class serves as the primary interface clas for the story components.  Instances of
this interface carry enough information to rendered to html.  Developers, analysts and
users should inherit from base class if they want components to be registered in the
rendering pipeline for presalytics stories.</p>
<p>Instance of this class must:
1. Initialize with a name parameter
2  Serialize to a subclass of presalytics.story.outline.OutlineBase
3. Deserialize from an instance of presalytics.story.OutlineBase
4. Render to html</p>
<p>The <strong>component_type</strong> and <strong>component_name</strong> metadata on subclasses is required in
order for instances to be registered in rendering pipeline for automatic updates</p>
<h2>Attributes:</h2>
<p>name: str
    The name of the instance of the component.  Used in component as a key to lookup
    instances to re-calcute during rendering</p>
<p>css: List[str]
    A list of keys in dot notation that point to links in the ALLOWED_STYLES dictionary
    in the presalytics.lib.templates.base module.</p>
<p>js: List[str]
    A list of keys in dot notation that point to links in the ALLOWED_SCRIPTS dictionary
    in the presalytics.lib.templates.base module.</p>
<p><strong>component_type</strong>: str
    The idenifier for the component superclass (e.g. widget, page_template, renderer, theme).
    Used for component registration.</p>
<p><strong>component_kind</strong>:
    An identifier for this component class.  Used for component registration.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Renderer', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Renderer" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Renderer</span><span class="p">(</span><span class="n">ComponentBase</span><span class="p">):</span>
    <span class="n">__component_type__</span> <span class="o">=</span> <span class="s1">&#39;renderer&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Renderer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#presalytics.Renderer">Renderer</a></li>
          <li>presalytics.story.components.ComponentBase</li>
          <li>abc.ABC</li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.Renderer.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Renderer.__init__', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Renderer.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Renderer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Renderer.get_client">
    <p>def <span class="ident">get_client</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Renderer.get_client', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Renderer.get_client" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">client_info</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Renderer.render">
    <p>def <span class="ident">render</span>(</p><p>self, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Renderer.render', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Renderer.render" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@abc.abstractmethod</span>
<span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Renderer.serialize">
    <p>def <span class="ident">serialize</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Renderer.serialize', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Renderer.serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@abc.abstractmethod</span>
<span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.Renderer.deserialize">
    <p>def <span class="ident">deserialize</span>(</p><p>cls, component, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Renderer.deserialize', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Renderer.deserialize" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Type</span><span class="p">[</span><span class="s1">&#39;OutlineBase&#39;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="presalytics.RevealConfigPlugin" class="name">class <span class="ident">RevealConfigPlugin</span></p>
      
  
    <div class="desc"><p>A script plugin render configures templated scripts to append to the body
tag of an html document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.RevealConfigPlugin', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.RevealConfigPlugin" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">RevealConfigPlugin</span><span class="p">(</span><span class="n">ext</span><span class="o">.</span><span class="n">ScriptPlugin</span><span class="p">,</span> <span class="n">jinja</span><span class="o">.</span><span class="n">JinjaPluginMakerMixin</span><span class="p">):</span>
    <span class="n">__plugin_name__</span> <span class="o">=</span> <span class="s1">&#39;reveal&#39;</span>

    <span class="n">__dependencies__</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;kind&#39;</span><span class="p">:</span> <span class="s1">&#39;script&#39;</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;external_scripts&#39;</span><span class="p">,</span>
            <span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;approved_scripts_key&#39;</span><span class="p">:</span> <span class="s1">&#39;reveal.base&#39;</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;kind&#39;</span><span class="p">:</span> <span class="s1">&#39;style&#39;</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;external_links&#39;</span><span class="p">,</span>
            <span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;approved_styles_key&#39;</span><span class="p">:</span> <span class="s1">&#39;reveal.base&#39;</span>
            <span class="p">}</span>

        <span class="p">}</span>
    <span class="p">]</span>

    <span class="k">def</span> <span class="nf">to_script</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">reveal_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_config</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reveal_params&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>
            <span class="n">reveal_config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;reveal_params&quot;</span><span class="p">))</span>
        <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;reveal_config&#39;</span><span class="p">:</span> <span class="n">reveal_config</span><span class="p">})</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

    <span class="n">template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;script type=&quot;text/javascript&quot;&gt; </span>
<span class="s2">        window.onload = function(e) {</span>
<span class="s2">            Reveal.initialize(</span>
<span class="s2">                {{ reveal_config|tojson(indent=4) }}</span>
<span class="s2">            );</span>
<span class="s2">        };</span>
<span class="s2">    &lt;/script&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="n">default_config</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;controls&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>  <span class="c1"># Display presentation control arrows</span>
        <span class="c1"># Help the user learn the controls by providing hints, for example by</span>
        <span class="c1"># bouncing the down arrow when they first encounter a vertical slide</span>
        <span class="s1">&#39;controlsTutorial&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>

        <span class="c1"># Determines where controls appear, &quot;edges&quot; or &quot;bottom-right&quot; #</span>
        <span class="s1">&#39;controlsLayout&#39;</span><span class="p">:</span> <span class="s1">&#39;bottom-right&#39;</span><span class="p">,</span>

        <span class="c1"># Visibility rule for backwards navigation arrows; &quot;faded&quot;, &quot;hidden&quot;</span>
        <span class="c1"># or &quot;visible&quot;</span>
        <span class="s1">&#39;controlsBackArrows&#39;</span><span class="p">:</span> <span class="s1">&#39;faded&#39;</span><span class="p">,</span>

        <span class="c1"># Display a presentation progress bar</span>
        <span class="s1">&#39;progress&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>

        <span class="c1"># Display the page number of the current slide</span>
        <span class="s1">&#39;slideNumber&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>

        <span class="c1"># Add the current slide number to the URL hash so that reloading the</span>
        <span class="c1">#page/copying the URL will return you to the same slide</span>
        <span class="s1">&#39;hash&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>

        <span class="c1"># Push each slide change to the browser history. Implies `hash: true`</span>
        <span class="s1">&#39;history&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>

        <span class="c1"># Enable keyboard shortcuts for navigation </span>
        <span class="s1">&#39;keyboard&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>

        <span class="c1"># Enable the slide overview mode</span>
        <span class="s1">&#39;overview&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>

        <span class="c1"># Vertical centering of slides</span>
        <span class="s1">&#39;center&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>

        <span class="c1"># Enables touch navigation on devices with touch input</span>
        <span class="s1">&#39;touch&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>

        <span class="c1"># Loop the presentation</span>
        <span class="s1">&#39;loop&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>

        <span class="c1"># Change the presentation direction to be RTL</span>
        <span class="s1">&#39;rtl&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>

        <span class="c1"># See https://github.com/hakimel/reveal.js/#navigation-mode</span>
        <span class="s1">&#39;navigationMode&#39;</span><span class="p">:</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span>

        <span class="c1"># Randomizes the order of slides each time the presentation loads</span>
        <span class="s1">&#39;shuffle&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>

        <span class="c1"># Turns fragments on and off globally</span>
        <span class="s1">&#39;fragments&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>

        <span class="c1"># Flags whether to include the current fragment in the URL,</span>
        <span class="c1"># so that reloading brings you to the same fragment position #}</span>
        <span class="s1">&#39;fragmentInURL&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>

        <span class="c1"># Flags if the presentation is running in an embedded mode,</span>
        <span class="c1"># i.e. contained within a limited portion of the screen #}</span>
        <span class="s1">&#39;embedded&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>

        <span class="c1"># Flags if we should show a help overlay when the questionmark</span>
        <span class="c1"># key is pressed #}</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>

        <span class="c1"># Flags if speaker notes should be visible to all viewers</span>
        <span class="s1">&#39;showNotes&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>

        <span class="c1"># Global override for autoplaying embedded media (video/audio/iframe)</span>
        <span class="c1"># - null: Media will only autoplay if data-autoplay is present</span>
        <span class="c1"># - true: All media will autoplay, regardless of individual setting</span>
        <span class="c1"># - false: No media will autoplay, regardless of individual setting</span>
        <span class="s1">&#39;autoPlayMedia&#39;</span><span class="p">:</span> <span class="s1">&#39;null&#39;</span><span class="p">,</span>

        <span class="c1"># Global override for preloading lazy-loaded iframes</span>
        <span class="c1"># - null: Iframes with data-src AND data-preload will be loaded when within</span>
        <span class="c1">#   the viewDistance, iframes with only data-src will be loaded when visible</span>
        <span class="c1"># - true: All iframes with data-src will be loaded when within the viewDistance</span>
        <span class="c1"># - false: All iframes with data-src will be loaded only when visible #}</span>
        <span class="s1">&#39;preloadIframes&#39;</span><span class="p">:</span> <span class="s1">&#39;null&#39;</span><span class="p">,</span>

        <span class="c1"># Number of milliseconds between automatically proceeding to the</span>
        <span class="c1"># next slide, disabled when set to 0, this value can be overwritten</span>
        <span class="c1"># by using a data-autoslide attribute on your slides #}</span>
        <span class="s1">&#39;autoSlide&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>

        <span class="c1"># Stop auto-sliding after user input</span>
        <span class="s1">&#39;autoSlideStoppable&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>

        <span class="c1"># Use this method for navigation when auto-sliding</span>
        <span class="s1">&#39;autoSlideMethod&#39;</span><span class="p">:</span> <span class="s1">&#39;Reveal.navigateNext&#39;</span><span class="p">,</span>

        <span class="c1"># Specify the average time in seconds that you think you will spend</span>
        <span class="c1"># presenting each slide. This is used to show a pacing timer in the</span>
        <span class="c1"># speaker view </span>
        <span class="s1">&#39;defaultTiming&#39;</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span>

        <span class="c1"># Enable slide navigation via mouse wheel</span>
        <span class="s1">&#39;mouseWheel&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>

        <span class="c1"># Hide cursor if inactive</span>
        <span class="s1">&#39;hideInactiveCursor&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>

        <span class="c1"># Time before the cursor is hidden (in ms)</span>
        <span class="s1">&#39;hideCursorTime&#39;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span>

        <span class="c1"># Hides the address bar on mobile devices</span>
        <span class="s1">&#39;hideAddressBar&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>

        <span class="c1"># Opens links in an iframe preview overlay</span>
        <span class="c1">#  Add `data-preview-link` and `data-preview-link=&quot;false&quot;` to customise each link</span>
        <span class="c1"># individually</span>
        <span class="s1">&#39;previewLinks&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>

        <span class="c1"># Transition style</span>
        <span class="s1">&#39;transition&#39;</span><span class="p">:</span> <span class="s1">&#39;slide&#39;</span><span class="p">,</span> <span class="c1"># none/fade/slide/convex/concave/zoom</span>

        <span class="c1"># Transition speed</span>
        <span class="s1">&#39;transitionSpeed&#39;</span><span class="p">:</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="c1"># default/fast/slow</span>

        <span class="c1"># Transition style for full page slide backgrounds</span>
        <span class="s1">&#39;backgroundTransition&#39;</span><span class="p">:</span> <span class="s1">&#39;fade&#39;</span><span class="p">,</span> <span class="c1"># none/fade/slide/convex/concave/zoom</span>

        <span class="c1"># Number of slides away from the current that are visible</span>
        <span class="s1">&#39;viewDistance&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>

        <span class="c1"># Parallax background image</span>
        <span class="s1">&#39;parallaxBackgroundImage&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="c1"># e.g. &quot;&#39;https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg&#39;&quot;</span>

        <span class="c1"># Parallax background size</span>
        <span class="s1">&#39;parallaxBackgroundSize&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="c1"># CSS syntax, e.g. &quot;2100px 900px&quot;</span>

        <span class="c1"># Number of pixels to move the parallax background per slide</span>
        <span class="c1"># - Calculated automatically unless specified</span>
        <span class="c1"># - Set to 0 to disable movement along an axis </span>
        <span class="s1">&#39;parallaxBackgroundHorizontal&#39;</span><span class="p">:</span> <span class="s1">&#39;null&#39;</span><span class="p">,</span>
        <span class="s1">&#39;parallaxBackgroundVertical&#39;</span><span class="p">:</span> <span class="s1">&#39;null&#39;</span><span class="p">,</span>

        <span class="c1"># The display mode that will be used to show slides</span>
        <span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;block&#39;</span><span class="p">,</span>

        <span class="c1"># Allow for responsive presenation formats</span>
        <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s2">&quot;100%&quot;</span><span class="p">,</span>
        <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="s2">&quot;100%&quot;</span><span class="p">,</span>
        <span class="s1">&#39;margin&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;minScale&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;maxScale&#39;</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">}</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#presalytics.RevealConfigPlugin">RevealConfigPlugin</a></li>
          <li>presalytics.lib.plugins.base.ScriptPlugin</li>
          <li><a href="#presalytics.PluginBase">PluginBase</a></li>
          <li>abc.ABC</li>
          <li><a href="#presalytics.JinjaPluginMakerMixin">JinjaPluginMakerMixin</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="presalytics.RevealConfigPlugin.default_config" class="name">var <span class="ident">default_config</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.RevealConfigPlugin.template" class="name">var <span class="ident">template</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#presalytics.JinjaPluginMakerMixin">JinjaPluginMakerMixin</a></code>.<code><a href="#presalytics.JinjaPluginMakerMixin.template">template</a></code>
    </p>

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.RevealConfigPlugin.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.RevealConfigPlugin.__init__', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.RevealConfigPlugin.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">validate_metadata</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.RevealConfigPlugin.get_tag">
    <p>def <span class="ident">get_tag</span>(</p><p>self, config, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Generic method to be implemented by all inheriting classes. Allow plugin
to be render without knowledge of the underlying plugin kind.</p>
<h2>Parameters:</h2>
<p>config: Dict
    A set configuration values for the plugin.  Required keys should be
    specified by the docstring of the inheriting classes.
    Can be implemented via a mypy_extensions.TypedDict object if warranted.
    The presalytics.story.outline.Plugin's config element should be passed
    as this value to render the script.</p>
<h2>Returns:</h2>
<p>A string carrying a html script that can be embedded in a html document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.RevealConfigPlugin.get_tag', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.RevealConfigPlugin.get_tag" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_script</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.RevealConfigPlugin.get_template">
    <p>def <span class="ident">get_template</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.RevealConfigPlugin.get_template', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.RevealConfigPlugin.get_template" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_template</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;Plugins the use the JinjaPluginMakerMixin must have a defiined template attribute.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.RevealConfigPlugin.render">
    <p>def <span class="ident">render</span>(</p><p>self, config)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.RevealConfigPlugin.render', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.RevealConfigPlugin.render" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;loader&quot;</span><span class="p">:</span> <span class="n">jinja2</span><span class="o">.</span><span class="n">BaseLoader</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;jinja_options&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;jinja_options&quot;</span><span class="p">))</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">jinja2</span><span class="o">.</span><span class="n">Environment</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_template</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.RevealConfigPlugin.to_script">
    <p>def <span class="ident">to_script</span>(</p><p>self, config, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>The to_script method maps a dictionary to an html script tag.</p>
<h2>Parameters:</h2>
<p>config: Dict
    A set configuration values for the plugin.  Required keys should be
    specified by the docstring of the inheriting classes.
    Can be implemented via a mypy_extensions.TypedDict object if warranted.
    The presalytics.story.outline.Plugin's config element should be passed
    as this value to render the script.</p>
<h2>Returns:</h2>
<p>A string carrying a html script that can be embedded in a html document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.RevealConfigPlugin.to_script', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.RevealConfigPlugin.to_script" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">to_script</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">reveal_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_config</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reveal_params&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>
        <span class="n">reveal_config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;reveal_params&quot;</span><span class="p">))</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;reveal_config&#39;</span><span class="p">:</span> <span class="n">reveal_config</span><span class="p">})</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.RevealConfigPlugin.validate_metadata">
    <p>def <span class="ident">validate_metadata</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.RevealConfigPlugin.validate_metadata', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.RevealConfigPlugin.validate_metadata" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">validate_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plugin_kind__</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plugin_name__</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Plugin class {0} has not defined either __plugin_kind__ or __plugin_name__ metadata&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="presalytics.RevealCustomTheme" class="name">class <span class="ident">RevealCustomTheme</span></p>
      
  
    <div class="desc"><p>A script plugin render configures templated scripts to append to the body
tag of an html document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.RevealCustomTheme', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.RevealCustomTheme" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">RevealCustomTheme</span><span class="p">(</span><span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">plugins</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">StylePlugin</span><span class="p">):</span>
    <span class="n">__plugin_name__</span> <span class="o">=</span> <span class="s1">&#39;reveal_custom_theme&#39;</span>
    <span class="n">defaults</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>

    <span class="n">fonts_base_url</span> <span class="o">=</span> <span class="s1">&#39;https://fonts.googleapis.com/css?family={0}&#39;</span>

    <span class="k">def</span> <span class="nf">to_style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">scss_variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaults</span>
        <span class="n">scss_variables</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="n">scss_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_base_scss</span><span class="p">(</span><span class="n">scss_variables</span><span class="p">)</span>
        <span class="n">new_css</span> <span class="o">=</span> <span class="n">sass</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">scss_string</span><span class="p">)</span>
        <span class="n">style_string</span> <span class="o">=</span> <span class="s2">&quot;&lt;style&gt;</span><span class="se">\n</span><span class="s2">{0}</span><span class="se">\n</span><span class="s2">&lt;/style&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">new_css</span><span class="p">)</span>
        <span class="n">links</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fonts</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;fonts&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">links</span> <span class="o">+</span> <span class="n">style_string</span>

    <span class="k">def</span> <span class="nf">get_fonts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fonts</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="n">links</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">font</span> <span class="ow">in</span> <span class="n">fonts</span><span class="p">:</span>
            <span class="n">link</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_font_link</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">link</span><span class="p">:</span>
                <span class="n">links</span> <span class="o">=</span> <span class="n">links</span> <span class="o">+</span> <span class="n">link</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">links</span>

    <span class="k">def</span> <span class="nf">get_font_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">font_name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">test_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fonts_base_url</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">font_name</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">test_url</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;link href=&quot;{0}&quot; rel=&quot;stylesheet&quot;&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">test_url</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">get_base_scss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scss_variables</span><span class="p">):</span>
        <span class="n">scss_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s2">&quot;scss&quot;</span><span class="p">)</span>
        <span class="n">mixins_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">scss_folder</span><span class="p">,</span> <span class="s2">&quot;reveal-mixins.scss&quot;</span><span class="p">)</span>
        <span class="n">settings_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">scss_folder</span><span class="p">,</span> <span class="s2">&quot;reveal-settings.scss&quot;</span><span class="p">)</span>
        <span class="n">theme_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">scss_folder</span><span class="p">,</span> <span class="s2">&quot;reveal-theme.scss&quot;</span><span class="p">)</span>
        <span class="n">overrides_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">scss_folder</span><span class="p">,</span> <span class="s2">&quot;overrides.scss.tmpl&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">mixins_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">m</span><span class="p">:</span>
            <span class="n">mixins</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">settings_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
            <span class="n">settings</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">theme_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">t</span><span class="p">:</span>
            <span class="n">theme</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">overrides_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">o</span><span class="p">:</span>
            <span class="n">overrides_template</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

        <span class="n">overrides</span> <span class="o">=</span> <span class="n">overrides_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">scss_variables</span><span class="p">)</span>

        <span class="n">scss_string</span> <span class="o">=</span> <span class="s2">&quot;{0}</span><span class="se">\n</span><span class="s2">{1}</span><span class="se">\n</span><span class="s2">{2}</span><span class="se">\n</span><span class="s2">{3}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mixins</span><span class="p">,</span> <span class="n">settings</span><span class="p">,</span> <span class="n">overrides</span><span class="p">,</span> <span class="n">theme</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">scss_string</span>

    <span class="c1"># Defaults to white theme parameters</span>
    <span class="n">defaults</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1"># Background of the presentation</span>
        <span class="s2">&quot;background_color&quot;</span><span class="p">:</span> <span class="s2">&quot;#2b2b2b&quot;</span><span class="p">,</span>

        <span class="c1"># Primary/body text</span>
        <span class="s2">&quot;main_font&quot;</span><span class="p">:</span> <span class="s1">&#39;Lato&#39;</span><span class="p">,</span>
        <span class="s2">&quot;main_font_size&quot;</span><span class="p">:</span> <span class="s2">&quot;inherit&quot;</span><span class="p">,</span>
        <span class="s2">&quot;main_color&quot;</span><span class="p">:</span> <span class="s2">&quot;#eee&quot;</span><span class="p">,</span>

        <span class="c1"># Vertical spacing between blocks of text</span>
        <span class="s2">&quot;block_margin&quot;</span><span class="p">:</span> <span class="s2">&quot;20px&quot;</span><span class="p">,</span>

        <span class="c1"># Headings</span>
        <span class="s2">&quot;heading_margin&quot;</span><span class="p">:</span> <span class="s2">&quot;0 0 $blockMargin 0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;heading_font&quot;</span><span class="p">:</span> <span class="s1">&#39;Lato&#39;</span><span class="p">,</span>
        <span class="s2">&quot;heading_color&quot;</span><span class="p">:</span> <span class="s2">&quot;#eee&quot;</span><span class="p">,</span>
        <span class="s2">&quot;heading_line_height&quot;</span><span class="p">:</span> <span class="s2">&quot;1.2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;heading_letter_spacing&quot;</span><span class="p">:</span> <span class="s2">&quot;normal&quot;</span><span class="p">,</span>
        <span class="s2">&quot;heading_text_transform&quot;</span><span class="p">:</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
        <span class="s2">&quot;heading_text_shadow&quot;</span><span class="p">:</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
        <span class="s2">&quot;heading_font_weight&quot;</span><span class="p">:</span> <span class="s2">&quot;normal&quot;</span><span class="p">,</span>

        <span class="s2">&quot;heading_one_text_shadow&quot;</span><span class="p">:</span> <span class="s2">&quot;$headingTextShadow&quot;</span><span class="p">,</span>
        <span class="s2">&quot;heading_one_size&quot;</span><span class="p">:</span> <span class="s2">&quot;3.77em&quot;</span><span class="p">,</span>
        <span class="s2">&quot;heading_two_size&quot;</span><span class="p">:</span> <span class="s2">&quot;2.11em&quot;</span><span class="p">,</span>
        <span class="s2">&quot;heading_three_size&quot;</span><span class="p">:</span> <span class="s2">&quot;1.55em&quot;</span><span class="p">,</span>
        <span class="s2">&quot;heading_four_size&quot;</span><span class="p">:</span> <span class="s2">&quot;1.00em&quot;</span><span class="p">,</span>

        <span class="s2">&quot;code_font&quot;</span><span class="p">:</span> <span class="s2">&quot;monospace&quot;</span><span class="p">,</span>

        <span class="c1"># Links and actions</span>
        <span class="s2">&quot;link_color&quot;</span><span class="p">:</span> <span class="s2">&quot;#13DAEC&quot;</span><span class="p">,</span>
        <span class="s2">&quot;linkColorHover&quot;</span><span class="p">:</span> <span class="s2">&quot;lighten( $linkColor, 20% )&quot;</span><span class="p">,</span>

        <span class="c1"># Text selection</span>
        <span class="s2">&quot;selection_background_color&quot;</span><span class="p">:</span> <span class="s2">&quot;#FF5E99&quot;</span><span class="p">,</span>
        <span class="s2">&quot;selection_color&quot;</span><span class="p">:</span> <span class="s2">&quot;#fff&quot;</span>
    <span class="p">}</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#presalytics.RevealCustomTheme">RevealCustomTheme</a></li>
          <li>presalytics.lib.plugins.base.StylePlugin</li>
          <li><a href="#presalytics.PluginBase">PluginBase</a></li>
          <li>abc.ABC</li>
          <li>builtins.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="presalytics.RevealCustomTheme.defaults" class="name">var <span class="ident">defaults</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.RevealCustomTheme.fonts_base_url" class="name">var <span class="ident">fonts_base_url</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.RevealCustomTheme.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.RevealCustomTheme.__init__', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.RevealCustomTheme.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">validate_metadata</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.RevealCustomTheme.get_base_scss">
    <p>def <span class="ident">get_base_scss</span>(</p><p>self, scss_variables)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.RevealCustomTheme.get_base_scss', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.RevealCustomTheme.get_base_scss" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_base_scss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scss_variables</span><span class="p">):</span>
    <span class="n">scss_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s2">&quot;scss&quot;</span><span class="p">)</span>
    <span class="n">mixins_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">scss_folder</span><span class="p">,</span> <span class="s2">&quot;reveal-mixins.scss&quot;</span><span class="p">)</span>
    <span class="n">settings_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">scss_folder</span><span class="p">,</span> <span class="s2">&quot;reveal-settings.scss&quot;</span><span class="p">)</span>
    <span class="n">theme_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">scss_folder</span><span class="p">,</span> <span class="s2">&quot;reveal-theme.scss&quot;</span><span class="p">)</span>
    <span class="n">overrides_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">scss_folder</span><span class="p">,</span> <span class="s2">&quot;overrides.scss.tmpl&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">mixins_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">m</span><span class="p">:</span>
        <span class="n">mixins</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">settings_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">theme_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">t</span><span class="p">:</span>
        <span class="n">theme</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">overrides_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">o</span><span class="p">:</span>
        <span class="n">overrides_template</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">overrides</span> <span class="o">=</span> <span class="n">overrides_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">scss_variables</span><span class="p">)</span>
    <span class="n">scss_string</span> <span class="o">=</span> <span class="s2">&quot;{0}</span><span class="se">\n</span><span class="s2">{1}</span><span class="se">\n</span><span class="s2">{2}</span><span class="se">\n</span><span class="s2">{3}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mixins</span><span class="p">,</span> <span class="n">settings</span><span class="p">,</span> <span class="n">overrides</span><span class="p">,</span> <span class="n">theme</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">scss_string</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.RevealCustomTheme.get_font_link">
    <p>def <span class="ident">get_font_link</span>(</p><p>self, font_name)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.RevealCustomTheme.get_font_link', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.RevealCustomTheme.get_font_link" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_font_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">font_name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="n">test_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fonts_base_url</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">font_name</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">test_url</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;link href=&quot;{0}&quot; rel=&quot;stylesheet&quot;&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">test_url</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.RevealCustomTheme.get_fonts">
    <p>def <span class="ident">get_fonts</span>(</p><p>self, fonts)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.RevealCustomTheme.get_fonts', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.RevealCustomTheme.get_fonts" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_fonts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fonts</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
    <span class="n">links</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">font</span> <span class="ow">in</span> <span class="n">fonts</span><span class="p">:</span>
        <span class="n">link</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_font_link</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">link</span><span class="p">:</span>
            <span class="n">links</span> <span class="o">=</span> <span class="n">links</span> <span class="o">+</span> <span class="n">link</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">links</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.RevealCustomTheme.get_tag">
    <p>def <span class="ident">get_tag</span>(</p><p>self, config, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Generic method to be implemented by all inheriting classes. Allow plugin
to be render without knowledge of the underlying plugin kind.</p>
<h2>Parameters:</h2>
<p>config: Dict
    A set configuration values for the plugin.  Required keys should be
    specified by the docstring of the inheriting classes.
    Can be implemented via a mypy_extensions.TypedDict object if warranted.
    The presalytics.story.outline.Plugin's config element should be passed
    as this value to render the script.</p>
<h2>Returns:</h2>
<p>A string carrying a html script that can be embedded in a html document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.RevealCustomTheme.get_tag', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.RevealCustomTheme.get_tag" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_style</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.RevealCustomTheme.to_style">
    <p>def <span class="ident">to_style</span>(</p><p>self, config, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>The to_style method maps a dictionary to an html style tag.</p>
<h2>Parameters:</h2>
<p>config: Dict
    A set configuration values for the plugin.  Required keys should be
    specified by the docstring of the inheriting classes.
    Can be implemented via a mypy_extensions.TypedDict object if warranted.
    The presalytics.story.outline.Plugin's config element should be passed
    as this value to render the script.</p>
<h2>Returns:</h2>
<p>A string carrying a html script that can be embedded in a html document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.RevealCustomTheme.to_style', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.RevealCustomTheme.to_style" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">to_style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">scss_variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaults</span>
    <span class="n">scss_variables</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="n">scss_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_base_scss</span><span class="p">(</span><span class="n">scss_variables</span><span class="p">)</span>
    <span class="n">new_css</span> <span class="o">=</span> <span class="n">sass</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">scss_string</span><span class="p">)</span>
    <span class="n">style_string</span> <span class="o">=</span> <span class="s2">&quot;&lt;style&gt;</span><span class="se">\n</span><span class="s2">{0}</span><span class="se">\n</span><span class="s2">&lt;/style&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">new_css</span><span class="p">)</span>
    <span class="n">links</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fonts</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;fonts&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">links</span> <span class="o">+</span> <span class="n">style_string</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.RevealCustomTheme.validate_metadata">
    <p>def <span class="ident">validate_metadata</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.RevealCustomTheme.validate_metadata', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.RevealCustomTheme.validate_metadata" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">validate_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plugin_kind__</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plugin_name__</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Plugin class {0} has not defined either __plugin_kind__ or __plugin_name__ metadata&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="presalytics.Revealer" class="name">class <span class="ident">Revealer</span></p>
      
  
    <div class="desc"><p>This class renders 'Story Outines' to reveal.js presentations</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Revealer', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Revealer" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Revealer</span><span class="p">(</span><span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">Renderer</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class renders &#39;Story Outines&#39; to reveal.js presentations</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">story_outline</span><span class="p">:</span> <span class="s1">&#39;StoryOutline&#39;</span>
    <span class="n">base</span><span class="p">:</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span>
    <span class="n">links</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">]</span>
    <span class="n">plugins</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">]</span>

    <span class="n">__component_kind__</span> <span class="o">=</span> <span class="s1">&#39;revealer&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">story_outline</span><span class="p">:</span> <span class="s1">&#39;StoryOutline&#39;</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Revealer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span> <span class="o">=</span> <span class="n">story_outline</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Initializing story render for {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">story_outline</span><span class="o">.</span><span class="n">title</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_base</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading plugins&quot;</span><span class="p">)</span>
        <span class="n">reveal_plugin_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;kind&#39;</span><span class="p">:</span> <span class="s1">&#39;script&#39;</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;reveal&#39;</span><span class="p">,</span>
            <span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="p">{}</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_outline_from_instances</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span> <span class="o">=</span> <span class="p">[</span><span class="n">reveal_plugin_config</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_component_implicit_plugins</span><span class="p">()</span>
        <span class="n">outline_plugins</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">plugins</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">PluginManager</span><span class="o">.</span><span class="n">get_plugins_from_nested_dict</span><span class="p">(</span><span class="n">story_outline</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">outline_plugins</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plugin_mgr</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">plugins</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">PluginManager</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plugins</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Revealer initilized.&quot;</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="s1">&#39;StoryOutline&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;StoryOutline&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_outline_from_instances</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span>

    <span class="k">def</span> <span class="nf">update_outline_from_instances</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_dict</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_dict</span><span class="p">:</span>
            <span class="n">sub_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">sub_dict</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">sub_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;widgets&quot;</span><span class="p">,</span> <span class="s2">&quot;themes&quot;</span><span class="p">,</span> <span class="s2">&quot;pages&quot;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">list_item</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">list_item</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                                <span class="k">if</span> <span class="s2">&quot;kind&quot;</span> <span class="ow">in</span> <span class="n">list_item</span><span class="p">:</span>
                                    <span class="n">class_key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">list_item</span><span class="p">[</span><span class="s2">&quot;kind&quot;</span><span class="p">]</span>
                                    <span class="n">klass</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">class_key</span><span class="p">)</span>
                                    <span class="k">if</span> <span class="n">klass</span><span class="p">:</span>
                                        <span class="k">if</span> <span class="s2">&quot;name&quot;</span> <span class="ow">in</span> <span class="n">list_item</span><span class="p">:</span>
                                            <span class="n">instance_key</span> <span class="o">=</span> <span class="n">class_key</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">list_item</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                                            <span class="n">inst</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">instance_key</span><span class="p">)</span>
                                            <span class="k">if</span> <span class="n">inst</span><span class="p">:</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">set_outline_data_from_instance</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">update_outline_from_instances</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">list_item</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">list_item</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">update_outline_from_instances</span><span class="p">(</span><span class="n">list_item</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_component_implicit_plugins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_dict</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_dict</span><span class="p">:</span>
            <span class="n">sub_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">sub_dict</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">sub_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;widgets&quot;</span><span class="p">,</span> <span class="s2">&quot;themes&quot;</span><span class="p">,</span> <span class="s2">&quot;pages&quot;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">list_item</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">list_item</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                                <span class="k">if</span> <span class="s2">&quot;kind&quot;</span> <span class="ow">in</span> <span class="n">list_item</span><span class="p">:</span>
                                    <span class="n">class_key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">list_item</span><span class="p">[</span><span class="s2">&quot;kind&quot;</span><span class="p">]</span>
                                    <span class="n">klass</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">class_key</span><span class="p">)</span>
                                    <span class="k">if</span> <span class="n">klass</span><span class="p">:</span>
                                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">klass</span><span class="o">.</span><span class="n">__plugins__</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">klass</span><span class="o">.</span><span class="n">__plugins__</span><span class="p">)</span>
                                                
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">get_component_implicit_plugins</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">list_item</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">list_item</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">get_component_implicit_plugins</span><span class="p">(</span><span class="n">list_item</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_outline_data_from_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inst</span><span class="p">:</span> <span class="s1">&#39;ComponentBase&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">inst</span><span class="o">.</span><span class="n">__component_type__</span> <span class="o">==</span> <span class="s1">&#39;widget&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_widget_outline_data</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inst</span><span class="o">.</span><span class="n">__component_type__</span> <span class="o">==</span> <span class="s1">&#39;page&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_page_outline_data</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inst</span><span class="o">.</span><span class="n">__component_type__</span> <span class="o">==</span> <span class="s1">&#39;theme&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_theme_outline_data</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_theme_outline_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inst</span><span class="p">:</span> <span class="s1">&#39;ThemeBase&#39;</span><span class="p">):</span>
        <span class="n">theme_index</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">themes</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">inst</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">themes</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="n">theme_index</span> <span class="o">=</span> <span class="n">t</span>
            <span class="k">if</span> <span class="n">theme_index</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="n">theme_outline</span> <span class="o">=</span> <span class="n">inst</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">theme_index</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">themes</span><span class="p">[</span><span class="n">theme_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">theme_outline</span>    

    <span class="k">def</span> <span class="nf">set_page_outline_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inst</span><span class="p">:</span> <span class="s1">&#39;PageTemplateBase&#39;</span><span class="p">):</span>
        <span class="n">page_index</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">pages</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">inst</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="n">page_index</span> <span class="o">=</span> <span class="n">p</span>
            <span class="k">if</span> <span class="n">page_index</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="n">page_outline</span> <span class="o">=</span> <span class="n">inst</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">page_index</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="n">page_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">page_outline</span>


    <span class="k">def</span> <span class="nf">set_widget_outline_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inst</span><span class="p">:</span> <span class="s1">&#39;WidgetBase&#39;</span><span class="p">):</span>
        <span class="n">widget_index</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">page_index</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">pages</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">widgets</span><span class="p">)):</span>
                <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="n">w</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">widget</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">inst</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                    <span class="n">page_index</span> <span class="o">=</span> <span class="n">p</span>
                    <span class="n">widget_index</span> <span class="o">=</span> <span class="n">w</span>
                <span class="k">if</span> <span class="n">page_index</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">page_index</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="n">w_outline</span> <span class="o">=</span> <span class="n">inst</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">page_index</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">widget_index</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="n">page_index</span><span class="p">]</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="n">widget_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">w_outline</span>  

    <span class="k">def</span> <span class="nf">update_outline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">make_base</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">base</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="n">attrib</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;reveal&quot;</span><span class="p">})</span>
        <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="n">attrib</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;slides&quot;</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">base</span>

    <span class="k">def</span> <span class="nf">package_as_standalone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pres</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
        <span class="n">body</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">BODY</span><span class="p">()</span>
        <span class="n">body</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pres</span><span class="p">)</span>
        <span class="n">body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">strip_unauthorized_scripts</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">scripts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugin_mgr</span><span class="o">.</span><span class="n">get_scripts</span><span class="p">():</span>
            <span class="n">lxml_scripts</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">fragments_fromstring</span><span class="p">(</span><span class="n">scripts</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">lxml_scripts</span><span class="p">:</span>
                <span class="n">body</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">head</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">HEAD</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugin_mgr</span><span class="o">.</span><span class="n">get_styles</span><span class="p">():</span>
            <span class="n">lxml_links</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">fragments_fromstring</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">lxml_links</span><span class="p">:</span>
                <span class="n">head</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">head</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">strip_unauthorized_scripts</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
        <span class="n">html</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span>
            <span class="n">head</span><span class="p">,</span>
            <span class="n">body</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">lxml</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">pretty_print</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="c1"># def render_plugin(self, plugin):</span>
    <span class="c1">#     plugin_type = plugin[&#39;type&#39;]</span>
    <span class="c1">#     plugin_config = plugin[&#39;config&#39;]</span>
    <span class="c1">#     plugin_class = self.plugin_loader.load(plugin_type)</span>
    <span class="c1">#     script_string = plugin_class().to_string(plugin_config)</span>
    <span class="c1">#     return lxml.html.fragment_fromstring(script_string)</span>

    <span class="k">def</span> <span class="nf">strip_unauthorized_scripts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">body</span><span class="p">):</span>
        <span class="n">allowed_scripts</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">plugins</span><span class="o">.</span><span class="n">external</span><span class="o">.</span><span class="n">ALLOWED_SCRIPTS</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="n">script_elements</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//script&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">script_elements</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">link</span> <span class="o">=</span> <span class="n">ele</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">ele</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">ele</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">link</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_scripts</span><span class="p">:</span>
                <span class="n">ele</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">ele</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">body</span>

    <span class="k">def</span> <span class="nf">update_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">info</span>
        <span class="n">info</span><span class="o">.</span><span class="n">date_modified</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns a t</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reveal_base</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base</span>
        <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">pages</span><span class="p">:</span>
            <span class="n">slides_container</span> <span class="o">=</span> <span class="n">reveal_base</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">slide</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">slides_container</span><span class="p">,</span> <span class="s2">&quot;section&quot;</span><span class="p">)</span>
            <span class="n">page_html</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">render_page</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
            <span class="n">slide_fragment</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">fragment_fromstring</span><span class="p">(</span><span class="n">page_html</span><span class="p">)</span>
            <span class="n">slide</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">slide_fragment</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">reveal_base</span>

    <span class="k">def</span> <span class="nf">render_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="s1">&#39;Page&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">class_key</span> <span class="o">=</span> <span class="s2">&quot;page.&quot;</span> <span class="o">+</span> <span class="n">page</span><span class="o">.</span><span class="n">kind</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">class_key</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">page</span><span class="o">.</span><span class="n">name</span>
        <span class="k">if</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
            <span class="n">page_instance</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">klass</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">class_key</span><span class="p">)</span>
            <span class="n">deserialize_method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">klass</span><span class="p">,</span> <span class="s2">&quot;deserialize&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">deserialize_method</span><span class="p">):</span>
                <span class="n">page_instance</span> <span class="o">=</span> <span class="n">deserialize_method</span><span class="p">(</span><span class="n">page</span><span class="p">,</span> <span class="n">client_info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client_info</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;Page component instance or class (kind) &quot;{0}&quot; unavailable in component registry&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">MissingConfigException</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">page_instance</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">present</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">files_path</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8082</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Building story rendering at http://{0}:{1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">files_path</span><span class="p">:</span>
            <span class="n">files_path</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Buidling standalone package for local rendering.&quot;</span><span class="p">)</span>
        <span class="n">html</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">package_as_standalone</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">to_title_case</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">id</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="nb">id</span> <span class="o">=</span> <span class="s1">&#39;blank&#39;</span>
        <span class="n">server</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">LocalServer</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="n">root_path</span><span class="o">=</span><span class="n">files_path</span><span class="p">)</span>
        <span class="n">pkg_templates_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)),</span> <span class="s2">&quot;lib&quot;</span><span class="p">,</span> <span class="s2">&quot;templates&quot;</span><span class="p">)</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pkg_templates_dir</span><span class="p">,</span> <span class="s2">&quot;favicon.ico&quot;</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">files_path</span><span class="p">,</span> <span class="s2">&quot;presalytics&quot;</span><span class="p">,</span> <span class="s2">&quot;static&quot;</span><span class="p">))</span>
        <span class="n">html_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">files_path</span><span class="p">,</span> <span class="s2">&quot;presalytics&quot;</span><span class="p">,</span> <span class="s2">&quot;templates&quot;</span><span class="p">,</span> <span class="nb">id</span> <span class="o">+</span> <span class="s1">&#39;.html&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">html_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
            <span class="nb">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
        <span class="n">address</span> <span class="o">=</span> <span class="s2">&quot;http://{}:{}/story/{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Opening browser tab...&quot;</span><span class="p">)</span>
        <span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">Browser</span><span class="p">(</span><span class="n">address</span><span class="p">)</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="n">server</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#presalytics.Revealer">Revealer</a></li>
          <li><a href="#presalytics.Renderer">Renderer</a></li>
          <li>presalytics.story.components.ComponentBase</li>
          <li>abc.ABC</li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.Revealer.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, story_outline, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Revealer.__init__', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Revealer.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">story_outline</span><span class="p">:</span> <span class="s1">&#39;StoryOutline&#39;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Revealer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span> <span class="o">=</span> <span class="n">story_outline</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Initializing story render for {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">story_outline</span><span class="o">.</span><span class="n">title</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">base</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_base</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading plugins&quot;</span><span class="p">)</span>
    <span class="n">reveal_plugin_config</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;kind&#39;</span><span class="p">:</span> <span class="s1">&#39;script&#39;</span><span class="p">,</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;reveal&#39;</span><span class="p">,</span>
        <span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="p">{}</span>
    <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_outline_from_instances</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span> <span class="o">=</span> <span class="p">[</span><span class="n">reveal_plugin_config</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">get_component_implicit_plugins</span><span class="p">()</span>
    <span class="n">outline_plugins</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">plugins</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">PluginManager</span><span class="o">.</span><span class="n">get_plugins_from_nested_dict</span><span class="p">(</span><span class="n">story_outline</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">outline_plugins</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">plugin_mgr</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">plugins</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">PluginManager</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plugins</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Revealer initilized.&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Revealer.get_client">
    <p>def <span class="ident">get_client</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Revealer.get_client', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Revealer.get_client" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">client_info</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Revealer.get_component_implicit_plugins">
    <p>def <span class="ident">get_component_implicit_plugins</span>(</p><p>self, sub_dict=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Revealer.get_component_implicit_plugins', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Revealer.get_component_implicit_plugins" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_component_implicit_plugins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_dict</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_dict</span><span class="p">:</span>
        <span class="n">sub_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">sub_dict</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">sub_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;widgets&quot;</span><span class="p">,</span> <span class="s2">&quot;themes&quot;</span><span class="p">,</span> <span class="s2">&quot;pages&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">list_item</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">list_item</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                            <span class="k">if</span> <span class="s2">&quot;kind&quot;</span> <span class="ow">in</span> <span class="n">list_item</span><span class="p">:</span>
                                <span class="n">class_key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">list_item</span><span class="p">[</span><span class="s2">&quot;kind&quot;</span><span class="p">]</span>
                                <span class="n">klass</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">class_key</span><span class="p">)</span>
                                <span class="k">if</span> <span class="n">klass</span><span class="p">:</span>
                                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">klass</span><span class="o">.</span><span class="n">__plugins__</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">klass</span><span class="o">.</span><span class="n">__plugins__</span><span class="p">)</span>
                                            
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">get_component_implicit_plugins</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">list_item</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">list_item</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">get_component_implicit_plugins</span><span class="p">(</span><span class="n">list_item</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Revealer.make_base">
    <p>def <span class="ident">make_base</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Revealer.make_base', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Revealer.make_base" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">make_base</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">base</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="n">attrib</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;reveal&quot;</span><span class="p">})</span>
    <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="n">attrib</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;slides&quot;</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">base</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Revealer.package_as_standalone">
    <p>def <span class="ident">package_as_standalone</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Revealer.package_as_standalone', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Revealer.package_as_standalone" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">package_as_standalone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">pres</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
    <span class="n">body</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">BODY</span><span class="p">()</span>
    <span class="n">body</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pres</span><span class="p">)</span>
    <span class="n">body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">strip_unauthorized_scripts</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">scripts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugin_mgr</span><span class="o">.</span><span class="n">get_scripts</span><span class="p">():</span>
        <span class="n">lxml_scripts</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">fragments_fromstring</span><span class="p">(</span><span class="n">scripts</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">lxml_scripts</span><span class="p">:</span>
            <span class="n">body</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="n">head</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">HEAD</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugin_mgr</span><span class="o">.</span><span class="n">get_styles</span><span class="p">():</span>
        <span class="n">lxml_links</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">fragments_fromstring</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">lxml_links</span><span class="p">:</span>
            <span class="n">head</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="n">head</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">strip_unauthorized_scripts</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span>
        <span class="n">head</span><span class="p">,</span>
        <span class="n">body</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">lxml</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">pretty_print</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Revealer.present">
    <p>def <span class="ident">present</span>(</p><p>self, files_path=None, debug=True, port=8082, host=&#39;127.0.0.1&#39;)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Revealer.present', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Revealer.present" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">present</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">files_path</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8082</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">):</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Building story rendering at http://{0}:{1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">files_path</span><span class="p">:</span>
        <span class="n">files_path</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Buidling standalone package for local rendering.&quot;</span><span class="p">)</span>
    <span class="n">html</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">package_as_standalone</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">to_title_case</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">id</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="s1">&#39;blank&#39;</span>
    <span class="n">server</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">LocalServer</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="n">root_path</span><span class="o">=</span><span class="n">files_path</span><span class="p">)</span>
    <span class="n">pkg_templates_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)),</span> <span class="s2">&quot;lib&quot;</span><span class="p">,</span> <span class="s2">&quot;templates&quot;</span><span class="p">)</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pkg_templates_dir</span><span class="p">,</span> <span class="s2">&quot;favicon.ico&quot;</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">files_path</span><span class="p">,</span> <span class="s2">&quot;presalytics&quot;</span><span class="p">,</span> <span class="s2">&quot;static&quot;</span><span class="p">))</span>
    <span class="n">html_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">files_path</span><span class="p">,</span> <span class="s2">&quot;presalytics&quot;</span><span class="p">,</span> <span class="s2">&quot;templates&quot;</span><span class="p">,</span> <span class="nb">id</span> <span class="o">+</span> <span class="s1">&#39;.html&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">html_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
        <span class="nb">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
    <span class="n">address</span> <span class="o">=</span> <span class="s2">&quot;http://{}:{}/story/{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Opening browser tab...&quot;</span><span class="p">)</span>
    <span class="n">presalytics</span><span class="o">.</span><span class="n">story</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">Browser</span><span class="p">(</span><span class="n">address</span><span class="p">)</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">server</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Revealer.render">
    <p>def <span class="ident">render</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>This method returns a t</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Revealer.render', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Revealer.render" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This method returns a t</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reveal_base</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base</span>
    <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">pages</span><span class="p">:</span>
        <span class="n">slides_container</span> <span class="o">=</span> <span class="n">reveal_base</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">slide</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">slides_container</span><span class="p">,</span> <span class="s2">&quot;section&quot;</span><span class="p">)</span>
        <span class="n">page_html</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">render_page</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
        <span class="n">slide_fragment</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">fragment_fromstring</span><span class="p">(</span><span class="n">page_html</span><span class="p">)</span>
        <span class="n">slide</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">slide_fragment</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">reveal_base</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Revealer.render_page">
    <p>def <span class="ident">render_page</span>(</p><p>self, page)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Revealer.render_page', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Revealer.render_page" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">render_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="s1">&#39;Page&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">class_key</span> <span class="o">=</span> <span class="s2">&quot;page.&quot;</span> <span class="o">+</span> <span class="n">page</span><span class="o">.</span><span class="n">kind</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">class_key</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">page</span><span class="o">.</span><span class="n">name</span>
    <span class="k">if</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="n">page_instance</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">klass</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">class_key</span><span class="p">)</span>
        <span class="n">deserialize_method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">klass</span><span class="p">,</span> <span class="s2">&quot;deserialize&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">deserialize_method</span><span class="p">):</span>
            <span class="n">page_instance</span> <span class="o">=</span> <span class="n">deserialize_method</span><span class="p">(</span><span class="n">page</span><span class="p">,</span> <span class="n">client_info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client_info</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;Page component instance or class (kind) &quot;{0}&quot; unavailable in component registry&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">MissingConfigException</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">page_instance</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Revealer.serialize">
    <p>def <span class="ident">serialize</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Revealer.serialize', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Revealer.serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;StoryOutline&#39;</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_outline_from_instances</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Revealer.set_outline_data_from_instance">
    <p>def <span class="ident">set_outline_data_from_instance</span>(</p><p>self, inst)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Revealer.set_outline_data_from_instance', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Revealer.set_outline_data_from_instance" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_outline_data_from_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inst</span><span class="p">:</span> <span class="s1">&#39;ComponentBase&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">inst</span><span class="o">.</span><span class="n">__component_type__</span> <span class="o">==</span> <span class="s1">&#39;widget&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_widget_outline_data</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">inst</span><span class="o">.</span><span class="n">__component_type__</span> <span class="o">==</span> <span class="s1">&#39;page&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_page_outline_data</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">inst</span><span class="o">.</span><span class="n">__component_type__</span> <span class="o">==</span> <span class="s1">&#39;theme&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_theme_outline_data</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Revealer.set_page_outline_data">
    <p>def <span class="ident">set_page_outline_data</span>(</p><p>self, inst)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Revealer.set_page_outline_data', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Revealer.set_page_outline_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_page_outline_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inst</span><span class="p">:</span> <span class="s1">&#39;PageTemplateBase&#39;</span><span class="p">):</span>
    <span class="n">page_index</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">pages</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">inst</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
            <span class="n">page_index</span> <span class="o">=</span> <span class="n">p</span>
        <span class="k">if</span> <span class="n">page_index</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="n">page_outline</span> <span class="o">=</span> <span class="n">inst</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">page_index</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="n">page_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">page_outline</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Revealer.set_theme_outline_data">
    <p>def <span class="ident">set_theme_outline_data</span>(</p><p>self, inst)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Revealer.set_theme_outline_data', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Revealer.set_theme_outline_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_theme_outline_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inst</span><span class="p">:</span> <span class="s1">&#39;ThemeBase&#39;</span><span class="p">):</span>
    <span class="n">theme_index</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">themes</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">inst</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">themes</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
            <span class="n">theme_index</span> <span class="o">=</span> <span class="n">t</span>
        <span class="k">if</span> <span class="n">theme_index</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="n">theme_outline</span> <span class="o">=</span> <span class="n">inst</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">theme_index</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">themes</span><span class="p">[</span><span class="n">theme_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">theme_outline</span>    
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Revealer.set_widget_outline_data">
    <p>def <span class="ident">set_widget_outline_data</span>(</p><p>self, inst)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Revealer.set_widget_outline_data', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Revealer.set_widget_outline_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_widget_outline_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inst</span><span class="p">:</span> <span class="s1">&#39;WidgetBase&#39;</span><span class="p">):</span>
    <span class="n">widget_index</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">page_index</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">pages</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">widgets</span><span class="p">)):</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="n">w</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">widget</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">inst</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="n">page_index</span> <span class="o">=</span> <span class="n">p</span>
                <span class="n">widget_index</span> <span class="o">=</span> <span class="n">w</span>
            <span class="k">if</span> <span class="n">page_index</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">page_index</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="n">w_outline</span> <span class="o">=</span> <span class="n">inst</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">page_index</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">widget_index</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="n">page_index</span><span class="p">]</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="n">widget_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">w_outline</span>  
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Revealer.strip_unauthorized_scripts">
    <p>def <span class="ident">strip_unauthorized_scripts</span>(</p><p>self, body)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Revealer.strip_unauthorized_scripts', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Revealer.strip_unauthorized_scripts" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">strip_unauthorized_scripts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">body</span><span class="p">):</span>
    <span class="n">allowed_scripts</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">plugins</span><span class="o">.</span><span class="n">external</span><span class="o">.</span><span class="n">ALLOWED_SCRIPTS</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="n">script_elements</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//script&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">script_elements</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">link</span> <span class="o">=</span> <span class="n">ele</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">ele</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">ele</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">link</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_scripts</span><span class="p">:</span>
            <span class="n">ele</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">ele</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">body</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Revealer.update_info">
    <p>def <span class="ident">update_info</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Revealer.update_info', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Revealer.update_info" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">update_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">info</span>
    <span class="n">info</span><span class="o">.</span><span class="n">date_modified</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Revealer.update_outline">
    <p>def <span class="ident">update_outline</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Revealer.update_outline', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Revealer.update_outline" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">update_outline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.Revealer.update_outline_from_instances">
    <p>def <span class="ident">update_outline_from_instances</span>(</p><p>self, sub_dict=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Revealer.update_outline_from_instances', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Revealer.update_outline_from_instances" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">update_outline_from_instances</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_dict</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_dict</span><span class="p">:</span>
        <span class="n">sub_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">story_outline</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">sub_dict</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">sub_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;widgets&quot;</span><span class="p">,</span> <span class="s2">&quot;themes&quot;</span><span class="p">,</span> <span class="s2">&quot;pages&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">list_item</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">list_item</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                            <span class="k">if</span> <span class="s2">&quot;kind&quot;</span> <span class="ow">in</span> <span class="n">list_item</span><span class="p">:</span>
                                <span class="n">class_key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">list_item</span><span class="p">[</span><span class="s2">&quot;kind&quot;</span><span class="p">]</span>
                                <span class="n">klass</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">class_key</span><span class="p">)</span>
                                <span class="k">if</span> <span class="n">klass</span><span class="p">:</span>
                                    <span class="k">if</span> <span class="s2">&quot;name&quot;</span> <span class="ow">in</span> <span class="n">list_item</span><span class="p">:</span>
                                        <span class="n">instance_key</span> <span class="o">=</span> <span class="n">class_key</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">list_item</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                                        <span class="n">inst</span> <span class="o">=</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">COMPONENTS</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">instance_key</span><span class="p">)</span>
                                        <span class="k">if</span> <span class="n">inst</span><span class="p">:</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">set_outline_data_from_instance</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">update_outline_from_instances</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">list_item</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">list_item</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">update_outline_from_instances</span><span class="p">(</span><span class="n">list_item</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="presalytics.Revealer.base" class="name">var <span class="ident">base</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.Revealer.plugin_mgr" class="name">var <span class="ident">plugin_mgr</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.Revealer.plugins" class="name">var <span class="ident">plugins</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.Revealer.story_outline" class="name">var <span class="ident">story_outline</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.Revealer.deserialize">
    <p>def <span class="ident">deserialize</span>(</p><p>cls, component, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.Revealer.deserialize', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.Revealer.deserialize" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="s1">&#39;StoryOutline&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="presalytics.StoryOutline" class="name">class <span class="ident">StoryOutline</span></p>
      
  
    <div class="desc"><p>Helper class that provides a standard way to create an ABC using
inheritance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.StoryOutline', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.StoryOutline" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">StoryOutline</span><span class="p">(</span><span class="n">OutlineBase</span><span class="p">):</span>
    <span class="n">presalytics_story</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">info</span><span class="p">:</span> <span class="n">Info</span>
    <span class="n">pages</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Page</span><span class="p">]</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">themes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Theme</span><span class="p">]</span>

    <span class="n">__required__</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;presalytics_story&#39;</span><span class="p">,</span>
        <span class="s1">&#39;info&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pages&#39;</span><span class="p">,</span>
        <span class="s1">&#39;title&#39;</span>
    <span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">presalytics_story</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">pages</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">themes</span><span class="p">,</span> <span class="n">plugins</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">StoryOutline</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">presalytics_story</span> <span class="o">=</span> <span class="n">presalytics_story</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">Info</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pages</span> <span class="o">=</span> <span class="p">[</span><span class="n">Page</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pages</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">description</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">themes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">themes</span> <span class="o">=</span> <span class="p">[</span><span class="n">Theme</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">themes</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">themes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">plugins</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span> <span class="o">=</span> <span class="p">[</span><span class="n">Plugin</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">plugins</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#presalytics.StoryOutline">StoryOutline</a></li>
          <li>presalytics.story.outline.OutlineBase</li>
          <li>abc.ABC</li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.StoryOutline.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, presalytics_story, info, pages, description, title, themes, plugins=None, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.StoryOutline.__init__', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.StoryOutline.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">presalytics_story</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">pages</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">themes</span><span class="p">,</span> <span class="n">plugins</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">StoryOutline</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">presalytics_story</span> <span class="o">=</span> <span class="n">presalytics_story</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">Info</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pages</span> <span class="o">=</span> <span class="p">[</span><span class="n">Page</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pages</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">description</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">themes</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">themes</span> <span class="o">=</span> <span class="p">[</span><span class="n">Theme</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">themes</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">themes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">plugins</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span> <span class="o">=</span> <span class="p">[</span><span class="n">Plugin</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">plugins</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.StoryOutline.dump">
    <p>def <span class="ident">dump</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.StoryOutline.dump', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.StoryOutline.dump" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">OutlineEncoder</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.StoryOutline.export_yaml">
    <p>def <span class="ident">export_yaml</span>(</p><p>self, filename)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.StoryOutline.export_yaml', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.StoryOutline.export_yaml" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">export_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
        <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="nb">file</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.StoryOutline.to_dict">
    <p>def <span class="ident">to_dict</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.StoryOutline.to_dict', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.StoryOutline.to_dict" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__required__</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">items</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>
        <span class="n">ret_key</span> <span class="o">=</span> <span class="s2">&quot;{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">to_camel_case</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
        <span class="n">ret_val</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">OutlineEncoder</span><span class="p">),</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="p">[</span><span class="n">ret_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ret_val</span>
    <span class="k">return</span> <span class="n">ret</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.StoryOutline.validate">
    <p>def <span class="ident">validate</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.StoryOutline.validate', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.StoryOutline.validate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__required__</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
            <span class="n">err_message</span> <span class="o">=</span> <span class="s1">&#39;Could not load {0} object, source data missing &quot;{1}&quot; key&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="n">err_message</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="presalytics.StoryOutline.info" class="name">var <span class="ident">info</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.StoryOutline.pages" class="name">var <span class="ident">pages</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.StoryOutline.presalytics_story" class="name">var <span class="ident">presalytics_story</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.StoryOutline.deserialize">
    <p>def <span class="ident">deserialize</span>(</p><p>cls, json_obj)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.StoryOutline.deserialize', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.StoryOutline.deserialize" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">json_obj</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">json_obj</span><span class="p">)</span> <span class="o">==</span> <span class="bp">cls</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">json_obj</span>
    <span class="n">updated_obj</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">json_obj</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">new_key</span> <span class="o">=</span> <span class="n">to_snake_case</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">updated_obj</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">new_key</span><span class="p">:</span> <span class="n">val</span><span class="p">})</span>
    <span class="k">for</span> <span class="n">req</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getargspec</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">req</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">updated_obj</span> <span class="ow">and</span> <span class="n">req</span> <span class="o">!=</span> <span class="s1">&#39;self&#39;</span><span class="p">:</span>
            <span class="n">updated_obj</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">req</span><span class="p">:</span> <span class="bp">None</span><span class="p">})</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">updated_obj</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.StoryOutline.import_yaml">
    <p>def <span class="ident">import_yaml</span>(</p><p>cls, yaml_file)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.StoryOutline.import_yaml', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.StoryOutline.import_yaml" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">import_yaml</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">yaml_file</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">yaml_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.StoryOutline.load">
    <p>def <span class="ident">load</span>(</p><p>cls, json_str)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.StoryOutline.load', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.StoryOutline.load" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">json_str</span><span class="p">):</span>
    <span class="n">json_obj</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">json_obj</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="presalytics.ThemeBase" class="name">class <span class="ident">ThemeBase</span></p>
      
  
    <div class="desc"><p>Themes are containers for plugins should be rendered once
across the entire document.  The init method should configure
parameters with get passed to plugins via serialization and 
deserialization.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.ThemeBase', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.ThemeBase" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ThemeBase</span><span class="p">(</span><span class="n">ComponentBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Themes are containers for plugins should be rendered once</span>
<span class="sd">    across the entire document.  The init method should configure</span>
<span class="sd">    parameters with get passed to plugins via serialization and </span>
<span class="sd">    deserialization.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plugins</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="s1">&#39;Plugin&#39;</span><span class="p">]]</span>

    <span class="n">__component_type__</span> <span class="o">=</span> <span class="s1">&#39;theme&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">pass</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#presalytics.ThemeBase">ThemeBase</a></li>
          <li>presalytics.story.components.ComponentBase</li>
          <li>abc.ABC</li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.ThemeBase.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.ThemeBase.__init__', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.ThemeBase.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.ThemeBase.get_client">
    <p>def <span class="ident">get_client</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.ThemeBase.get_client', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.ThemeBase.get_client" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">client_info</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.ThemeBase.render">
    <p>def <span class="ident">render</span>(</p><p>self, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.ThemeBase.render', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.ThemeBase.render" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.ThemeBase.serialize">
    <p>def <span class="ident">serialize</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.ThemeBase.serialize', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.ThemeBase.serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@abc.abstractmethod</span>
<span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.ThemeBase.deserialize">
    <p>def <span class="ident">deserialize</span>(</p><p>cls, component, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.ThemeBase.deserialize', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.ThemeBase.deserialize" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Type</span><span class="p">[</span><span class="s1">&#39;OutlineBase&#39;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="presalytics.WidgetBase" class="name">class <span class="ident">WidgetBase</span></p>
      
  
    <div class="desc"><p>Inherit from this base class to create widget components that can be rendered to html via the
presalytics.story.revealer.Revealer class.  This component also need to build a method
that allows the widget to be serialzed into a presalytics.story.outline.Widget object.</p>
<h2>Parameters:</h2>
<p>widget: Widget
    A presalytics.story.outline.Widget object use for initialized the component class.</p>
<h2>Attributes:</h2>
<p>outline_widget: Widget
    A presalytics.story.outline.Widget object</p>
<p>css: List[str]
    A list of keys in dot notation that point to links in the ALLOWED_STYLES dictionary
    in the presalytics.lib.templates.base module.</p>
<p>js: List[str]
    A list of keys in dot notation that point to links in the ALLOWED_SCRIPTS dictionary
    in the presalytics.lib.templates.base module.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.WidgetBase', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.WidgetBase" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">WidgetBase</span><span class="p">(</span><span class="n">ComponentBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Inherit from this base class to create widget components that can be rendered to html via the</span>
<span class="sd">    presalytics.story.revealer.Revealer class.  This component also need to build a method</span>
<span class="sd">    that allows the widget to be serialzed into a presalytics.story.outline.Widget object.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ----------</span>
<span class="sd">    widget: Widget</span>
<span class="sd">        A presalytics.story.outline.Widget object use for initialized the component class.</span>

<span class="sd">    Attributes:</span>
<span class="sd">    ----------</span>
<span class="sd">    outline_widget: Widget</span>
<span class="sd">        A presalytics.story.outline.Widget object</span>

<span class="sd">    css: List[str]</span>
<span class="sd">        A list of keys in dot notation that point to links in the ALLOWED_STYLES dictionary</span>
<span class="sd">        in the presalytics.lib.templates.base module.</span>

<span class="sd">    js: List[str]</span>
<span class="sd">        A list of keys in dot notation that point to links in the ALLOWED_SCRIPTS dictionary</span>
<span class="sd">        in the presalytics.lib.templates.base module.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">outline_widget</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="s1">&#39;Widget&#39;</span><span class="p">]</span>

    <span class="n">__component_type__</span> <span class="o">=</span> <span class="s1">&#39;widget&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Note: When inheriting from this base class, call &quot;super().__init__(self, *args, **kwargs)&quot; before add your</span>
<span class="sd">        own custom initialization.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">WidgetBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outline_widget</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">to_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns valid html that renders the widget in a broswer.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        ----------</span>
<span class="sd">        data: Dict</span>
<span class="sd">            The data parameter is a dictionary should contain the minimum amount of that is required to</span>
<span class="sd">            successfully render the object.  As the widget is update, data control how the disply of</span>
<span class="sd">            information changes.</span>
<span class="sd">        **kwargs:</span>
<span class="sd">            Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.</span>
<span class="sd">            these keyword arguments should be geinvariant through successive updates to the chart.  For example,</span>
<span class="sd">            keycloak argument should control the styling of the widget, which should not change as the data in</span>
<span class="sd">            the object (e.g., a chart) is updated.  Keyword arguments are loaded via additional_properties</span>
<span class="sd">            parameter in in the presalytics.story.outline.Widget object.</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        A string of containing an html fragment that will be loaded into a template in successive operations</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Widget&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates presalytics.story.outline.Widget object from instance data. This widget should</span>
<span class="sd">        have the correct name, data and additional_properties so the same widget can be reconstituted</span>
<span class="sd">        via the to_html method, given the same set of data.</span>

<span class="sd">        Typically, this method will call an update method that run a local script with updates this</span>
<span class="sd">        Widget&#39;s data Dictionary prior being loading into the Widget outline object for serialization.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        ----------</span>
<span class="sd">        **kwargs:</span>
<span class="sd">            Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.</span>
<span class="sd">            these keyword arguments should be be invariant through successive updates to the chart. Overrides</span>
<span class="sd">            for this widgets default additional_properties shoudl be loaded via these keyword argments.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">widget</span><span class="p">:</span> <span class="s1">&#39;Widget&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;WidgetBase&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates an instance of the widget from the data object in the presalytics.story.outline.Widget</span>
<span class="sd">        object. This method exists to ensure widgets can be portable across environments.  To clarify,</span>
<span class="sd">        widgets built on the client-side via the __init__ method can be reconstructed server-side via</span>
<span class="sd">        the deserialize method.  This allows decoupling of the widget generation/updating of data and</span>
<span class="sd">        the rendering of the widget in a UI.  Renderers (e.g., presalytics.story.revealer.Revealer object)</span>
<span class="sd">        need not know about how the data get updated, but can update the graphic with data generated by</span>
<span class="sd">        the widget when the serialize method is called.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        ----------</span>

<span class="sd">        widget: Widget</span>
<span class="sd">            A prealytics.story.outline.Widget object</span>

<span class="sd">        Returns:</span>
<span class="sd">        ----------</span>

<span class="sd">        An instance the widget class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#presalytics.WidgetBase">WidgetBase</a></li>
          <li>presalytics.story.components.ComponentBase</li>
          <li>abc.ABC</li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.WidgetBase.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, name, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Note: When inheriting from this base class, call "super().<strong>init</strong>(self, <em>args, </em>*kwargs)" before add your
own custom initialization.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.WidgetBase.__init__', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.WidgetBase.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Note: When inheriting from this base class, call &quot;super().__init__(self, *args, **kwargs)&quot; before add your</span>
<span class="sd">    own custom initialization.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">WidgetBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">outline_widget</span> <span class="o">=</span> <span class="bp">None</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.WidgetBase.get_client">
    <p>def <span class="ident">get_client</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.WidgetBase.get_client', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.WidgetBase.get_client" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">presalytics</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">client_info</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.WidgetBase.render">
    <p>def <span class="ident">render</span>(</p><p>self, component, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.WidgetBase.render', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.WidgetBase.render" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.WidgetBase.serialize">
    <p>def <span class="ident">serialize</span>(</p><p>self, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates presalytics.story.outline.Widget object from instance data. This widget should
have the correct name, data and additional_properties so the same widget can be reconstituted
via the to_html method, given the same set of data.</p>
<p>Typically, this method will call an update method that run a local script with updates this
Widget's data Dictionary prior being loading into the Widget outline object for serialization.</p>
<h2>Parameters:</h2>
<p>**kwargs:
    Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.
    these keyword arguments should be be invariant through successive updates to the chart. Overrides
    for this widgets default additional_properties shoudl be loaded via these keyword argments.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.WidgetBase.serialize', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.WidgetBase.serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@abc.abstractmethod</span>
<span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Widget&#39;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates presalytics.story.outline.Widget object from instance data. This widget should</span>
<span class="sd">    have the correct name, data and additional_properties so the same widget can be reconstituted</span>
<span class="sd">    via the to_html method, given the same set of data.</span>
<span class="sd">    Typically, this method will call an update method that run a local script with updates this</span>
<span class="sd">    Widget&#39;s data Dictionary prior being loading into the Widget outline object for serialization.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    ----------</span>
<span class="sd">    **kwargs:</span>
<span class="sd">        Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.</span>
<span class="sd">        these keyword arguments should be be invariant through successive updates to the chart. Overrides</span>
<span class="sd">        for this widgets default additional_properties shoudl be loaded via these keyword argments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.WidgetBase.to_html">
    <p>def <span class="ident">to_html</span>(</p><p>self, data=None, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns valid html that renders the widget in a broswer.</p>
<h2>Parameters:</h2>
<p>data: Dict
    The data parameter is a dictionary should contain the minimum amount of that is required to
    successfully render the object.  As the widget is update, data control how the disply of
    information changes.
**kwargs:
    Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.
    these keyword arguments should be geinvariant through successive updates to the chart.  For example,
    keycloak argument should control the styling of the widget, which should not change as the data in
    the object (e.g., a chart) is updated.  Keyword arguments are loaded via additional_properties
    parameter in in the presalytics.story.outline.Widget object.</p>
<h2>Returns</h2>
<p>A string of containing an html fragment that will be loaded into a template in successive operations</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.WidgetBase.to_html', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.WidgetBase.to_html" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@abc.abstractmethod</span>
<span class="k">def</span> <span class="nf">to_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns valid html that renders the widget in a broswer.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    ----------</span>
<span class="sd">    data: Dict</span>
<span class="sd">        The data parameter is a dictionary should contain the minimum amount of that is required to</span>
<span class="sd">        successfully render the object.  As the widget is update, data control how the disply of</span>
<span class="sd">        information changes.</span>
<span class="sd">    **kwargs:</span>
<span class="sd">        Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.</span>
<span class="sd">        these keyword arguments should be geinvariant through successive updates to the chart.  For example,</span>
<span class="sd">        keycloak argument should control the styling of the widget, which should not change as the data in</span>
<span class="sd">        the object (e.g., a chart) is updated.  Keyword arguments are loaded via additional_properties</span>
<span class="sd">        parameter in in the presalytics.story.outline.Widget object.</span>
<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    A string of containing an html fragment that will be loaded into a template in successive operations</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="presalytics.WidgetBase.name" class="name">var <span class="ident">name</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="presalytics.WidgetBase.outline_widget" class="name">var <span class="ident">outline_widget</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.WidgetBase.deserialize">
    <p>def <span class="ident">deserialize</span>(</p><p>cls, widget, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates an instance of the widget from the data object in the presalytics.story.outline.Widget
object. This method exists to ensure widgets can be portable across environments.  To clarify,
widgets built on the client-side via the <strong>init</strong> method can be reconstructed server-side via
the deserialize method.  This allows decoupling of the widget generation/updating of data and
the rendering of the widget in a UI.  Renderers (e.g., presalytics.story.revealer.Revealer object)
need not know about how the data get updated, but can update the graphic with data generated by
the widget when the serialize method is called.</p>
<h2>Parameters:</h2>
<p>widget: Widget
    A prealytics.story.outline.Widget object</p>
<h2>Returns:</h2>
<p>An instance the widget class</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.WidgetBase.deserialize', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.WidgetBase.deserialize" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">widget</span><span class="p">:</span> <span class="s1">&#39;Widget&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;WidgetBase&#39;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates an instance of the widget from the data object in the presalytics.story.outline.Widget</span>
<span class="sd">    object. This method exists to ensure widgets can be portable across environments.  To clarify,</span>
<span class="sd">    widgets built on the client-side via the __init__ method can be reconstructed server-side via</span>
<span class="sd">    the deserialize method.  This allows decoupling of the widget generation/updating of data and</span>
<span class="sd">    the rendering of the widget in a UI.  Renderers (e.g., presalytics.story.revealer.Revealer object)</span>
<span class="sd">    need not know about how the data get updated, but can update the graphic with data generated by</span>
<span class="sd">    the widget when the serialize method is called.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    ----------</span>
<span class="sd">    widget: Widget</span>
<span class="sd">        A prealytics.story.outline.Widget object</span>
<span class="sd">    Returns:</span>
<span class="sd">    ----------</span>
<span class="sd">    An instance the widget class</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="presalytics.XmlTransformBase" class="name">class <span class="ident">XmlTransformBase</span></p>
      
  
    <div class="desc"><p>Helper class that provides a standard way to create an ABC using
inheritance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.XmlTransformBase', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.XmlTransformBase" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">XmlTransformBase</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function_params</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">function_params</span> <span class="o">=</span> <span class="n">function_params</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">transform_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lxml_element</span><span class="p">:</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lxml_element</span><span class="p">:</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform_function</span><span class="p">(</span><span class="n">lxml_element</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">function_params</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#presalytics.XmlTransformBase">XmlTransformBase</a></li>
          <li>abc.ABC</li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="presalytics.XmlTransformBase.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, function_params, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.XmlTransformBase.__init__', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.XmlTransformBase.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function_params</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">function_params</span> <span class="o">=</span> <span class="n">function_params</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.XmlTransformBase.execute">
    <p>def <span class="ident">execute</span>(</p><p>self, lxml_element)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.XmlTransformBase.execute', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.XmlTransformBase.execute" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lxml_element</span><span class="p">:</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform_function</span><span class="p">(</span><span class="n">lxml_element</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">function_params</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="presalytics.XmlTransformBase.transform_function">
    <p>def <span class="ident">transform_function</span>(</p><p>self, lxml_element, params)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-presalytics.XmlTransformBase.transform_function', this);">Show source &equiv;</a></p>
  <div id="source-presalytics.XmlTransformBase.transform_function" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@abc.abstractmethod</span>
<span class="k">def</span> <span class="nf">transform_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lxml_element</span><span class="p">:</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="presalytics.XmlTransformBase.function_params" class="name">var <span class="ident">function_params</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>