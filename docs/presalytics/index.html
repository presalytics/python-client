<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.7.4" />
<title>presalytics API documentation</title>
<meta name="description" content="Presalytics python client
https://presalytics.io" />
<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css' rel='stylesheet'>
<link href='https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css' rel='stylesheet'>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{font-weight:bold}#index h4 + ul{margin-bottom:.6em}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>presalytics</code></h1>
</header>
<section id="section-intro">
<p>Presalytics python client
<a href="https://presalytics.io">https://presalytics.io</a></p>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/__init__.py#L0-L100" class="git-link">Browse git</a>
</summary>
<pre><code class="python">&#34;&#34;&#34;
Presalytics python client
https://presalytics.io

&#34;&#34;&#34;
import os
import environs
import logging
import presalytics.lib
import presalytics.lib.logger
import presalytics.lib.plugins
import presalytics.lib.plugins.base
import presalytics.lib.config_loader
import presalytics.story
import presalytics.story.components

env = environs.Env()
env.read_env()

# A comma-separated list of paths to search of config.py, plugin classes, and component classes
autodiscover_paths = env.list(&#39;AUTODISCOVER_PATHS&#39;, [])

CONFIG = presalytics.lib.config_loader.load_config(additional_paths=autodiscover_paths)

file_logger = CONFIG.get(&#34;USE_LOGGER&#34;, True)
log_level = CONFIG.get(&#34;LOG_LEVEL&#34;, logging.DEBUG)

presalytics.lib.logger.configure_logger(log_level=log_level, file_logger=file_logger)

registry_kwargs = {
    &#39;show_errors&#39;: False,
    &#39;autodiscover_paths&#39;: autodiscover_paths
}

PLUGINS = presalytics.lib.plugins.base.PluginRegistry(**registry_kwargs)

COMPONENTS = presalytics.story.components.ComponentRegistry(**registry_kwargs)

from presalytics.client.api import Client
from presalytics.lib.plugins.base import PluginBase
from presalytics.lib.plugins.external import ApprovedExternalLinks, ApprovedExternalScripts
from presalytics.lib.plugins.jinja import JinjaPluginMakerMixin
from presalytics.lib.plugins.local import LocalStylesPlugin
from presalytics.lib.plugins.matplotlib import Mpld3Plugin
from presalytics.lib.plugins.ooxml import OoxmlTheme
from presalytics.lib.plugins.reveal import RevealConfigPlugin
from presalytics.lib.plugins.reveal_theme import RevealCustomTheme
from presalytics.lib.templates.base import JinjaTemplateBuilder
from presalytics.lib.widgets.matplotlib import MatplotlibFigure
from presalytics.lib.widgets.ooxml import OoxmlFileWidget, OoxmlEndpointMap
from presalytics.story.outline import StoryOutline
from presalytics.story.revealer import Revealer
from presalytics.story.components import WidgetBase, PageTemplateBase, Renderer, ThemeBase
from presalytics.lib.tools.ooxml_tools import (
    create_theme_from_ooxml_document,
    create_pages_from_ooxml_document,
    create_story_from_ooxml_file,
    create_outline_from_ooxml_document,
    get_mime_type_from_filename
)
from presalytics.lib.tools.story_tools import story_post_file_bytes
from presalytics.lib.widgets.ooxml_editors import (
    OoxmlEditorWidget,
    XmlTransformBase,
    ChangeShapeColor
)

__all__ = [
    &#39;CONFIG&#39;,
    &#39;COMPONENTS&#39;,
    &#39;PLUGINS&#39;,
    &#39;Client&#39;,
    &#39;PluginBase&#39;,
    &#39;ApprovedExternalLinks&#39;,
    &#39;ApprovedExternalScripts&#39;,
    &#39;JinjaPluginMakerMixin&#39;,
    &#39;LocalStylesPlugin&#39;,
    &#39;Mpld3Plugin&#39;,
    &#39;OoxmlTheme&#39;,
    &#39;RevealConfigPlugin&#39;,
    &#39;RevealCustomTheme&#39;,
    &#39;JinjaTemplateBuilder&#39;,
    &#39;MatplotlibFigure&#39;,
    &#39;OoxmlFileWidget&#39;,
    &#39;OoxmlEndpointMap&#39;,
    &#39;StoryOutline&#39;,
    &#39;Revealer&#39;,
    &#39;WidgetBase&#39;,
    &#39;PageTemplateBase&#39;,
    &#39;Renderer&#39;,
    &#39;ThemeBase&#39;,
    &#39;create_theme_from_ooxml_document&#39;,
    &#39;create_pages_from_ooxml_document&#39;,
    &#39;create_story_from_ooxml_file&#39;,
    &#39;create_outline_from_ooxml_document&#39;,
    &#39;get_mime_type_from_filename&#39;,
    &#39;OoxmlEditorWidget&#39;,
    &#39;XmlTransformBase&#39;,
    &#39;ChangeShapeColor&#39;,
    &#39;story_post_file_bytes&#39;
]</code></pre>
</details>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="presalytics.client" href="/python-client/presalytics/client/index.html">presalytics.client</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="presalytics.lib" href="/python-client/presalytics/lib/index.html">presalytics.lib</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="presalytics.story" href="/python-client/presalytics/story/index.html">presalytics.story</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="presalytics.create_outline_from_ooxml_document"><code class="name flex">
<span>def <span class="ident">create_outline_from_ooxml_document</span></span>(<span><a title="presalytics.story" href="/python-client/presalytics/story/index.html">presalytics.story</a>: Story, ooxml_document: Document, title: str = None, description: str = None, themes: Sequence[_ForwardRef('<a title="presalytics.ThemeBase" href="/python-client/presalytics/index.html#presalytics.ThemeBase">ThemeBase</a>')] = None, client_info={})</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/tools/ooxml_tools.py#L42-L85" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def create_outline_from_ooxml_document(story: &#39;Story&#39;,
                                       ooxml_document: &#39;Document&#39;,
                                       title: str = None,
                                       description: str = None,
                                       themes: typing.Sequence[&#39;ThemeBase&#39;] = None,
                                       client_info={}):

    info = presalytics.story.outline.Info(
        revision=0,
        date_created=datetime.datetime.utcnow().isoformat(),
        date_modified=datetime.datetime.utcnow().isoformat(),
        created_by=presalytics.CONFIG.get(&#34;USERNAME&#34;, &#34;&#34;),
        modified_by=presalytics.CONFIG.get(&#34;USERNAME&#34;, &#34;&#34;),
        revision_notes=&#39;Created by via &#34;create_outline_from_ooxml_file&#34; method&#39;
    )

    if description:
        _description = description
    else:
        _description = &#34;&#34;

    pages = create_pages_from_ooxml_document(story, ooxml_document, client_info=client_info)

    if themes:
        _themes = themes
    else:
        ooxml_id = pages[0].widgets[0].data[&#34;document_ooxml_id&#34;]
        _themes = [create_theme_from_ooxml_document(ooxml_id, client_info=client_info)]

    if title:
        _title = title
    else:
        _title = pages[0].widgets[0].name

    outline = presalytics.story.outline.StoryOutline(
        presalytics_story=presalytics.story.outline.get_current_spec_version(),
        info=info,
        pages=pages,
        description=_description,
        title=_title,
        themes=_themes,
        plugins=[]
    )
    return outline</code></pre>
</details>
</dd>
<dt id="presalytics.create_pages_from_ooxml_document"><code class="name flex">
<span>def <span class="ident">create_pages_from_ooxml_document</span></span>(<span><a title="presalytics.story" href="/python-client/presalytics/story/index.html">presalytics.story</a>: Story, ooxml_document: Document, client_info={})</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/tools/ooxml_tools.py#L88-L119" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def create_pages_from_ooxml_document(story: &#39;Story&#39;, 
                                     ooxml_document: &#39;Document&#39;,
                                     client_info={}):
    pages = []
    client = presalytics.Client(**client_info)
    child_objects = client.ooxml_automation.documents_childobjects_get_id(ooxml_document.id)
    document_type = client.ooxml_automation.documents_documenttype_typeid_get_type_id(ooxml_document.document_type_id)
    if document_type.file_extension == &#34;pptx&#34;:
        slides_meta = [x for x in child_objects if x.object_type == &#34;Slide.Slides&#34;]
        ep_map = presalytics.OoxmlEndpointMap(presalytics.OoxmlEndpointMap.SLIDE)
        for slide in slides_meta:
            widget = presalytics.OoxmlFileWidget(
                filename=ooxml_document.filename,
                name=slide.entity_name,
                endpoint_map=ep_map,
                object_name=slide.entity_name,
                object_ooxml_id=slide.entity_id,
                document_ooxml_id=ooxml_document.id,
                story_id=story.id,
                client_info=client_info
            )
            widget_kind = &#34;widget-page&#34;
            widget_name = slide.entity_name
            widgets = [widget.serialize()]
            page = presalytics.story.outline.Page(
                kind=widget_kind,
                name=widget_name,
                widgets=widgets
            )
            pages.append(page)
    # TODO: insert excel chart handling here
    return pages</code></pre>
</details>
</dd>
<dt id="presalytics.create_story_from_ooxml_file"><code class="name flex">
<span>def <span class="ident">create_story_from_ooxml_file</span></span>(<span>filename: str, client_info={}) -> 'Story'</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/tools/ooxml_tools.py#L20-L39" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def create_story_from_ooxml_file(filename: str, client_info={}) -&gt; &#39;Story&#39;:
    story: &#39;Story&#39;
    logger.info(&#34;Starting presalytics tool: create_story_from_ooxml_file&#34;)
    logger.info(&#34;Intializing presalytics client.&#34;)
    client = presalytics.Client(**client_info)
    logger.info(&#34;Sending file to presaltyics server for document processing and base story creation&#34;)
    story = client.story.story_post_file(file=filename)
    logger.info(&#34;Creating local instances of file widgets&#34;)
    outline = presalytics.StoryOutline.load(story.outline)
    for i in range(0, len(outline.pages)):
        page = outline.pages[i]
        for j in range(0, len(page.widgets)):
            widget = page.widgets[j]
            logger.info(&#39;Creating OoxmlFileWidget with name &#34;{}&#34;&#39;.format(widget.name))
            inst = presalytics.OoxmlFileWidget.deserialize(widget, **client_info)
            presalytics.COMPONENTS.register(inst)
            logger.info(&#39;Rewriting outline with widget: &#34;{}&#34;&#39;.format(widget.name))
            outline.pages[i].widgets[j] = inst.serialize()
    story.outline = outline.dump()
    return story</code></pre>
</details>
</dd>
<dt id="presalytics.create_theme_from_ooxml_document"><code class="name flex">
<span>def <span class="ident">create_theme_from_ooxml_document</span></span>(<span>document_id: str, client_info={})</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/tools/ooxml_tools.py#L122-L146" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def create_theme_from_ooxml_document(document_id: str, client_info={}):
    client = presalytics.Client(**client_info)
    child_objects = client.ooxml_automation.documents_childobjects_get_id(document_id)
    themes = [x for x in child_objects if x.object_type == &#34;Theme.Themes&#34;]
    if len(themes) &gt; 1:
        slide_no = None
        for theme_data in themes:
            theme_info = client.ooxml_automation.theme_themes_get_id(theme_data.entity_id)
            parent_slide = client.ooxml_automation.slides_slides_get_id(theme_info.slide_id)
            if slide_no is None:
                slide_no = parent_slide.number
                theme_meta = theme_info
            else:
                if parent_slide.number &lt; slide_no:
                    theme_meta = theme_info
                    if parent_slide.number == 0:
                        break
    else:
        theme_meta = client.ooxml_automation.theme_themes_get_id(themes[0].entity_id)
    theme = presalytics.lib.themes.ooxml.OoxmlTheme(
        theme_meta.name, 
        theme_meta.id, 
        client_info=client_info
    )
    return theme.serialize().to_dict()</code></pre>
</details>
</dd>
<dt id="presalytics.get_mime_type_from_filename"><code class="name flex">
<span>def <span class="ident">get_mime_type_from_filename</span></span>(<span><a title="presalytics.client" href="/python-client/presalytics/client/index.html">presalytics.client</a>: <a title="presalytics.client.api.Client" href="/python-client/presalytics/client/api.html#presalytics.client.api.Client">Client</a>, filename) -> Union[str, NoneType]</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/tools/ooxml_tools.py#L148-L154" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_mime_type_from_filename(client: presalytics.Client, filename) -&gt; typing.Optional[str]:
    doc_types = client.ooxml_automation.documents_documenttype_get()
    file_extension = filename.split(&#34;.&#34;)[-1]
    try:
        return next(x.mime_type for x in doc_types if x.file_extension == file_extension)
    except StopIteration:
        return None</code></pre>
</details>
</dd>
<dt id="presalytics.story_post_file_bytes"><code class="name flex">
<span>def <span class="ident">story_post_file_bytes</span></span>(<span><a title="presalytics.client" href="/python-client/presalytics/client/index.html">presalytics.client</a>: <a title="presalytics.Client" href="/python-client/presalytics/index.html#presalytics.Client">Client</a>, binary_obj: BytesIO, filename: str, mime_type: str = None)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/tools/story_tools.py#L15-L41" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def story_post_file_bytes(client: &#39;Client&#39;, binary_obj: &#39;BytesIO&#39;, filename: str, mime_type: str = None):
    if not mime_type:
        mime_type = presalytics.lib.tools.ooxml_tools.get_mime_type_from_filename(client, filename)
    _file = {&#39;file&#39;: (filename, binary_obj, mime_type,)}
    headers = client.get_auth_header()
    headers.update({
        &#39;User-Agent&#39;: client.story.api_client.user_agent,
        &#39;Accept&#39;: &#39;application/json&#39;
    })
    endpoint = urllib.parse.urljoin(client.story.api_client.configuration.host, &#39;story/file&#39;)
    try:
        resp = requests.post(endpoint, headers=headers, files=_file)
    except Exception as ex:
        message = &#34;An error occured in the presalytics API client&#34;
        raise presalytics.lib.exceptions.ApiError(message=message, status_code=resp.status_code)
    data = resp.json()
    if resp.status_code &gt; 299:
        logger.error(data[&#39;detail&#39;])
        raise presalytics.lib.exceptions.ApiError(message=data[&#34;detail&#34;], status_code=resp.status_code)
    else:
        try:
            story = client.story.api_client._ApiClient__deserialize(data, &#39;Story&#39;)
            return story
        except Exception as ex:
            logger.error(&#34;Story object could not be deserialized.&#34;)
            logger.exception(ex)
        return data</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="presalytics.ApprovedExternalLinks"><code class="flex name class">
<span>class <span class="ident">ApprovedExternalLinks</span></span>
<span>(</span><span>**kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>A script plugin render configures templated scripts to append to the body
tag of an html document</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/external.py#L91-L100" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class ApprovedExternalLinks(presalytics.lib.plugins.base.StylePlugin):
    __plugin_name__ = &#39;external_links&#39;

    def to_style(self, config, **kwargs):
        key = config[&#39;approved_styles_key&#39;]
        link = ALLOWED_STYLES.flatten()[key]
        if link is None:
            message = &#34;Key {0} does not reference a link in the APPROVED_LINKS dictionary&#34;.format(key)
            raise presalytics.lib.exceptions.MissingConfigException(message)
        return &#39;&lt;link rel=&#34;stylesheet&#34; href=&#34;{0}&#34;/&gt;&#39;.format(link)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.plugins.base.StylePlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.StylePlugin">StylePlugin</a></li>
<li><a title="presalytics.lib.plugins.base.PluginBase" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase">PluginBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.plugins.base.StylePlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.StylePlugin">StylePlugin</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.plugins.base.StylePlugin.get_tag" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase.get_tag">get_tag</a></code></li>
<li><code><a title="presalytics.lib.plugins.base.StylePlugin.to_style" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.StylePlugin.to_style">to_style</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.ApprovedExternalScripts"><code class="flex name class">
<span>class <span class="ident">ApprovedExternalScripts</span></span>
<span>(</span><span>**kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>A script plugin render configures templated scripts to append to the body
tag of an html document</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/external.py#L103-L112" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class ApprovedExternalScripts(presalytics.lib.plugins.base.ScriptPlugin):
    __plugin_name__ = &#39;external_scripts&#39;

    def to_script(self, config, **kwargs):
        key = config[&#39;approved_scripts_key&#39;]
        link = ALLOWED_SCRIPTS.flatten()[key]
        if link is None:
            message = &#34;Key {0} does not reference a link in the APPROVED_SCRIPTS dictionary&#34;.format(key)
            raise presalytics.lib.exceptions.MissingConfigException(message)
        return &#39;&lt;script type=&#34;text/javascript&#34; src=&#34;{0}&#34;&gt;&lt;/script&gt;&#39;.format(link)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.plugins.base.ScriptPlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.ScriptPlugin">ScriptPlugin</a></li>
<li><a title="presalytics.lib.plugins.base.PluginBase" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase">PluginBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.plugins.base.ScriptPlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.ScriptPlugin">ScriptPlugin</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.plugins.base.ScriptPlugin.get_tag" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase.get_tag">get_tag</a></code></li>
<li><code><a title="presalytics.lib.plugins.base.ScriptPlugin.to_script" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.ScriptPlugin.to_script">to_script</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.ChangeShapeColor"><code class="flex name class">
<span>class <span class="ident">ChangeShapeColor</span></span>
<span>(</span><span>function_params: Dict, *args, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Helper class that provides a standard way to create an ABC using
inheritance.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml_editors.py#L25-L70" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class ChangeShapeColor(XmlTransformBase):
    @staticmethod
    def replace_color_on_target_shape(shape_xml: lxml.etree.Element, new_color: str) -&gt; lxml.etree.Element:
        new_fill = lxml.etree.Element(&#34;solidFill&#34;)
        lxml.etree.SubElement(new_fill, &#34;srbgClr&#34;, {&#34;val&#34;: new_color})
        fill_tags = [
            &#39;noFill&#39;,
            &#39;blipFill&#39;,
            &#39;gradFill&#39;,
            &#39;pattFill&#39;,
            &#39;solidFill&#39;
        ]
        props = shape_xml.find(&#39;.//{*}spPr&#39;)
        for child in props.getchildren():
            if any(re.search(&#39;{*}&#39; + r, child.tag) for r in fill_tags):
                current_nsmap = child.nsmap
                current_index = props.index(child)
                current_prefix = child.prefix
                current_ns = current_nsmap.get(current_prefix, None)
                new_fill = lxml.etree.Element(lxml.etree.QName(current_ns, &#34;solidFill&#34;), nsmap=current_nsmap)
                lxml.etree.SubElement(new_fill, lxml.etree.QName(current_ns, &#34;srgbClr&#34;), {&#34;val&#34;: new_color}, nsmap=current_nsmap)
                child.getparent().remove(child)
                props.insert(current_index, new_fill)
        return shape_xml

    def transform_function(self, lxml_element, params):
        if re.match(&#39;{.*}sp&#39;, lxml_element.tag):
            shapes = [lxml_element]
        else:
            shapes = lxml_element.findall(&#39;.//{*}sp&#39;)
        object_name = params.get(&#34;object_name&#34;, None)
        color = params.get(&#34;hex_color&#34;)
        if object_name:
            for shape in shapes:
                is_target = False
                nvprops = shape.find(&#39;.//{*}nvSpPr&#39;)
                if len(nvprops) &gt; 0:
                    name = nvprops.find(&#39;.//*[@name]&#39;).get(&#34;name&#34;)
                    if name == object_name:
                        is_target = True
                if is_target:
                    shape = ChangeShapeColor.replace_color_on_target_shape(shape, color)
        else:
            for shape in shapes:
                shape = ChangeShapeColor.replace_color_on_target_shape(shape, color)
        return lxml_element</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.widgets.ooxml_editors.XmlTransformBase" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.XmlTransformBase">XmlTransformBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Static methods</h3>
<dl>
<dt id="presalytics.ChangeShapeColor.replace_color_on_target_shape"><code class="name flex">
<span>def <span class="ident">replace_color_on_target_shape</span></span>(<span>shape_xml: <cyfunction Element at 0x7f6a06864df0>, new_color: str) -> <cyfunction Element at 0x7f6a06864df0></span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml_editors.py#L26-L48" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@staticmethod
def replace_color_on_target_shape(shape_xml: lxml.etree.Element, new_color: str) -&gt; lxml.etree.Element:
    new_fill = lxml.etree.Element(&#34;solidFill&#34;)
    lxml.etree.SubElement(new_fill, &#34;srbgClr&#34;, {&#34;val&#34;: new_color})
    fill_tags = [
        &#39;noFill&#39;,
        &#39;blipFill&#39;,
        &#39;gradFill&#39;,
        &#39;pattFill&#39;,
        &#39;solidFill&#39;
    ]
    props = shape_xml.find(&#39;.//{*}spPr&#39;)
    for child in props.getchildren():
        if any(re.search(&#39;{*}&#39; + r, child.tag) for r in fill_tags):
            current_nsmap = child.nsmap
            current_index = props.index(child)
            current_prefix = child.prefix
            current_ns = current_nsmap.get(current_prefix, None)
            new_fill = lxml.etree.Element(lxml.etree.QName(current_ns, &#34;solidFill&#34;), nsmap=current_nsmap)
            lxml.etree.SubElement(new_fill, lxml.etree.QName(current_ns, &#34;srgbClr&#34;), {&#34;val&#34;: new_color}, nsmap=current_nsmap)
            child.getparent().remove(child)
            props.insert(current_index, new_fill)
    return shape_xml</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.ChangeShapeColor.transform_function"><code class="name flex">
<span>def <span class="ident">transform_function</span></span>(<span>self, lxml_element, params)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml_editors.py#L50-L70" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def transform_function(self, lxml_element, params):
    if re.match(&#39;{.*}sp&#39;, lxml_element.tag):
        shapes = [lxml_element]
    else:
        shapes = lxml_element.findall(&#39;.//{*}sp&#39;)
    object_name = params.get(&#34;object_name&#34;, None)
    color = params.get(&#34;hex_color&#34;)
    if object_name:
        for shape in shapes:
            is_target = False
            nvprops = shape.find(&#39;.//{*}nvSpPr&#39;)
            if len(nvprops) &gt; 0:
                name = nvprops.find(&#39;.//*[@name]&#39;).get(&#34;name&#34;)
                if name == object_name:
                    is_target = True
            if is_target:
                shape = ChangeShapeColor.replace_color_on_target_shape(shape, color)
    else:
        for shape in shapes:
            shape = ChangeShapeColor.replace_color_on_target_shape(shape, color)
    return lxml_element</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="presalytics.Client"><code class="flex name class">
<span>class <span class="ident">Client</span></span>
<span>(</span><span>delegate_login=False, token=None, cache_tokens=True, username=None, password=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Class for interacting with Presalytics API endpoints</p>
<p>The Client class creates a simple interface for user to interactive with the
Presaltyics API and is the primary building block user-built tools, stories,
dashboards and interactive presentations.</p>
<p>A client instance wraps python functions around Presalytics API endpoints and
manages user authentication. On initialization, he client checks the status of
a user authentication the expiry of their refresh an access tokens.
When needed,
the client will prompt (or raise a )</p>
<p>After authenication, users can the methods bound to the story, ooxml_automation,
and doc_converter attributes to make calls in into the Presalytics API.</p>
<p>A note for server-side development:</p>
<p>By default, the client class automatically caches tokens in a file called
"token.json", located in the python's current working directory.
If building a
client to operate in a multi-user environment, this behavior should be turned off.
To do this, ensure the following parameters are pass to the configuration: </p>
<pre><code>cache_tokens = False,
delegate_login = True
</code></pre>
<p>When delegate login is True, the client assumes that the application creating
instances of the client object will handle user authentication.
The simplest way
to do this is to pass a token to the client via the "token" keyword argument.</p>
<h2 id="parameters">Parameters:</h2>
<h2 id="attributes">Attributes:</h2></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/client/api.py#L26-L270" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class Client(object):
    &#34;&#34;&#34; Class for interacting with Presalytics API endpoints

    The Client class creates a simple interface for user to interactive with the 
    Presaltyics API and is the primary building block user-built tools, stories, 
    dashboards and interactive presentations.

    A client instance wraps python functions around Presalytics API endpoints and
    manages user authentication. On initialization, he client checks the status of 
    a user authentication the expiry of their refresh an access tokens.  When needed,
    the client will prompt (or raise a )

    After authenication, users can the methods bound to the story, ooxml_automation, 
    and doc_converter attributes to make calls in into the Presalytics API.


    A note for server-side development:

    By default, the client class automatically caches tokens in a file called 
    &#34;token.json&#34;, located in the python&#39;s current working directory.  If building a
    client to operate in a multi-user environment, this behavior should be turned off.
    To do this, ensure the following parameters are pass to the configuration: 
    
        cache_tokens = False,
        delegate_login = True
    
    When delegate login is True, the client assumes that the application creating 
    instances of the client object will handle user authentication.  The simplest way
    to do this is to pass a token to the client via the &#34;token&#34; keyword argument.

    Parameters:
    ----------

    Attributes:
    ----------
      
    
    
    
    
    &#34;&#34;&#34;
    def __init__(
            self,
            delegate_login=False,
            token=None,
            cache_tokens=True,
            username=None,
            password=None,
            **kwargs):
    
        if username:
            self.username = username
        else:
            try:
                self.username = presalytics.CONFIG[&#39;USERNAME&#39;]
            except KeyError:
                if token:
                    self.username = None
                else:
                    raise presalytics.lib.exceptions.MissingConfigException(&#34;Configuration variable PRESALYTICS_USERNAME is required when client is not initalized with an API token.  Please reconfigure and retry.&#34;)
        try:
            if password:
                self.password = password
            else:
                self.password = presalytics.CONFIG[&#39;PASSWORD&#39;]
            self.direct_grant = True
        except KeyError:
            self.password = None
            self.direct_grant = False
        try:
            self.client_id = presalytics.CONFIG[&#39;CLIENT_ID&#39;]
        except KeyError:
            self.client_id = cnst.DEFAULT_CLIENT_ID
        try:
            self.client_secret = presalytics.CONFIG[&#39;CLIENT_SECRET&#39;]
            self.confidential_client = True
        except KeyError:
            self.client_secret = None
            self.confidential_client = False
        self.verify_https = env.bool(&#34;VERIFY_HTTPS&#34;, True)
        try:
            self.site_host = presalytics.CONFIG[&#34;HOSTS&#34;][&#34;SITE&#34;]
        except KeyError:
            self.site_host = cnst.SITE_HOST
        self.login_sleep_interval = 5  # seconds
        self.login_timeout = 60  # seconds
        try:
            self.redirect_uri = presalytics.CONFIG[&#34;REDIRECT_URI&#34;]
        except KeyError:
            self.redirect_uri = cnst.REDIRECT_URI
        if delegate_login or presalytics.CONFIG.get(&#34;DELEGATE_LOGIN&#34;, False):
            self._delegate_login = True
        else:
            self._delegate_login = False
        self.oidc = keycloak.KeycloakOpenID(
            server_url=cnst.OIDC_AUTH_HOST,
            realm_name=cnst.OIDC_REALM,
            client_id=self.client_id,
            verify=self.verify_https
        )
        self.token_util = presalytics.client.auth.TokenUtil(token_cache=cache_tokens)
        if token:
            if token.get(&#39;access_token_expire_time&#39;, None):
                self.token_util.token = token
            elif token.get(&#39;expires_in&#39;, None):
                self.token_util.process_keycloak_token(token)
            else:
                raise presalytics.lib.exceptions.InvalidTokenException(message=&#34;Unknown token format.&#34;)
            if self.token_util.token_cache:
                self.token_util._put_token_file()
        if not self._delegate_login:
            self.token_util.token = self.refresh_token()

        doc_converter_api_client = DocConverterApiClientWithAuth(self, **kwargs)
        self.doc_converter = presalytics.client.presalytics_doc_converter.DefaultApi(api_client=doc_converter_api_client)
        ooxml_automation_api_client = OoxmlAutomationApiClientWithAuth(self, **kwargs)
        self.ooxml_automation = presalytics.client.presalytics_ooxml_automation.DefaultApi(api_client=ooxml_automation_api_client)
        story_api_client = StoryApiClientWithAuth(self, **kwargs)
        self.story = presalytics.client.presalytics_story.DefaultApi(api_client=story_api_client)

    def login(self):
        try:
            if self.direct_grant:
                keycloak_token = self.oidc.token(username=self.username, password=self.password)
            else:
                keycloak_token = self._get_new_token_browser()
        except keycloak.exceptions.KeycloakGetError as e:
            if e.response_code == 404:
                logger.error(&#34;Received reponse code 404 from api authentication.  Indicates username does not exist.  Please recheck config and try again.&#34;)
            elif e.response_code == 401:
                logger.error(&#34;Received 401 response code from api authentication.  This user&#39;s access to this resource is unauthorized&#34;)
            elif e.response_code &gt;= 500:
                logger.error(&#34;Server error.  Please try again later.&#34;)
            else:
                logger.error(e.error_message)
            raise presalytics.lib.exceptions.MissingConfigException(e.error_message)
        self.token_util.process_keycloak_token(keycloak_token)
        return self.token_util.token

    def exchange_token(self, original_token, audience=None):
        &#34;&#34;&#34; Requires developer account and authorized client credentials &#34;&#34;&#34;
        self.oidc.decode_token(original_token, cnst.JWT_KEY)
        kwargs = {
            &#34;client_id&#34;: self.client_id,
            &#34;client_secret&#34;: self.client_secret,
            &#34;grant_type&#34;: &#34;urn:ietf:params:oauth:grant-type:token-exchange&#34;,
            &#34;subject_token&#34;: original_token
        }
        if audience is not None:
            kwargs.update(
                {
                    &#34;audience&#34;: audience
                }
            )
        keycloak_token = self.oidc.token(**kwargs)
        self.token_util.process_keycloak_token(keycloak_token)
        return self.token_util.token[&#34;access_token&#34;]

    def _get_new_token_browser(self):
        &#34;&#34;&#34;
        Opens browser in on presalytics.io and prompts for user login.
        Retrieves authorization code from website and obtains api token
        &#34;&#34;&#34;
        logger.info(&#34;Opening new browser tab.  Please input login credentials...&#34;)
        api_otp = uuid4()
        query = {
            &#34;api_otp&#34;: api_otp,
            &#34;client_id&#34;: self.client_id,
            &#34;next&#34;: urllib.parse.urlparse(self.redirect_uri).path
        }
        query_string = &#39;?{}&#39;.format(urllib.parse.urlencode(query))
        url = urllib.parse.urljoin(self.site_host, urllib.parse.urljoin(cnst.LOGIN_PATH, query_string))
        webbrowser.open_new_tab(url)
        auth_code = None
        payload = {
            &#34;username&#34;: self.username,
            &#34;api_otp&#34;: str(api_otp),
            &#34;client_id&#34;: self.client_id
        }

        auth_code_url = urllib.parse.urljoin(self.site_host, cnst.API_CODE_URL)
        interval = 0
        while True:
            response = requests.post(auth_code_url, json=payload, verify=self.verify_https)
            if response.status_code != 200:
                if interval &lt;= self.login_timeout:
                    interval += self.login_sleep_interval
                    time.sleep(self.login_sleep_interval)
                else:
                    raise presalytics.lib.exceptions.LoginTimeout()
            else:
                data = json.loads(response.content)
                break
        if data.get(&#34;token&#34;, None):
            #  pick up otp token off presalytics backend
            token = data.get(&#34;token&#34;) 
        else:
            # support oidc authorization code flow
            auth_code = data[&#34;authorization_code&#34;]
            token = self.oidc.token(username=self.username, grant_type=&#34;authorization_code&#34;, code=auth_code, redirect_uri=self.redirect_uri)
        if token:
            logger.info(&#34;Login Succeeded.  Proceeding.&#34;)
        return token

    def refresh_token(self):
        if self.token_util.is_api_access_token_expired():
            if self.token_util.is_api_refresh_token_expired():
                if not self._delegate_login:  # do not automatically log in at init
                    self.login()
                else:
                    raise presalytics.lib.exceptions.InvalidTokenException(message=&#34;This token has expired.&#34;)
            else:
                try:
                    refresh_token = self.token_util.token[&#34;refresh_token&#34;]
                    self.token_util.token = self.oidc.refresh_token(refresh_token)
                except keycloak.exceptions.KeycloakGetError:
                    if not self._delegate_login:
                        self.login()
            if self.token_util.token_cache:
                self.token_util._put_token_file()
        return self.token_util.token

    def get_auth_header(self):
        self.refresh_token()
        auth_header = {
            &#34;Authorization&#34;: &#34;Bearer &#34; + self.token_util.token[&#34;access_token&#34;]
        }
        return auth_header

    def get_request_id_header(self):
        return {
            &#34;X-Request-Id&#34;: str(uuid4())
        }

    def download_file(self, story_id, ooxml_automation_id, download_folder=None, filename=None, **kwargs):
        response, status, headers = self.story.story_id_file_ooxmlautomationid_get_with_http_info(story_id, ooxml_automation_id, _preload_content=False)
        if download_folder is None:
            download_folder = os.getcwd()
        if filename is None:
            cd_header = headers.get(&#39;Content-Disposition&#39;)
            _, params = cgi.parse_header(cd_header)
            filename = params[&#34;filename&#34;]
        filepath = os.path.join(download_folder, filename)
        with open(filepath, &#39;wb&#39;) as f:
            f.write(response.data)</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="presalytics.Client.download_file"><code class="name flex">
<span>def <span class="ident">download_file</span></span>(<span>self, story_id, ooxml_automation_id, download_folder=None, filename=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/client/api.py#L260-L270" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def download_file(self, story_id, ooxml_automation_id, download_folder=None, filename=None, **kwargs):
    response, status, headers = self.story.story_id_file_ooxmlautomationid_get_with_http_info(story_id, ooxml_automation_id, _preload_content=False)
    if download_folder is None:
        download_folder = os.getcwd()
    if filename is None:
        cd_header = headers.get(&#39;Content-Disposition&#39;)
        _, params = cgi.parse_header(cd_header)
        filename = params[&#34;filename&#34;]
    filepath = os.path.join(download_folder, filename)
    with open(filepath, &#39;wb&#39;) as f:
        f.write(response.data)</code></pre>
</details>
</dd>
<dt id="presalytics.Client.exchange_token"><code class="name flex">
<span>def <span class="ident">exchange_token</span></span>(<span>self, original_token, audience=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Requires developer account and authorized client credentials</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/client/api.py#L165-L182" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def exchange_token(self, original_token, audience=None):
    &#34;&#34;&#34; Requires developer account and authorized client credentials &#34;&#34;&#34;
    self.oidc.decode_token(original_token, cnst.JWT_KEY)
    kwargs = {
        &#34;client_id&#34;: self.client_id,
        &#34;client_secret&#34;: self.client_secret,
        &#34;grant_type&#34;: &#34;urn:ietf:params:oauth:grant-type:token-exchange&#34;,
        &#34;subject_token&#34;: original_token
    }
    if audience is not None:
        kwargs.update(
            {
                &#34;audience&#34;: audience
            }
        )
    keycloak_token = self.oidc.token(**kwargs)
    self.token_util.process_keycloak_token(keycloak_token)
    return self.token_util.token[&#34;access_token&#34;]</code></pre>
</details>
</dd>
<dt id="presalytics.Client.get_auth_header"><code class="name flex">
<span>def <span class="ident">get_auth_header</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/client/api.py#L248-L253" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_auth_header(self):
    self.refresh_token()
    auth_header = {
        &#34;Authorization&#34;: &#34;Bearer &#34; + self.token_util.token[&#34;access_token&#34;]
    }
    return auth_header</code></pre>
</details>
</dd>
<dt id="presalytics.Client.get_request_id_header"><code class="name flex">
<span>def <span class="ident">get_request_id_header</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/client/api.py#L255-L258" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_request_id_header(self):
    return {
        &#34;X-Request-Id&#34;: str(uuid4())
    }</code></pre>
</details>
</dd>
<dt id="presalytics.Client.login"><code class="name flex">
<span>def <span class="ident">login</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/client/api.py#L146-L163" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def login(self):
    try:
        if self.direct_grant:
            keycloak_token = self.oidc.token(username=self.username, password=self.password)
        else:
            keycloak_token = self._get_new_token_browser()
    except keycloak.exceptions.KeycloakGetError as e:
        if e.response_code == 404:
            logger.error(&#34;Received reponse code 404 from api authentication.  Indicates username does not exist.  Please recheck config and try again.&#34;)
        elif e.response_code == 401:
            logger.error(&#34;Received 401 response code from api authentication.  This user&#39;s access to this resource is unauthorized&#34;)
        elif e.response_code &gt;= 500:
            logger.error(&#34;Server error.  Please try again later.&#34;)
        else:
            logger.error(e.error_message)
        raise presalytics.lib.exceptions.MissingConfigException(e.error_message)
    self.token_util.process_keycloak_token(keycloak_token)
    return self.token_util.token</code></pre>
</details>
</dd>
<dt id="presalytics.Client.refresh_token"><code class="name flex">
<span>def <span class="ident">refresh_token</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/client/api.py#L230-L246" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def refresh_token(self):
    if self.token_util.is_api_access_token_expired():
        if self.token_util.is_api_refresh_token_expired():
            if not self._delegate_login:  # do not automatically log in at init
                self.login()
            else:
                raise presalytics.lib.exceptions.InvalidTokenException(message=&#34;This token has expired.&#34;)
        else:
            try:
                refresh_token = self.token_util.token[&#34;refresh_token&#34;]
                self.token_util.token = self.oidc.refresh_token(refresh_token)
            except keycloak.exceptions.KeycloakGetError:
                if not self._delegate_login:
                    self.login()
        if self.token_util.token_cache:
            self.token_util._put_token_file()
    return self.token_util.token</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="presalytics.JinjaPluginMakerMixin"><code class="flex name class">
<span>class <span class="ident">JinjaPluginMakerMixin</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/jinja.py#L6-L26" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class JinjaPluginMakerMixin(object):
    template: typing.Optional[str]
    template = None

    def __init__(self, *args, **kwargs):
        super(JinjaPluginMakerMixin, self).__init__(*args, *kwargs)

    def render(self, config: typing.Dict):
        options = {
            &#34;loader&#34;: jinja2.BaseLoader()
        }
        if config.get(&#34;jinja_options&#34;, None):
            options.update(config.pop(&#34;jinja_options&#34;))
        template = jinja2.Environment(**options).from_string(self.get_template())
        return template.render(config)

    def get_template(self) -&gt; str:
        if not self.template:
            raise presalytics.lib.exceptions.ValidationError(&#34;Plugins the use the JinjaPluginMakerMixin must have a defiined template attribute.&#34;)
        else:
            return self.template</code></pre>
</details>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="presalytics.lib.plugins.matplotlib.Mpld3Plugin" href="/python-client/presalytics/lib/plugins/matplotlib.html#presalytics.lib.plugins.matplotlib.Mpld3Plugin">Mpld3Plugin</a></li>
<li><a title="presalytics.lib.plugins.reveal.RevealConfigPlugin" href="/python-client/presalytics/lib/plugins/reveal.html#presalytics.lib.plugins.reveal.RevealConfigPlugin">RevealConfigPlugin</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.JinjaPluginMakerMixin.template"><code class="name">var <span class="ident">template</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.JinjaPluginMakerMixin.get_template"><code class="name flex">
<span>def <span class="ident">get_template</span></span>(<span>self) -> str</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/jinja.py#L22-L26" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_template(self) -&gt; str:
    if not self.template:
        raise presalytics.lib.exceptions.ValidationError(&#34;Plugins the use the JinjaPluginMakerMixin must have a defiined template attribute.&#34;)
    else:
        return self.template</code></pre>
</details>
</dd>
<dt id="presalytics.JinjaPluginMakerMixin.render"><code class="name flex">
<span>def <span class="ident">render</span></span>(<span>self, config: Dict)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/jinja.py#L13-L20" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def render(self, config: typing.Dict):
    options = {
        &#34;loader&#34;: jinja2.BaseLoader()
    }
    if config.get(&#34;jinja_options&#34;, None):
        options.update(config.pop(&#34;jinja_options&#34;))
    template = jinja2.Environment(**options).from_string(self.get_template())
    return template.render(config)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="presalytics.JinjaTemplateBuilder"><code class="flex name class">
<span>class <span class="ident">JinjaTemplateBuilder</span></span>
<span>(</span><span>page: Page, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Inherit from this base class to render templates to html via the
presalytics.story.revealer.Revealer class.</p>
<h2 id="parameters">Parameters:</h2>
<p>page: Page
A presalytics.story.outline.Page object for instalizing the class</p>
<h2 id="attributes">Attributes:</h2>
<p>outline_page: Page
A presalytics.story.outline.Page object</p>
<p>widgets: List[WidgetComponentBase]
A list widget that will be loaded into templates and rendered via placeholders.
These widgets must have a "to_html(self, data, **kwargs)" method.</p>
<p>css: List[str]
A list of keys in dot notation that point to links in the ALLOWED_STYLES dictionary
in the presalytics.lib.templates.base module.</p>
<p>js: List[str]
A list of keys in dot notation that point to links in the ALLOWED_SCRIPTS dictionary
in the presalytics.lib.templates.base module.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/templates/base.py#L29-L92" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class JinjaTemplateBuilder(presalytics.story.components.PageTemplateBase):
    __css__: typing.Sequence[str]
    __template_file__: str
    __template_paths__: typing.List[str]
    template_paths: typing.List[str]

    __template_paths__ = []
    __css__ = []

    def __init__(self, page: &#39;Page&#39;, **kwargs) -&gt; None:
        super().__init__(page, **kwargs)
        pkg_templates = os.path.join(os.path.dirname(__file__), &#34;html&#34;)
        self.template_paths = [pkg_templates]
        if len(self.__template_paths__) &gt; 0:
            self.template_paths[0:0] = self.__template_paths__

    @classmethod
    def deserialize(cls, component, **kwargs):
        return cls(component, **kwargs)

    @util.classproperty
    def __plugins__(cls):
        plugin_list = []
        for id in cls.__css__:
            new_item = {
                &#39;kind&#39;: &#39;style&#39;,
                &#39;name&#39;: &#39;local&#39;,
                &#39;config&#39;: {
                    &#39;css_file_id&#39;: id
                }
            }
            plugin_list.append(new_item)
        return plugin_list

    def serialize(self):
        updated_plugins = []
        for plugin_data in self.__plugins__:
            updated_plugins.append(presalytics.story.outline.Plugin(**plugin_data))
        self.outline_page.plugins = updated_plugins
        return self.outline_page

    def get_template_name(self):
        &#34;&#34;&#34;
        Requires subclasses have either a &#34;__template___&#34; property or override this method
        &#34;&#34;&#34;
        if self.__template_file__:
            return self.__template_file__
        else:
            raise NotImplementedError

    def render(self, **kwargs) -&gt; str:
        template = self.load_jinja_template()
        context = {
            &#34;widgets&#34;: self.widgets,
            &#34;widget_index&#34;: 0
        }
        if self.outline_page.additional_properties:
            context.update(self.outline_page.additional_properties)
        return template.render(**context)

    def load_jinja_template(self) -&gt; jinja2.Template:
        loader = jinja2.FileSystemLoader(self.template_paths)
        env = jinja2.Environment(loader=loader)
        return env.get_template(self.get_template_name())</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.components.PageTemplateBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.PageTemplateBase">PageTemplateBase</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="presalytics.lib.templates.base.TitleWithSingleItem" href="/python-client/presalytics/lib/templates/base.html#presalytics.lib.templates.base.TitleWithSingleItem">TitleWithSingleItem</a></li>
</ul>
<h3>Static methods</h3>
<dl>
<dt id="presalytics.JinjaTemplateBuilder.deserialize"><code class="name flex">
<span>def <span class="ident">deserialize</span></span>(<span>component, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/templates/base.py#L45-L47" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def deserialize(cls, component, **kwargs):
    return cls(component, **kwargs)</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.JinjaTemplateBuilder.get_template_name"><code class="name flex">
<span>def <span class="ident">get_template_name</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Requires subclasses have either a "__template___" property or override this method</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/templates/base.py#L70-L77" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_template_name(self):
    &#34;&#34;&#34;
    Requires subclasses have either a &#34;__template___&#34; property or override this method
    &#34;&#34;&#34;
    if self.__template_file__:
        return self.__template_file__
    else:
        raise NotImplementedError</code></pre>
</details>
</dd>
<dt id="presalytics.JinjaTemplateBuilder.load_jinja_template"><code class="name flex">
<span>def <span class="ident">load_jinja_template</span></span>(<span>self) -> jinja2.environment.Template</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/templates/base.py#L89-L92" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def load_jinja_template(self) -&gt; jinja2.Template:
    loader = jinja2.FileSystemLoader(self.template_paths)
    env = jinja2.Environment(loader=loader)
    return env.get_template(self.get_template_name())</code></pre>
</details>
</dd>
<dt id="presalytics.JinjaTemplateBuilder.serialize"><code class="name flex">
<span>def <span class="ident">serialize</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/templates/base.py#L63-L68" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def serialize(self):
    updated_plugins = []
    for plugin_data in self.__plugins__:
        updated_plugins.append(presalytics.story.outline.Plugin(**plugin_data))
    self.outline_page.plugins = updated_plugins
    return self.outline_page</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.story.components.PageTemplateBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.PageTemplateBase">PageTemplateBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.story.components.PageTemplateBase.get_page_widgets" href="/python-client/presalytics/story/components.html#presalytics.story.components.PageTemplateBase.get_page_widgets">get_page_widgets</a></code></li>
<li><code><a title="presalytics.story.components.PageTemplateBase.load_widget" href="/python-client/presalytics/story/components.html#presalytics.story.components.PageTemplateBase.load_widget">load_widget</a></code></li>
<li><code><a title="presalytics.story.components.PageTemplateBase.render" href="/python-client/presalytics/story/components.html#presalytics.story.components.PageTemplateBase.render">render</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.LocalStylesPlugin"><code class="flex name class">
<span>class <span class="ident">LocalStylesPlugin</span></span>
<span>(</span><span>**kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>A script plugin render configures templated scripts to append to the body
tag of an html document</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/local.py#L13-L31" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class LocalStylesPlugin(presalytics.lib.plugins.base.StylePlugin):
    __plugin_name__ = &#39;local&#39;

    def to_style(self, config, **kwargs):
        id = config.get(&#34;css_file_id&#34;, None)
        if not id:
            file_path = config.get(&#34;css_file_path&#34;, None)
            if not file_path:
                message = &#39;Plugin requires &#34;css_file_id&#34; or &#34;css_file_path&#34; in its configuration dictionary&#39;
                raise presalytics.lib.exceptions.MissingConfigException(message)
            if not os.path.exists(file_path):
                message = &#39;Path {0} in plugin configuration does not exist&#39;.format(file_path)
                raise presalytics.lib.exceptions.MissingConfigException(message)
        else:
            file_path = local_styles_map[id]
        with open(file_path, &#39;r&#39;) as f:
            style_data = f.read()
        tag = &#34;&lt;style&gt;{0}&lt;/style&gt;&#34;.format(style_data)
        return tag</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.plugins.base.StylePlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.StylePlugin">StylePlugin</a></li>
<li><a title="presalytics.lib.plugins.base.PluginBase" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase">PluginBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.plugins.base.StylePlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.StylePlugin">StylePlugin</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.plugins.base.StylePlugin.get_tag" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase.get_tag">get_tag</a></code></li>
<li><code><a title="presalytics.lib.plugins.base.StylePlugin.to_style" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.StylePlugin.to_style">to_style</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.MatplotlibFigure"><code class="flex name class">
<span>class <span class="ident">MatplotlibFigure</span></span>
<span>(</span><span>figure: Figure, name: str, *args, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Inherit from this base class to create widget components that can be rendered to html via the
presalytics.story.revealer.Revealer class.
This component also need to build a method
that allows the widget to be serialzed into a presalytics.story.outline.Widget object.</p>
<h2 id="parameters">Parameters:</h2>
<p>widget: Widget
A presalytics.story.outline.Widget object use for initialized the component class.</p>
<h2 id="attributes">Attributes:</h2>
<p>outline_widget: Widget
A presalytics.story.outline.Widget object</p>
<p>css: List[str]
A list of keys in dot notation that point to links in the ALLOWED_STYLES dictionary
in the presalytics.lib.templates.base module.</p>
<p>js: List[str]
A list of keys in dot notation that point to links in the ALLOWED_SCRIPTS dictionary
in the presalytics.lib.templates.base module.</p>
<p>Note: When inheriting from this base class, call "super().<strong>init</strong>(self, <em>args, </em>*kwargs)" before add your
own custom initialization.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/matplotlib.py#L10-L58" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class MatplotlibFigure(presalytics.story.components.WidgetBase):
    __component_kind__ = &#39;matplotlib_figure&#39;
    additional_properties: typing.Dict

    def __init__(self, figure: &#39;Figure&#39;, name: str, *args, **kwargs):
        super().__init__(self, *args, **kwargs)
        self.fig = figure
        self.name = name
        self.figure_dict = None
        if self.fig:
            self.figure_dict = mpld3.fig_to_dict(figure)
        else:
            figure_dict = kwargs.pop(&#34;figure_dict&#34;, None)
            if figure_dict:
                self.figure_dict = figure_dict
        if self.figure_dict is None:
            message = &#34;MatplotlibFigure requires a figure_dict attribute.  Please supply either a valid figure_dict or matplotlib.pyplot.Figure object to __init__&#34;
            raise presalytics.lib.exceptions.ValidationError(message)
        self.figure_id = self.figure_dict[&#34;id&#34;]
        self.additional_properties = {}
        for key, val in kwargs.items():
            self.additional_properties[key] = val
        self.outline_widget = self.serialize()

    def to_html(self):
        return &#39;&lt;div id=&#34;{0}&#34; class=&#34;mpld3&#34;&gt;&lt;/div&gt;&#39;.format(self.figure_id)

    @classmethod
    def deserialize(cls, outline, **kwargs):
        figure_dict = outline.data.get(&#34;figure_dict&#34;)
        return cls(None, outline.name, figure_dict=figure_dict, **outline.additional_properties)

    def serialize(self, **kwargs):
        data = {
            &#39;figure_dict&#39;: self.figure_dict,
            &#39;id&#39;: self.figure_id
        }
        plugin_obj = presalytics.story.outline.Plugin(
            name=&#39;mpld3&#39;,
            kind=&#39;script&#39;,
            config=data
        )
        return presalytics.story.outline.Widget(
            name=self.name,
            kind=self.__component_kind__,
            plugins=[plugin_obj.to_dict()],
            data=data,
            additional_properties=self.additional_properties
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.story.components.WidgetBase.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.serialize">serialize</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.to_html" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.to_html">to_html</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.Mpld3Plugin"><code class="flex name class">
<span>class <span class="ident">Mpld3Plugin</span></span>
<span>(</span><span>**kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>A script plugin render configures templated scripts to append to the body
tag of an html document</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/matplotlib.py#L6-L40" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class Mpld3Plugin(ext.ScriptPlugin, jinja.JinjaPluginMakerMixin):
    __plugin_name__ = &#39;mpld3&#39;

    __dependencies__ = [
        {
            &#39;kind&#39;: &#39;script&#39;,
            &#39;name&#39;: &#39;external_scripts&#39;,
            &#39;config&#39;: {
                &#39;approved_scripts_key&#39;: &#39;reveal.base&#39;
            }
        },
        {
            &#39;kind&#39;: &#39;script&#39;,
            &#39;name&#39;: &#39;external_scripts&#39;,
            &#39;config&#39;: {
                &#39;approved_scripts_key&#39;: &#39;d3v3&#39;
            }
        },
        {
            &#39;kind&#39;: &#39;script&#39;,
            &#39;name&#39;: &#39;external_scripts&#39;,
            &#39;config&#39;: {
                &#39;approved_scripts_key&#39;: &#39;mpld3&#39;
            }
        }
    ]

    template = &#39;&lt;script type=&#34;text/javascript&#34;&gt;mpld3.draw_figure(&#34;{{ id|safe }}&#34;,{{ fig_json|tojson }});&lt;/script&gt;&#39;

    def to_script(self, config, **kwargs):
        render_config = {
            &#39;id&#39;: config[&#34;id&#34;],
            &#39;fig_json&#39;: config[&#34;figure_dict&#34;]
        }
        return self.render(render_config)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.plugins.base.ScriptPlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.ScriptPlugin">ScriptPlugin</a></li>
<li><a title="presalytics.lib.plugins.base.PluginBase" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase">PluginBase</a></li>
<li>abc.ABC</li>
<li><a title="presalytics.lib.plugins.jinja.JinjaPluginMakerMixin" href="/python-client/presalytics/lib/plugins/jinja.html#presalytics.lib.plugins.jinja.JinjaPluginMakerMixin">JinjaPluginMakerMixin</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.Mpld3Plugin.template"><code class="name">var <span class="ident">template</span></code></dt>
<dd>
<section class="desc"><p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to sys.getdefaultencoding().
errors defaults to 'strict'.</p></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.plugins.base.ScriptPlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.ScriptPlugin">ScriptPlugin</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.plugins.base.ScriptPlugin.get_tag" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase.get_tag">get_tag</a></code></li>
<li><code><a title="presalytics.lib.plugins.base.ScriptPlugin.to_script" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.ScriptPlugin.to_script">to_script</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.OoxmlEditorWidget"><code class="flex name class">
<span>class <span class="ident">OoxmlEditorWidget</span></span>
<span>(</span><span>name: str, story_id, object_ooxml_id, endpoint_map, transform_class=None, transform_params=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Inherit from this base class to create widget components that can be rendered to html via the
presalytics.story.revealer.Revealer class.
This component also need to build a method
that allows the widget to be serialzed into a presalytics.story.outline.Widget object.</p>
<h2 id="parameters">Parameters:</h2>
<p>widget: Widget
A presalytics.story.outline.Widget object use for initialized the component class.</p>
<h2 id="attributes">Attributes:</h2>
<p>outline_widget: Widget
A presalytics.story.outline.Widget object</p>
<p>css: List[str]
A list of keys in dot notation that point to links in the ALLOWED_STYLES dictionary
in the presalytics.lib.templates.base module.</p>
<p>js: List[str]
A list of keys in dot notation that point to links in the ALLOWED_SCRIPTS dictionary
in the presalytics.lib.templates.base module.</p>
<p>Note: When inheriting from this base class, call "super().<strong>init</strong>(self, <em>args, </em>*kwargs)" before add your
own custom initialization.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml_editors.py#L73-L136" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class OoxmlEditorWidget(presalytics.lib.widgets.ooxml.OoxmlWidgetBase):
    transform: XmlTransformBase

    __component_kind__ = &#39;ooxml-xml-editor&#39;

    def __init__(self,
                 name: str,
                 story_id,
                 object_ooxml_id,
                 endpoint_map,
                 transform_class=None,
                 transform_params=None,
                 **kwargs):
        super(OoxmlEditorWidget, self).__init__(name, story_id=story_id, object_ooxml_id=object_ooxml_id, endpoint_map=endpoint_map, **kwargs)
        self.name = name
        self.transform = transform_class(transform_params)
        self.svg_data = self.update()
        self.svg_html = self.create_container(**self.client_info)
        self.outline_widget = self.serialize()

    def update_xml(self, xml_str) -&gt; str:
        xml = lxml.etree.fromstring(xml_str)
        new_xml = self.transform.execute(xml)
        new_xml_str = lxml.etree.tostring(new_xml)
        return new_xml_str

    def update(self):
        client = self.get_client()
        auth_header = client.get_auth_header()
        if self.transform:
            xml_url = self.endpoint_map.get_xml_url(self.object_ooxml_id)
            xml_response = requests.get(xml_url, headers=auth_header)
            if xml_response.status_code != 200:
                raise presalytics.lib.exceptions.ApiError(message=xml_response.text)
            dto = xml_response.json()
            new_xml = self.update_xml(dto[&#34;openOfficeXml&#34;])
            dto[&#34;openOfficeXml&#34;] = new_xml.decode(&#39;utf-8&#39;)
            xml_update_response = requests.put(xml_url, json=dto, headers=auth_header)
            if xml_response.status_code != 200:
                raise presalytics.lib.exceptions.ApiError(message=xml_update_response.content)
        svg_data = self.get_svg(self.object_ooxml_id)
        return svg_data

    @classmethod
    def deseriailize(cls, component, **kwargs):
        endpoint_map = presalytics.lib.widgets.ooxml.OoxmlEndpointMap(component.data[&#34;endpoint_id&#34;])
        return cls(component.name,
                   component.data[&#34;story_id&#34;],
                   component.data[&#34;object_ooxml_id&#34;],
                   endpoint_map
                   )

    def serialize(self, **kwargs):
        data = {
            &#34;story_id&#34;: self.story_id,
            &#34;object_ooxml_id&#34;: self.object_ooxml_id,
            &#34;endpoint_id&#34;: self.endpoint_map.endpoint_id
        }
        widget = presalytics.story.outline.Widget(
            name=self.name,
            data=data,
            kind=self.__component_kind__
        )
        return widget</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase">OoxmlWidgetBase</a></li>
<li><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Static methods</h3>
<dl>
<dt id="presalytics.OoxmlEditorWidget.deseriailize"><code class="name flex">
<span>def <span class="ident">deseriailize</span></span>(<span>component, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml_editors.py#L116-L123" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def deseriailize(cls, component, **kwargs):
    endpoint_map = presalytics.lib.widgets.ooxml.OoxmlEndpointMap(component.data[&#34;endpoint_id&#34;])
    return cls(component.name,
               component.data[&#34;story_id&#34;],
               component.data[&#34;object_ooxml_id&#34;],
               endpoint_map
               )</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.OoxmlEditorWidget.update"><code class="name flex">
<span>def <span class="ident">update</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml_editors.py#L99-L114" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def update(self):
    client = self.get_client()
    auth_header = client.get_auth_header()
    if self.transform:
        xml_url = self.endpoint_map.get_xml_url(self.object_ooxml_id)
        xml_response = requests.get(xml_url, headers=auth_header)
        if xml_response.status_code != 200:
            raise presalytics.lib.exceptions.ApiError(message=xml_response.text)
        dto = xml_response.json()
        new_xml = self.update_xml(dto[&#34;openOfficeXml&#34;])
        dto[&#34;openOfficeXml&#34;] = new_xml.decode(&#39;utf-8&#39;)
        xml_update_response = requests.put(xml_url, json=dto, headers=auth_header)
        if xml_response.status_code != 200:
            raise presalytics.lib.exceptions.ApiError(message=xml_update_response.content)
    svg_data = self.get_svg(self.object_ooxml_id)
    return svg_data</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEditorWidget.update_xml"><code class="name flex">
<span>def <span class="ident">update_xml</span></span>(<span>self, xml_str) -> str</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml_editors.py#L93-L97" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def update_xml(self, xml_str) -&gt; str:
    xml = lxml.etree.fromstring(xml_str)
    new_xml = self.transform.execute(xml)
    new_xml_str = lxml.etree.tostring(new_xml)
    return new_xml_str</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase">OoxmlWidgetBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.serialize">serialize</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.to_html" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.to_html">to_html</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.OoxmlEndpointMap"><code class="flex name class">
<span>class <span class="ident">OoxmlEndpointMap</span></span>
<span>(</span><span>endpoint_id, baseurl: str = None)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L24-L142" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class OoxmlEndpointMap(object):
    BASE_URL = &#34;https://api.presalytics.io/ooxml-automation&#34;

    CHART = &#34;Charts&#34;
    CONNECTION_SHAPE = &#34;ConnectionShapes&#34;
    DOCUMENT = &#34;Documents&#34;
    GROUP = &#34;Groups&#34;
    IMAGE = &#34;Images&#34;
    SHAPE = &#34;Shapes&#34;
    SHAPETREE = &#34;ShapeTrees&#34;
    SLIDE = &#34;Slides&#34;
    TABLE = &#34;Tables&#34;
    THEME = &#34;Themes&#34;


    def _build_object_type_map(self):
        return {
            &#34;Chart&#34;: [
                OoxmlEndpointMap.CHART,
            ],
            &#34;Slide&#34;: [
                OoxmlEndpointMap.GROUP,
                OoxmlEndpointMap.SHAPE,
                OoxmlEndpointMap.SHAPETREE, 
                OoxmlEndpointMap.CONNECTION_SHAPE,
                OoxmlEndpointMap.SLIDE
            ],
            &#34;Table&#34;: [
                OoxmlEndpointMap.TABLE
            ],
            &#34;Theme&#34;: [
                OoxmlEndpointMap.THEME
            ],
            &#34;Shared&#34;: [
                OoxmlEndpointMap.IMAGE
            ],
            &#34;EMPTY&#34;: [
                OoxmlEndpointMap.DOCUMENT
            ]
        }
    
    

    def __init__(self, endpoint_id, baseurl: str = None):
        if endpoint_id not in OoxmlEndpointMap.__dict__.values():
            raise presalytics.lib.exceptions.ValidationError(&#34;{0} is not a valid endpoint ID&#34;.format(endpoint))
        self.endpoint_id = endpoint_id
        if not baseurl:
            self.baseurl = OoxmlEndpointMap.BASE_URL
            custom_hosts = presalytics.CONFIG.get(&#34;HOSTS&#34;, None)
            if custom_hosts:
                ooxml_host = custom_hosts.get(&#34;OOXML_AUTOMATION&#34;, None)
                if ooxml_host:
                    self.baseurl = ooxml_host
                
        else:
            self.baseurl = baseurl
        self.root_url = posixpath.join(self.baseurl, self.endpoint_id)
        self.OBJECT_TYPE_MAP = self._build_object_type_map()
    
    def get_object_type(self):
        for key, val in self.OBJECT_TYPE_MAP.items():
            for test_ep in val:
                if test_ep == self.endpoint_id:
                    if key == &#34;EMPTY&#34;:
                        return self.endpoint_id
                    else:
                        return &#34;{0}.{1}&#34;.format(key, self.endpoint_id)
        message = &#34;Invalid EndpointMap configuration: {0} is not in OBJECT_TYPE_MAP&#34;.format(self.endpoint_id)
        raise presalytics.lib.exceptions.ValidationError(message)

    def get_id_url(self, id):
        return posixpath.join(self.root_url, id)

    def get_svg_url(self, id):
        return posixpath.join(self.root_url, &#34;Svg&#34;, id)

    def get_xml_url(self, id):
        return posixpath.join(self.root_url, &#34;OpenOfficeXml&#34;, id)

    @classmethod
    def connection_shape(cls, baseurl=None):
        return cls(OoxmlEndpointMap.CONNECTION_SHAPE, baseurl)

    @classmethod
    def chart(cls, baseurl=None):
        return cls(OoxmlEndpointMap.CHART, baseurl)

    @classmethod
    def document(cls, baseurl=None):
        return cls(OoxmlEndpointMap.DOCUMENT, baseurl)
    
    @classmethod
    def group(cls, baseurl=None):
        return cls(OoxmlEndpointMap.GROUP, baseurl)

    @classmethod
    def image(cls, baseurl=None):
        return cls(OoxmlEndpointMap.IMAGE, baseurl)

    @classmethod
    def shape(cls, baseurl=None):
        return cls(OoxmlEndpointMap.SHAPE, baseurl)

    @classmethod
    def shapetree(cls, baseurl=None):
        return cls(OoxmlEndpointMap.SHAPETREE, baseurl)

    @classmethod
    def slide(cls, baseurl=None):
        return cls(OoxmlEndpointMap.SLIDE, baseurl)

    @classmethod
    def table(cls, baseurl=None):
        return cls(OoxmlEndpointMap.table, baseurl)

    @classmethod
    def theme(cls, baseurl=None):
        return cls(OoxmlEndpointMap.THEME, baseurl)</code></pre>
</details>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.OoxmlEndpointMap.BASE_URL"><code class="name">var <span class="ident">BASE_URL</span></code></dt>
<dd>
<section class="desc"><p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to sys.getdefaultencoding().
errors defaults to 'strict'.</p></section>
</dd>
<dt id="presalytics.OoxmlEndpointMap.CHART"><code class="name">var <span class="ident">CHART</span></code></dt>
<dd>
<section class="desc"><p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to sys.getdefaultencoding().
errors defaults to 'strict'.</p></section>
</dd>
<dt id="presalytics.OoxmlEndpointMap.CONNECTION_SHAPE"><code class="name">var <span class="ident">CONNECTION_SHAPE</span></code></dt>
<dd>
<section class="desc"><p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to sys.getdefaultencoding().
errors defaults to 'strict'.</p></section>
</dd>
<dt id="presalytics.OoxmlEndpointMap.DOCUMENT"><code class="name">var <span class="ident">DOCUMENT</span></code></dt>
<dd>
<section class="desc"><p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to sys.getdefaultencoding().
errors defaults to 'strict'.</p></section>
</dd>
<dt id="presalytics.OoxmlEndpointMap.GROUP"><code class="name">var <span class="ident">GROUP</span></code></dt>
<dd>
<section class="desc"><p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to sys.getdefaultencoding().
errors defaults to 'strict'.</p></section>
</dd>
<dt id="presalytics.OoxmlEndpointMap.IMAGE"><code class="name">var <span class="ident">IMAGE</span></code></dt>
<dd>
<section class="desc"><p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to sys.getdefaultencoding().
errors defaults to 'strict'.</p></section>
</dd>
<dt id="presalytics.OoxmlEndpointMap.SHAPE"><code class="name">var <span class="ident">SHAPE</span></code></dt>
<dd>
<section class="desc"><p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to sys.getdefaultencoding().
errors defaults to 'strict'.</p></section>
</dd>
<dt id="presalytics.OoxmlEndpointMap.SHAPETREE"><code class="name">var <span class="ident">SHAPETREE</span></code></dt>
<dd>
<section class="desc"><p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to sys.getdefaultencoding().
errors defaults to 'strict'.</p></section>
</dd>
<dt id="presalytics.OoxmlEndpointMap.SLIDE"><code class="name">var <span class="ident">SLIDE</span></code></dt>
<dd>
<section class="desc"><p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to sys.getdefaultencoding().
errors defaults to 'strict'.</p></section>
</dd>
<dt id="presalytics.OoxmlEndpointMap.TABLE"><code class="name">var <span class="ident">TABLE</span></code></dt>
<dd>
<section class="desc"><p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to sys.getdefaultencoding().
errors defaults to 'strict'.</p></section>
</dd>
<dt id="presalytics.OoxmlEndpointMap.THEME"><code class="name">var <span class="ident">THEME</span></code></dt>
<dd>
<section class="desc"><p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to sys.getdefaultencoding().
errors defaults to 'strict'.</p></section>
</dd>
</dl>
<h3>Static methods</h3>
<dl>
<dt id="presalytics.OoxmlEndpointMap.chart"><code class="name flex">
<span>def <span class="ident">chart</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L108-L110" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def chart(cls, baseurl=None):
    return cls(OoxmlEndpointMap.CHART, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.connection_shape"><code class="name flex">
<span>def <span class="ident">connection_shape</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L104-L106" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def connection_shape(cls, baseurl=None):
    return cls(OoxmlEndpointMap.CONNECTION_SHAPE, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.document"><code class="name flex">
<span>def <span class="ident">document</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L112-L114" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def document(cls, baseurl=None):
    return cls(OoxmlEndpointMap.DOCUMENT, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.group"><code class="name flex">
<span>def <span class="ident">group</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L116-L118" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def group(cls, baseurl=None):
    return cls(OoxmlEndpointMap.GROUP, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.image"><code class="name flex">
<span>def <span class="ident">image</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L120-L122" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def image(cls, baseurl=None):
    return cls(OoxmlEndpointMap.IMAGE, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.shape"><code class="name flex">
<span>def <span class="ident">shape</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L124-L126" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def shape(cls, baseurl=None):
    return cls(OoxmlEndpointMap.SHAPE, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.shapetree"><code class="name flex">
<span>def <span class="ident">shapetree</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L128-L130" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def shapetree(cls, baseurl=None):
    return cls(OoxmlEndpointMap.SHAPETREE, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.slide"><code class="name flex">
<span>def <span class="ident">slide</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L132-L134" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def slide(cls, baseurl=None):
    return cls(OoxmlEndpointMap.SLIDE, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.table"><code class="name flex">
<span>def <span class="ident">table</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L136-L138" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def table(cls, baseurl=None):
    return cls(OoxmlEndpointMap.table, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.theme"><code class="name flex">
<span>def <span class="ident">theme</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L140-L142" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def theme(cls, baseurl=None):
    return cls(OoxmlEndpointMap.THEME, baseurl)</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.OoxmlEndpointMap.get_id_url"><code class="name flex">
<span>def <span class="ident">get_id_url</span></span>(<span>self, id)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L95-L96" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_id_url(self, id):
    return posixpath.join(self.root_url, id)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.get_object_type"><code class="name flex">
<span>def <span class="ident">get_object_type</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L84-L93" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_object_type(self):
    for key, val in self.OBJECT_TYPE_MAP.items():
        for test_ep in val:
            if test_ep == self.endpoint_id:
                if key == &#34;EMPTY&#34;:
                    return self.endpoint_id
                else:
                    return &#34;{0}.{1}&#34;.format(key, self.endpoint_id)
    message = &#34;Invalid EndpointMap configuration: {0} is not in OBJECT_TYPE_MAP&#34;.format(self.endpoint_id)
    raise presalytics.lib.exceptions.ValidationError(message)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.get_svg_url"><code class="name flex">
<span>def <span class="ident">get_svg_url</span></span>(<span>self, id)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L98-L99" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_svg_url(self, id):
    return posixpath.join(self.root_url, &#34;Svg&#34;, id)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.get_xml_url"><code class="name flex">
<span>def <span class="ident">get_xml_url</span></span>(<span>self, id)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L101-L102" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_xml_url(self, id):
    return posixpath.join(self.root_url, &#34;OpenOfficeXml&#34;, id)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="presalytics.OoxmlFileWidget"><code class="flex name class">
<span>class <span class="ident">OoxmlFileWidget</span></span>
<span>(</span><span>filename, name=None, story_id=None, object_ooxml_id=None, endpoint_map=None, object_name=None, previous_ooxml_version={}, file_last_modified=None, document_ooxml_id=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Inherit from this base class to create widget components that can be rendered to html via the
presalytics.story.revealer.Revealer class.
This component also need to build a method
that allows the widget to be serialzed into a presalytics.story.outline.Widget object.</p>
<h2 id="parameters">Parameters:</h2>
<p>widget: Widget
A presalytics.story.outline.Widget object use for initialized the component class.</p>
<h2 id="attributes">Attributes:</h2>
<p>outline_widget: Widget
A presalytics.story.outline.Widget object</p>
<p>css: List[str]
A list of keys in dot notation that point to links in the ALLOWED_STYLES dictionary
in the presalytics.lib.templates.base module.</p>
<p>js: List[str]
A list of keys in dot notation that point to links in the ALLOWED_SCRIPTS dictionary
in the presalytics.lib.templates.base module.</p>
<p>Note: When inheriting from this base class, call "super().<strong>init</strong>(self, <em>args, </em>*kwargs)" before add your
own custom initialization.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L230-L402" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class OoxmlFileWidget(OoxmlWidgetBase):
    object_name: typing.Optional[str]
    ooxml_id: str
    file_last_modified: datetime.datetime
    previous_ooxml_version: typing.Dict[str, str]

    __component_kind__ = &#39;ooxml-file-object&#39;

    def __init__(self,
                 filename,
                 name=None,
                 story_id=None,
                 object_ooxml_id=None,
                 endpoint_map=None,
                 object_name=None,
                 previous_ooxml_version={},
                 file_last_modified=None,
                 document_ooxml_id=None,
                 **kwargs):
        if object_name:
            self.object_name = object_name
        else:
            self.object_name = None
        if not name:
            if self.object_name:
                name = self.object_name
            else:
                name = filename
        super(OoxmlFileWidget, self).__init__(name, story_id, object_ooxml_id, endpoint_map, **kwargs)
        self.filename = os.path.basename(filename)
        if not self.endpoint_map:
            if filename.split(&#34;.&#34;)[-1] in [&#34;pptx&#34;, &#34;ppt&#34;]:
                self.endpoint_map = OoxmlEndpointMap(OoxmlEndpointMap.SLIDE)
        self.previous_ooxml_version = previous_ooxml_version
        if file_last_modified:
            self.file_last_modified = file_last_modified.replace(tzinfo=datetime.timezone.utc)
        else:
            self.file_last_modified = datetime.datetime.utcnow()
        self.document_ooxml_id = document_ooxml_id
        self.update()
        self.svg_html = self.create_container(**kwargs)

    def update(self):
        &#34;&#34;&#34;
        If the file is available locally, this renders that updated file and pushes
        the updated rendering data to the server
        &#34;&#34;&#34;
        story: &#39;ApiStory&#39;
        page: &#39;Page&#39;
        widget: &#39;Widget&#39;

        search_paths = list(set(presalytics.autodiscover_paths))
        if os.getcwd() not in search_paths:
            search_paths.append(os.getcwd())
        for path in search_paths:
            fpath = os.path.join(path, self.filename)
            if os.path.exists(fpath):
                # update only the file has been modified sine last time
                this_file_last_modified = datetime.datetime.utcfromtimestamp(os.path.getmtime(fpath)).astimezone(tz=datetime.timezone.utc)
                if self.file_last_modified is None or self.file_last_modified &lt;= this_file_last_modified:
                    client = self.get_client()
                    story, status, headers = client.story.story_id_file_post_with_http_info(self.story_id, file=fpath, replace_existing=True, obsolete_id=self.document_ooxml_id)
                    if status &gt;= 299:
                        raise presalytics.lib.exceptions.ApiError()
                    self.previous_ooxml_version = {
                        &#34;document_ooxml_id&#34;: self.document_ooxml_id,
                        &#34;object_ooxml_id&#34;: self.object_ooxml_id
                    }
                    new_outline = presalytics.story.outline.StoryOutline.load(story.outline)
                    for page in new_outline.pages:
                        found = False
                        for widget in page.widgets:
                            if widget.name == self.object_name:
                                self.document_ooxml_id = widget.data[&#34;document_ooxml_id&#34;]
                                found = True
                                break
                        if found:
                            break
                    if not found:
                        message = &#34;Unable to find widget object name {0} in new story outline.  Has this widget been deleted?&#34;.format(self.object_name)
                        raise presalytics.lib.exceptions.ValidationError(message)

                    # Get object tree, compare to object name
                    child_tree = client.ooxml_automation.documents_childobjects_get_id(self.document_ooxml_id)
                    target_dto = None

                    try:
                        target_dto = next(x for x in child_tree if x.entity_name == self.object_name)
                    except StopIteration:
                        pass
                    # if name not in object or _object_name is none, get first item of type in end_point id
                    if not target_dto:
                        try:
                            target_dto = next(x for x in child_tree if x.object_type.split(&#34;.&#34;)[1] == self.endpoint_map.endpoint_id)
                        except StopIteration:
                            message = &#34;Child tree of document {0} does not have a child object of type {1} or name {2}.&#34;.format(self.ooxml_id, self.endpoint_map.endpoint_id, self.object_name)
                            raise presalytics.lib.exceptions.InvalidConfigurationError(message)
                    # set widget parameters for recreation server-side (without file)
                    self.object_ooxml_id = target_dto.entity_id
                    self.file_last_modified = presalytics.lib.util.roundup_date_modified(this_file_last_modified)


    @classmethod
    def deserialize(cls, component, **kwargs):
        init_args = {
            &#34;filename&#34;: component.data[&#34;filename&#34;],
            &#34;endpoint_map&#34;: OoxmlEndpointMap(component.data[&#34;endpoint_id&#34;]),
            &#34;object_name&#34;: component.data[&#34;object_name&#34;],
            &#34;name&#34;: component.name,
        }
        if &#34;document_ooxml_id&#34; in component.data:
            init_args.update(
                {
                    &#34;document_ooxml_id&#34;: component.data[&#34;document_ooxml_id&#34;]
                }
            )
        if &#34;object_ooxml_id&#34; in component.data:
            init_args.update(
                {
                    &#34;object_ooxml_id&#34;: component.data[&#34;object_ooxml_id&#34;]
                }
            )
        if &#34;file_last_modified&#34; in component.data:
            init_args.update(
                {
                    &#34;file_last_modified&#34;: dateutil.parser.parse(component.data[&#34;file_last_modified&#34;]).replace(tzinfo=datetime.timezone.utc)
                }
            )
        if &#34;previous_ooxml_version&#34; in component.data:
            init_args.update(
                {
                    &#34;previous_ooxml_version&#34;: component.data[&#34;previous_ooxml_version&#34;]
                }
            )
        if &#34;story_id&#34; in component.data:
            init_args.update(
                {
                    &#34;story_id&#34;: component.data[&#34;story_id&#34;]
                }
            )
        if len(kwargs.keys()) &gt; 0:
            init_args.update(kwargs)
        return cls(**init_args)

    def serialize(self):
        self.update()
        data = {
            &#34;filename&#34;: self.filename,
            &#34;object_name&#34;: self.object_name,
            &#34;endpoint_id&#34;: self.endpoint_map.endpoint_id,
            &#34;document_ooxml_id&#34;: self.document_ooxml_id,
            &#34;object_ooxml_id&#34;: self.object_ooxml_id,
            &#34;story_id&#34;: self.story_id
        }
        if self.file_last_modified:
            data.update(
                {
                    &#34;file_last_modified&#34;: self.file_last_modified.isoformat()
                }
            )
        if self.previous_ooxml_version:
            data.update(
                {
                    &#34;previous_ooxml_version&#34;: self.previous_ooxml_version
                }
            )
        widget = presalytics.story.outline.Widget(
            name=self.name,
            kind=self.__component_kind__,
            data=data,
            plugins=None
        )
        return widget</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase">OoxmlWidgetBase</a></li>
<li><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="presalytics.OoxmlFileWidget.update"><code class="name flex">
<span>def <span class="ident">update</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>If the file is available locally, this renders that updated file and pushes
the updated rendering data to the server</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L272-L329" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def update(self):
    &#34;&#34;&#34;
    If the file is available locally, this renders that updated file and pushes
    the updated rendering data to the server
    &#34;&#34;&#34;
    story: &#39;ApiStory&#39;
    page: &#39;Page&#39;
    widget: &#39;Widget&#39;

    search_paths = list(set(presalytics.autodiscover_paths))
    if os.getcwd() not in search_paths:
        search_paths.append(os.getcwd())
    for path in search_paths:
        fpath = os.path.join(path, self.filename)
        if os.path.exists(fpath):
            # update only the file has been modified sine last time
            this_file_last_modified = datetime.datetime.utcfromtimestamp(os.path.getmtime(fpath)).astimezone(tz=datetime.timezone.utc)
            if self.file_last_modified is None or self.file_last_modified &lt;= this_file_last_modified:
                client = self.get_client()
                story, status, headers = client.story.story_id_file_post_with_http_info(self.story_id, file=fpath, replace_existing=True, obsolete_id=self.document_ooxml_id)
                if status &gt;= 299:
                    raise presalytics.lib.exceptions.ApiError()
                self.previous_ooxml_version = {
                    &#34;document_ooxml_id&#34;: self.document_ooxml_id,
                    &#34;object_ooxml_id&#34;: self.object_ooxml_id
                }
                new_outline = presalytics.story.outline.StoryOutline.load(story.outline)
                for page in new_outline.pages:
                    found = False
                    for widget in page.widgets:
                        if widget.name == self.object_name:
                            self.document_ooxml_id = widget.data[&#34;document_ooxml_id&#34;]
                            found = True
                            break
                    if found:
                        break
                if not found:
                    message = &#34;Unable to find widget object name {0} in new story outline.  Has this widget been deleted?&#34;.format(self.object_name)
                    raise presalytics.lib.exceptions.ValidationError(message)

                # Get object tree, compare to object name
                child_tree = client.ooxml_automation.documents_childobjects_get_id(self.document_ooxml_id)
                target_dto = None

                try:
                    target_dto = next(x for x in child_tree if x.entity_name == self.object_name)
                except StopIteration:
                    pass
                # if name not in object or _object_name is none, get first item of type in end_point id
                if not target_dto:
                    try:
                        target_dto = next(x for x in child_tree if x.object_type.split(&#34;.&#34;)[1] == self.endpoint_map.endpoint_id)
                    except StopIteration:
                        message = &#34;Child tree of document {0} does not have a child object of type {1} or name {2}.&#34;.format(self.ooxml_id, self.endpoint_map.endpoint_id, self.object_name)
                        raise presalytics.lib.exceptions.InvalidConfigurationError(message)
                # set widget parameters for recreation server-side (without file)
                self.object_ooxml_id = target_dto.entity_id
                self.file_last_modified = presalytics.lib.util.roundup_date_modified(this_file_last_modified)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase">OoxmlWidgetBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.serialize">serialize</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.to_html" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.to_html">to_html</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.OoxmlTheme"><code class="flex name class">
<span>class <span class="ident">OoxmlTheme</span></span>
<span>(</span><span>**kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>A script plugin render configures templated scripts to append to the body
tag of an html document</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/ooxml.py#L7-L25" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class OoxmlTheme(presalytics.lib.plugins.reveal_theme.RevealCustomTheme):
    __plugin_name__ = &#39;ooxml-theme&#39;

    def to_style(self, config, **kwargs):
        base_path = os.path.join(os.path.dirname(__file__), &#39;scss&#39;)
        if os.name == &#34;nt&#34;:
            import_path = posixpath.join(*base_path.split(&#39;\\&#39;))
        else:
            import_path = base_path
        scss_file = os.path.join(base_path, &#39;overrides.tmpl&#39;)
        config.update({&#39;path&#39;: import_path})
        with open(scss_file, &#39;r&#39;) as file:
            scss_template_string = file.read()
        scss_string = scss_template_string.format(**config)
        new_css = sass.compile(string=scss_string)
        style_string = &#34;&lt;style&gt;\n{0}\n&lt;/style&gt;&#34;.format(new_css)
        font_names = [config[&#34;headingFont&#34;], config[&#34;bodyFont&#34;]]
        links = self.get_fonts(font_names)
        return links + style_string</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.plugins.reveal_theme.RevealCustomTheme" href="/python-client/presalytics/lib/plugins/reveal_theme.html#presalytics.lib.plugins.reveal_theme.RevealCustomTheme">RevealCustomTheme</a></li>
<li><a title="presalytics.lib.plugins.base.StylePlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.StylePlugin">StylePlugin</a></li>
<li><a title="presalytics.lib.plugins.base.PluginBase" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase">PluginBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.plugins.reveal_theme.RevealCustomTheme" href="/python-client/presalytics/lib/plugins/reveal_theme.html#presalytics.lib.plugins.reveal_theme.RevealCustomTheme">RevealCustomTheme</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.plugins.reveal_theme.RevealCustomTheme.defaults" href="/python-client/presalytics/lib/plugins/reveal_theme.html#presalytics.lib.plugins.reveal_theme.RevealCustomTheme.defaults">defaults</a></code></li>
<li><code><a title="presalytics.lib.plugins.reveal_theme.RevealCustomTheme.fonts_base_url" href="/python-client/presalytics/lib/plugins/reveal_theme.html#presalytics.lib.plugins.reveal_theme.RevealCustomTheme.fonts_base_url">fonts_base_url</a></code></li>
<li><code><a title="presalytics.lib.plugins.reveal_theme.RevealCustomTheme.get_tag" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase.get_tag">get_tag</a></code></li>
<li><code><a title="presalytics.lib.plugins.reveal_theme.RevealCustomTheme.to_style" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.StylePlugin.to_style">to_style</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.PageTemplateBase"><code class="flex name class">
<span>class <span class="ident">PageTemplateBase</span></span>
<span>(</span><span>page: Page, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Inherit from this base class to render templates to html via the
presalytics.story.revealer.Revealer class.</p>
<h2 id="parameters">Parameters:</h2>
<p>page: Page
A presalytics.story.outline.Page object for instalizing the class</p>
<h2 id="attributes">Attributes:</h2>
<p>outline_page: Page
A presalytics.story.outline.Page object</p>
<p>widgets: List[WidgetComponentBase]
A list widget that will be loaded into templates and rendered via placeholders.
These widgets must have a "to_html(self, data, **kwargs)" method.</p>
<p>css: List[str]
A list of keys in dot notation that point to links in the ALLOWED_STYLES dictionary
in the presalytics.lib.templates.base module.</p>
<p>js: List[str]
A list of keys in dot notation that point to links in the ALLOWED_SCRIPTS dictionary
in the presalytics.lib.templates.base module.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L199-L298" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class PageTemplateBase(ComponentBase):
    &#34;&#34;&#34;
    Inherit from this base class to render templates to html via the
    presalytics.story.revealer.Revealer class.

    Parameters:
    ----------
    page: Page
        A presalytics.story.outline.Page object for instalizing the class

    Attributes:
    ----------
    outline_page: Page
        A presalytics.story.outline.Page object

    widgets: List[WidgetComponentBase]
        A list widget that will be loaded into templates and rendered via placeholders.
        These widgets must have a &#34;to_html(self, data, **kwargs)&#34; method.

    css: List[str]
        A list of keys in dot notation that point to links in the ALLOWED_STYLES dictionary
        in the presalytics.lib.templates.base module.

    js: List[str]
        A list of keys in dot notation that point to links in the ALLOWED_SCRIPTS dictionary
        in the presalytics.lib.templates.base module.
    &#34;&#34;&#34;

    outline_page: &#39;Page&#39;
    widgets: typing.List[&#39;WidgetBase&#39;]
    plugins: typing.List[typing.Dict]

    __component_type__ = &#39;page&#39;

    def __init__(self, page: &#39;Page&#39;, **kwargs) -&gt; None:
        super(PageTemplateBase, self).__init__(**kwargs)
        self.outline_page = page
        self.widgets = self.get_page_widgets(self.outline_page)
        

    @abc.abstractmethod
    def render(self, **kwargs) -&gt; str:
        &#34;&#34;&#34;
        Returns valid html that renders the template in a broswer with data loaded from widgets.

        Parameters:
        ----------
        widgets: Sequence[WidgetComponentBase]
            List of widget instances a one to many different class that inhereit from the WidgetComponentBase
            abstract class. Defaults tot he widget list that the class as initilazed with.

        **kwargs:
            Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.
            these keyword arguments should be geinvariant through successive updates to the chart.  For example,
            keycloak argument should control the styling of the widget, which should not change as the data in
            the object (e.g., a chart) is updated.  Keyword arguments are loaded via additional_properties
            parameter in in the presalytics.story.outline.Widget object.

        Returns
        ----------
        A string of containing an html fragment that will be loaded into a template in successive operations
        &#34;&#34;&#34;
        raise NotImplementedError

    def load_widget(self, widget: &#39;Widget&#39;):
        &#34;&#34;&#34;
        Converts a presalytics.story.outline.Widget object to a subclass of WidgetComponentBase
        via a presalytics.story.loaders.WidgetLoaderBase object.
        &#34;&#34;&#34;
        class_key = &#34;widget.&#34; + widget.kind
        key = class_key + &#34;.&#34; + widget.name
        if presalytics.COMPONENTS.get_instance(key):
            widget_instance = presalytics.COMPONENTS.get_instance(key)
        else:
            klass = presalytics.COMPONENTS.get(class_key)
            deserialize_method = getattr(klass, &#34;deserialize&#34;, None)
            if callable(deserialize_method):
                widget_instance = deserialize_method(widget, client_info=self.client_info)
            else:
                message = &#34;Widget component instance or class (kind) {0} unavailable in component registry&#34;.format(key)
                raise presalytics.lib.exceptions.MissingConfigException(message)
        return widget_instance

    def get_page_widgets(self, page: &#39;Page&#39;):
        &#34;&#34;&#34;
        Converts the widgets within a presaltytics.story.outline.Page object to a list
        of widgets subclassed from WidgetComponentBase
        &#34;&#34;&#34;
        widget_instances = []
        for widget_outline in page.widgets:
            next_widget = self.load_widget(widget_outline)
            widget_instances.append(next_widget)
        return widget_instances
    
    def serialize(self):
        return self.outline_page.dump()

    @classmethod
    def deseriailize(cls, component, **kwargs):
        return cls(page=component)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="presalytics.lib.templates.base.JinjaTemplateBuilder" href="/python-client/presalytics/lib/templates/base.html#presalytics.lib.templates.base.JinjaTemplateBuilder">JinjaTemplateBuilder</a></li>
<li><a title="presalytics.lib.templates.base.WidgetPage" href="/python-client/presalytics/lib/templates/base.html#presalytics.lib.templates.base.WidgetPage">WidgetPage</a></li>
</ul>
<h3>Static methods</h3>
<dl>
<dt id="presalytics.PageTemplateBase.deseriailize"><code class="name flex">
<span>def <span class="ident">deseriailize</span></span>(<span>component, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L296-L298" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def deseriailize(cls, component, **kwargs):
    return cls(page=component)</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.PageTemplateBase.get_page_widgets"><code class="name flex">
<span>def <span class="ident">get_page_widgets</span></span>(<span>self, page: Page)</span>
</code></dt>
<dd>
<section class="desc"><p>Converts the widgets within a presaltytics.story.outline.Page object to a list
of widgets subclassed from WidgetComponentBase</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L282-L291" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_page_widgets(self, page: &#39;Page&#39;):
    &#34;&#34;&#34;
    Converts the widgets within a presaltytics.story.outline.Page object to a list
    of widgets subclassed from WidgetComponentBase
    &#34;&#34;&#34;
    widget_instances = []
    for widget_outline in page.widgets:
        next_widget = self.load_widget(widget_outline)
        widget_instances.append(next_widget)
    return widget_instances</code></pre>
</details>
</dd>
<dt id="presalytics.PageTemplateBase.load_widget"><code class="name flex">
<span>def <span class="ident">load_widget</span></span>(<span>self, widget: Widget)</span>
</code></dt>
<dd>
<section class="desc"><p>Converts a presalytics.story.outline.Widget object to a subclass of WidgetComponentBase
via a presalytics.story.loaders.WidgetLoaderBase object.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L263-L280" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def load_widget(self, widget: &#39;Widget&#39;):
    &#34;&#34;&#34;
    Converts a presalytics.story.outline.Widget object to a subclass of WidgetComponentBase
    via a presalytics.story.loaders.WidgetLoaderBase object.
    &#34;&#34;&#34;
    class_key = &#34;widget.&#34; + widget.kind
    key = class_key + &#34;.&#34; + widget.name
    if presalytics.COMPONENTS.get_instance(key):
        widget_instance = presalytics.COMPONENTS.get_instance(key)
    else:
        klass = presalytics.COMPONENTS.get(class_key)
        deserialize_method = getattr(klass, &#34;deserialize&#34;, None)
        if callable(deserialize_method):
            widget_instance = deserialize_method(widget, client_info=self.client_info)
        else:
            message = &#34;Widget component instance or class (kind) {0} unavailable in component registry&#34;.format(key)
            raise presalytics.lib.exceptions.MissingConfigException(message)
    return widget_instance</code></pre>
</details>
</dd>
<dt id="presalytics.PageTemplateBase.render"><code class="name flex">
<span>def <span class="ident">render</span></span>(<span>self, **kwargs) -> str</span>
</code></dt>
<dd>
<section class="desc"><p>Returns valid html that renders the template in a broswer with data loaded from widgets.</p>
<h2 id="parameters">Parameters:</h2>
<p>widgets: Sequence[WidgetComponentBase]
List of widget instances a one to many different class that inhereit from the WidgetComponentBase
abstract class. Defaults tot he widget list that the class as initilazed with.</p>
<p>**kwargs:
Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.
these keyword arguments should be geinvariant through successive updates to the chart.
For example,
keycloak argument should control the styling of the widget, which should not change as the data in
the object (e.g., a chart) is updated.
Keyword arguments are loaded via additional_properties
parameter in in the presalytics.story.outline.Widget object.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>A</code> <code>string</code> of <code>containing</code> <code>an</code> <code>html</code> <code>fragment</code> <code>that</code> <code>will</code> <code>be</code> <code>loaded</code> <code>into</code> <code>a</code> <code>template</code> <code>in</code> <code>successive</code> <code>operations</code></dt>
<dd>&nbsp;</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L239-L261" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@abc.abstractmethod
def render(self, **kwargs) -&gt; str:
    &#34;&#34;&#34;
    Returns valid html that renders the template in a broswer with data loaded from widgets.

    Parameters:
    ----------
    widgets: Sequence[WidgetComponentBase]
        List of widget instances a one to many different class that inhereit from the WidgetComponentBase
        abstract class. Defaults tot he widget list that the class as initilazed with.

    **kwargs:
        Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.
        these keyword arguments should be geinvariant through successive updates to the chart.  For example,
        keycloak argument should control the styling of the widget, which should not change as the data in
        the object (e.g., a chart) is updated.  Keyword arguments are loaded via additional_properties
        parameter in in the presalytics.story.outline.Widget object.

    Returns
    ----------
    A string of containing an html fragment that will be loaded into a template in successive operations
    &#34;&#34;&#34;
    raise NotImplementedError</code></pre>
</details>
</dd>
<dt id="presalytics.PageTemplateBase.serialize"><code class="name flex">
<span>def <span class="ident">serialize</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L293-L294" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def serialize(self):
    return self.outline_page.dump()</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="presalytics.PluginBase"><code class="flex name class">
<span>class <span class="ident">PluginBase</span></span>
<span>(</span><span>**kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>A plugin converts a dictionary of configuration values into an html script.
Typically plugins are are used as reable mapping classes to add script tags to
to a rendered html body.</p>
<h2 id="attributes">Attributes:</h2>
<p><strong>plugin_kind</strong>: str
The <strong>plugin_kind</strong> is a static string that uniquely identifies this plugin to classes
the render story outlines (e.g., presalytics.story.revealer.Revealer).</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/base.py#L15-L67" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class PluginBase(abc.ABC):
    &#34;&#34;&#34;
    A plugin converts a dictionary of configuration values into an html script.
    Typically plugins are are used as reable mapping classes to add script tags to
    to a rendered html body.

    Attributes:
    ----------

    __plugin_kind__: str
        The __plugin_kind__ is a static string that uniquely identifies this plugin to classes
        the render story outlines (e.g., presalytics.story.revealer.Revealer).

    &#34;&#34;&#34;
    __plugin_kind__: str
    __plugin_name__: str
    __dependencies__: typing.List[typing.Dict]

    __dependencies__ = []

    config: typing.Dict

    def __init__(self, **kwargs):
        self.validate_metadata()

    def validate_metadata(self):
        if self.__plugin_kind__ == &#34;&#34; or self.__plugin_name__ == &#34;&#34;:
            message = &#34;Plugin class {0} has not defined either __plugin_kind__ or __plugin_name__ metadata&#34;.format(self.__class__.__name__)
            raise presalytics.lib.exceptions.ValidationError(message)

    @abc.abstractmethod
    def get_tag(self, config: typing.Dict[str, typing.Any], **kwargs) -&gt; str:
        &#34;&#34;&#34;
        Generic method to be implemented by all inheriting classes. Allow plugin
        to be render without knowledge of the underlying plugin kind.

        Parameters:
        ----------

        config: Dict
            A set configuration values for the plugin.  Required keys should be
            specified by the docstring of the inheriting classes.
            Can be implemented via a mypy_extensions.TypedDict object if warranted.
            The presalytics.story.outline.Plugin&#39;s config element should be passed
            as this value to render the script.

        Returns:
        ----------

        A string carrying a html script that can be embedded in a html document

        &#34;&#34;&#34;
        raise NotImplementedError</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="presalytics.lib.plugins.base.ScriptPlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.ScriptPlugin">ScriptPlugin</a></li>
<li><a title="presalytics.lib.plugins.base.StylePlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.StylePlugin">StylePlugin</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="presalytics.PluginBase.get_tag"><code class="name flex">
<span>def <span class="ident">get_tag</span></span>(<span>self, config: Dict[str, Any], **kwargs) -> str</span>
</code></dt>
<dd>
<section class="desc"><p>Generic method to be implemented by all inheriting classes. Allow plugin
to be render without knowledge of the underlying plugin kind.</p>
<h2 id="parameters">Parameters:</h2>
<p>config: Dict
A set configuration values for the plugin.
Required keys should be
specified by the docstring of the inheriting classes.
Can be implemented via a mypy_extensions.TypedDict object if warranted.
The presalytics.story.outline.Plugin's config element should be passed
as this value to render the script.</p>
<h2 id="returns">Returns:</h2>
<p>A string carrying a html script that can be embedded in a html document</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/base.py#L45-L67" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@abc.abstractmethod
def get_tag(self, config: typing.Dict[str, typing.Any], **kwargs) -&gt; str:
    &#34;&#34;&#34;
    Generic method to be implemented by all inheriting classes. Allow plugin
    to be render without knowledge of the underlying plugin kind.

    Parameters:
    ----------

    config: Dict
        A set configuration values for the plugin.  Required keys should be
        specified by the docstring of the inheriting classes.
        Can be implemented via a mypy_extensions.TypedDict object if warranted.
        The presalytics.story.outline.Plugin&#39;s config element should be passed
        as this value to render the script.

    Returns:
    ----------

    A string carrying a html script that can be embedded in a html document

    &#34;&#34;&#34;
    raise NotImplementedError</code></pre>
</details>
</dd>
<dt id="presalytics.PluginBase.validate_metadata"><code class="name flex">
<span>def <span class="ident">validate_metadata</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/base.py#L40-L43" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def validate_metadata(self):
    if self.__plugin_kind__ == &#34;&#34; or self.__plugin_name__ == &#34;&#34;:
        message = &#34;Plugin class {0} has not defined either __plugin_kind__ or __plugin_name__ metadata&#34;.format(self.__class__.__name__)
        raise presalytics.lib.exceptions.ValidationError(message)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="presalytics.Renderer"><code class="flex name class">
<span>class <span class="ident">Renderer</span></span>
<span>(</span><span>**kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>This class serves as the primary interface clas for the story components.
Instances of
this interface carry enough information to rendered to html.
Developers, analysts and
users should inherit from base class if they want components to be registered in the
rendering pipeline for presalytics stories.</p>
<p>Instance of this class must:
1. Initialize with a name parameter
2
Serialize to a subclass of presalytics.story.outline.OutlineBase
3. Deserialize from an instance of presalytics.story.OutlineBase
4. Render to html</p>
<p>The <strong>component_type</strong> and <strong>component_name</strong> metadata on subclasses is required in
order for instances to be registered in rendering pipeline for automatic updates</p>
<h2 id="attributes">Attributes:</h2>
<p>name: str
The name of the instance of the component.
Used in component as a key to lookup
instances to re-calcute during rendering</p>
<p>css: List[str]
A list of keys in dot notation that point to links in the ALLOWED_STYLES dictionary
in the presalytics.lib.templates.base module.</p>
<p>js: List[str]
A list of keys in dot notation that point to links in the ALLOWED_SCRIPTS dictionary
in the presalytics.lib.templates.base module.</p>
<p><strong>component_type</strong>: str
The idenifier for the component superclass (e.g. widget, page_template, renderer, theme).
Used for component registration.</p>
<p><strong>component_kind</strong>:
An identifier for this component class.
Used for component registration.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L319-L323" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class Renderer(ComponentBase):
    __component_type__ = &#39;renderer&#39;

    def __init__(self, **kwargs):
        super(Renderer, self).__init__(**kwargs)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="presalytics.story.revealer.Revealer" href="/python-client/presalytics/story/revealer.html#presalytics.story.revealer.Revealer">Revealer</a></li>
</ul>
</dd>
<dt id="presalytics.RevealConfigPlugin"><code class="flex name class">
<span>class <span class="ident">RevealConfigPlugin</span></span>
<span>(</span><span>**kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>A script plugin render configures templated scripts to append to the body
tag of an html document</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/reveal.py#L5-L189" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class RevealConfigPlugin(ext.ScriptPlugin, jinja.JinjaPluginMakerMixin):
    __plugin_name__ = &#39;reveal&#39;

    __dependencies__ = [
        {
            &#39;kind&#39;: &#39;script&#39;,
            &#39;name&#39;: &#39;external_scripts&#39;,
            &#39;config&#39;: {
                &#39;approved_scripts_key&#39;: &#39;reveal.base&#39;
            }
        },
        {
            &#39;kind&#39;: &#39;style&#39;,
            &#39;name&#39;: &#39;external_links&#39;,
            &#39;config&#39;: {
                &#39;approved_styles_key&#39;: &#39;reveal.base&#39;
            }

        }
    ]

    def to_script(self, config, **kwargs):
        reveal_config = self.default_config
        if config.get(&#34;reveal_params&#34;, None):
            reveal_config.update(config.pop(&#34;reveal_params&#34;))
        config.update({&#39;reveal_config&#39;: reveal_config})
        return self.render(config)

    template = &#34;&#34;&#34;
    &lt;script type=&#34;text/javascript&#34;&gt; 
        window.onload = function(e) {
            Reveal.initialize(
                {{ reveal_config|tojson(indent=4) }}
            );
        };
    &lt;/script&gt;
    &#34;&#34;&#34;
    default_config = {
        &#39;controls&#39;: True,  # Display presentation control arrows
        # Help the user learn the controls by providing hints, for example by
        # bouncing the down arrow when they first encounter a vertical slide
        &#39;controlsTutorial&#39;: True,

        # Determines where controls appear, &#34;edges&#34; or &#34;bottom-right&#34; #
        &#39;controlsLayout&#39;: &#39;bottom-right&#39;,

        # Visibility rule for backwards navigation arrows; &#34;faded&#34;, &#34;hidden&#34;
        # or &#34;visible&#34;
        &#39;controlsBackArrows&#39;: &#39;faded&#39;,

        # Display a presentation progress bar
        &#39;progress&#39;: True,

        # Display the page number of the current slide
        &#39;slideNumber&#39;: False,

        # Add the current slide number to the URL hash so that reloading the
        #page/copying the URL will return you to the same slide
        &#39;hash&#39;: False,

        # Push each slide change to the browser history. Implies `hash: true`
        &#39;history&#39;: False,

        # Enable keyboard shortcuts for navigation 
        &#39;keyboard&#39;: True,

        # Enable the slide overview mode
        &#39;overview&#39;: True,

        # Vertical centering of slides
        &#39;center&#39;: True,

        # Enables touch navigation on devices with touch input
        &#39;touch&#39;: True,

        # Loop the presentation
        &#39;loop&#39;: False,

        # Change the presentation direction to be RTL
        &#39;rtl&#39;: False,

        # See https://github.com/hakimel/reveal.js/#navigation-mode
        &#39;navigationMode&#39;: &#39;default&#39;,

        # Randomizes the order of slides each time the presentation loads
        &#39;shuffle&#39;: False,

        # Turns fragments on and off globally
        &#39;fragments&#39;: True,

        # Flags whether to include the current fragment in the URL,
        # so that reloading brings you to the same fragment position #}
        &#39;fragmentInURL&#39;: False,

        # Flags if the presentation is running in an embedded mode,
        # i.e. contained within a limited portion of the screen #}
        &#39;embedded&#39;: False,

        # Flags if we should show a help overlay when the questionmark
        # key is pressed #}
        &#39;help&#39;: True,

        # Flags if speaker notes should be visible to all viewers
        &#39;showNotes&#39;: False,

        # Global override for autoplaying embedded media (video/audio/iframe)
        # - null: Media will only autoplay if data-autoplay is present
        # - true: All media will autoplay, regardless of individual setting
        # - false: No media will autoplay, regardless of individual setting
        &#39;autoPlayMedia&#39;: &#39;null&#39;,

        # Global override for preloading lazy-loaded iframes
        # - null: Iframes with data-src AND data-preload will be loaded when within
        #   the viewDistance, iframes with only data-src will be loaded when visible
        # - true: All iframes with data-src will be loaded when within the viewDistance
        # - false: All iframes with data-src will be loaded only when visible #}
        &#39;preloadIframes&#39;: &#39;null&#39;,

        # Number of milliseconds between automatically proceeding to the
        # next slide, disabled when set to 0, this value can be overwritten
        # by using a data-autoslide attribute on your slides #}
        &#39;autoSlide&#39;: 0,

        # Stop auto-sliding after user input
        &#39;autoSlideStoppable&#39;: True,

        # Use this method for navigation when auto-sliding
        &#39;autoSlideMethod&#39;: &#39;Reveal.navigateNext&#39;,

        # Specify the average time in seconds that you think you will spend
        # presenting each slide. This is used to show a pacing timer in the
        # speaker view 
        &#39;defaultTiming&#39;: 120,

        # Enable slide navigation via mouse wheel
        &#39;mouseWheel&#39;: False,

        # Hide cursor if inactive
        &#39;hideInactiveCursor&#39;: True,

        # Time before the cursor is hidden (in ms)
        &#39;hideCursorTime&#39;: 5000,

        # Hides the address bar on mobile devices
        &#39;hideAddressBar&#39;: True,

        # Opens links in an iframe preview overlay
        #  Add `data-preview-link` and `data-preview-link=&#34;false&#34;` to customise each link
        # individually
        &#39;previewLinks&#39;: False,

        # Transition style
        &#39;transition&#39;: &#39;slide&#39;, # none/fade/slide/convex/concave/zoom

        # Transition speed
        &#39;transitionSpeed&#39;: &#39;default&#39;, # default/fast/slow

        # Transition style for full page slide backgrounds
        &#39;backgroundTransition&#39;: &#39;fade&#39;, # none/fade/slide/convex/concave/zoom

        # Number of slides away from the current that are visible
        &#39;viewDistance&#39;: 3,

        # Parallax background image
        &#39;parallaxBackgroundImage&#39;: &#39;&#39;, # e.g. &#34;&#39;https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg&#39;&#34;

        # Parallax background size
        &#39;parallaxBackgroundSize&#39;: &#39;&#39;, # CSS syntax, e.g. &#34;2100px 900px&#34;

        # Number of pixels to move the parallax background per slide
        # - Calculated automatically unless specified
        # - Set to 0 to disable movement along an axis 
        &#39;parallaxBackgroundHorizontal&#39;: &#39;null&#39;,
        &#39;parallaxBackgroundVertical&#39;: &#39;null&#39;,

        # The display mode that will be used to show slides
        &#39;display&#39;: &#39;block&#39;,

        # Allow for responsive presenation formats
        &#39;width&#39;: &#34;100%&#34;,
        &#39;height&#39;: &#34;100%&#34;,
        &#39;margin&#39;: 0,
        &#39;minScale&#39;: 1,
        &#39;maxScale&#39;: 1
    }</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.plugins.base.ScriptPlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.ScriptPlugin">ScriptPlugin</a></li>
<li><a title="presalytics.lib.plugins.base.PluginBase" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase">PluginBase</a></li>
<li>abc.ABC</li>
<li><a title="presalytics.lib.plugins.jinja.JinjaPluginMakerMixin" href="/python-client/presalytics/lib/plugins/jinja.html#presalytics.lib.plugins.jinja.JinjaPluginMakerMixin">JinjaPluginMakerMixin</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.RevealConfigPlugin.default_config"><code class="name">var <span class="ident">default_config</span></code></dt>
<dd>
<section class="desc"><p>dict() -&gt; new empty dictionary
dict(mapping) -&gt; new dictionary initialized from a mapping object's
(key, value) pairs
dict(iterable) -&gt; new dictionary initialized as if via:
d = {}
for k, v in iterable:
d[k] = v
dict(**kwargs) -&gt; new dictionary initialized with the name=value pairs
in the keyword argument list.
For example:
dict(one=1, two=2)</p></section>
</dd>
<dt id="presalytics.RevealConfigPlugin.template"><code class="name">var <span class="ident">template</span></code></dt>
<dd>
<section class="desc"><p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to sys.getdefaultencoding().
errors defaults to 'strict'.</p></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.plugins.base.ScriptPlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.ScriptPlugin">ScriptPlugin</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.plugins.base.ScriptPlugin.get_tag" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase.get_tag">get_tag</a></code></li>
<li><code><a title="presalytics.lib.plugins.base.ScriptPlugin.to_script" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.ScriptPlugin.to_script">to_script</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.RevealCustomTheme"><code class="flex name class">
<span>class <span class="ident">RevealCustomTheme</span></span>
<span>(</span><span>**kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>A script plugin render configures templated scripts to append to the body
tag of an html document</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/reveal_theme.py#L9-L102" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class RevealCustomTheme(presalytics.lib.plugins.base.StylePlugin):
    __plugin_name__ = &#39;reveal_custom_theme&#39;
    defaults: typing.Dict[str, str]

    fonts_base_url = &#39;https://fonts.googleapis.com/css?family={0}&#39;

    def to_style(self, config, **kwargs):
        scss_variables = self.defaults
        scss_variables.update(config)
        scss_string = self.get_base_scss(scss_variables)
        new_css = sass.compile(string=scss_string)
        style_string = &#34;&lt;style&gt;\n{0}\n&lt;/style&gt;&#34;.format(new_css)
        links = self.get_fonts(config[&#34;fonts&#34;])
        return links + style_string

    def get_fonts(self, fonts: typing.List[str]):
        links = &#34;&#34;
        for font in fonts:
            link = self.get_font_link(font)
            if link:
                links = links + link + &#34;\n&#34;
        return links

    def get_font_link(self, font_name) -&gt; typing.Optional[str]:
        test_url = self.fonts_base_url.format(font_name)
        r = requests.get(test_url)
        if r.status_code == 200:
            return &#39;&lt;link href=&#34;{0}&#34; rel=&#34;stylesheet&#34;&gt;&#39;.format(test_url)
        else:
            return None

    def get_base_scss(self, scss_variables):
        scss_folder = os.path.join(os.path.dirname(__file__), &#34;scss&#34;)
        mixins_file = os.path.join(scss_folder, &#34;reveal-mixins.scss&#34;)
        settings_file = os.path.join(scss_folder, &#34;reveal-settings.scss&#34;)
        theme_file = os.path.join(scss_folder, &#34;reveal-theme.scss&#34;)
        overrides_file = os.path.join(scss_folder, &#34;overrides.scss.tmpl&#34;)

        with open(mixins_file, &#39;r&#39;) as m:
            mixins = m.read()

        with open(settings_file, &#39;r&#39;) as s:
            settings = s.read()

        with open(theme_file, &#39;r&#39;) as t:
            theme = t.read()

        with open(overrides_file, &#39;r&#39;) as o:
            overrides_template = o.read()

        overrides = overrides_template.format(**scss_variables)

        scss_string = &#34;{0}\n{1}\n{2}\n{3}&#34;.format(mixins, settings, overrides, theme)
        return scss_string

    # Defaults to white theme parameters
    defaults = {
        # Background of the presentation
        &#34;background_color&#34;: &#34;#2b2b2b&#34;,

        # Primary/body text
        &#34;main_font&#34;: &#39;Lato&#39;,
        &#34;main_font_size&#34;: &#34;inherit&#34;,
        &#34;main_color&#34;: &#34;#eee&#34;,

        # Vertical spacing between blocks of text
        &#34;block_margin&#34;: &#34;20px&#34;,

        # Headings
        &#34;heading_margin&#34;: &#34;0 0 $blockMargin 0&#34;,
        &#34;heading_font&#34;: &#39;Lato&#39;,
        &#34;heading_color&#34;: &#34;#eee&#34;,
        &#34;heading_line_height&#34;: &#34;1.2&#34;,
        &#34;heading_letter_spacing&#34;: &#34;normal&#34;,
        &#34;heading_text_transform&#34;: &#34;none&#34;,
        &#34;heading_text_shadow&#34;: &#34;none&#34;,
        &#34;heading_font_weight&#34;: &#34;normal&#34;,

        &#34;heading_one_text_shadow&#34;: &#34;$headingTextShadow&#34;,
        &#34;heading_one_size&#34;: &#34;3.77em&#34;,
        &#34;heading_two_size&#34;: &#34;2.11em&#34;,
        &#34;heading_three_size&#34;: &#34;1.55em&#34;,
        &#34;heading_four_size&#34;: &#34;1.00em&#34;,

        &#34;code_font&#34;: &#34;monospace&#34;,

        # Links and actions
        &#34;link_color&#34;: &#34;#13DAEC&#34;,
        &#34;linkColorHover&#34;: &#34;lighten( $linkColor, 20% )&#34;,

        # Text selection
        &#34;selection_background_color&#34;: &#34;#FF5E99&#34;,
        &#34;selection_color&#34;: &#34;#fff&#34;
    }</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.plugins.base.StylePlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.StylePlugin">StylePlugin</a></li>
<li><a title="presalytics.lib.plugins.base.PluginBase" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase">PluginBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="presalytics.lib.plugins.ooxml.OoxmlTheme" href="/python-client/presalytics/lib/plugins/ooxml.html#presalytics.lib.plugins.ooxml.OoxmlTheme">OoxmlTheme</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.RevealCustomTheme.defaults"><code class="name">var <span class="ident">defaults</span></code></dt>
<dd>
<section class="desc"><p>dict() -&gt; new empty dictionary
dict(mapping) -&gt; new dictionary initialized from a mapping object's
(key, value) pairs
dict(iterable) -&gt; new dictionary initialized as if via:
d = {}
for k, v in iterable:
d[k] = v
dict(**kwargs) -&gt; new dictionary initialized with the name=value pairs
in the keyword argument list.
For example:
dict(one=1, two=2)</p></section>
</dd>
<dt id="presalytics.RevealCustomTheme.fonts_base_url"><code class="name">var <span class="ident">fonts_base_url</span></code></dt>
<dd>
<section class="desc"><p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to sys.getdefaultencoding().
errors defaults to 'strict'.</p></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.RevealCustomTheme.get_base_scss"><code class="name flex">
<span>def <span class="ident">get_base_scss</span></span>(<span>self, scss_variables)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/reveal_theme.py#L40-L62" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_base_scss(self, scss_variables):
    scss_folder = os.path.join(os.path.dirname(__file__), &#34;scss&#34;)
    mixins_file = os.path.join(scss_folder, &#34;reveal-mixins.scss&#34;)
    settings_file = os.path.join(scss_folder, &#34;reveal-settings.scss&#34;)
    theme_file = os.path.join(scss_folder, &#34;reveal-theme.scss&#34;)
    overrides_file = os.path.join(scss_folder, &#34;overrides.scss.tmpl&#34;)

    with open(mixins_file, &#39;r&#39;) as m:
        mixins = m.read()

    with open(settings_file, &#39;r&#39;) as s:
        settings = s.read()

    with open(theme_file, &#39;r&#39;) as t:
        theme = t.read()

    with open(overrides_file, &#39;r&#39;) as o:
        overrides_template = o.read()

    overrides = overrides_template.format(**scss_variables)

    scss_string = &#34;{0}\n{1}\n{2}\n{3}&#34;.format(mixins, settings, overrides, theme)
    return scss_string</code></pre>
</details>
</dd>
<dt id="presalytics.RevealCustomTheme.get_font_link"><code class="name flex">
<span>def <span class="ident">get_font_link</span></span>(<span>self, font_name) -> Union[str, NoneType]</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/reveal_theme.py#L32-L38" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_font_link(self, font_name) -&gt; typing.Optional[str]:
    test_url = self.fonts_base_url.format(font_name)
    r = requests.get(test_url)
    if r.status_code == 200:
        return &#39;&lt;link href=&#34;{0}&#34; rel=&#34;stylesheet&#34;&gt;&#39;.format(test_url)
    else:
        return None</code></pre>
</details>
</dd>
<dt id="presalytics.RevealCustomTheme.get_fonts"><code class="name flex">
<span>def <span class="ident">get_fonts</span></span>(<span>self, fonts: List[str])</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/reveal_theme.py#L24-L30" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_fonts(self, fonts: typing.List[str]):
    links = &#34;&#34;
    for font in fonts:
        link = self.get_font_link(font)
        if link:
            links = links + link + &#34;\n&#34;
    return links</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.plugins.base.StylePlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.StylePlugin">StylePlugin</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.plugins.base.StylePlugin.get_tag" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase.get_tag">get_tag</a></code></li>
<li><code><a title="presalytics.lib.plugins.base.StylePlugin.to_style" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.StylePlugin.to_style">to_style</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.Revealer"><code class="flex name class">
<span>class <span class="ident">Revealer</span></span>
<span>(</span><span>story_outline: <a title="presalytics.StoryOutline" href="/python-client/presalytics/index.html#presalytics.StoryOutline">StoryOutline</a>, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>This class renders 'Story Outines' to reveal.js presentations</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L32-L270" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class Revealer(presalytics.story.components.Renderer):
    &#34;&#34;&#34;
    This class renders &#39;Story Outines&#39; to reveal.js presentations
    &#34;&#34;&#34;
    story_outline: &#39;StoryOutline&#39;
    base: lxml.etree.Element
    links: typing.Sequence[lxml.etree.Element]
    plugins: typing.List[typing.Dict]

    __component_kind__ = &#39;revealer&#39;

    def __init__(
            self,
            story_outline: &#39;StoryOutline&#39;,
            **kwargs):
        super(Revealer, self).__init__(**kwargs)
        self.story_outline = story_outline
        logger.info(&#34;Initializing story render for {}&#34;.format(story_outline.title))
        self.story_outline.validate()
        self.base = self.make_base()
        logger.info(&#34;Loading plugins&#34;)
        reveal_plugin_config = {
            &#39;kind&#39;: &#39;script&#39;,
            &#39;name&#39;: &#39;reveal&#39;,
            &#39;config&#39;: {}
        }
        self.update_outline_from_instances()
        self.plugins = [reveal_plugin_config]
        self.get_component_implicit_plugins()
        outline_plugins = presalytics.lib.plugins.base.PluginManager.get_plugins_from_nested_dict(story_outline.to_dict())
        self.plugins.extend(outline_plugins)
        self.plugin_mgr = presalytics.lib.plugins.base.PluginManager(self.plugins)
        logger.info(&#34;Revealer initilized.&#34;)

    @classmethod
    def deserialize(cls, component: &#39;StoryOutline&#39;, **kwargs):
        return cls(component, **kwargs)

    def serialize(self) -&gt; &#39;StoryOutline&#39;:
        self.update_outline_from_instances()
        return self.story_outline

    def update_outline_from_instances(self, sub_dict: typing.Dict = None):
        if not sub_dict:
            sub_dict = self.story_outline.to_dict()
        if sub_dict:
            for key, val in sub_dict.items():
                if key in [&#34;widgets&#34;, &#34;themes&#34;, &#34;pages&#34;]:
                    if isinstance(val, list):
                        for list_item in val:
                            if isinstance(list_item, dict):
                                if &#34;kind&#34; in list_item:
                                    class_key = key.rstrip(&#34;s&#34;) + &#34;.&#34; + list_item[&#34;kind&#34;]
                                    klass = presalytics.COMPONENTS.get(class_key)
                                    if klass:
                                        if &#34;name&#34; in list_item:
                                            instance_key = class_key + &#34;.&#34; + list_item[&#34;name&#34;]
                                            inst = presalytics.COMPONENTS.get_instance(instance_key)
                                            if inst:
                                                self.set_outline_data_from_instance(inst)
                if isinstance(val, dict):
                    if len(val.keys()) &gt; 0:
                        self.update_outline_from_instances(val)
                if isinstance(val, list):
                    for list_item in val:
                        if isinstance(list_item, dict):
                            self.update_outline_from_instances(list_item)

    def get_component_implicit_plugins(self, sub_dict: typing.Dict = None):
        if not sub_dict:
            sub_dict = self.story_outline.to_dict()
        if sub_dict:
            for key, val in sub_dict.items():
                if key in [&#34;widgets&#34;, &#34;themes&#34;, &#34;pages&#34;]:
                    if isinstance(val, list):
                        for list_item in val:
                            if isinstance(list_item, dict):
                                if &#34;kind&#34; in list_item:
                                    class_key = key.rstrip(&#34;s&#34;) + &#34;.&#34; + list_item[&#34;kind&#34;]
                                    klass = presalytics.COMPONENTS.get(class_key)
                                    if klass:
                                        if len(klass.__plugins__) &gt; 0:
                                            self.plugins.extend(klass.__plugins__)
                                                
                if isinstance(val, dict):
                    if len(val.keys()) &gt; 0:
                        self.get_component_implicit_plugins(val)
                if isinstance(val, list):
                    for list_item in val:
                        if isinstance(list_item, dict):
                            self.get_component_implicit_plugins(list_item)

    def set_outline_data_from_instance(self, inst: &#39;ComponentBase&#39;):
        if inst.__component_type__ == &#39;widget&#39;:
            self.set_widget_outline_data(inst)
        if inst.__component_type__ == &#39;page&#39;:
            self.set_page_outline_data(inst)
        if inst.__component_type__ == &#39;theme&#39;:
            self.set_theme_outline_data(inst)

    def set_theme_outline_data(self, inst: &#39;ThemeBase&#39;):
        theme_index = None
        for t in range(0, len(self.story_outline.themes)):
            if inst.name == self.story_outline.themes[t].name:
                theme_index = t
            if theme_index:
                break
        theme_outline = inst.serialize()
        if theme_index:
            self.story_outline.themes[theme_index] = theme_outline    

    def set_page_outline_data(self, inst: &#39;PageTemplateBase&#39;):
        page_index = None
        for p in range(0, len(self.story_outline.pages)):
            if inst.name == self.story_outline.pages[p].name:
                page_index = p
            if page_index:
                break
        page_outline = inst.serialize()
        if page_index:
            self.story_outline.pages[page_index] = page_outline


    def set_widget_outline_data(self, inst: &#39;WidgetBase&#39;):
        widget_index = None
        page_index = None
        for p in range(0, len(self.story_outline.pages)):
            for w in range(0, len(self.story_outline.pages[p].widgets)):
                widget = self.story_outline.pages[p].widgets[w]
                if widget.name == inst.name:
                    page_index = p
                    widget_index = w
                if page_index:
                    break
            if page_index:
                break
        w_outline = inst.serialize()
        if isinstance(page_index, int) and isinstance(widget_index, int):
            self.story_outline.pages[page_index].widgets[widget_index] = w_outline  

    def update_outline(self):
        raise NotImplementedError

    def make_base(self):
        base = lxml.etree.Element(&#34;div&#34;, attrib={&#34;class&#34;: &#34;reveal&#34;})
        lxml.etree.SubElement(base, &#34;div&#34;, attrib={&#34;class&#34;: &#34;slides&#34;})
        return base

    def package_as_standalone(self):
        pres = self.render()
        body = E.BODY()
        body.append(pres)
        body = self.strip_unauthorized_scripts(body)
        for scripts in self.plugin_mgr.get_scripts():
            lxml_scripts = lxml.html.fragments_fromstring(scripts)
            for item in lxml_scripts:
                body.append(item)
        head = E.HEAD()
        for link in self.plugin_mgr.get_styles():
            lxml_links = lxml.html.fragments_fromstring(link)
            for item in lxml_links:
                head.append(item)
        head = self.strip_unauthorized_scripts(head)
        html = E.HTML(
            head,
            body
        )
        return lxml.html.tostring(html, pretty_print=True)

    # def render_plugin(self, plugin):
    #     plugin_type = plugin[&#39;type&#39;]
    #     plugin_config = plugin[&#39;config&#39;]
    #     plugin_class = self.plugin_loader.load(plugin_type)
    #     script_string = plugin_class().to_string(plugin_config)
    #     return lxml.html.fragment_fromstring(script_string)

    def strip_unauthorized_scripts(self, body):
        allowed_scripts = presalytics.lib.plugins.external.ALLOWED_SCRIPTS.flatten().values()
        script_elements = body.findall(&#34;.//script&#34;)
        for ele in script_elements:
            try:
                link = ele.get(&#34;src&#34;)
            except KeyError:
                ele.getparent().remove(ele)
            if link not in allowed_scripts:
                ele.getparent().remove(ele)
        return body

    def update_info(self):
        info = self.story_outline.info
        info.date_modified = datetime.datetime.utcnow()

    def render(self):
        &#34;&#34;&#34;
        This method returns a t
        &#34;&#34;&#34;
        reveal_base = self.base
        for page in self.story_outline.pages:
            slides_container = reveal_base[0]
            slide = lxml.etree.SubElement(slides_container, &#34;section&#34;)
            page_html = self.render_page(page)
            slide_fragment = lxml.html.fragment_fromstring(page_html)
            slide.append(slide_fragment)
        return reveal_base

    def render_page(self, page: &#39;Page&#39;) -&gt; str:
        class_key = &#34;page.&#34; + page.kind
        key = class_key + &#34;.&#34; + page.name
        if presalytics.COMPONENTS.get_instance(key):
            page_instance = presalytics.COMPONENTS.get_instance(key)
        else:
            klass = presalytics.COMPONENTS.get(class_key)
            deserialize_method = getattr(klass, &#34;deserialize&#34;, None)
            if callable(deserialize_method):
                page_instance = deserialize_method(page, client_info=self.client_info)
            else:
                message = &#39;Page component instance or class (kind) &#34;{0}&#34; unavailable in component registry&#39;.format(key)
                raise presalytics.lib.exceptions.MissingConfigException(message)
        return page_instance.render()

    def present(self, files_path=None, debug=True, port=8082, host=&#39;127.0.0.1&#39;):
        logger.info(&#34;Building story rendering at http://{0}:{1}&#34;.format(host, port))
        if not files_path:
            files_path = tempfile.gettempdir()
        logger.info(&#34;Buidling standalone package for local rendering.&#34;)
        html = self.package_as_standalone().decode(&#39;utf-8&#39;)
        id = presalytics.story.util.to_title_case(self.story_outline.title)
        if id == &#39;&#39;:
            id = &#39;blank&#39;
        server = presalytics.story.server.LocalServer(host=host, debug=debug, port=port, root_path=files_path)
        pkg_templates_dir = os.path.join(os.path.dirname(os.path.dirname(__file__)), &#34;lib&#34;, &#34;templates&#34;)
        shutil.copy(os.path.join(pkg_templates_dir, &#34;favicon.ico&#34;), os.path.join(files_path, &#34;presalytics&#34;, &#34;static&#34;))
        html_file = os.path.join(files_path, &#34;presalytics&#34;, &#34;templates&#34;, id + &#39;.html&#39;)
        with open(html_file, &#39;w&#39;) as file:
            file.write(html)
        address = &#34;http://{}:{}/story/{}&#34;.format(host, port, id)
        logger.info(&#34;Opening browser tab...&#34;)
        presalytics.story.server.Browser(address).start()
        server.run()</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.components.Renderer" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer">Renderer</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Static methods</h3>
<dl>
<dt id="presalytics.Revealer.deserialize"><code class="name flex">
<span>def <span class="ident">deserialize</span></span>(<span>component: <a title="presalytics.StoryOutline" href="/python-client/presalytics/index.html#presalytics.StoryOutline">StoryOutline</a>, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L66-L68" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def deserialize(cls, component: &#39;StoryOutline&#39;, **kwargs):
    return cls(component, **kwargs)</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.Revealer.get_component_implicit_plugins"><code class="name flex">
<span>def <span class="ident">get_component_implicit_plugins</span></span>(<span>self, sub_dict: Dict = None)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L100-L122" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_component_implicit_plugins(self, sub_dict: typing.Dict = None):
    if not sub_dict:
        sub_dict = self.story_outline.to_dict()
    if sub_dict:
        for key, val in sub_dict.items():
            if key in [&#34;widgets&#34;, &#34;themes&#34;, &#34;pages&#34;]:
                if isinstance(val, list):
                    for list_item in val:
                        if isinstance(list_item, dict):
                            if &#34;kind&#34; in list_item:
                                class_key = key.rstrip(&#34;s&#34;) + &#34;.&#34; + list_item[&#34;kind&#34;]
                                klass = presalytics.COMPONENTS.get(class_key)
                                if klass:
                                    if len(klass.__plugins__) &gt; 0:
                                        self.plugins.extend(klass.__plugins__)
                                            
            if isinstance(val, dict):
                if len(val.keys()) &gt; 0:
                    self.get_component_implicit_plugins(val)
            if isinstance(val, list):
                for list_item in val:
                    if isinstance(list_item, dict):
                        self.get_component_implicit_plugins(list_item)</code></pre>
</details>
</dd>
<dt id="presalytics.Revealer.make_base"><code class="name flex">
<span>def <span class="ident">make_base</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L175-L178" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def make_base(self):
    base = lxml.etree.Element(&#34;div&#34;, attrib={&#34;class&#34;: &#34;reveal&#34;})
    lxml.etree.SubElement(base, &#34;div&#34;, attrib={&#34;class&#34;: &#34;slides&#34;})
    return base</code></pre>
</details>
</dd>
<dt id="presalytics.Revealer.package_as_standalone"><code class="name flex">
<span>def <span class="ident">package_as_standalone</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L180-L199" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def package_as_standalone(self):
    pres = self.render()
    body = E.BODY()
    body.append(pres)
    body = self.strip_unauthorized_scripts(body)
    for scripts in self.plugin_mgr.get_scripts():
        lxml_scripts = lxml.html.fragments_fromstring(scripts)
        for item in lxml_scripts:
            body.append(item)
    head = E.HEAD()
    for link in self.plugin_mgr.get_styles():
        lxml_links = lxml.html.fragments_fromstring(link)
        for item in lxml_links:
            head.append(item)
    head = self.strip_unauthorized_scripts(head)
    html = E.HTML(
        head,
        body
    )
    return lxml.html.tostring(html, pretty_print=True)</code></pre>
</details>
</dd>
<dt id="presalytics.Revealer.present"><code class="name flex">
<span>def <span class="ident">present</span></span>(<span>self, files_path=None, debug=True, port=8082, host='127.0.0.1')</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L252-L270" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def present(self, files_path=None, debug=True, port=8082, host=&#39;127.0.0.1&#39;):
    logger.info(&#34;Building story rendering at http://{0}:{1}&#34;.format(host, port))
    if not files_path:
        files_path = tempfile.gettempdir()
    logger.info(&#34;Buidling standalone package for local rendering.&#34;)
    html = self.package_as_standalone().decode(&#39;utf-8&#39;)
    id = presalytics.story.util.to_title_case(self.story_outline.title)
    if id == &#39;&#39;:
        id = &#39;blank&#39;
    server = presalytics.story.server.LocalServer(host=host, debug=debug, port=port, root_path=files_path)
    pkg_templates_dir = os.path.join(os.path.dirname(os.path.dirname(__file__)), &#34;lib&#34;, &#34;templates&#34;)
    shutil.copy(os.path.join(pkg_templates_dir, &#34;favicon.ico&#34;), os.path.join(files_path, &#34;presalytics&#34;, &#34;static&#34;))
    html_file = os.path.join(files_path, &#34;presalytics&#34;, &#34;templates&#34;, id + &#39;.html&#39;)
    with open(html_file, &#39;w&#39;) as file:
        file.write(html)
    address = &#34;http://{}:{}/story/{}&#34;.format(host, port, id)
    logger.info(&#34;Opening browser tab...&#34;)
    presalytics.story.server.Browser(address).start()
    server.run()</code></pre>
</details>
</dd>
<dt id="presalytics.Revealer.render"><code class="name flex">
<span>def <span class="ident">render</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>This method returns a t</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L224-L235" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def render(self):
    &#34;&#34;&#34;
    This method returns a t
    &#34;&#34;&#34;
    reveal_base = self.base
    for page in self.story_outline.pages:
        slides_container = reveal_base[0]
        slide = lxml.etree.SubElement(slides_container, &#34;section&#34;)
        page_html = self.render_page(page)
        slide_fragment = lxml.html.fragment_fromstring(page_html)
        slide.append(slide_fragment)
    return reveal_base</code></pre>
</details>
</dd>
<dt id="presalytics.Revealer.render_page"><code class="name flex">
<span>def <span class="ident">render_page</span></span>(<span>self, page: Page) -> str</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L237-L250" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def render_page(self, page: &#39;Page&#39;) -&gt; str:
    class_key = &#34;page.&#34; + page.kind
    key = class_key + &#34;.&#34; + page.name
    if presalytics.COMPONENTS.get_instance(key):
        page_instance = presalytics.COMPONENTS.get_instance(key)
    else:
        klass = presalytics.COMPONENTS.get(class_key)
        deserialize_method = getattr(klass, &#34;deserialize&#34;, None)
        if callable(deserialize_method):
            page_instance = deserialize_method(page, client_info=self.client_info)
        else:
            message = &#39;Page component instance or class (kind) &#34;{0}&#34; unavailable in component registry&#39;.format(key)
            raise presalytics.lib.exceptions.MissingConfigException(message)
    return page_instance.render()</code></pre>
</details>
</dd>
<dt id="presalytics.Revealer.serialize"><code class="name flex">
<span>def <span class="ident">serialize</span></span>(<span>self) -> '<a title="presalytics.StoryOutline" href="/python-client/presalytics/index.html#presalytics.StoryOutline">StoryOutline</a>'</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L70-L72" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def serialize(self) -&gt; &#39;StoryOutline&#39;:
    self.update_outline_from_instances()
    return self.story_outline</code></pre>
</details>
</dd>
<dt id="presalytics.Revealer.set_outline_data_from_instance"><code class="name flex">
<span>def <span class="ident">set_outline_data_from_instance</span></span>(<span>self, inst: ComponentBase)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L124-L130" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def set_outline_data_from_instance(self, inst: &#39;ComponentBase&#39;):
    if inst.__component_type__ == &#39;widget&#39;:
        self.set_widget_outline_data(inst)
    if inst.__component_type__ == &#39;page&#39;:
        self.set_page_outline_data(inst)
    if inst.__component_type__ == &#39;theme&#39;:
        self.set_theme_outline_data(inst)</code></pre>
</details>
</dd>
<dt id="presalytics.Revealer.set_page_outline_data"><code class="name flex">
<span>def <span class="ident">set_page_outline_data</span></span>(<span>self, inst: <a title="presalytics.PageTemplateBase" href="/python-client/presalytics/index.html#presalytics.PageTemplateBase">PageTemplateBase</a>)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L143-L152" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def set_page_outline_data(self, inst: &#39;PageTemplateBase&#39;):
    page_index = None
    for p in range(0, len(self.story_outline.pages)):
        if inst.name == self.story_outline.pages[p].name:
            page_index = p
        if page_index:
            break
    page_outline = inst.serialize()
    if page_index:
        self.story_outline.pages[page_index] = page_outline</code></pre>
</details>
</dd>
<dt id="presalytics.Revealer.set_theme_outline_data"><code class="name flex">
<span>def <span class="ident">set_theme_outline_data</span></span>(<span>self, inst: <a title="presalytics.ThemeBase" href="/python-client/presalytics/index.html#presalytics.ThemeBase">ThemeBase</a>)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L132-L141" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def set_theme_outline_data(self, inst: &#39;ThemeBase&#39;):
    theme_index = None
    for t in range(0, len(self.story_outline.themes)):
        if inst.name == self.story_outline.themes[t].name:
            theme_index = t
        if theme_index:
            break
    theme_outline = inst.serialize()
    if theme_index:
        self.story_outline.themes[theme_index] = theme_outline    </code></pre>
</details>
</dd>
<dt id="presalytics.Revealer.set_widget_outline_data"><code class="name flex">
<span>def <span class="ident">set_widget_outline_data</span></span>(<span>self, inst: <a title="presalytics.WidgetBase" href="/python-client/presalytics/index.html#presalytics.WidgetBase">WidgetBase</a>)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L155-L170" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def set_widget_outline_data(self, inst: &#39;WidgetBase&#39;):
    widget_index = None
    page_index = None
    for p in range(0, len(self.story_outline.pages)):
        for w in range(0, len(self.story_outline.pages[p].widgets)):
            widget = self.story_outline.pages[p].widgets[w]
            if widget.name == inst.name:
                page_index = p
                widget_index = w
            if page_index:
                break
        if page_index:
            break
    w_outline = inst.serialize()
    if isinstance(page_index, int) and isinstance(widget_index, int):
        self.story_outline.pages[page_index].widgets[widget_index] = w_outline  </code></pre>
</details>
</dd>
<dt id="presalytics.Revealer.strip_unauthorized_scripts"><code class="name flex">
<span>def <span class="ident">strip_unauthorized_scripts</span></span>(<span>self, body)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L208-L218" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def strip_unauthorized_scripts(self, body):
    allowed_scripts = presalytics.lib.plugins.external.ALLOWED_SCRIPTS.flatten().values()
    script_elements = body.findall(&#34;.//script&#34;)
    for ele in script_elements:
        try:
            link = ele.get(&#34;src&#34;)
        except KeyError:
            ele.getparent().remove(ele)
        if link not in allowed_scripts:
            ele.getparent().remove(ele)
    return body</code></pre>
</details>
</dd>
<dt id="presalytics.Revealer.update_info"><code class="name flex">
<span>def <span class="ident">update_info</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L220-L222" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def update_info(self):
    info = self.story_outline.info
    info.date_modified = datetime.datetime.utcnow()</code></pre>
</details>
</dd>
<dt id="presalytics.Revealer.update_outline"><code class="name flex">
<span>def <span class="ident">update_outline</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L172-L173" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def update_outline(self):
    raise NotImplementedError</code></pre>
</details>
</dd>
<dt id="presalytics.Revealer.update_outline_from_instances"><code class="name flex">
<span>def <span class="ident">update_outline_from_instances</span></span>(<span>self, sub_dict: Dict = None)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L74-L98" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def update_outline_from_instances(self, sub_dict: typing.Dict = None):
    if not sub_dict:
        sub_dict = self.story_outline.to_dict()
    if sub_dict:
        for key, val in sub_dict.items():
            if key in [&#34;widgets&#34;, &#34;themes&#34;, &#34;pages&#34;]:
                if isinstance(val, list):
                    for list_item in val:
                        if isinstance(list_item, dict):
                            if &#34;kind&#34; in list_item:
                                class_key = key.rstrip(&#34;s&#34;) + &#34;.&#34; + list_item[&#34;kind&#34;]
                                klass = presalytics.COMPONENTS.get(class_key)
                                if klass:
                                    if &#34;name&#34; in list_item:
                                        instance_key = class_key + &#34;.&#34; + list_item[&#34;name&#34;]
                                        inst = presalytics.COMPONENTS.get_instance(instance_key)
                                        if inst:
                                            self.set_outline_data_from_instance(inst)
            if isinstance(val, dict):
                if len(val.keys()) &gt; 0:
                    self.update_outline_from_instances(val)
            if isinstance(val, list):
                for list_item in val:
                    if isinstance(list_item, dict):
                        self.update_outline_from_instances(list_item)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="presalytics.StoryOutline"><code class="flex name class">
<span>class <span class="ident">StoryOutline</span></span>
<span>(</span><span>presalytics_story, info, pages, description, title, themes, plugins=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Helper class that provides a standard way to create an ABC using
inheritance.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/outline.py#L221-L256" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class StoryOutline(OutlineBase):
    presalytics_story: str
    info: Info
    pages: typing.Sequence[Page]
    description: str
    title: str
    themes: typing.Sequence[Theme]

    __required__ = [
        &#39;presalytics_story&#39;,
        &#39;info&#39;,
        &#39;pages&#39;,
        &#39;title&#39;
    ]

    def __init__(self, presalytics_story, info, pages, description, title, themes, plugins=None, **kwargs):
        super(StoryOutline, self).__init__(**kwargs)
        self.presalytics_story = presalytics_story
        self.info = Info.deserialize(info)
        self.pages = [Page.deserialize(x) for x in pages]
        if description:
            self.description = description
        else:
            self.description = &#34;&#34;
        if title:
            self.title = title
        else:
            self.title = &#34;&#34;
        if themes:
            self.themes = [Theme.deserialize(x) for x in themes]
        else:
            self.themes = []
        if plugins:
            self.plugins = [Plugin.deserialize(x) for x in plugins]
        else:
            self.plugins = []</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.outline.OutlineBase" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.OutlineBase">OutlineBase</a></li>
<li>abc.ABC</li>
</ul>
</dd>
<dt id="presalytics.ThemeBase"><code class="flex name class">
<span>class <span class="ident">ThemeBase</span></span>
<span>(</span><span>**kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Themes are containers for plugins should be rendered once
across the entire document.
The init method should configure
parameters with get passed to plugins via serialization and
deserialization.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L301-L316" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class ThemeBase(ComponentBase):
    &#34;&#34;&#34;
    Themes are containers for plugins should be rendered once
    across the entire document.  The init method should configure
    parameters with get passed to plugins via serialization and 
    deserialization.
    &#34;&#34;&#34;
    plugins: typing.Optional[typing.List[&#39;Plugin&#39;]]

    __component_type__ = &#39;theme&#39;

    def __init__(self, **kwargs):
        pass

    def render(self, **kwargs):
        pass</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="presalytics.lib.themes.ooxml.OoxmlTheme" href="/python-client/presalytics/lib/themes/ooxml.html#presalytics.lib.themes.ooxml.OoxmlTheme">OoxmlTheme</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="presalytics.ThemeBase.render"><code class="name flex">
<span>def <span class="ident">render</span></span>(<span>self, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L315-L316" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def render(self, **kwargs):
    pass</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="presalytics.WidgetBase"><code class="flex name class">
<span>class <span class="ident">WidgetBase</span></span>
<span>(</span><span>name, *args, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Inherit from this base class to create widget components that can be rendered to html via the
presalytics.story.revealer.Revealer class.
This component also need to build a method
that allows the widget to be serialzed into a presalytics.story.outline.Widget object.</p>
<h2 id="parameters">Parameters:</h2>
<p>widget: Widget
A presalytics.story.outline.Widget object use for initialized the component class.</p>
<h2 id="attributes">Attributes:</h2>
<p>outline_widget: Widget
A presalytics.story.outline.Widget object</p>
<p>css: List[str]
A list of keys in dot notation that point to links in the ALLOWED_STYLES dictionary
in the presalytics.lib.templates.base module.</p>
<p>js: List[str]
A list of keys in dot notation that point to links in the ALLOWED_SCRIPTS dictionary
in the presalytics.lib.templates.base module.</p>
<p>Note: When inheriting from this base class, call "super().<strong>init</strong>(self, <em>args, </em>*kwargs)" before add your
own custom initialization.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L89-L196" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class WidgetBase(ComponentBase):
    &#34;&#34;&#34;
    Inherit from this base class to create widget components that can be rendered to html via the
    presalytics.story.revealer.Revealer class.  This component also need to build a method
    that allows the widget to be serialzed into a presalytics.story.outline.Widget object.

    Parameters:
    ----------
    widget: Widget
        A presalytics.story.outline.Widget object use for initialized the component class.

    Attributes:
    ----------
    outline_widget: Widget
        A presalytics.story.outline.Widget object

    css: List[str]
        A list of keys in dot notation that point to links in the ALLOWED_STYLES dictionary
        in the presalytics.lib.templates.base module.

    js: List[str]
        A list of keys in dot notation that point to links in the ALLOWED_SCRIPTS dictionary
        in the presalytics.lib.templates.base module.
    &#34;&#34;&#34;
    outline_widget: typing.Optional[&#39;Widget&#39;]

    __component_type__ = &#39;widget&#39;

    def __init__(self, name, *args, **kwargs) -&gt; None:
        &#34;&#34;&#34;
        Note: When inheriting from this base class, call &#34;super().__init__(self, *args, **kwargs)&#34; before add your
        own custom initialization.

        &#34;&#34;&#34;
        super(WidgetBase, self).__init__(*args, **kwargs)
        self.name = name
        self.outline_widget = None

    def render(self, component, **kwargs):
        self.to_html(component, **kwargs)

    @abc.abstractmethod
    def to_html(self, data: typing.Dict = None, **kwargs) -&gt; str:
        &#34;&#34;&#34;
        Returns valid html that renders the widget in a broswer.

        Parameters:
        ----------
        data: Dict
            The data parameter is a dictionary should contain the minimum amount of that is required to
            successfully render the object.  As the widget is update, data control how the disply of
            information changes.
        **kwargs:
            Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.
            these keyword arguments should be geinvariant through successive updates to the chart.  For example,
            keycloak argument should control the styling of the widget, which should not change as the data in
            the object (e.g., a chart) is updated.  Keyword arguments are loaded via additional_properties
            parameter in in the presalytics.story.outline.Widget object.

        Returns
        ----------
        A string of containing an html fragment that will be loaded into a template in successive operations
        &#34;&#34;&#34;
        raise NotImplementedError

    @abc.abstractmethod
    def serialize(self, **kwargs) -&gt; &#39;Widget&#39;:
        &#34;&#34;&#34;
        Creates presalytics.story.outline.Widget object from instance data. This widget should
        have the correct name, data and additional_properties so the same widget can be reconstituted
        via the to_html method, given the same set of data.

        Typically, this method will call an update method that run a local script with updates this
        Widget&#39;s data Dictionary prior being loading into the Widget outline object for serialization.

        Parameters:
        ----------
        **kwargs:
            Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.
            these keyword arguments should be be invariant through successive updates to the chart. Overrides
            for this widgets default additional_properties shoudl be loaded via these keyword argments.

        &#34;&#34;&#34;
        raise NotImplementedError

    @classmethod
    def deserialize(cls, widget: &#39;Widget&#39;, **kwargs) -&gt; &#39;WidgetBase&#39;:
        &#34;&#34;&#34;
        Creates an instance of the widget from the data object in the presalytics.story.outline.Widget
        object. This method exists to ensure widgets can be portable across environments.  To clarify,
        widgets built on the client-side via the __init__ method can be reconstructed server-side via
        the deserialize method.  This allows decoupling of the widget generation/updating of data and
        the rendering of the widget in a UI.  Renderers (e.g., presalytics.story.revealer.Revealer object)
        need not know about how the data get updated, but can update the graphic with data generated by
        the widget when the serialize method is called.

        Parameters:
        ----------

        widget: Widget
            A prealytics.story.outline.Widget object

        Returns:
        ----------

        An instance the widget class
        &#34;&#34;&#34;
        raise NotImplementedError</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="presalytics.lib.widgets.matplotlib.MatplotlibFigure" href="/python-client/presalytics/lib/widgets/matplotlib.html#presalytics.lib.widgets.matplotlib.MatplotlibFigure">MatplotlibFigure</a></li>
<li><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase">OoxmlWidgetBase</a></li>
</ul>
<h3>Static methods</h3>
<dl>
<dt id="presalytics.WidgetBase.deserialize"><code class="name flex">
<span>def <span class="ident">deserialize</span></span>(<span>widget: Widget, **kwargs) -> '<a title="presalytics.WidgetBase" href="/python-client/presalytics/index.html#presalytics.WidgetBase">WidgetBase</a>'</span>
</code></dt>
<dd>
<section class="desc"><p>Creates an instance of the widget from the data object in the presalytics.story.outline.Widget
object. This method exists to ensure widgets can be portable across environments.
To clarify,
widgets built on the client-side via the <strong>init</strong> method can be reconstructed server-side via
the deserialize method.
This allows decoupling of the widget generation/updating of data and
the rendering of the widget in a UI.
Renderers (e.g., presalytics.story.revealer.Revealer object)
need not know about how the data get updated, but can update the graphic with data generated by
the widget when the serialize method is called.</p>
<h2 id="parameters">Parameters:</h2>
<p>widget: Widget
A prealytics.story.outline.Widget object</p>
<h2 id="returns">Returns:</h2>
<p>An instance the widget class</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L174-L196" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def deserialize(cls, widget: &#39;Widget&#39;, **kwargs) -&gt; &#39;WidgetBase&#39;:
    &#34;&#34;&#34;
    Creates an instance of the widget from the data object in the presalytics.story.outline.Widget
    object. This method exists to ensure widgets can be portable across environments.  To clarify,
    widgets built on the client-side via the __init__ method can be reconstructed server-side via
    the deserialize method.  This allows decoupling of the widget generation/updating of data and
    the rendering of the widget in a UI.  Renderers (e.g., presalytics.story.revealer.Revealer object)
    need not know about how the data get updated, but can update the graphic with data generated by
    the widget when the serialize method is called.

    Parameters:
    ----------

    widget: Widget
        A prealytics.story.outline.Widget object

    Returns:
    ----------

    An instance the widget class
    &#34;&#34;&#34;
    raise NotImplementedError</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.WidgetBase.render"><code class="name flex">
<span>def <span class="ident">render</span></span>(<span>self, component, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L127-L128" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def render(self, component, **kwargs):
    self.to_html(component, **kwargs)</code></pre>
</details>
</dd>
<dt id="presalytics.WidgetBase.serialize"><code class="name flex">
<span>def <span class="ident">serialize</span></span>(<span>self, **kwargs) -> 'Widget'</span>
</code></dt>
<dd>
<section class="desc"><p>Creates presalytics.story.outline.Widget object from instance data. This widget should
have the correct name, data and additional_properties so the same widget can be reconstituted
via the to_html method, given the same set of data.</p>
<p>Typically, this method will call an update method that run a local script with updates this
Widget's data Dictionary prior being loading into the Widget outline object for serialization.</p>
<h2 id="parameters">Parameters:</h2>
<p>**kwargs:
Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.
these keyword arguments should be be invariant through successive updates to the chart. Overrides
for this widgets default additional_properties shoudl be loaded via these keyword argments.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L154-L172" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@abc.abstractmethod
def serialize(self, **kwargs) -&gt; &#39;Widget&#39;:
    &#34;&#34;&#34;
    Creates presalytics.story.outline.Widget object from instance data. This widget should
    have the correct name, data and additional_properties so the same widget can be reconstituted
    via the to_html method, given the same set of data.

    Typically, this method will call an update method that run a local script with updates this
    Widget&#39;s data Dictionary prior being loading into the Widget outline object for serialization.

    Parameters:
    ----------
    **kwargs:
        Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.
        these keyword arguments should be be invariant through successive updates to the chart. Overrides
        for this widgets default additional_properties shoudl be loaded via these keyword argments.

    &#34;&#34;&#34;
    raise NotImplementedError</code></pre>
</details>
</dd>
<dt id="presalytics.WidgetBase.to_html"><code class="name flex">
<span>def <span class="ident">to_html</span></span>(<span>self, data: Dict = None, **kwargs) -> str</span>
</code></dt>
<dd>
<section class="desc"><p>Returns valid html that renders the widget in a broswer.</p>
<h2 id="parameters">Parameters:</h2>
<p>data: Dict
The data parameter is a dictionary should contain the minimum amount of that is required to
successfully render the object.
As the widget is update, data control how the disply of
information changes.
**kwargs:
Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.
these keyword arguments should be geinvariant through successive updates to the chart.
For example,
keycloak argument should control the styling of the widget, which should not change as the data in
the object (e.g., a chart) is updated.
Keyword arguments are loaded via additional_properties
parameter in in the presalytics.story.outline.Widget object.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>A</code> <code>string</code> of <code>containing</code> <code>an</code> <code>html</code> <code>fragment</code> <code>that</code> <code>will</code> <code>be</code> <code>loaded</code> <code>into</code> <code>a</code> <code>template</code> <code>in</code> <code>successive</code> <code>operations</code></dt>
<dd>&nbsp;</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L130-L152" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@abc.abstractmethod
def to_html(self, data: typing.Dict = None, **kwargs) -&gt; str:
    &#34;&#34;&#34;
    Returns valid html that renders the widget in a broswer.

    Parameters:
    ----------
    data: Dict
        The data parameter is a dictionary should contain the minimum amount of that is required to
        successfully render the object.  As the widget is update, data control how the disply of
        information changes.
    **kwargs:
        Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.
        these keyword arguments should be geinvariant through successive updates to the chart.  For example,
        keycloak argument should control the styling of the widget, which should not change as the data in
        the object (e.g., a chart) is updated.  Keyword arguments are loaded via additional_properties
        parameter in in the presalytics.story.outline.Widget object.

    Returns
    ----------
    A string of containing an html fragment that will be loaded into a template in successive operations
    &#34;&#34;&#34;
    raise NotImplementedError</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="presalytics.XmlTransformBase"><code class="flex name class">
<span>class <span class="ident">XmlTransformBase</span></span>
<span>(</span><span>function_params: Dict, *args, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Helper class that provides a standard way to create an ABC using
inheritance.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml_editors.py#L13-L22" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class XmlTransformBase(abc.ABC):
    def __init__(self, function_params: typing.Dict, *args, **kwargs):
        self.function_params = function_params

    @abc.abstractmethod
    def transform_function(self, lxml_element: lxml.etree.Element, params: typing.Dict) -&gt; lxml.etree.Element:
        pass

    def execute(self, lxml_element: lxml.etree.Element):
        return self.transform_function(lxml_element, self.function_params)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="presalytics.lib.widgets.ooxml_editors.ChangeShapeColor" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.ChangeShapeColor">ChangeShapeColor</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="presalytics.XmlTransformBase.execute"><code class="name flex">
<span>def <span class="ident">execute</span></span>(<span>self, lxml_element: <cyfunction Element at 0x7f6a06864df0>)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml_editors.py#L21-L22" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def execute(self, lxml_element: lxml.etree.Element):
    return self.transform_function(lxml_element, self.function_params)</code></pre>
</details>
</dd>
<dt id="presalytics.XmlTransformBase.transform_function"><code class="name flex">
<span>def <span class="ident">transform_function</span></span>(<span>self, lxml_element: <cyfunction Element at 0x7f6a06864df0>, params: Dict) -> <cyfunction Element at 0x7f6a06864df0></span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml_editors.py#L17-L19" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@abc.abstractmethod
def transform_function(self, lxml_element: lxml.etree.Element, params: typing.Dict) -&gt; lxml.etree.Element:
    pass</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="presalytics.client" href="/python-client/presalytics/client/index.html">presalytics.client</a></code></li>
<li><code><a title="presalytics.lib" href="/python-client/presalytics/lib/index.html">presalytics.lib</a></code></li>
<li><code><a title="presalytics.story" href="/python-client/presalytics/story/index.html">presalytics.story</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="presalytics.create_outline_from_ooxml_document" href="/python-client/presalytics/index.html#presalytics.create_outline_from_ooxml_document">create_outline_from_ooxml_document</a></code></li>
<li><code><a title="presalytics.create_pages_from_ooxml_document" href="/python-client/presalytics/index.html#presalytics.create_pages_from_ooxml_document">create_pages_from_ooxml_document</a></code></li>
<li><code><a title="presalytics.create_story_from_ooxml_file" href="/python-client/presalytics/index.html#presalytics.create_story_from_ooxml_file">create_story_from_ooxml_file</a></code></li>
<li><code><a title="presalytics.create_theme_from_ooxml_document" href="/python-client/presalytics/index.html#presalytics.create_theme_from_ooxml_document">create_theme_from_ooxml_document</a></code></li>
<li><code><a title="presalytics.get_mime_type_from_filename" href="/python-client/presalytics/index.html#presalytics.get_mime_type_from_filename">get_mime_type_from_filename</a></code></li>
<li><code><a title="presalytics.story_post_file_bytes" href="/python-client/presalytics/index.html#presalytics.story_post_file_bytes">story_post_file_bytes</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="presalytics.ApprovedExternalLinks" href="/python-client/presalytics/index.html#presalytics.ApprovedExternalLinks">ApprovedExternalLinks</a></code></h4>
</li>
<li>
<h4><code><a title="presalytics.ApprovedExternalScripts" href="/python-client/presalytics/index.html#presalytics.ApprovedExternalScripts">ApprovedExternalScripts</a></code></h4>
</li>
<li>
<h4><code><a title="presalytics.ChangeShapeColor" href="/python-client/presalytics/index.html#presalytics.ChangeShapeColor">ChangeShapeColor</a></code></h4>
<ul class="">
<li><code><a title="presalytics.ChangeShapeColor.replace_color_on_target_shape" href="/python-client/presalytics/index.html#presalytics.ChangeShapeColor.replace_color_on_target_shape">replace_color_on_target_shape</a></code></li>
<li><code><a title="presalytics.ChangeShapeColor.transform_function" href="/python-client/presalytics/index.html#presalytics.ChangeShapeColor.transform_function">transform_function</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.Client" href="/python-client/presalytics/index.html#presalytics.Client">Client</a></code></h4>
<ul class="">
<li><code><a title="presalytics.Client.download_file" href="/python-client/presalytics/index.html#presalytics.Client.download_file">download_file</a></code></li>
<li><code><a title="presalytics.Client.exchange_token" href="/python-client/presalytics/index.html#presalytics.Client.exchange_token">exchange_token</a></code></li>
<li><code><a title="presalytics.Client.get_auth_header" href="/python-client/presalytics/index.html#presalytics.Client.get_auth_header">get_auth_header</a></code></li>
<li><code><a title="presalytics.Client.get_request_id_header" href="/python-client/presalytics/index.html#presalytics.Client.get_request_id_header">get_request_id_header</a></code></li>
<li><code><a title="presalytics.Client.login" href="/python-client/presalytics/index.html#presalytics.Client.login">login</a></code></li>
<li><code><a title="presalytics.Client.refresh_token" href="/python-client/presalytics/index.html#presalytics.Client.refresh_token">refresh_token</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.JinjaPluginMakerMixin" href="/python-client/presalytics/index.html#presalytics.JinjaPluginMakerMixin">JinjaPluginMakerMixin</a></code></h4>
<ul class="">
<li><code><a title="presalytics.JinjaPluginMakerMixin.get_template" href="/python-client/presalytics/index.html#presalytics.JinjaPluginMakerMixin.get_template">get_template</a></code></li>
<li><code><a title="presalytics.JinjaPluginMakerMixin.render" href="/python-client/presalytics/index.html#presalytics.JinjaPluginMakerMixin.render">render</a></code></li>
<li><code><a title="presalytics.JinjaPluginMakerMixin.template" href="/python-client/presalytics/index.html#presalytics.JinjaPluginMakerMixin.template">template</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.JinjaTemplateBuilder" href="/python-client/presalytics/index.html#presalytics.JinjaTemplateBuilder">JinjaTemplateBuilder</a></code></h4>
<ul class="">
<li><code><a title="presalytics.JinjaTemplateBuilder.deserialize" href="/python-client/presalytics/index.html#presalytics.JinjaTemplateBuilder.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.JinjaTemplateBuilder.get_template_name" href="/python-client/presalytics/index.html#presalytics.JinjaTemplateBuilder.get_template_name">get_template_name</a></code></li>
<li><code><a title="presalytics.JinjaTemplateBuilder.load_jinja_template" href="/python-client/presalytics/index.html#presalytics.JinjaTemplateBuilder.load_jinja_template">load_jinja_template</a></code></li>
<li><code><a title="presalytics.JinjaTemplateBuilder.serialize" href="/python-client/presalytics/index.html#presalytics.JinjaTemplateBuilder.serialize">serialize</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.LocalStylesPlugin" href="/python-client/presalytics/index.html#presalytics.LocalStylesPlugin">LocalStylesPlugin</a></code></h4>
</li>
<li>
<h4><code><a title="presalytics.MatplotlibFigure" href="/python-client/presalytics/index.html#presalytics.MatplotlibFigure">MatplotlibFigure</a></code></h4>
</li>
<li>
<h4><code><a title="presalytics.Mpld3Plugin" href="/python-client/presalytics/index.html#presalytics.Mpld3Plugin">Mpld3Plugin</a></code></h4>
<ul class="">
<li><code><a title="presalytics.Mpld3Plugin.template" href="/python-client/presalytics/index.html#presalytics.Mpld3Plugin.template">template</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.OoxmlEditorWidget" href="/python-client/presalytics/index.html#presalytics.OoxmlEditorWidget">OoxmlEditorWidget</a></code></h4>
<ul class="">
<li><code><a title="presalytics.OoxmlEditorWidget.deseriailize" href="/python-client/presalytics/index.html#presalytics.OoxmlEditorWidget.deseriailize">deseriailize</a></code></li>
<li><code><a title="presalytics.OoxmlEditorWidget.update" href="/python-client/presalytics/index.html#presalytics.OoxmlEditorWidget.update">update</a></code></li>
<li><code><a title="presalytics.OoxmlEditorWidget.update_xml" href="/python-client/presalytics/index.html#presalytics.OoxmlEditorWidget.update_xml">update_xml</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.OoxmlEndpointMap" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap">OoxmlEndpointMap</a></code></h4>
<ul class="two-column">
<li><code><a title="presalytics.OoxmlEndpointMap.BASE_URL" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.BASE_URL">BASE_URL</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.CHART" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.CHART">CHART</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.CONNECTION_SHAPE" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.CONNECTION_SHAPE">CONNECTION_SHAPE</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.DOCUMENT" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.DOCUMENT">DOCUMENT</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.GROUP" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.GROUP">GROUP</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.IMAGE" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.IMAGE">IMAGE</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.SHAPE" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.SHAPE">SHAPE</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.SHAPETREE" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.SHAPETREE">SHAPETREE</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.SLIDE" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.SLIDE">SLIDE</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.TABLE" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.TABLE">TABLE</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.THEME" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.THEME">THEME</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.chart" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.chart">chart</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.connection_shape" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.connection_shape">connection_shape</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.document" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.document">document</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.get_id_url" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.get_id_url">get_id_url</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.get_object_type" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.get_object_type">get_object_type</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.get_svg_url" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.get_svg_url">get_svg_url</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.get_xml_url" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.get_xml_url">get_xml_url</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.group" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.group">group</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.image" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.image">image</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.shape" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.shape">shape</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.shapetree" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.shapetree">shapetree</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.slide" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.slide">slide</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.table" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.table">table</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.theme" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.theme">theme</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.OoxmlFileWidget" href="/python-client/presalytics/index.html#presalytics.OoxmlFileWidget">OoxmlFileWidget</a></code></h4>
<ul class="">
<li><code><a title="presalytics.OoxmlFileWidget.update" href="/python-client/presalytics/index.html#presalytics.OoxmlFileWidget.update">update</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.OoxmlTheme" href="/python-client/presalytics/index.html#presalytics.OoxmlTheme">OoxmlTheme</a></code></h4>
</li>
<li>
<h4><code><a title="presalytics.PageTemplateBase" href="/python-client/presalytics/index.html#presalytics.PageTemplateBase">PageTemplateBase</a></code></h4>
<ul class="">
<li><code><a title="presalytics.PageTemplateBase.deseriailize" href="/python-client/presalytics/index.html#presalytics.PageTemplateBase.deseriailize">deseriailize</a></code></li>
<li><code><a title="presalytics.PageTemplateBase.get_page_widgets" href="/python-client/presalytics/index.html#presalytics.PageTemplateBase.get_page_widgets">get_page_widgets</a></code></li>
<li><code><a title="presalytics.PageTemplateBase.load_widget" href="/python-client/presalytics/index.html#presalytics.PageTemplateBase.load_widget">load_widget</a></code></li>
<li><code><a title="presalytics.PageTemplateBase.render" href="/python-client/presalytics/index.html#presalytics.PageTemplateBase.render">render</a></code></li>
<li><code><a title="presalytics.PageTemplateBase.serialize" href="/python-client/presalytics/index.html#presalytics.PageTemplateBase.serialize">serialize</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.PluginBase" href="/python-client/presalytics/index.html#presalytics.PluginBase">PluginBase</a></code></h4>
<ul class="">
<li><code><a title="presalytics.PluginBase.get_tag" href="/python-client/presalytics/index.html#presalytics.PluginBase.get_tag">get_tag</a></code></li>
<li><code><a title="presalytics.PluginBase.validate_metadata" href="/python-client/presalytics/index.html#presalytics.PluginBase.validate_metadata">validate_metadata</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.Renderer" href="/python-client/presalytics/index.html#presalytics.Renderer">Renderer</a></code></h4>
</li>
<li>
<h4><code><a title="presalytics.RevealConfigPlugin" href="/python-client/presalytics/index.html#presalytics.RevealConfigPlugin">RevealConfigPlugin</a></code></h4>
<ul class="">
<li><code><a title="presalytics.RevealConfigPlugin.default_config" href="/python-client/presalytics/index.html#presalytics.RevealConfigPlugin.default_config">default_config</a></code></li>
<li><code><a title="presalytics.RevealConfigPlugin.template" href="/python-client/presalytics/index.html#presalytics.RevealConfigPlugin.template">template</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.RevealCustomTheme" href="/python-client/presalytics/index.html#presalytics.RevealCustomTheme">RevealCustomTheme</a></code></h4>
<ul class="">
<li><code><a title="presalytics.RevealCustomTheme.defaults" href="/python-client/presalytics/index.html#presalytics.RevealCustomTheme.defaults">defaults</a></code></li>
<li><code><a title="presalytics.RevealCustomTheme.fonts_base_url" href="/python-client/presalytics/index.html#presalytics.RevealCustomTheme.fonts_base_url">fonts_base_url</a></code></li>
<li><code><a title="presalytics.RevealCustomTheme.get_base_scss" href="/python-client/presalytics/index.html#presalytics.RevealCustomTheme.get_base_scss">get_base_scss</a></code></li>
<li><code><a title="presalytics.RevealCustomTheme.get_font_link" href="/python-client/presalytics/index.html#presalytics.RevealCustomTheme.get_font_link">get_font_link</a></code></li>
<li><code><a title="presalytics.RevealCustomTheme.get_fonts" href="/python-client/presalytics/index.html#presalytics.RevealCustomTheme.get_fonts">get_fonts</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.Revealer" href="/python-client/presalytics/index.html#presalytics.Revealer">Revealer</a></code></h4>
<ul class="">
<li><code><a title="presalytics.Revealer.deserialize" href="/python-client/presalytics/index.html#presalytics.Revealer.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.Revealer.get_component_implicit_plugins" href="/python-client/presalytics/index.html#presalytics.Revealer.get_component_implicit_plugins">get_component_implicit_plugins</a></code></li>
<li><code><a title="presalytics.Revealer.make_base" href="/python-client/presalytics/index.html#presalytics.Revealer.make_base">make_base</a></code></li>
<li><code><a title="presalytics.Revealer.package_as_standalone" href="/python-client/presalytics/index.html#presalytics.Revealer.package_as_standalone">package_as_standalone</a></code></li>
<li><code><a title="presalytics.Revealer.present" href="/python-client/presalytics/index.html#presalytics.Revealer.present">present</a></code></li>
<li><code><a title="presalytics.Revealer.render" href="/python-client/presalytics/index.html#presalytics.Revealer.render">render</a></code></li>
<li><code><a title="presalytics.Revealer.render_page" href="/python-client/presalytics/index.html#presalytics.Revealer.render_page">render_page</a></code></li>
<li><code><a title="presalytics.Revealer.serialize" href="/python-client/presalytics/index.html#presalytics.Revealer.serialize">serialize</a></code></li>
<li><code><a title="presalytics.Revealer.set_outline_data_from_instance" href="/python-client/presalytics/index.html#presalytics.Revealer.set_outline_data_from_instance">set_outline_data_from_instance</a></code></li>
<li><code><a title="presalytics.Revealer.set_page_outline_data" href="/python-client/presalytics/index.html#presalytics.Revealer.set_page_outline_data">set_page_outline_data</a></code></li>
<li><code><a title="presalytics.Revealer.set_theme_outline_data" href="/python-client/presalytics/index.html#presalytics.Revealer.set_theme_outline_data">set_theme_outline_data</a></code></li>
<li><code><a title="presalytics.Revealer.set_widget_outline_data" href="/python-client/presalytics/index.html#presalytics.Revealer.set_widget_outline_data">set_widget_outline_data</a></code></li>
<li><code><a title="presalytics.Revealer.strip_unauthorized_scripts" href="/python-client/presalytics/index.html#presalytics.Revealer.strip_unauthorized_scripts">strip_unauthorized_scripts</a></code></li>
<li><code><a title="presalytics.Revealer.update_info" href="/python-client/presalytics/index.html#presalytics.Revealer.update_info">update_info</a></code></li>
<li><code><a title="presalytics.Revealer.update_outline" href="/python-client/presalytics/index.html#presalytics.Revealer.update_outline">update_outline</a></code></li>
<li><code><a title="presalytics.Revealer.update_outline_from_instances" href="/python-client/presalytics/index.html#presalytics.Revealer.update_outline_from_instances">update_outline_from_instances</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.StoryOutline" href="/python-client/presalytics/index.html#presalytics.StoryOutline">StoryOutline</a></code></h4>
</li>
<li>
<h4><code><a title="presalytics.ThemeBase" href="/python-client/presalytics/index.html#presalytics.ThemeBase">ThemeBase</a></code></h4>
<ul class="">
<li><code><a title="presalytics.ThemeBase.render" href="/python-client/presalytics/index.html#presalytics.ThemeBase.render">render</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.WidgetBase" href="/python-client/presalytics/index.html#presalytics.WidgetBase">WidgetBase</a></code></h4>
<ul class="">
<li><code><a title="presalytics.WidgetBase.deserialize" href="/python-client/presalytics/index.html#presalytics.WidgetBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.WidgetBase.render" href="/python-client/presalytics/index.html#presalytics.WidgetBase.render">render</a></code></li>
<li><code><a title="presalytics.WidgetBase.serialize" href="/python-client/presalytics/index.html#presalytics.WidgetBase.serialize">serialize</a></code></li>
<li><code><a title="presalytics.WidgetBase.to_html" href="/python-client/presalytics/index.html#presalytics.WidgetBase.to_html">to_html</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.XmlTransformBase" href="/python-client/presalytics/index.html#presalytics.XmlTransformBase">XmlTransformBase</a></code></h4>
<ul class="">
<li><code><a title="presalytics.XmlTransformBase.execute" href="/python-client/presalytics/index.html#presalytics.XmlTransformBase.execute">execute</a></code></li>
<li><code><a title="presalytics.XmlTransformBase.transform_function" href="/python-client/presalytics/index.html#presalytics.XmlTransformBase.transform_function">transform_function</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.7.4</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>