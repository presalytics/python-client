<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>presalytics API documentation</title>
<meta name="description" content="Presalytics Python Library
For more information, visit https://presalytics.io …" />
<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css' rel='stylesheet'>
<link href='https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css' rel='stylesheet'>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{font-weight:bold}#index h4 + ul{margin-bottom:.6em}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>presalytics</code></h1>
</header>
<section id="section-intro">
<h1 id="presalytics-python-library">Presalytics Python Library</h1>
<p>For more information, visit <a href="https://presalytics.io.">https://presalytics.io.</a></p>
<h1 id="overview">Overview</h1>
<p>The Presalytics Python Library streamlines analytic operations across analysts, executives, consultants,
and developers.
These tools enable for a simplified workflow for analysts to rapidly generate
client-ready presentation materials and web content that update in real-time and easily scale across your user-base.</p>
<p>Our objective when building this platform is make the analyst experience as simple as possible.
Set up time for new user should take less than half an hour, and all features are self-service and self-explanatory.</p>
<p>Of course, if you have any questions or need help to get going, you can <a href="/contact-us">contact us</a> or
quickly get the help you need on our <a href="https://presalytics.slack.com">slack channel</a>
(<a href="https://join.slack.com/t/presalytics/shared_invite/enQtODExMjc3MDE1Nzc5LWU0ZDlhZTgwZTM3MzQ4Yzc4Nzk4Zjc0NmQ3YjgzNTEwODdlYjM0ZjFkZWI4Y2ZhNzBmOTZhMzA2MzE3YjFiZTg">Join Here!</a>).</p>
<p>To get going quickly, you can browse our <a href="https://presalytics.io/docs/getting-started/">Getting Started</a> page and review
some <a href="https://presalytics.io/docs/examples">examples</a>.</p>
<p>For more advanced users and developers, you can learn more about the API by reviewing
the <a href="https://presalytics.io/docs/how-it-works">service structure</a> to build a better understanding
of the API and its <a href="https://presalytics.io/docs/develpers/security">security</a> features.</p>
<h1 id="installation">Installation</h1>
<p>The Presalytics Python Library is avialabe in python package index, and can be installed via pip:</p>
<pre><code class="language-python">pip install presalytics
</code></pre>
<h1 id="contributing">Contributing</h1>
<p>Presalytics.io is on <a href="https://github.com/presalytics">Github</a>.
Bug reports and pull requests are strongly encouraged at
the package <a href="https://github.com/presalytics/python-client">repository</a>. If you encounter any problems or have any suggestions for
the API endpoints that this libary interacts with at <a href="https://api.presalytics.io,">https://api.presalytics.io,</a> please open an issue in the
<a href="https://github.com/presalytics/Presalytics-API">API repository</a>.</p>
<h1 id="license">License</h1>
<p>The Presalytics Python Library can be used in any of your applications and is covered by the MIT License.
This library
exchanges infromation with other web APIs that may be proprietary and carry their own licensing restriction.
More more
information on licensing, please contact <a href="mailto:inquires@presalytics.io">inquires@presalytics.io</a>.</p>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/__init__.py#L0-L185" class="git-link">Browse git</a>
</summary>
<pre><code class="python">&#34;&#34;&#34;
# Presalytics Python Library
For more information, visit https://presalytics.io.

# Overview

The Presalytics Python Library streamlines analytic operations across analysts, executives, consultants,
and developers.  These tools enable for a simplified workflow for analysts to rapidly generate
client-ready presentation materials and web content that update in real-time and easily scale across your user-base.

Our objective when building this platform is make the analyst experience as simple as possible.
Set up time for new user should take less than half an hour, and all features are self-service and self-explanatory.

Of course, if you have any questions or need help to get going, you can [contact us](/contact-us) or
quickly get the help you need on our [slack channel](https://presalytics.slack.com)
([Join Here!](https://join.slack.com/t/presalytics/shared_invite/enQtODExMjc3MDE1Nzc5LWU0ZDlhZTgwZTM3MzQ4Yzc4Nzk4Zjc0NmQ3YjgzNTEwODdlYjM0ZjFkZWI4Y2ZhNzBmOTZhMzA2MzE3YjFiZTg)).

To get going quickly, you can browse our [Getting Started](https://presalytics.io/docs/getting-started/) page and review
some [examples](https://presalytics.io/docs/examples).

For more advanced users and developers, you can learn more about the API by reviewing
the [service structure](https://presalytics.io/docs/how-it-works) to build a better understanding
of the API and its [security](https://presalytics.io/docs/develpers/security) features.

# Installation

The Presalytics Python Library is avialabe in python package index, and can be installed via pip:

~~~~python
pip install presalytics
~~~~

# Contributing

Presalytics.io is on [Github](https://github.com/presalytics).  Bug reports and pull requests are strongly encouraged at
the package [repository](https://github.com/presalytics/python-client). If you encounter any problems or have any suggestions for
the API endpoints that this libary interacts with at https://api.presalytics.io, please open an issue in the
[API repository](https://github.com/presalytics/Presalytics-API).

# License

The Presalytics Python Library can be used in any of your applications and is covered by the MIT License.  This library
exchanges infromation with other web APIs that may be proprietary and carry their own licensing restriction.  More more
information on licensing, please contact [inquires@presalytics.io](mailto:inquires@presalytics.io).

&#34;&#34;&#34;
import pkg_resources
import presalytics.lib
import presalytics.lib.logger
import presalytics.lib.plugins
import presalytics.lib.plugins.base
import presalytics.lib.config_loader
import presalytics.story
import presalytics.story.components

settings = presalytics.lib.config_loader.Settings()
&#34;&#34;&#34;
The Presalytics Python Client settings instance.

Settings are are loaded into this instance via package defaults.  Users can override
default setting by (in order of precedence):

    1. Settings variable using a `settings.py` file in the current working directory
    2. Using a .env file
    3. Setting environment variables with same key as default setting

For a comprehsive list of settings values, please review `presalytics.lib.default_settings`.
&#34;&#34;&#34;

presalytics.lib.logger.configure_logger(log_level=settings.LOG_LEVEL, file_logger=settings.USE_LOGGER)  # type: ignore[attr-defined]


PLUGINS = presalytics.lib.plugins.base.PluginRegistry()
&#34;&#34;&#34;
Instance of `presalytics.lib.plugins.base.PluginRegistry`.  A container listing the
Presalytics Library Plugins available and loaded in this environment. This instance is used
by `presalytics.story.components.Renderer` subclasses (e.g., `presalytics.story.revealer.Revealer`)
to write scripts and links into stories.
&#34;&#34;&#34;

COMPONENTS = presalytics.story.components.ComponentRegistry()
&#34;&#34;&#34;
Instance of `presalytics.story.components.ComponentRegistry`.  Registry for Library components and
component instances.  A container listing the Presalytics Library components and instances available
and loaded in this environment. This instance is used by `presalytics.story.components.Renderer` subclasses
(e.g., `presalytics.story.revealer.Revealer`) to convert widgets, pages, and themes into stories.
&#34;&#34;&#34;

try:
    __version__ = pkg_resources.require(presalytics.__name__)[0].version
except Exception:
    __version__ = &#34;build&#34;

from presalytics.client.api import Client
from presalytics.lib.plugins.base import PluginBase  # noqa: F401
from presalytics.lib.plugins.external import ApprovedExternalLinks, ApprovedExternalScripts
from presalytics.lib.plugins.jinja import JinjaPluginMakerMixin  # noqa: F401
from presalytics.lib.plugins.local import LocalStylesPlugin
from presalytics.lib.plugins.matplotlib import Mpld3Plugin  # noqa: F401
from presalytics.lib.plugins.ooxml import OoxmlTheme
from presalytics.lib.plugins.reveal import RevealConfigPlugin
from presalytics.lib.plugins.reveal_theme import RevealCustomTheme
from presalytics.lib.plugins.scss import ScssPlugin
from presalytics.lib.templates.base import (
    JinjaTemplateBuilder,
    BootstrapCustomTemplate  # noqa: F401
)
from presalytics.lib.widgets.matplotlib import MatplotlibFigure, MatplotlibResponsiveFigure
from presalytics.lib.widgets.d3 import (
    D3Widget
)
from presalytics.lib.widgets.chart import ChartWidget
from presalytics.lib.widgets.data_table import DataTableWidget
from presalytics.lib.widgets.url import UrlWidget
from presalytics.lib.widgets.markdown import MarkdownWidget  # noqa: F401
from presalytics.lib.widgets.ooxml import (
    OoxmlWidgetBase,
    OoxmlFileWidget,
    OoxmlEndpointMap,
    ChartUpdaterWidget,
    TableUpdaterWidget
)
from presalytics.story.outline import StoryOutline
from presalytics.story.revealer import Revealer
from presalytics.story.renderers import ClientSideRenderer
from presalytics.story.components import WidgetBase, PageTemplateBase, Renderer, ThemeBase
from presalytics.lib.tools.ooxml_tools import (
    create_story_from_ooxml_file
)
from presalytics.lib.tools.story_tools import story_post_file_bytes
from presalytics.lib.tools.component_tools import (
    create_outline_from_page,
    create_outline_from_widget
)
from presalytics.lib.widgets.ooxml_editors import (
    OoxmlEditorWidget,
    XmlTransformBase,
    ChangeShapeColor,
    TextReplace,
    MultiXmlTransform
)


__all__ = [
    &#39;COMPONENTS&#39;,
    &#39;PLUGINS&#39;,
    &#39;Client&#39;,
    &#39;StoryOutline&#39;,
    &#39;Renderer&#39;,
    &#39;ClientSideRenderer&#39;,
    &#39;Revealer&#39;,
    &#39;MatplotlibFigure&#39;,
    &#39;MatplotlibResponsiveFigure&#39;,
    &#39;Mpld3Plugin&#39;,
    &#39;MarkdownWidget&#39;,
    &#39;OoxmlFileWidget&#39;,
    &#39;OoxmlEndpointMap&#39;,
    &#39;OoxmlWidgetBase&#39;,
    &#39;OoxmlEditorWidget&#39;,
    &#39;D3Widget&#39;,
    &#39;ChartWidget&#39;,
    &#39;DataTableWidget&#39;,
    &#39;UrlWidget&#39;,
    &#39;ChartUpdaterWidget&#39;,
    &#39;TableUpdaterWidget&#39;,
    &#39;BootstrapCustomTemplate&#39;,
    &#39;XmlTransformBase&#39;,
    &#39;ChangeShapeColor&#39;,
    &#39;TextReplace&#39;,
    &#39;MultiXmlTransform&#39;,
    &#39;ApprovedExternalLinks&#39;,
    &#39;ApprovedExternalScripts&#39;,
    &#39;LocalStylesPlugin&#39;,
    &#39;OoxmlTheme&#39;,
    &#39;RevealConfigPlugin&#39;,
    &#39;RevealCustomTheme&#39;,
    &#39;JinjaTemplateBuilder&#39;,
    &#39;WidgetBase&#39;,
    &#39;PageTemplateBase&#39;,
    &#39;ScssPlugin&#39;,
    &#39;ThemeBase&#39;,
    &#39;create_story_from_ooxml_file&#39;,
    &#39;story_post_file_bytes&#39;,
    &#39;create_outline_from_page&#39;,
    &#39;create_outline_from_widget&#39;
]</code></pre>
</details>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="presalytics.cli" href="/python-client/presalytics/cli.html">presalytics.cli</a></code></dt>
<dd>
<section class="desc"><p>Command Line Interface for Presalytics Python Library …</p></section>
</dd>
<dt><code class="name"><a title="presalytics.client" href="/python-client/presalytics/client/index.html">presalytics.client</a></code></dt>
<dd>
<section class="desc"><p>This module conatains objects for interacting with the Presalytics API.
It has three submodules:
<code><a title="presalytics.client.doc_converter" href="/python-client/presalytics/client/doc_converter/index.html">presalytics.client.doc_converter</a></code>, …</p></section>
</dd>
<dt><code class="name"><a title="presalytics.lib" href="/python-client/presalytics/lib/index.html">presalytics.lib</a></code></dt>
<dd>
<section class="desc"><p>Contains configuration and library objects for users to build upon when create story objects</p></section>
</dd>
<dt><code class="name"><a title="presalytics.story" href="/python-client/presalytics/story/index.html">presalytics.story</a></code></dt>
<dd>
<section class="desc"><p>Conains base objects for rendering, building, serializing, and view Story objects</p></section>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-variables">Global variables</h2>
<dl>
<dt id="presalytics.COMPONENTS"><code class="name">var <span class="ident">COMPONENTS</span></code></dt>
<dd>
<section class="desc"><p>Instance of <code><a title="presalytics.story.components.ComponentRegistry" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentRegistry">ComponentRegistry</a></code>.
Registry for Library components and
component instances.
A container listing the Presalytics Library components and instances available
and loaded in this environment. This instance is used by <code><a title="presalytics.story.components.Renderer" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer">Renderer</a></code> subclasses
(e.g., <code><a title="presalytics.story.revealer.Revealer" href="/python-client/presalytics/story/revealer.html#presalytics.story.revealer.Revealer">Revealer</a></code>) to convert widgets, pages, and themes into stories.</p></section>
</dd>
<dt id="presalytics.PLUGINS"><code class="name">var <span class="ident">PLUGINS</span></code></dt>
<dd>
<section class="desc"><p>Instance of <code><a title="presalytics.lib.plugins.base.PluginRegistry" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginRegistry">PluginRegistry</a></code>.
A container listing the
Presalytics Library Plugins available and loaded in this environment. This instance is used
by <code><a title="presalytics.story.components.Renderer" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer">Renderer</a></code> subclasses (e.g., <code><a title="presalytics.story.revealer.Revealer" href="/python-client/presalytics/story/revealer.html#presalytics.story.revealer.Revealer">Revealer</a></code>)
to write scripts and links into stories.</p></section>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="presalytics.create_story_from_ooxml_file"><code class="name flex">
<span>def <span class="ident">create_story_from_ooxml_file</span></span>(<span>filename, client_info={})</span>
</code></dt>
<dd>
<section class="desc"><p>Utility Method for building stories into the Presalytics API directly from a Presentation or Spreadsheet file.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>filename</code></strong> :&ensp;<code>str</code></dt>
<dd>A string contain the local path to a presenation or spreadsheet object.</dd>
<dt><strong><code>client_info</code></strong> :&ensp;<code>dict</code>, optional</dt>
<dd>A dictionary containing arguments that will be unpacked and passed to a <code><a title="presalytics.client.api.Client" href="/python-client/presalytics/client/api.html#presalytics.client.api.Client">Client</a></code> object on intialization.
This dictionary can include the <code>token</code>, <code>cache_tokens</code>, <code>delegate_login</code> values.
See <code><a title="presalytics.client.api.Client" href="/python-client/presalytics/client/api.html#presalytics.client.api.Client">Client</a></code> for more information.</dd>
</dl>
<h2 id="returns">Returns:</h2>
<p>A <code><a title="presalytics.client.story.models.story.Story" href="/python-client/presalytics/client/story/models/story.html#presalytics.client.story.models.story.Story">Story</a></code> containing information about the Story object in the Presalytics API</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/tools/ooxml_tools.py#L56-L94" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def create_story_from_ooxml_file(filename: str, client_info={}) -&gt; &#39;Story&#39;:
    &#34;&#34;&#34;
    Utility Method for building stories into the Presalytics API directly from a Presentation or Spreadsheet file.

    Parameters
    ----------
    filename : str
        A string contain the local path to a presenation or spreadsheet object.

    client_info : dict, optional
        A dictionary containing arguments that will be unpacked and passed to a `presalytics.client.api.Client` object on intialization.
        This dictionary can include the `token`, `cache_tokens`, `delegate_login` values.  See `presalytics.client.api.Client` for more information.

    Returns:
    ----------
    A `presalytics.client.story.models.story.Story` containing information about the Story object in the Presalytics API

    &#34;&#34;&#34;

    story: &#39;Story&#39;
    logger.info(&#34;Starting presalytics tool: create_story_from_ooxml_file&#34;)
    logger.info(&#34;Intializing presalytics client.&#34;)

    client = presalytics.Client(**client_info)
    logger.info(&#34;Sending file to presalytics server for document processing and base story creation&#34;)
    story = client.story.story_post_file(file=filename)
    logger.info(&#34;Creating local instances of file widgets&#34;)
    outline = presalytics.StoryOutline.load(story.outline)
    for i in range(0, len(outline.pages)):
        page = outline.pages[i]
        for j in range(0, len(page.widgets)):
            widget = page.widgets[j]
            logger.info(&#39;Creating OoxmlFileWidget with name &#34;{}&#34;&#39;.format(widget.name))
            inst = presalytics.OoxmlFileWidget.deserialize(widget, **client_info)
            presalytics.COMPONENTS.register(inst)
            logger.info(&#39;Rewriting outline with widget: &#34;{}&#34;&#39;.format(widget.name))
            outline.pages[i].widgets[j] = inst.serialize()
    story.outline = outline.dump()
    return story</code></pre>
</details>
</dd>
<dt id="presalytics.story_post_file_bytes"><code class="name flex">
<span>def <span class="ident">story_post_file_bytes</span></span>(<span>client, binary_obj, filename, mime_type=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Create a Presalytics API Story object from a file-like <code>io.BytesIO</code> object.
Helpful for server-side
interaction with the Presalytics Story API</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>client</code></strong> :&ensp;<code><a title="presalytics.client.api.Client" href="/python-client/presalytics/client/api.html#presalytics.client.api.Client">Client</a></code></dt>
<dd>A client object for making api calls</dd>
<dt><strong><code>binary_obj</code></strong> :&ensp;<code>io.BytesIO</code></dt>
<dd>A file-like object for storing file-data in memory.
Often found in multipart messages
uploaded from browsers.</dd>
<dt><strong><code>filename</code></strong> :&ensp;<code>str</code></dt>
<dd>The filename of the object to be uploaded</dd>
<dt><strong><code>mimetype</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>If known, please add the mimetype of the file.
Otherwise, this method will execute an
additional API call ascertain the file's mimetype</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>A <code><a title="presalytics.client.story.models.story.Story" href="/python-client/presalytics/client/story/models/story.html#presalytics.client.story.models.story.Story">Story</a></code> containing information about the Story object in the Presalytics API</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/tools/story_tools.py#L15-L74" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def story_post_file_bytes(client: &#39;Client&#39;,
                          binary_obj: &#39;BytesIO&#39;,
                          filename: str,
                          mime_type: str = None):
    &#34;&#34;&#34;
    Create a Presalytics API Story object from a file-like `io.BytesIO` object.  Helpful for server-side
    interaction with the Presalytics Story API

    Parameters
    ----------
    client : presalytics.client.api.Client
        A client object for making api calls

    binary_obj : io.BytesIO
        A file-like object for storing file-data in memory.  Often found in multipart messages
        uploaded from browsers.

    filename : str
        The filename of the object to be uploaded

    mimetype : str, optional
        If known, please add the mimetype of the file.  Otherwise, this method will execute an
        additional API call ascertain the file&#39;s mimetype

    Returns
    ----------
    A `presalytics.client.story.models.story.Story` containing information about the Story object in the Presalytics API
    &#34;&#34;&#34;
    if not mime_type:
        mime_type = presalytics.lib.tools.ooxml_tools.get_mime_type_from_filename(client, filename)
    _file = {&#39;file&#39;: (filename, binary_obj, mime_type,)}
    headers = client.get_auth_header()
    headers.update(client.get_request_id_header())
    headers.update({
        &#39;User-Agent&#39;: client.story.api_client.user_agent,
        &#39;Accept&#39;: &#39;application/json&#39;
    })
    endpoint = urllib.parse.urljoin(client.story.api_client.configuration.host, &#39;story/file&#39;)
    try:
        resp = requests.post(endpoint, headers=headers, files=_file)
    except Exception as ex:
        message = &#34;An error occured in the presalytics API client&#34;
        if locals().get(&#34;resp&#34;, None):
            code = resp.status_code
        else:
            code = 500
        raise presalytics.lib.exceptions.ApiError(message=message, status_code=code)

    data = resp.json()
    if resp.status_code &gt; 299:
        logger.error(data[&#39;detail&#39;])
        raise presalytics.lib.exceptions.ApiError(message=data[&#34;detail&#34;], status_code=resp.status_code)
    else:
        try:
            story = client.story.api_client._ApiClient__deserialize(data, &#39;Story&#39;)
            return story
        except Exception as ex:
            logger.error(&#34;Story object could not be deserialized.&#34;)
            logger.exception(ex)
        return data</code></pre>
</details>
</dd>
<dt id="presalytics.create_outline_from_page"><code class="name flex">
<span>def <span class="ident">create_outline_from_page</span></span>(<span>page, title=None, description=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Creates a <code><a title="presalytics.story.outline.StoryOutline" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.StoryOutline">StoryOutline</a></code> from a subclass of
<code><a title="presalytics.story.components.PageTemplateBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.PageTemplateBase">PageTemplateBase</a></code>.
Useful for quick starts, demos, and
rapidly sharing content without having to manaully build a <code><a title="presalytics.StoryOutline" href="/python-client/presalytics/index.html#presalytics.StoryOutline">StoryOutline</a></code>.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>page</code></strong> :&ensp;<code>subclass</code> of <code><a title="presalytics.story.components.PageTemplateBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.PageTemplateBase">PageTemplateBase</a></code></dt>
<dd>The Page component that you want to build the story from</dd>
<dt><strong><code>title</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The title of the <code><a title="presalytics.story.outline.StoryOutline" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.StoryOutline">StoryOutline</a></code>.
Defaults to
the name of the page.</dd>
<dt><strong><code>description</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The description of the story.
Autopopulated if unassigned.</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/tools/component_tools.py#L74-L121" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def create_outline_from_page(page: &#39;PageTemplateBase&#39;,
                             title: str = None,
                             description: str = None) -&gt; &#39;StoryOutline&#39;:
    &#34;&#34;&#34;
    Creates a `presalytics.story.outline.StoryOutline` from a subclass of
    `presalytics.story.components.PageTemplateBase`.  Useful for quick starts, demos, and
    rapidly sharing content without having to manaully build a `StoryOutline`.

    Parameters
    ----------

    page : subclass of presalytics.story.components.PageTemplateBase
        The Page component that you want to build the story from

    title : str, optional
        The title of the `presalytics.story.outline.StoryOutline`.  Defaults to
        the name of the page.

    description : str, optional
        The description of the story.  Autopopulated if unassigned.

    &#34;&#34;&#34;
    info = presalytics.story.outline.Info(
        revision=&#34;0&#34;,
        date_created=datetime.datetime.now().astimezone(datetime.timezone.utc).isoformat(),
        date_modified=datetime.datetime.now().astimezone(datetime.timezone.utc).isoformat(),
        created_by=presalytics.settings.USERNAME,  # type: ignore[attr-defined]
        modified_by=presalytics.settings.USERNAME,  # type: ignore[attr-defined]
        revision_notes=&#34;Created by &#39;create_outline_from_page&#39; method&#34;
    )

    page_outline = page.serialize()

    if not description:
        description = &#34;{0} created by &#39;create_outline_from_page&#39; method&#34;.format(page_outline.name)

    if not title:
        title = page_outline.name

    outline = presalytics.story.outline.StoryOutline(
        info=info,
        pages=[page],
        description=description,
        title=title,
        themes=[]
    )

    return outline</code></pre>
</details>
</dd>
<dt id="presalytics.create_outline_from_widget"><code class="name flex">
<span>def <span class="ident">create_outline_from_widget</span></span>(<span>widget, page_name=None, title=None, description=None, story_id=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Creates a <code><a title="presalytics.story.outline.StoryOutline" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.StoryOutline">StoryOutline</a></code> from a subclass of
<code><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></code>.
Useful for quickstarts, demos, and
rapidly sharing content without having to manaully build a <code><a title="presalytics.StoryOutline" href="/python-client/presalytics/index.html#presalytics.StoryOutline">StoryOutline</a></code>.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>widget</code></strong> :&ensp;<code>subclass</code> of <code><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></code></dt>
<dd>The widget component that you want to build the story from</dd>
<dt><strong><code>page_name</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The name you want to give the <code><a title="presalytics.story.outline.Page" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.Page">Page</a></code> in the outline.
Defaults to the name of the supplied <code>widget</code></dd>
<dt><strong><code>title</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The title of the <code><a title="presalytics.story.outline.StoryOutline" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.StoryOutline">StoryOutline</a></code>.
Defaults to
<code>page_name</code>.</dd>
<dt><strong><code>description</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The description of the story.
Autopopulated if unassigned.</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/tools/component_tools.py#L10-L71" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def create_outline_from_widget(widget: &#39;WidgetBase&#39;,
                               page_name: str = None,
                               title: str = None,
                               description: str = None,
                               story_id: str = None) -&gt; &#39;StoryOutline&#39;:
    &#34;&#34;&#34;
    Creates a `presalytics.story.outline.StoryOutline` from a subclass of
    `presalytics.story.components.WidgetBase`.  Useful for quickstarts, demos, and
    rapidly sharing content without having to manaully build a `StoryOutline`.

    Parameters
    ----------

    widget : subclass of presalytics.story.components.WidgetBase
        The widget component that you want to build the story from

    page_name : str, optional
        The name you want to give the `presalytics.story.outline.Page` in the outline.
        Defaults to the name of the supplied `widget`

    title : str, optional
        The title of the `presalytics.story.outline.StoryOutline`.  Defaults to
        `page_name`.

    description : str, optional
        The description of the story.  Autopopulated if unassigned.

    &#34;&#34;&#34;
    info = presalytics.story.outline.Info(
        revision=&#34;0&#34;,
        date_created=datetime.datetime.now().astimezone(datetime.timezone.utc).isoformat(),
        date_modified=datetime.datetime.now().astimezone(datetime.timezone.utc).isoformat(),
        created_by=presalytics.settings.USERNAME,  # type: ignore
        modified_by=presalytics.settings.USERNAME,  # type: ignore
        revision_notes=&#34;Created by &#39;create_outline_from_widget&#39; method&#34;
    )

    outline_widget = widget.serialize()
    if not page_name:
        page_name = outline_widget.name

    page = presalytics.story.outline.Page(
        name=page_name,
        kind=&#34;widget-page&#34;,
        widgets=[outline_widget]
    )
    if not description:
        description = &#34;{0} with {1} created by &#39;create_outline_from_widget&#39; method&#34;.format(page_name, outline_widget.name)

    if not title:
        title = page_name

    outline = presalytics.story.outline.StoryOutline(
        info=info,
        pages=[page],
        description=description,
        title=title,
        themes=[],
        story_id=story_id
    )

    return outline</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="presalytics.Client"><code class="flex name class">
<span>class <span class="ident">Client</span></span>
<span>(</span><span>username=None, password=None, delegate_login=False, token=None, cache_tokens=False, client_id=None, client_secret=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Class for interacting with Presalytics API endpoints</p>
<p>The Client class creates a simple interface for user to interactive with the
Presalytics API and is the primary building block for user-built automation of stories,
dashboards, and interactive presentations.</p>
<p>A client instance wraps python functions around Presalytics API endpoints and
manages user authentication. On initialization, he client checks the status of
a user authentication the expiry of their refresh an access tokens.
When needed,
the client will open a browser to prompt the user to login at the presalytics.io
login page (or raise an <code><a title="presalytics.lib.exceptions.InvalidTokenException" href="/python-client/presalytics/lib/exceptions.html#presalytics.lib.exceptions.InvalidTokenException">InvalidTokenException</a></code> when
<code>delegate_login</code> is <code>True</code>).</p>
<p>After authenication, users can call the methods bound to the story, ooxml_automation,
and doc_converter attributes to make calls in into the Presalytics API.</p>
<p><em>A note for server-side development</em>:</p>
<p>The client class can automatically cache tokens in a file called
"token.json", located in the python's current working directory.
This is done so
users running scripts accross multiple client instances do not have to acquire a new token
every time an API call is made. If building a client to operate in a multi-user environment,
this behavior should be turned off so that one user cannot not pull one another's tokens.
To do this, ensure the following parameters are pass to the configuration either
via initialization or in a <code>presaltyics.settings</code>:</p>
<pre><code>cache_tokens = False,
delegate_login = True
</code></pre>
<p>When delegate login is True, the client assumes that the application creating
instances of the client object will handle user authentication.
The simplest way
to do this is to pass a token to the client via the "token" keyword argument.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>username</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Defaults to None.
The user's Presalytics API username.
This keyword will take precedence over a passed to the client
via <code>presalytics.settings</code>.
The username must either be present in <code>presalytics.settings</code> or be passed in
via keyword, otherwise the client will raise a <code><a title="presalytics.lib.exceptions.MissingConfigException" href="/python-client/presalytics/lib/exceptions.html#presalytics.lib.exceptions.MissingConfigException">MissingConfigException</a></code>.</dd>
<dt><strong><code>password</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Defaults to None.
The user's Presalytics API password.
This useful for quickly testing scripts, but in most
scenario users should not be passing plaintext into the client via this keyword.
In a secure, single-user
environment, passwords are better placed in the <code>presalytics.settings</code> object for reuseability.
A more secure
is to leave passwords out of the configuration, keep <code>delegate_login</code> = <code>False</code>, and acquire tokens via the browser.</dd>
<dt><strong><code>delegate_login</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Defaults to False.
Indicates whether the client would redirect to a browser to
acquire an API token. If <code>DELEGATE_LOGIN</code> is <code>True</code>, when the <code><a title="presalytics.client.api.Client" href="/python-client/presalytics/client/api.html#presalytics.client.api.Client">Client</a></code> does not have
access to a valid API token, the client will raise a <code><a title="presalytics.lib.exceptions.InvalidTokenException" href="/python-client/presalytics/lib/exceptions.html#presalytics.lib.exceptions.InvalidTokenException">InvalidTokenException</a></code>.
The default operation will automatically open a new browser tab to acquire a new token
via website client from the presalytics.io login page.
Putting this setting to True is
useful for server-side development.</dd>
<dt><strong><code>token</code></strong> :&ensp;<code>dict</code>, optional</dt>
<dd>
<p>Defaults to None.
A dictionary contain information about tokens acquire from auth.presalytics.io.
The
dictionary must contain an <code>access_token</code>, a <code>refresh_token</code>, and entries contiaing information about token expiry.</p>
<p>Token expiry information can either passed in ISO 8601 formatted string with a UTC offset as dictionary keys
<code>access_token_expire_time</code> and <code>refresh_token_expire_time</code> or an integer in seconds with the corresponding
dictionary keys<code>expires_in</code> and <code>refresh_expires_in</code>.</p>
<p>if the <code>dict</code> passed in via this keywork does is not have the correct entries, the client will
raise an <code><a title="presalytics.lib.exceptions.InvalidTokenException" href="/python-client/presalytics/lib/exceptions.html#presalytics.lib.exceptions.InvalidTokenException">InvalidTokenException</a></code>.</p>
</dd>
<dt><strong><code>cache_tokens</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Defaults to False.
Toggles whether or the client should cache its acquired tokens in file called "token.json"
in the current working directory.
Minimizes the number of times a user is required to login.
Set to False
in multi-user environments.</dd>
</dl>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>direct_grant</code></strong> :&ensp;<code>bool</code></dt>
<dd>Indicates whether an token will be acquire via the "direct_grant" OpenID Connect flow.
Usually indicates
whether the user has supplied a passwork to the client either through <code>presalytics.settings</code> ro
during object initialization.</dd>
<dt><strong><code>doc_converter</code></strong> :&ensp;<code><a title="presalytics.client.doc_converter.api.default_api.DefaultApi" href="/python-client/presalytics/client/doc_converter/api/default_api.html#presalytics.client.doc_converter.api.default_api.DefaultApi">DefaultApi</a></code></dt>
<dd>
<p>Interface to the Presalytics API Doc Converter service.
The object contains methods that enable
the client to make api calls that return deserialized objects from the Presalytics API,
simplying user and developer interaction with the Presaltytics API.
API calls can be generated
as follows:</p>
<pre><code>client = presalytics.Client()
api_obj = client.doc_converter.{operation_id}(*args)
</code></pre>
<p>where <code>{operation_id}</code> is the <code>operationId</code> assocated with the endpoint specified the <a href="https://presalytics.io/docs/api-specifications/doc-converter/">Doc Converter
Service OpenAPI Contract</a> , and *args
are the corresponding arguments that are passed to the method.
A complete list of the avialable
methods is shown on the <code><a title="presalytics.client.doc_converter.api.default_api.DefaultApi" href="/python-client/presalytics/client/doc_converter/api/default_api.html#presalytics.client.doc_converter.api.default_api.DefaultApi">DefaultApi</a></code> object.</p>
<p><em>Note</em>:
This attribute contains automatically generated methods via
the <a href="https://github.com/OpenAPITools/openapi-generator">OpenAPI generator</a>.
The
<code><a title="presalytics.client.doc_converter.api.default_api.DefaultApi" href="/python-client/presalytics/client/doc_converter/api/default_api.html#presalytics.client.doc_converter.api.default_api.DefaultApi">DefaultApi</a></code> has been passed an an <code>api_client</code>
keyword argument with an instance of <code><a title="presalytics.client.api.DocConverterApiClientWithAuth" href="/python-client/presalytics/client/api.html#presalytics.client.api.DocConverterApiClientWithAuth">DocConverterApiClientWithAuth</a></code>, which adds
an authentication and request processing middleware layer to the default sub package
built via code generatation.</p>
</dd>
<dt><strong><code>ooxml_automation</code></strong> :&ensp;<code><a title="presalytics.client.ooxml_automation.api.default_api.DefaultApi" href="/python-client/presalytics/client/ooxml_automation/api/default_api.html#presalytics.client.ooxml_automation.api.default_api.DefaultApi">DefaultApi</a></code></dt>
<dd>
<p>Interface to the Presalytics API Ooxml Automation service.
The object contains methods that enable
the client to make api calls that return deserialized objects from the Presalytics API,
simplying user and developer interaction with the Presaltytics API.
API calls can be generated
as follows:</p>
<pre><code>client = presalytics.Client()
api_obj = client.ooxml_automation.{operation_id}(*args)
</code></pre>
<p>where <code>{operation_id}</code> is the <code>operationId</code> assocated with the endpoint specified the <a href="https://presalytics.io/docs/api-specifications/ooxml-automation/">Ooxml Automation
Service OpenAPI Contract</a> , and *args
are the corresponding arguments that are passed to the method.
A complete list of the avialable
methods is shown on the <code><a title="presalytics.client.ooxml_automation.api.default_api.DefaultApi" href="/python-client/presalytics/client/ooxml_automation/api/default_api.html#presalytics.client.ooxml_automation.api.default_api.DefaultApi">DefaultApi</a></code> object.</p>
<p><em>Note</em>:
This attribute contains automatically generated methods via
the <a href="https://github.com/OpenAPITools/openapi-generator">OpenAPI generator</a>.
The
<code><a title="presalytics.client.ooxml_automation.api.default_api.DefaultApi" href="/python-client/presalytics/client/ooxml_automation/api/default_api.html#presalytics.client.ooxml_automation.api.default_api.DefaultApi">DefaultApi</a></code> has been passed an an <code>api_client</code>
keyword argument with an instance of <code><a title="presalytics.client.api.OoxmlAutomationApiClientWithAuth" href="/python-client/presalytics/client/api.html#presalytics.client.api.OoxmlAutomationApiClientWithAuth">OoxmlAutomationApiClientWithAuth</a></code>, which adds
an authentication and request processing middleware layer to the default sub package
built via code generatation.</p>
</dd>
<dt><strong><code>story</code></strong> :&ensp;<code><a title="presalytics.client.story.api.default_api.DefaultApi" href="/python-client/presalytics/client/story/api/default_api.html#presalytics.client.story.api.default_api.DefaultApi">DefaultApi</a></code></dt>
<dd>
<p>Interface to the Presalytics API Ooxml Automation service.
The object contains methods that enable
the client to make api calls that return deserialized objects from the Presalytics API,
simplying user and developer interaction with the Presaltytics API.
API calls can be generated
as follows:</p>
<pre><code>client = presalytics.Client()
api_obj = client.story.{operation_id}(*args)
</code></pre>
<p>where <code>{operation_id}</code> is the <code>operationId</code> assocated with the endpoint specified the <a href="https://presalytics.io/docs/api-specifications/story/">Ooxml Automation
Service OpenAPI Contract</a> , and *args
are the corresponding arguments that are passed to the method.
A complete list of the avialable
methods is shown on the <code><a title="presalytics.client.story.api.default_api.DefaultApi" href="/python-client/presalytics/client/story/api/default_api.html#presalytics.client.story.api.default_api.DefaultApi">DefaultApi</a></code> object.</p>
<p><em>Note</em>:
This attribute contains automatically generated methods via
the <a href="https://github.com/OpenAPITools/openapi-generator">OpenAPI generator</a>.
The
<code><a title="presalytics.client.story.api.default_api.DefaultApi" href="/python-client/presalytics/client/story/api/default_api.html#presalytics.client.story.api.default_api.DefaultApi">DefaultApi</a></code> has been passed an an <code>api_client</code>
keyword argument with an instance of <code><a title="presalytics.client.api.StoryApiClientWithAuth" href="/python-client/presalytics/client/api.html#presalytics.client.api.StoryApiClientWithAuth">StoryApiClientWithAuth</a></code>, which adds
an authentication and request processing middleware layer to the default sub package
built via code generatation.</p>
</dd>
<dt><strong><code>client_id</code></strong> :&ensp;<code>str</code></dt>
<dd>The client_id that is used OpenID Connect login.
Defaults to "python-client".</dd>
<dt><strong><code>client_secret</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The client_secret used during OpenID Connect login.
Useful <code>confidential_client</code> is True.</dd>
<dt><strong><code>confidential_client</code></strong> :&ensp;<code>bool</code></dt>
<dd>Indicates whether a this client can obtain tokens from auth.presalytics.io without a user under
OpenID Connect grant type "confidential_client".
Requires a <code>client_secret</code>.
Default is False.</dd>
<dt><strong><code>oidc</code></strong> :&ensp;<code><a title="presalytics.client.oidc.OidcClient" href="/python-client/presalytics/client/oidc.html#presalytics.client.oidc.OidcClient">OidcClient</a></code></dt>
<dd>A middleware class to help acquire and validate tokens from login.presalytics.io.</dd>
<dt><strong><code>token_util</code></strong> :&ensp;<code><a title="presalytics.client.auth.TokenUtil" href="/python-client/presalytics/client/auth.html#presalytics.client.auth.TokenUtil">TokenUtil</a></code></dt>
<dd>A handler for managing an caching tokens acquired from auth.presalytics.io.</dd>
<dt><strong><code>site_host</code></strong> :&ensp;<code>str</code></dt>
<dd>The login site host for acquiring tokens.
Set from <code>presalytics.settings</code> with keyword <code>HOST_SITE</code>.
Defaults to <a href="https://presalytics.io.">https://presalytics.io.</a></dd>
<dt><strong><code>redirect_uri</code></strong> :&ensp;<code>str</code></dt>
<dd>Useful if implementing authorization code flow for and OpenID Connect client.
Redirect URIs must
be approved by Presalytics API devops for use in client applications. Set from Set from
<code>presalytics.settings</code> with keyword <code>REDIRECT_URI</code>.
Defaults to <a href="https://presalytics.io/user/login-success.">https://presalytics.io/user/login-success.</a></dd>
<dt><strong><code>login_sleep_interval</code></strong> :&ensp;<code>int</code></dt>
<dd>The duration (in seconds) between attempts to acquire a token after browser-based authentication. Defaults
to 5 seconds.</dd>
<dt><strong><code>login_timeout</code></strong> :&ensp;<code>int</code></dt>
<dd>Defaults to 60 seconds.
The amount of time the client will attempt to acquire a token after the
<a href="https://presalytics.io">https://presalytics.io</a> authenicates a user. Raises a <code><a title="presalytics.lib.exceptions.LoginTimeout" href="/python-client/presalytics/lib/exceptions.html#presalytics.lib.exceptions.LoginTimeout">LoginTimeout</a></code>
if the user has not authenticated by the time the interval has expired.</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/client/api.py#L27-L485" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class Client(object):
    &#34;&#34;&#34; Class for interacting with Presalytics API endpoints

    The Client class creates a simple interface for user to interactive with the
    Presalytics API and is the primary building block for user-built automation of stories,
    dashboards, and interactive presentations.

    A client instance wraps python functions around Presalytics API endpoints and
    manages user authentication. On initialization, he client checks the status of
    a user authentication the expiry of their refresh an access tokens.  When needed,
    the client will open a browser to prompt the user to login at the presalytics.io
    login page (or raise an `presalytics.lib.exceptions.InvalidTokenException` when
    `delegate_login` is `True`).

    After authenication, users can call the methods bound to the story, ooxml_automation,
    and doc_converter attributes to make calls in into the Presalytics API.

    *A note for server-side development*:

    The client class can automatically cache tokens in a file called
    &#34;token.json&#34;, located in the python&#39;s current working directory.  This is done so
    users running scripts accross multiple client instances do not have to acquire a new token
    every time an API call is made. If building a client to operate in a multi-user environment,
    this behavior should be turned off so that one user cannot not pull one another&#39;s tokens.
    To do this, ensure the following parameters are pass to the configuration either
    via initialization or in a `presaltyics.settings`:

        cache_tokens = False,
        delegate_login = True

    When delegate login is True, the client assumes that the application creating
    instances of the client object will handle user authentication.  The simplest way
    to do this is to pass a token to the client via the &#34;token&#34; keyword argument.

    Parameters
    ----------

    username : str, optional
        Defaults to None.  The user&#39;s Presalytics API username.  This keyword will take precedence over a passed to the client
        via `presalytics.settings`.  The username must either be present in `presalytics.settings` or be passed in
        via keyword, otherwise the client will raise a `presalytics.lib.exceptions.MissingConfigException`.

    password : str, optional
        Defaults to None.  The user&#39;s Presalytics API password.  This useful for quickly testing scripts, but in most
        scenario users should not be passing plaintext into the client via this keyword.  In a secure, single-user
        environment, passwords are better placed in the `presalytics.settings` object for reuseability.  A more secure
        is to leave passwords out of the configuration, keep `delegate_login` = `False`, and acquire tokens via the browser.

    delegate_login : bool, optional
        Defaults to False.  Indicates whether the client would redirect to a browser to
        acquire an API token. If `DELEGATE_LOGIN` is `True`, when the `presalytics.client.api.Client` does not have
        access to a valid API token, the client will raise a `presalytics.lib.exceptions.InvalidTokenException`.
        The default operation will automatically open a new browser tab to acquire a new token
        via website client from the presalytics.io login page.  Putting this setting to True is
        useful for server-side development.

    token : dict, optional
        Defaults to None.  A dictionary contain information about tokens acquire from auth.presalytics.io.  The
        dictionary must contain an `access_token`, a `refresh_token`, and entries contiaing information about token expiry.

        Token expiry information can either passed in ISO 8601 formatted string with a UTC offset as dictionary keys
        `access_token_expire_time` and `refresh_token_expire_time` or an integer in seconds with the corresponding
        dictionary keys`expires_in` and `refresh_expires_in`.

        if the `dict` passed in via this keywork does is not have the correct entries, the client will
        raise an `presalytics.lib.exceptions.InvalidTokenException`.

    cache_tokens : bool, optional
        Defaults to False.  Toggles whether or the client should cache its acquired tokens in file called &#34;token.json&#34;
        in the current working directory.  Minimizes the number of times a user is required to login.  Set to False
        in multi-user environments.

    Attributes
    ----------

    direct_grant : bool
        Indicates whether an token will be acquire via the &#34;direct_grant&#34; OpenID Connect flow.  Usually indicates
        whether the user has supplied a passwork to the client either through `presalytics.settings` ro
        during object initialization.

    doc_converter : presalytics.client.doc_converter.api.default_api.DefaultApi
        Interface to the Presalytics API Doc Converter service.  The object contains methods that enable
        the client to make api calls that return deserialized objects from the Presalytics API,
        simplying user and developer interaction with the Presaltytics API.  API calls can be generated
        as follows:

            client = presalytics.Client()
            api_obj = client.doc_converter.{operation_id}(*args)

        where `{operation_id}` is the `operationId` assocated with the endpoint specified the [Doc Converter
        Service OpenAPI Contract](https://presalytics.io/docs/api-specifications/doc-converter/) , and *args
        are the corresponding arguments that are passed to the method.  A complete list of the avialable
        methods is shown on the `presalytics.client.doc_converter.api.default_api.DefaultApi` object.

        *Note*:
        This attribute contains automatically generated methods via
        the [OpenAPI generator](https://github.com/OpenAPITools/openapi-generator).  The
        `presalytics.client.doc_converter.api.default_api.DefaultApi` has been passed an an `api_client`
        keyword argument with an instance of `presalytics.client.api.DocConverterApiClientWithAuth`, which adds
        an authentication and request processing middleware layer to the default sub package
        built via code generatation.

    ooxml_automation : presalytics.client.ooxml_automation.api.default_api.DefaultApi
        Interface to the Presalytics API Ooxml Automation service.  The object contains methods that enable
        the client to make api calls that return deserialized objects from the Presalytics API,
        simplying user and developer interaction with the Presaltytics API.  API calls can be generated
        as follows:

            client = presalytics.Client()
            api_obj = client.ooxml_automation.{operation_id}(*args)

        where `{operation_id}` is the `operationId` assocated with the endpoint specified the [Ooxml Automation
        Service OpenAPI Contract](https://presalytics.io/docs/api-specifications/ooxml-automation/) , and *args
        are the corresponding arguments that are passed to the method.  A complete list of the avialable
        methods is shown on the `presalytics.client.ooxml_automation.api.default_api.DefaultApi` object.

        *Note*:
        This attribute contains automatically generated methods via
        the [OpenAPI generator](https://github.com/OpenAPITools/openapi-generator).  The
        `presalytics.client.ooxml_automation.api.default_api.DefaultApi` has been passed an an `api_client`
        keyword argument with an instance of `presalytics.client.api.OoxmlAutomationApiClientWithAuth`, which adds
        an authentication and request processing middleware layer to the default sub package
        built via code generatation.

    story : presalytics.client.story.api.default_api.DefaultApi
        Interface to the Presalytics API Ooxml Automation service.  The object contains methods that enable
        the client to make api calls that return deserialized objects from the Presalytics API,
        simplying user and developer interaction with the Presaltytics API.  API calls can be generated
        as follows:

            client = presalytics.Client()
            api_obj = client.story.{operation_id}(*args)

        where `{operation_id}` is the `operationId` assocated with the endpoint specified the [Ooxml Automation
        Service OpenAPI Contract](https://presalytics.io/docs/api-specifications/story/) , and *args
        are the corresponding arguments that are passed to the method.  A complete list of the avialable
        methods is shown on the `presalytics.client.story.api.default_api.DefaultApi` object.

        *Note*:
        This attribute contains automatically generated methods via
        the [OpenAPI generator](https://github.com/OpenAPITools/openapi-generator).  The
        `presalytics.client.story.api.default_api.DefaultApi` has been passed an an `api_client`
        keyword argument with an instance of `presalytics.client.api.StoryApiClientWithAuth`, which adds
        an authentication and request processing middleware layer to the default sub package
        built via code generatation.

    client_id : str
        The client_id that is used OpenID Connect login.  Defaults to &#34;python-client&#34;.

    client_secret : str, optional
        The client_secret used during OpenID Connect login.  Useful `confidential_client` is True.

    confidential_client : bool
        Indicates whether a this client can obtain tokens from auth.presalytics.io without a user under
        OpenID Connect grant type &#34;confidential_client&#34;.  Requires a `client_secret`.  Default is False.

    oidc : `presalytics.client.oidc.OidcClient`
        A middleware class to help acquire and validate tokens from login.presalytics.io.

    token_util : `presalytics.client.auth.TokenUtil`
        A handler for managing an caching tokens acquired from auth.presalytics.io.

    site_host : str
        The login site host for acquiring tokens.  Set from `presalytics.settings` with keyword `HOST_SITE`.
        Defaults to https://presalytics.io.

    redirect_uri : str
        Useful if implementing authorization code flow for and OpenID Connect client.  Redirect URIs must
        be approved by Presalytics API devops for use in client applications. Set from Set from
        `presalytics.settings` with keyword `REDIRECT_URI`.  Defaults to https://presalytics.io/user/login-success.

    login_sleep_interval : int
        The duration (in seconds) between attempts to acquire a token after browser-based authentication. Defaults
        to 5 seconds.

    login_timeout : int
        Defaults to 60 seconds.  The amount of time the client will attempt to acquire a token after the
        https://presalytics.io authenicates a user. Raises a `presalytics.lib.exceptions.LoginTimeout`
        if the user has not authenticated by the time the interval has expired.

    &#34;&#34;&#34;

    def __init__(
            self,
            username=None,
            password=None,
            delegate_login=False,
            token=None,
            cache_tokens=False,
            client_id=None,
            client_secret=None,
            **kwargs):

        if username:
            self.username = username
        else:
            try:
                self.username = presalytics.settings.USERNAME
            except KeyError:
                if token:
                    self.username = None
                else:
                    if not client_secret:
                        raise presalytics.lib.exceptions.MissingConfigException(&#34;when not passing tokens directly, a clien must have either a client_secrect or a username&#34;)
        try:
            if password:
                self.password = password
            else:
                self.password = presalytics.settings.PASSWORD
            self.direct_grant = True
        except KeyError:
            self.password = None
            self.direct_grant = False
        try:
            if client_id:
                self.client_id = client_id
            else:
                self.client_id = presalytics.settings.CLIENT_ID
        except KeyError:
            self.client_id = cnst.DEFAULT_CLIENT_ID
        try:
            if client_secret:
                self.client_secret = client_secret
            else:
                self.client_secret = presalytics.settings.CLIENT_SECRET
            self.confidential_client = True
        except KeyError:
            self.client_secret = None
            self.confidential_client = False

        try:
            self.site_host = presalytics.settings.HOST_SITE
        except KeyError:
            self.site_host = cnst.SITE_HOST

        try:
            self.redirect_uri = presalytics.settings.REDIRECT_URI
        except KeyError:
            self.redirect_uri = cnst.REDIRECT_URI
        if delegate_login or presalytics.settings.DELEGATE_LOGIN:
            self._delegate_login = True
        else:
            self._delegate_login = False
        self.oidc = presalytics.client.oidc.OidcClient(
            client_id=self.client_id,
            client_secret=self.client_secret
        )
        if presalytics.settings.CACHE_TOKENS:
            cache_tokens = presalytics.settings.CACHE_TOKENS
        self.token_util = presalytics.client.auth.TokenUtil(token_cache=cache_tokens)
        if token:
            #  Assume if token is passed as string, then it&#39;s an access token
            if isinstance(token, str):
                self.token_util.token = {&#34;access_token&#34;: token}

            # if token is a dictionary with an &#39;access_token_expire_time&#39; key, it&#39;s previous been processed / deserialized
            elif token.get(&#39;access_token_expire_time&#39;, None):
                self.token_util.token = token

            # if token has an &#39;expires_in&#39; key, if has not been deserialized
            elif token.get(&#39;expires_in&#39;, None):
                self.token_util.process_token(token)
            else:
                raise presalytics.lib.exceptions.InvalidTokenException(message=&#34;Unknown token format.&#34;)
            if self.token_util.token_cache:
                self.token_util._put_token_file()
        if not self._delegate_login:
            self.token_util.token = self.refresh_token()

        doc_converter_api_client = DocConverterApiClientWithAuth(self, **kwargs)
        self.doc_converter = presalytics.client.doc_converter.DefaultApi(api_client=doc_converter_api_client)
        ooxml_automation_api_client = OoxmlAutomationApiClientWithAuth(self, **kwargs)
        self.ooxml_automation = presalytics.client.ooxml_automation.DefaultApi(api_client=ooxml_automation_api_client)
        story_api_client = StoryApiClientWithAuth(self, **kwargs)
        self.story = presalytics.client.story.DefaultApi(api_client=story_api_client)

    def login(self):
        &#34;&#34;&#34;
        Triggers a an attempt to acquire an API token based on the the client configuration
        &#34;&#34;&#34;
        if self.direct_grant:
            token = self.oidc.token(username=self.username, password=self.password)
        else:
            token = self.oidc.token(username=self.username)
        self.token_util.process_token(token)
        return self.token_util.token

    def refresh_token(self):
        &#34;&#34;&#34;
        Obtains a new access token if the access token is expired. if refresh token is expired,
        this method prompt user to re-authenticate when `delegate_login` is `False` or raise
        an `presalytics.lib.exceptions.InvalidTokenException` when `deletegate_login` is True.
        &#34;&#34;&#34;
        if self.token_util.is_api_access_token_expired():
            if self.token_util.token.get(&#39;refresh_token&#39;, None) and self.client_secret:
                refresh_token = self.token_util.token[&#34;refresh_token&#34;]
                token = self.oidc.refresh_token(refresh_token)
                self.token_util.process_token(token)
                logger.debug(&#34;Refresh token granted successfully.&#34;)
            else:
                if self.direct_grant:
                    token = self.oidc.token(username=self.username, password=self.password)
                elif self.confidential_client:
                    token = self.oidc.client_credentials_token()
                elif self._delegate_login:
                    raise presalytics.lib.exceptions.ApiError(&#34;Unauthorized. Token has expired&#34;, status_code=401)
                else:
                    token = self.oidc.token(username=self.username)
                self.token_util.process_token(token)
            if self.token_util.token_cache:
                self.token_util._put_token_file()
        return self.token_util.token

    def get_auth_header(self):
        &#34;&#34;&#34;
        Creates a JWT Bearer Authorization token header

        Returns
        ----------
        A `dict` authorization crediential to be attached to an API request
        &#34;&#34;&#34;
        tkn = self.get_access_token()
        auth_header = {
            &#34;Authorization&#34;: &#34;Bearer &#34; + tkn
        }
        return auth_header

    def get_access_token(self):
        &#34;&#34;&#34;
        Refreshes tokens and returns updated access token

        Returns
        ----------
        A `str` containing a JWT bearer access token
        &#34;&#34;&#34;
        self.refresh_token()
        return self.token_util.token[&#34;access_token&#34;]

    def get_request_id_header(self):
        &#34;&#34;&#34;
        Creates an &#39;X-Request-Id&#39; token header for tracing requests through Presalytics API
        services.  If deployed alongside the [WSGI Microservice Middleware](https://github.com/presalytics/WSGI-Microservice-Middleware)
        package, this method will pull the request id from the call stack.

        Returns
        ----------
        A `dict` header representation with an &#39;X-Request-Id&#39; key to be attached to an API request
        &#34;&#34;&#34;

        current_request_id = wsgi_microservice_middleware.current_request_id()
        if not current_request_id:
            current_request_id = str(uuid4())
        header = {
            &#34;X-Request-Id&#34;: current_request_id
        }
        return header

    def download_file(self, story_id, ooxml_automation_id, download_folder=None, filename=None, **kwargs):
        &#34;&#34;&#34;
        Downloads an updated Ooxml Automation file and places the file in a designated folder

        Parameters
        ---------
        story : str
            The id of the Presalytics Story API object that manages access to document

        ooxml_automation_id : str
            The id of the Presalytics API Ooxml Automation service object that you want to download

        download_folder : str, optional
            The filepath to the local directory that you want to download the file to. Defaults to the
            current working directory.

        filename: str, optional
            The name of the downloaded file. Defaults to the original filename the the object was created.

        &#34;&#34;&#34;
        response, status, headers = self.story.story_id_file_ooxmlautomationid_get_with_http_info(story_id, ooxml_automation_id, _preload_content=False)
        if download_folder is None:
            download_folder = os.getcwd()
        if filename is None:
            cd_header = headers.get(&#39;Content-Disposition&#39;)
            _, params = cgi.parse_header(cd_header)
            filename = params[&#34;filename&#34;]
        filepath = os.path.join(download_folder, filename)
        with open(filepath, &#39;wb&#39;) as f:
            f.write(response.data)

    def get_client_info(self):
        &#34;&#34;&#34;
        Convenience method returning information about this client to pass to downstream objects, e.g.,
        components and new client instances

        Returns
        ----------
        A dictionary containing instances values:
            - token: self.token_util.token
            - client_id: self.client_id
            - cache_tokens: self.token_util.token_cache
            - delegate_login: self.delegate login
        &#34;&#34;&#34;
        return {
            &#34;token&#34;: self.token_util.token,
            &#34;client_id&#34;: self.client_id,
            &#34;cache_tokens&#34;: self.token_util.token_cache,
            &#34;delegate_login&#34;: self._delegate_login
        }

    STATUS_REPOLL_SECONDS = 2
    STATUS_REPOLL_MAX_CYCLES = 20

    def upload_file_and_await_outline(self,
                                      file: typing.Union[FileStorage, str],
                                      include_relationships=True,
                                      status_repoll_seconds: int = None,
                                      repoll_max_cycles: int = None):
        &#34;&#34;&#34; Useful for testing &#34;&#34;&#34;
        if isinstance(file, str):
            content_type = mimetypes.guess_type(file, False)[0]  # type: ignore
            with open(file, &#39;rb&#39;) as f:  # type: ignore
                stream = io.BytesIO(f.read())
            file = FileStorage(
                stream=stream,  # type: ignore
                filename=file,  # type: ignore
                content_type=content_type,
                content_length=stream.__sizeof__()
            )
        if not status_repoll_seconds:
            status_repoll_seconds = self.STATUS_REPOLL_SECONDS
        if not repoll_max_cycles:
            repoll_max_cycles = self.STATUS_REPOLL_MAX_CYCLES
        story = self.story.story_post_file(file=file)
        self.await_outline(story.id)
        return self.story.story_id_get(story.id, include_outline=True, include_relationships=include_relationships)

    def await_outline(self,
                      story_id,
                      status_repoll_seconds: int = None,
                      repoll_max_cycles: int = None):
        task_running = True
        repoll_cycle_count = 0
        if not status_repoll_seconds:
            status_repoll_seconds = self.STATUS_REPOLL_SECONDS
        if not repoll_max_cycles:
            repoll_max_cycles = self.STATUS_REPOLL_MAX_CYCLES
        while task_running:
            status, status_code, _ = self.story.story_id_status_get_with_http_info(story_id)
            if status_code == 204:
                task_running = False
            elif status_code == 200:
                if status.status == &#34;SUCCESS&#34;:
                    task_running = False
                elif repoll_cycle_count &gt;= repoll_max_cycles:
                    raise presalytics.lib.exceptions.ApiError(message=&#34;Error occured while uploading file&#34;, status_code=500)
                else:
                    logger.info(&#34;Story creation task still running.  Rechecking status in {0} seconds&#34;.format(status_repoll_seconds))
                    time.sleep(status_repoll_seconds)
                    repoll_cycle_count += 1
        return self.story.story_id_outline_get(story_id)</code></pre>
</details>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.Client.STATUS_REPOLL_SECONDS"><code class="name">var <span class="ident">STATUS_REPOLL_SECONDS</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.Client.STATUS_REPOLL_MAX_CYCLES"><code class="name">var <span class="ident">STATUS_REPOLL_MAX_CYCLES</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.Client.login"><code class="name flex">
<span>def <span class="ident">login</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Triggers a an attempt to acquire an API token based on the the client configuration</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/client/api.py#L303-L312" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def login(self):
    &#34;&#34;&#34;
    Triggers a an attempt to acquire an API token based on the the client configuration
    &#34;&#34;&#34;
    if self.direct_grant:
        token = self.oidc.token(username=self.username, password=self.password)
    else:
        token = self.oidc.token(username=self.username)
    self.token_util.process_token(token)
    return self.token_util.token</code></pre>
</details>
</dd>
<dt id="presalytics.Client.refresh_token"><code class="name flex">
<span>def <span class="ident">refresh_token</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Obtains a new access token if the access token is expired. if refresh token is expired,
this method prompt user to re-authenticate when <code>delegate_login</code> is <code>False</code> or raise
an <code><a title="presalytics.lib.exceptions.InvalidTokenException" href="/python-client/presalytics/lib/exceptions.html#presalytics.lib.exceptions.InvalidTokenException">InvalidTokenException</a></code> when <code>deletegate_login</code> is True.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/client/api.py#L314-L338" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def refresh_token(self):
    &#34;&#34;&#34;
    Obtains a new access token if the access token is expired. if refresh token is expired,
    this method prompt user to re-authenticate when `delegate_login` is `False` or raise
    an `presalytics.lib.exceptions.InvalidTokenException` when `deletegate_login` is True.
    &#34;&#34;&#34;
    if self.token_util.is_api_access_token_expired():
        if self.token_util.token.get(&#39;refresh_token&#39;, None) and self.client_secret:
            refresh_token = self.token_util.token[&#34;refresh_token&#34;]
            token = self.oidc.refresh_token(refresh_token)
            self.token_util.process_token(token)
            logger.debug(&#34;Refresh token granted successfully.&#34;)
        else:
            if self.direct_grant:
                token = self.oidc.token(username=self.username, password=self.password)
            elif self.confidential_client:
                token = self.oidc.client_credentials_token()
            elif self._delegate_login:
                raise presalytics.lib.exceptions.ApiError(&#34;Unauthorized. Token has expired&#34;, status_code=401)
            else:
                token = self.oidc.token(username=self.username)
            self.token_util.process_token(token)
        if self.token_util.token_cache:
            self.token_util._put_token_file()
    return self.token_util.token</code></pre>
</details>
</dd>
<dt id="presalytics.Client.get_auth_header"><code class="name flex">
<span>def <span class="ident">get_auth_header</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Creates a JWT Bearer Authorization token header</p>
<h2 id="returns">Returns</h2>
<p>A <code>dict</code> authorization crediential to be attached to an API request</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/client/api.py#L340-L352" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_auth_header(self):
    &#34;&#34;&#34;
    Creates a JWT Bearer Authorization token header

    Returns
    ----------
    A `dict` authorization crediential to be attached to an API request
    &#34;&#34;&#34;
    tkn = self.get_access_token()
    auth_header = {
        &#34;Authorization&#34;: &#34;Bearer &#34; + tkn
    }
    return auth_header</code></pre>
</details>
</dd>
<dt id="presalytics.Client.get_access_token"><code class="name flex">
<span>def <span class="ident">get_access_token</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Refreshes tokens and returns updated access token</p>
<h2 id="returns">Returns</h2>
<p>A <code>str</code> containing a JWT bearer access token</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/client/api.py#L354-L363" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_access_token(self):
    &#34;&#34;&#34;
    Refreshes tokens and returns updated access token

    Returns
    ----------
    A `str` containing a JWT bearer access token
    &#34;&#34;&#34;
    self.refresh_token()
    return self.token_util.token[&#34;access_token&#34;]</code></pre>
</details>
</dd>
<dt id="presalytics.Client.get_request_id_header"><code class="name flex">
<span>def <span class="ident">get_request_id_header</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Creates an 'X-Request-Id' token header for tracing requests through Presalytics API
services.
If deployed alongside the <a href="https://github.com/presalytics/WSGI-Microservice-Middleware">WSGI Microservice Middleware</a>
package, this method will pull the request id from the call stack.</p>
<h2 id="returns">Returns</h2>
<p>A <code>dict</code> header representation with an 'X-Request-Id' key to be attached to an API request</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/client/api.py#L365-L382" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_request_id_header(self):
    &#34;&#34;&#34;
    Creates an &#39;X-Request-Id&#39; token header for tracing requests through Presalytics API
    services.  If deployed alongside the [WSGI Microservice Middleware](https://github.com/presalytics/WSGI-Microservice-Middleware)
    package, this method will pull the request id from the call stack.

    Returns
    ----------
    A `dict` header representation with an &#39;X-Request-Id&#39; key to be attached to an API request
    &#34;&#34;&#34;

    current_request_id = wsgi_microservice_middleware.current_request_id()
    if not current_request_id:
        current_request_id = str(uuid4())
    header = {
        &#34;X-Request-Id&#34;: current_request_id
    }
    return header</code></pre>
</details>
</dd>
<dt id="presalytics.Client.download_file"><code class="name flex">
<span>def <span class="ident">download_file</span></span>(<span>self, story_id, ooxml_automation_id, download_folder=None, filename=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Downloads an updated Ooxml Automation file and places the file in a designated folder</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>story</code></strong> :&ensp;<code>str</code></dt>
<dd>The id of the Presalytics Story API object that manages access to document</dd>
<dt><strong><code>ooxml_automation_id</code></strong> :&ensp;<code>str</code></dt>
<dd>The id of the Presalytics API Ooxml Automation service object that you want to download</dd>
<dt><strong><code>download_folder</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The filepath to the local directory that you want to download the file to. Defaults to the
current working directory.</dd>
<dt><strong><code>filename</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The name of the downloaded file. Defaults to the original filename the the object was created.</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/client/api.py#L384-L413" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def download_file(self, story_id, ooxml_automation_id, download_folder=None, filename=None, **kwargs):
    &#34;&#34;&#34;
    Downloads an updated Ooxml Automation file and places the file in a designated folder

    Parameters
    ---------
    story : str
        The id of the Presalytics Story API object that manages access to document

    ooxml_automation_id : str
        The id of the Presalytics API Ooxml Automation service object that you want to download

    download_folder : str, optional
        The filepath to the local directory that you want to download the file to. Defaults to the
        current working directory.

    filename: str, optional
        The name of the downloaded file. Defaults to the original filename the the object was created.

    &#34;&#34;&#34;
    response, status, headers = self.story.story_id_file_ooxmlautomationid_get_with_http_info(story_id, ooxml_automation_id, _preload_content=False)
    if download_folder is None:
        download_folder = os.getcwd()
    if filename is None:
        cd_header = headers.get(&#39;Content-Disposition&#39;)
        _, params = cgi.parse_header(cd_header)
        filename = params[&#34;filename&#34;]
    filepath = os.path.join(download_folder, filename)
    with open(filepath, &#39;wb&#39;) as f:
        f.write(response.data)</code></pre>
</details>
</dd>
<dt id="presalytics.Client.get_client_info"><code class="name flex">
<span>def <span class="ident">get_client_info</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Convenience method returning information about this client to pass to downstream objects, e.g.,
components and new client instances</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>A dictionary containing instances values:</code></dt>
<dd>
<ul>
<li>token: self.token_util.token</li>
<li>client_id: self.client_id</li>
<li>cache_tokens: self.token_util.token_cache</li>
<li>delegate_login: self.delegate login</li>
</ul>
</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/client/api.py#L415-L433" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_client_info(self):
    &#34;&#34;&#34;
    Convenience method returning information about this client to pass to downstream objects, e.g.,
    components and new client instances

    Returns
    ----------
    A dictionary containing instances values:
        - token: self.token_util.token
        - client_id: self.client_id
        - cache_tokens: self.token_util.token_cache
        - delegate_login: self.delegate login
    &#34;&#34;&#34;
    return {
        &#34;token&#34;: self.token_util.token,
        &#34;client_id&#34;: self.client_id,
        &#34;cache_tokens&#34;: self.token_util.token_cache,
        &#34;delegate_login&#34;: self._delegate_login
    }</code></pre>
</details>
</dd>
<dt id="presalytics.Client.upload_file_and_await_outline"><code class="name flex">
<span>def <span class="ident">upload_file_and_await_outline</span></span>(<span>self, file, include_relationships=True, status_repoll_seconds=None, repoll_max_cycles=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Useful for testing</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/client/api.py#L438-L460" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def upload_file_and_await_outline(self,
                                  file: typing.Union[FileStorage, str],
                                  include_relationships=True,
                                  status_repoll_seconds: int = None,
                                  repoll_max_cycles: int = None):
    &#34;&#34;&#34; Useful for testing &#34;&#34;&#34;
    if isinstance(file, str):
        content_type = mimetypes.guess_type(file, False)[0]  # type: ignore
        with open(file, &#39;rb&#39;) as f:  # type: ignore
            stream = io.BytesIO(f.read())
        file = FileStorage(
            stream=stream,  # type: ignore
            filename=file,  # type: ignore
            content_type=content_type,
            content_length=stream.__sizeof__()
        )
    if not status_repoll_seconds:
        status_repoll_seconds = self.STATUS_REPOLL_SECONDS
    if not repoll_max_cycles:
        repoll_max_cycles = self.STATUS_REPOLL_MAX_CYCLES
    story = self.story.story_post_file(file=file)
    self.await_outline(story.id)
    return self.story.story_id_get(story.id, include_outline=True, include_relationships=include_relationships)</code></pre>
</details>
</dd>
<dt id="presalytics.Client.await_outline"><code class="name flex">
<span>def <span class="ident">await_outline</span></span>(<span>self, story_id, status_repoll_seconds=None, repoll_max_cycles=None)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/client/api.py#L462-L485" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def await_outline(self,
                  story_id,
                  status_repoll_seconds: int = None,
                  repoll_max_cycles: int = None):
    task_running = True
    repoll_cycle_count = 0
    if not status_repoll_seconds:
        status_repoll_seconds = self.STATUS_REPOLL_SECONDS
    if not repoll_max_cycles:
        repoll_max_cycles = self.STATUS_REPOLL_MAX_CYCLES
    while task_running:
        status, status_code, _ = self.story.story_id_status_get_with_http_info(story_id)
        if status_code == 204:
            task_running = False
        elif status_code == 200:
            if status.status == &#34;SUCCESS&#34;:
                task_running = False
            elif repoll_cycle_count &gt;= repoll_max_cycles:
                raise presalytics.lib.exceptions.ApiError(message=&#34;Error occured while uploading file&#34;, status_code=500)
            else:
                logger.info(&#34;Story creation task still running.  Rechecking status in {0} seconds&#34;.format(status_repoll_seconds))
                time.sleep(status_repoll_seconds)
                repoll_cycle_count += 1
    return self.story.story_id_outline_get(story_id)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="presalytics.StoryOutline"><code class="flex name class">
<span>class <span class="ident">StoryOutline</span></span>
<span>(</span><span>info, pages, description, title, themes, plugins=None, id=None, story_id='empty', **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>A StoryOutline contains instructions for a <code><a title="presalytics.story.components.Renderer" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer">Renderer</a></code>
(e.g., <code><a title="presalytics.story.revealer.Revealer" href="/python-client/presalytics/story/revealer.html#presalytics.story.revealer.Revealer">Revealer</a></code>) to render an story into html.</p>
<p>A story outline's <code>info</code>, <code>pages</code>, <code>widgets</code>, and <code>themes</code> are intended to be easily editable
by both human users and machines via json serialization and deserialization, and the ecosystem
of tools that can be used to edit json objects. Once a valid <code><a title="presalytics.StoryOutline" href="/python-client/presalytics/index.html#presalytics.StoryOutline">StoryOutline</a></code> is
built, it contains sufficient instructions for this library find the required components in the user's
workspace and render theme.</p>
<p>StoryOutlines are stored in the <a href="https://presalytics.io/docs/api-specifications/story/">Presalytics API Story Service</a>.
The story service manages version history and user permissions for StoryOutlines.
For more information
about how outlines are used, please see the <a href="https://presalytics.io/docs/how-it-works/">How It Works</a>
section of the website.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>outline_version</code></strong> :&ensp;<code>str</code></dt>
<dd>the version of that StoryOuline schema.</dd>
<dt><strong><code>info</code></strong> :&ensp;<code><a title="presalytics.story.outline.Info" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.Info">Info</a></code></dt>
<dd>Metadata about this StoryOutline</dd>
<dt><strong><code>pages</code></strong> :&ensp;<code>list</code> of <code><a title="presalytics.story.outline.Page" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.Page">Page</a></code></dt>
<dd>The pages that will be rendered in this story</dd>
<dt><strong><code>themes</code></strong> :&ensp;<code>list</code> of <code><a title="presalytics.story.outline.Theme" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.Theme">Theme</a></code></dt>
<dd>The themes that will underlie each <code><a title="presalytics.story.outline.Page" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.Page">Page</a></code> in the StoryOutline</dd>
<dt><strong><code>title</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>A title for the story</dd>
<dt><strong><code>description</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>A description of the story</dd>
<dt><strong><code>story_id</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The Presalytics API Story Id.
Automatically added once the story outline has been pushed to
the server.</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/outline.py#L466-L551" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class StoryOutline(OutlineBase):
    &#34;&#34;&#34;
    A StoryOutline contains instructions for a `presalytics.story.components.Renderer`
    (e.g., `presalytics.story.revealer.Revealer`) to render an story into html.

    A story outline&#39;s `info`, `pages`, `widgets`, and `themes` are intended to be easily editable
    by both human users and machines via json serialization and deserialization, and the ecosystem
    of tools that can be used to edit json objects. Once a valid `StoryOutline` is
    built, it contains sufficient instructions for this library find the required components in the user&#39;s
    workspace and render theme.

    StoryOutlines are stored in the [Presalytics API Story Service](https://presalytics.io/docs/api-specifications/story/).
    The story service manages version history and user permissions for StoryOutlines.  For more information
    about how outlines are used, please see the [How It Works](https://presalytics.io/docs/how-it-works/)
    section of the website.

    Attributes
    ----------

    outline_version : str
        the version of that StoryOuline schema.

    info : presalytics.story.outline.Info
        Metadata about this StoryOutline

    pages : list of presalytics.story.outline.Page
        The pages that will be rendered in this story

    themes : list of presalytics.story.outline.Theme
        The themes that will underlie each `presalytics.story.outline.Page` in the StoryOutline

    title : str, optional
        A title for the story

    description: str, optional
        A description of the story

    story_id : str, optional
        The Presalytics API Story Id.  Automatically added once the story outline has been pushed to
        the server.

    &#34;&#34;&#34;
    outline_version: str
    info: Info
    pages: typing.List[Page]
    description: str
    title: str
    themes: typing.List[Theme]
    id: str

    __required__ = [
        &#39;outline_version&#39;,
        &#39;info&#39;,
        &#39;pages&#39;,
        &#39;title&#39;,
        &#39;id&#39;
    ]

    def __init__(self, info, pages, description, title, themes, plugins=None, id=None, story_id=&#34;empty&#34;, **kwargs):
        super(StoryOutline, self).__init__(**kwargs)
        self.outline_version = get_current_spec_version()
        self.info = Info.deserialize(info)
        self.pages = [Page.deserialize(x) for x in pages]
        if description:
            self.description = description
        else:
            self.description = &#34;&#34;
        if title:
            self.title = title
        else:
            self.title = &#34;&#34;
        if themes:
            self.themes = [Theme.deserialize(x) for x in themes]
        else:
            self.themes = []
        if plugins:
            self.plugins = [Plugin.deserialize(x) for x in plugins]
        else:
            self.plugins = []
        self.id = id or story_id
        if not kwargs.get(&#34;validate&#34;, True):
            self.validate()

        def validate(self):
            super(StoryOutline, self).validate()
            jsonschema.validate(instance=self.to_dict(), schema=load_latest_schema())</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.outline.OutlineBase" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.OutlineBase">OutlineBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.StoryOutline.outline_version"><code class="name">var <span class="ident">outline_version</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.StoryOutline.info"><code class="name">var <span class="ident">info</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.StoryOutline.pages"><code class="name">var <span class="ident">pages</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.StoryOutline.description"><code class="name">var <span class="ident">description</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.StoryOutline.title"><code class="name">var <span class="ident">title</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.StoryOutline.themes"><code class="name">var <span class="ident">themes</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.StoryOutline.id"><code class="name">var <span class="ident">id</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.story.outline.OutlineBase" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.OutlineBase">OutlineBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.story.outline.OutlineBase.deserialize" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.OutlineBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.story.outline.OutlineBase.dump" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.OutlineBase.dump">dump</a></code></li>
<li><code><a title="presalytics.story.outline.OutlineBase.export_yaml" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.OutlineBase.export_yaml">export_yaml</a></code></li>
<li><code><a title="presalytics.story.outline.OutlineBase.import_yaml" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.OutlineBase.import_yaml">import_yaml</a></code></li>
<li><code><a title="presalytics.story.outline.OutlineBase.load" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.OutlineBase.load">load</a></code></li>
<li><code><a title="presalytics.story.outline.OutlineBase.to_dict" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.OutlineBase.to_dict">to_dict</a></code></li>
<li><code><a title="presalytics.story.outline.OutlineBase.validate" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.OutlineBase.validate">validate</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.Renderer"><code class="flex name class">
<span>class <span class="ident">Renderer</span></span>
<span>(</span><span>story_outline, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Base class for objects that convert <code><a title="presalytics.story.outline.StoryOutline" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.StoryOutline">StoryOutline</a></code>
objects into html and rendering them over the web</p>
<p>With this class, users can push changes to their <code><a title="presalytics.story.outline.StoryOutline" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.StoryOutline">StoryOutline</a></code>
to the Presalytics API and web clients.
Renderer class contains a couplemethods for
syncing changes from component instances in the <code>presalytics.settings</code> to the Presalytics API
Story service.</p>
<ul>
<li>
<p>The <code>view</code> method allows users programattically view their stories at <a href="https://presalytics.io">https://presalytics.io</a>
after changes are made</p>
</li>
<li>
<p>The <code>manage</code> method takes users to to the story management interface, where users can share their
work with other users, continue making edits or change story properties.</p>
</li>
</ul>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>story_outline</code></strong> :&ensp;<code><a title="presalytics.story.outline.StoryOutline" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.StoryOutline">StoryOutline</a></code></dt>
<dd>The presalytics StoryOutline to be rendered and presented</dd>
</dl>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>plugins</code></strong> :&ensp;<code>list</code> of <code>dict</code></dt>
<dd>Plugin data that transform to html <code>&lt;script&gt;</code> and <code>&lt;link&gt;</code> tags through
the rendering process</dd>
<dt><strong><code>site_host</code></strong> :&ensp;<code>str</code></dt>
<dd>The host of the website.
Defaults to <a href="https://presalytics.io.">https://presalytics.io.</a></dd>
<dt><strong><code>view_url</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The url to view the story.
Unavailable if story outline has not been pushed to
the Presalytics API story service</dd>
<dt><strong><code>manage_url</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The url to view the story.
Unavailable if story outline has not been pushed to
the Presalytics API story service</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L368-L629" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class Renderer(ComponentBase):
    &#34;&#34;&#34;
    Base class for objects that convert `presalytics.story.outline.StoryOutline`
    objects into html and rendering them over the web

    With this class, users can push changes to their `presalytics.story.outline.StoryOutline`
    to the Presalytics API and web clients.  Renderer class contains a couplemethods for
    syncing changes from component instances in the `presalytics.settings` to the Presalytics API
    Story service.

    * The `view` method allows users programattically view their stories at https://presalytics.io
    after changes are made

    * The `manage` method takes users to to the story management interface, where users can share their
    work with other users, continue making edits or change story properties.


    Parameters
    ----------
    story_outline : presalytics.story.outline.StoryOutline
        The presalytics StoryOutline to be rendered and presented

    Attributes
    -----------
    plugins : list of dict
        Plugin data that transform to html `&lt;script&gt;` and `&lt;link&gt;` tags through
        the rendering process

    site_host : str
        The host of the website.  Defaults to https://presalytics.io.

    view_url : str, optional
         The url to view the story.  Unavailable if story outline has not been pushed to
         the Presalytics API story service

    manage_url : str, optional
         The url to view the story.  Unavailable if story outline has not been pushed to
         the Presalytics API story service
    &#34;&#34;&#34;
    story_outline: &#39;StoryOutline&#39;
    plugins: typing.List[typing.Dict]
    view_url: typing.Optional[str]
    manage_url: typing.Optional[str]

    __component_type__ = &#39;renderer&#39;

    def __init__(self, story_outline: &#39;StoryOutline&#39;, **kwargs):
        super(Renderer, self).__init__(**kwargs)
        self.story_outline = story_outline
        try:
            self.site_host = presalytics.settings.HOST_SITE  # type: ignore[attr-defined]
        except (KeyError, AttributeError):
            self.site_host = presalytics.lib.constants.SITE_HOST
        try:
            story_id = self.story_outline.story_id
            view_endpoint = presalytics.lib.constants.STORY_VIEW_URL.format(story_id)
            self.view_url = urllib.parse.urljoin(self.site_host, view_endpoint)
            manage_endpoint = presalytics.lib.constants.STORY_MANAGE_URL.format(story_id)
            self.manage_url = urllib.parse.urljoin(self.site_host, manage_endpoint)
        except (KeyError, AttributeError):
            self.view_url = None
            self.manage_url = None

    def render(self, **kwargs):
        &#34;&#34;&#34;
        Renders server-side (i.e., opens the story on https://presalytics.io)
        &#34;&#34;&#34;
        return self.view()

    def strip_unauthorized_scripts(self, body):
        &#34;&#34;&#34;
        Finds and removes unauthorized scripts from that the html document.  For security reasons,
        content in `&lt;script&gt;` tags that has not been vetted by presalytics.io devops

        If you would like to get a tag included in the base library, raise an issue on
        [Github](https://github.com/presalytics/python-client/issues/new).  We&#39;d love to hear from you and learn
        about your use case, and will respond promptly to help.
        &#34;&#34;&#34;
        allowed_scripts = presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().values()
        script_elements = body.findall(&#34;.//script&#34;)
        for ele in script_elements:
            remove_ele = True
            script_id = ele.get(&#34;id&#34;)
            if script_id in self.story_outline.allowed_ids:
                remove_ele = False
            link = ele.get(&#34;src&#34;)
            if link in allowed_scripts:
                remove_ele = False
            if remove_ele:
                ele.getparent().remove(ele)
        return body

    @classmethod
    def deserialize(cls, component: &#39;StoryOutline&#39;, **kwargs):
        &#34;&#34;&#34;
        Initializes the class from a `presalytics.story.outline.StoryOutline`.  See __init___.
        &#34;&#34;&#34;
        return cls(component, **kwargs)

    def serialize(self) -&gt; &#39;StoryOutline&#39;:
        &#34;&#34;&#34;
        Updates the story_outline

        Returns
        -----------
        A refreshed `presalytics.story.outline.StoryOutline`
        &#34;&#34;&#34;
        self.update_outline_from_instances()
        return self.story_outline

    def update_outline_from_instances(self, sub_dict: typing.Dict = None):
        &#34;&#34;&#34;
        If a component instance for the widget is available in `presalytics.COMPONENTS`,
        this method find the instance and regenerates the component data
        so the latest data is available during the renering process.
        &#34;&#34;&#34;
        if not sub_dict:
            sub_dict = self.story_outline.to_dict()
        if sub_dict:
            for key, val in sub_dict.items():
                if key in [&#34;widgets&#34;, &#34;themes&#34;, &#34;pages&#34;]:
                    if isinstance(val, list):
                        for list_item in val:
                            if isinstance(list_item, dict):
                                if &#34;kind&#34; in list_item:
                                    class_key = key.rstrip(&#34;s&#34;) + &#34;.&#34; + list_item[&#34;kind&#34;]
                                    klass = presalytics.COMPONENTS.get(class_key)
                                    if klass:
                                        if &#34;name&#34; in list_item:
                                            instance_key = class_key + &#34;.&#34; + list_item[&#34;name&#34;]
                                            inst = presalytics.COMPONENTS.get_instance(instance_key)
                                            if inst:
                                                self._set_outline_data_from_instance(inst)
                if isinstance(val, dict):
                    if len(val.keys()) &gt; 0:
                        self.update_outline_from_instances(val)
                if isinstance(val, list):
                    for list_item in val:
                        if isinstance(list_item, dict):
                            self.update_outline_from_instances(list_item)

    def get_component_implicit_plugins(self, sub_dict: typing.Dict = None):
        &#34;&#34;&#34;
        Retrieves plugin data from plugins attached to `presalytics.story.components`
        classes referenced in the `presalytics.story.outline.StoryOutline`
        &#34;&#34;&#34;
        if not sub_dict:
            sub_dict = self.story_outline.to_dict()
        if sub_dict:
            for key, val in sub_dict.items():
                if key in [&#34;widgets&#34;, &#34;themes&#34;, &#34;pages&#34;]:
                    if isinstance(val, list):
                        for list_item in val:
                            if isinstance(list_item, dict):
                                if &#34;kind&#34; in list_item:
                                    class_key = key.rstrip(&#34;s&#34;) + &#34;.&#34; + list_item[&#34;kind&#34;]
                                    klass = presalytics.COMPONENTS.get(class_key)
                                    if klass:
                                        if len(klass.__plugins__) &gt; 0:
                                            self.plugins.extend(klass.__plugins__)
                if isinstance(val, dict):
                    if len(val.keys()) &gt; 0:
                        self.get_component_implicit_plugins(val)
                if isinstance(val, list):
                    for list_item in val:
                        if isinstance(list_item, dict):
                            self.get_component_implicit_plugins(list_item)

    def _set_outline_data_from_instance(self, inst):

        if inst.__component_type__ == &#39;widget&#39;:
            self._set_widget_outline_data(inst)
        if inst.__component_type__ == &#39;page&#39;:
            self._set_page_outline_data(inst)
        if inst.__component_type__ == &#39;theme&#39;:
            self._set_theme_outline_data(inst)

    def _set_theme_outline_data(self, inst: &#39;ThemeBase&#39;):
        theme_index = None
        for t in range(0, len(self.story_outline.themes)):
            if inst.name == self.story_outline.themes[t].name:
                theme_index = t
            if theme_index:
                break
        theme_outline = inst.serialize()
        if theme_index:
            self.story_outline.themes[theme_index] = theme_outline

    def _set_page_outline_data(self, inst: &#39;PageTemplateBase&#39;):
        page_index = None
        for p in range(0, len(self.story_outline.pages)):
            if inst.name == self.story_outline.pages[p].name:
                page_index = p
            if page_index:
                break
        page_outline = inst.serialize()
        if page_index:
            self.story_outline.pages[page_index] = page_outline

    def _set_widget_outline_data(self, inst: &#39;WidgetBase&#39;):
        widget_index: typing.Optional[int]
        page_index: typing.Optional[int]
        widget_index = None
        page_index = None
        for p in range(0, len(self.story_outline.pages)):
            for w in range(0, len(self.story_outline.pages[p].widgets)):
                widget = self.story_outline.pages[p].widgets[w]
                if widget.name == inst.name:
                    page_index = p
                    widget_index = w
                if page_index:
                    break
            if page_index:
                break
        w_outline = inst.serialize()
        if isinstance(page_index, int) and isinstance(widget_index, int):  # Causes &#39;unsupported target for assingment error`
            self.story_outline.pages[page_index].widgets[widget_index] = w_outline  # type: ignore

    def update_story(self):
        &#34;&#34;&#34;
        Updates the StoryOutline and pushes those updates to the Presalytics API Story service
        &#34;&#34;&#34;
        self.update_outline_from_instances()
        client = presalytics.client.api.Client(**self.client_info)
        story = client.story.story_id_get(self.story_outline.story_id)
        story.outline = self.story_outline.dump()
        client.story.story_id_put(story.id, story)

    def view(self, update=False):
        &#34;&#34;&#34;
        Updates a story and opens it on the presalytics.io website

        Parameters
        ----------
        update : bool
            Defaults to True.  Indicates whether the StoryOutline should be updated
            prior to opening in the web browser
        &#34;&#34;&#34;
        if not self.view_url:
            message = &#34;The outline has not been pushed to the Presalytics API yet, and therefore cannot be viewed via presalytics.io&#34;
            raise presalytics.lib.exceptions.InvalidConfigurationError(message=message)
        if update:
            self.update_story()
        webbrowser.open_new_tab(self.view_url)

    def manage(self, update=False):
        &#34;&#34;&#34;
        Updates a story and opens the management page on the presalytics.io website

        Parameters
        ----------
        update : bool
            Defaults to True.  Indicates whether the StoryOutline should be updated
            prior to opening in the web browser
        &#34;&#34;&#34;
        if not self.manage_url:
            message = &#34;The outline has not been pushed to the Presalytics API yet, and therefore cannot be viewed via presalytics.io&#34;
            raise presalytics.lib.exceptions.InvalidConfigurationError(message=message)

        if update:
            self.update_story()
        webbrowser.open_new_tab(self.manage_url)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="presalytics.story.renderers.ClientSideRenderer" href="/python-client/presalytics/story/renderers.html#presalytics.story.renderers.ClientSideRenderer">ClientSideRenderer</a></li>
<li><a title="presalytics.story.revealer.Revealer" href="/python-client/presalytics/story/revealer.html#presalytics.story.revealer.Revealer">Revealer</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.Renderer.story_outline"><code class="name">var <span class="ident">story_outline</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.Renderer.plugins"><code class="name">var <span class="ident">plugins</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.Renderer.view_url"><code class="name">var <span class="ident">view_url</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.Renderer.manage_url"><code class="name">var <span class="ident">manage_url</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Static methods</h3>
<dl>
<dt id="presalytics.Renderer.deserialize"><code class="name flex">
<span>def <span class="ident">deserialize</span></span>(<span>component, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Initializes the class from a <code><a title="presalytics.story.outline.StoryOutline" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.StoryOutline">StoryOutline</a></code>.
See __init___.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L460-L465" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def deserialize(cls, component: &#39;StoryOutline&#39;, **kwargs):
    &#34;&#34;&#34;
    Initializes the class from a `presalytics.story.outline.StoryOutline`.  See __init___.
    &#34;&#34;&#34;
    return cls(component, **kwargs)</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.Renderer.render"><code class="name flex">
<span>def <span class="ident">render</span></span>(<span>self, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Renders server-side (i.e., opens the story on <a href="https://presalytics.io">https://presalytics.io</a>)</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L431-L435" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def render(self, **kwargs):
    &#34;&#34;&#34;
    Renders server-side (i.e., opens the story on https://presalytics.io)
    &#34;&#34;&#34;
    return self.view()</code></pre>
</details>
</dd>
<dt id="presalytics.Renderer.strip_unauthorized_scripts"><code class="name flex">
<span>def <span class="ident">strip_unauthorized_scripts</span></span>(<span>self, body)</span>
</code></dt>
<dd>
<section class="desc"><p>Finds and removes unauthorized scripts from that the html document.
For security reasons,
content in <code>&lt;script&gt;</code> tags that has not been vetted by presalytics.io devops</p>
<p>If you would like to get a tag included in the base library, raise an issue on
<a href="https://github.com/presalytics/python-client/issues/new">Github</a>.
We'd love to hear from you and learn
about your use case, and will respond promptly to help.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L437-L458" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def strip_unauthorized_scripts(self, body):
    &#34;&#34;&#34;
    Finds and removes unauthorized scripts from that the html document.  For security reasons,
    content in `&lt;script&gt;` tags that has not been vetted by presalytics.io devops

    If you would like to get a tag included in the base library, raise an issue on
    [Github](https://github.com/presalytics/python-client/issues/new).  We&#39;d love to hear from you and learn
    about your use case, and will respond promptly to help.
    &#34;&#34;&#34;
    allowed_scripts = presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().values()
    script_elements = body.findall(&#34;.//script&#34;)
    for ele in script_elements:
        remove_ele = True
        script_id = ele.get(&#34;id&#34;)
        if script_id in self.story_outline.allowed_ids:
            remove_ele = False
        link = ele.get(&#34;src&#34;)
        if link in allowed_scripts:
            remove_ele = False
        if remove_ele:
            ele.getparent().remove(ele)
    return body</code></pre>
</details>
</dd>
<dt id="presalytics.Renderer.serialize"><code class="name flex">
<span>def <span class="ident">serialize</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Updates the story_outline</p>
<h2 id="returns">Returns</h2>
<p>A refreshed <code><a title="presalytics.story.outline.StoryOutline" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.StoryOutline">StoryOutline</a></code></p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L467-L476" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def serialize(self) -&gt; &#39;StoryOutline&#39;:
    &#34;&#34;&#34;
    Updates the story_outline

    Returns
    -----------
    A refreshed `presalytics.story.outline.StoryOutline`
    &#34;&#34;&#34;
    self.update_outline_from_instances()
    return self.story_outline</code></pre>
</details>
</dd>
<dt id="presalytics.Renderer.update_outline_from_instances"><code class="name flex">
<span>def <span class="ident">update_outline_from_instances</span></span>(<span>self, sub_dict=None)</span>
</code></dt>
<dd>
<section class="desc"><p>If a component instance for the widget is available in <code><a title="presalytics.COMPONENTS" href="/python-client/presalytics/index.html#presalytics.COMPONENTS">COMPONENTS</a></code>,
this method find the instance and regenerates the component data
so the latest data is available during the renering process.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L478-L507" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def update_outline_from_instances(self, sub_dict: typing.Dict = None):
    &#34;&#34;&#34;
    If a component instance for the widget is available in `presalytics.COMPONENTS`,
    this method find the instance and regenerates the component data
    so the latest data is available during the renering process.
    &#34;&#34;&#34;
    if not sub_dict:
        sub_dict = self.story_outline.to_dict()
    if sub_dict:
        for key, val in sub_dict.items():
            if key in [&#34;widgets&#34;, &#34;themes&#34;, &#34;pages&#34;]:
                if isinstance(val, list):
                    for list_item in val:
                        if isinstance(list_item, dict):
                            if &#34;kind&#34; in list_item:
                                class_key = key.rstrip(&#34;s&#34;) + &#34;.&#34; + list_item[&#34;kind&#34;]
                                klass = presalytics.COMPONENTS.get(class_key)
                                if klass:
                                    if &#34;name&#34; in list_item:
                                        instance_key = class_key + &#34;.&#34; + list_item[&#34;name&#34;]
                                        inst = presalytics.COMPONENTS.get_instance(instance_key)
                                        if inst:
                                            self._set_outline_data_from_instance(inst)
            if isinstance(val, dict):
                if len(val.keys()) &gt; 0:
                    self.update_outline_from_instances(val)
            if isinstance(val, list):
                for list_item in val:
                    if isinstance(list_item, dict):
                        self.update_outline_from_instances(list_item)</code></pre>
</details>
</dd>
<dt id="presalytics.Renderer.get_component_implicit_plugins"><code class="name flex">
<span>def <span class="ident">get_component_implicit_plugins</span></span>(<span>self, sub_dict=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Retrieves plugin data from plugins attached to <code><a title="presalytics.story.components" href="/python-client/presalytics/story/components.html">presalytics.story.components</a></code>
classes referenced in the <code><a title="presalytics.story.outline.StoryOutline" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.StoryOutline">StoryOutline</a></code></p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L509-L534" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_component_implicit_plugins(self, sub_dict: typing.Dict = None):
    &#34;&#34;&#34;
    Retrieves plugin data from plugins attached to `presalytics.story.components`
    classes referenced in the `presalytics.story.outline.StoryOutline`
    &#34;&#34;&#34;
    if not sub_dict:
        sub_dict = self.story_outline.to_dict()
    if sub_dict:
        for key, val in sub_dict.items():
            if key in [&#34;widgets&#34;, &#34;themes&#34;, &#34;pages&#34;]:
                if isinstance(val, list):
                    for list_item in val:
                        if isinstance(list_item, dict):
                            if &#34;kind&#34; in list_item:
                                class_key = key.rstrip(&#34;s&#34;) + &#34;.&#34; + list_item[&#34;kind&#34;]
                                klass = presalytics.COMPONENTS.get(class_key)
                                if klass:
                                    if len(klass.__plugins__) &gt; 0:
                                        self.plugins.extend(klass.__plugins__)
            if isinstance(val, dict):
                if len(val.keys()) &gt; 0:
                    self.get_component_implicit_plugins(val)
            if isinstance(val, list):
                for list_item in val:
                    if isinstance(list_item, dict):
                        self.get_component_implicit_plugins(list_item)</code></pre>
</details>
</dd>
<dt id="presalytics.Renderer.update_story"><code class="name flex">
<span>def <span class="ident">update_story</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Updates the StoryOutline and pushes those updates to the Presalytics API Story service</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L586-L594" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def update_story(self):
    &#34;&#34;&#34;
    Updates the StoryOutline and pushes those updates to the Presalytics API Story service
    &#34;&#34;&#34;
    self.update_outline_from_instances()
    client = presalytics.client.api.Client(**self.client_info)
    story = client.story.story_id_get(self.story_outline.story_id)
    story.outline = self.story_outline.dump()
    client.story.story_id_put(story.id, story)</code></pre>
</details>
</dd>
<dt id="presalytics.Renderer.view"><code class="name flex">
<span>def <span class="ident">view</span></span>(<span>self, update=False)</span>
</code></dt>
<dd>
<section class="desc"><p>Updates a story and opens it on the presalytics.io website</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>update</code></strong> :&ensp;<code>bool</code></dt>
<dd>Defaults to True.
Indicates whether the StoryOutline should be updated
prior to opening in the web browser</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L596-L611" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def view(self, update=False):
    &#34;&#34;&#34;
    Updates a story and opens it on the presalytics.io website

    Parameters
    ----------
    update : bool
        Defaults to True.  Indicates whether the StoryOutline should be updated
        prior to opening in the web browser
    &#34;&#34;&#34;
    if not self.view_url:
        message = &#34;The outline has not been pushed to the Presalytics API yet, and therefore cannot be viewed via presalytics.io&#34;
        raise presalytics.lib.exceptions.InvalidConfigurationError(message=message)
    if update:
        self.update_story()
    webbrowser.open_new_tab(self.view_url)</code></pre>
</details>
</dd>
<dt id="presalytics.Renderer.manage"><code class="name flex">
<span>def <span class="ident">manage</span></span>(<span>self, update=False)</span>
</code></dt>
<dd>
<section class="desc"><p>Updates a story and opens the management page on the presalytics.io website</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>update</code></strong> :&ensp;<code>bool</code></dt>
<dd>Defaults to True.
Indicates whether the StoryOutline should be updated
prior to opening in the web browser</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L613-L629" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def manage(self, update=False):
    &#34;&#34;&#34;
    Updates a story and opens the management page on the presalytics.io website

    Parameters
    ----------
    update : bool
        Defaults to True.  Indicates whether the StoryOutline should be updated
        prior to opening in the web browser
    &#34;&#34;&#34;
    if not self.manage_url:
        message = &#34;The outline has not been pushed to the Presalytics API yet, and therefore cannot be viewed via presalytics.io&#34;
        raise presalytics.lib.exceptions.InvalidConfigurationError(message=message)

    if update:
        self.update_story()
    webbrowser.open_new_tab(self.manage_url)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.story.components.ComponentBase.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.ClientSideRenderer"><code class="flex name class">
<span>class <span class="ident">ClientSideRenderer</span></span>
<span>(</span><span>story_outline, pages=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Renders <code><a title="presalytics.story.outline.StoryOutline" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.StoryOutline">StoryOutline</a></code> objects to
<a href="https://github.com/hakimel/reveal.js/">reveal.js</a> presentations</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>story_outline</code></strong> :&ensp;<code><a title="presalytics.story.outline.StoryOutline" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.StoryOutline">StoryOutline</a></code></dt>
<dd>The presalytics StoryOutline to be rendered and presented</dd>
<dt><strong><code>pages</code></strong> :&ensp;<code>list[int]</code></dt>
<dd>A list of page numbers to render (starting at 0).
By default,
all pages are rendered</dd>
</dl>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>plugins</code></strong> :&ensp;<code>list</code> of <code>dict</code></dt>
<dd>Plugin data that transform to html <code>&lt;script&gt;</code> and <code>&lt;link&gt;</code> tags through
the rendering process</dd>
<dt><strong><code>plugin_mgr</code></strong> :&ensp;<code><a title="presalytics.lib.plugins.base.PluginManager" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginManager">PluginManager</a></code></dt>
<dd>Sorts, validates, and renders plugins</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/renderers.py#L29-L155" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class ClientSideRenderer(presalytics.story.components.Renderer):
    &#34;&#34;&#34;
    Renders `presalytics.story.outline.StoryOutline` objects to
    [reveal.js](https://github.com/hakimel/reveal.js/) presentations

    Parameters
    ----------
    story_outline : presalytics.story.outline.StoryOutline
        The presalytics StoryOutline to be rendered and presented

    pages : `list[int]`
        A list of page numbers to render (starting at 0).  By default,
        all pages are rendered

    Attributes
    -----------

    plugins : list of dict
        Plugin data that transform to html `&lt;script&gt;` and `&lt;link&gt;` tags through
        the rendering process

    plugin_mgr : presalytics.lib.plugins.base.PluginManager
        Sorts, validates, and renders plugins

    &#34;&#34;&#34;

    __component_kind__ = &#39;client_side&#39;

    def __init__(
            self,
            story_outline: &#39;StoryOutline&#39;,
            pages: typing.List[int] = None,
            **kwargs):
        super(ClientSideRenderer, self).__init__(story_outline, **kwargs)
        self.story_outline.validate()
        if isinstance(pages, int):
            pages = [pages]
        elif not pages:
            pages = [p for p in range(0, len(self.story_outline.pages))]
        elif not isinstance(pages, list) or not isinstance(pages[0], int):
            raise presalytics.lib.exceptions.InvalidArgumentException(message=&#39;&#34;pages&#34; must be a list of integers&#39;)
        if len([p for p in pages if p &gt;= len(self.story_outline.pages)]) &gt; 0:
            raise presalytics.lib.exceptions.InvalidArgumentException(message=&#39;&#34;pages&#34; can only contain integers lower than the number of pages in the story&#39;)
        self.pages_to_render = pages
        self.update_outline_from_instances()
        self.plugins = []
        self.get_component_implicit_plugins()
        outline_plugins = presalytics.lib.plugins.base.PluginManager.get_plugins_from_nested_dict(source_dict=self.story_outline.to_dict())
        self.plugins.extend(outline_plugins)
        self.plugin_mgr = presalytics.lib.plugins.base.PluginManager(self.plugins)

    def package(self, base64=True) -&gt; typing.Dict:
        &#34;&#34;&#34;
        Prepares a story for rendering via a client-side application

        Returns
        ----------

        A dictionary of lists of html fragments with 3 keys: `pages`, `styles` and `scripts`
        &#34;&#34;&#34;
        pages = self.render()
        scripts = self.plugin_mgr.get_scripts()
        styles = self.plugin_mgr.get_styles()
        if base64:
            pages = presalytics.lib.util.list_to_base64(pages)
            scripts = presalytics.lib.util.list_to_base64(scripts)
            styles = presalytics.lib.util.list_to_base64(styles)
        return {
            &#34;pages&#34;: pages,
            &#34;scripts&#34;: scripts,
            &#34;styles&#34;: styles
        }

    def update_info(self):
        &#34;&#34;&#34;
        Updates story metadata
        &#34;&#34;&#34;
        info = self.story_outline.info
        info.date_modified = datetime.datetime.utcnow()

    def render(self):
        &#34;&#34;&#34;
        Creates a reveal.js presenation html fragement

        Returns:
        ---------
        A `list` of `str` html fragments for each page
        &#34;&#34;&#34;
        slides = []
        for p in range(0, len(self.story_outline.pages)):
            if p in self.pages_to_render:
                page = self.story_outline.pages[p]
                page_html = self.render_page(page)
                slide_fragment = lxml.html.fragment_fromstring(page_html)
                slides.append(slide_fragment)
        return slides

    def render_page(self, page: &#39;Page&#39;) -&gt; str:
        &#34;&#34;&#34;
        Creates a reveal.js slide

        Returns
        ----------
        A `str` html framgment of the page
        &#34;&#34;&#34;
        class_key = &#34;page.&#34; + page.kind
        key = class_key + &#34;.&#34; + page.name
        try:
            if presalytics.COMPONENTS.get_instance(key):
                page_instance = presalytics.COMPONENTS.get_instance(key)
            else:
                klass = presalytics.COMPONENTS.get(class_key)
                deserialize_method = getattr(klass, &#34;deserialize&#34;, None)
                if callable(deserialize_method):
                    page_instance = deserialize_method(page, client_info=self.client_info)
                else:
                    message = &#39;Page component instance or class (kind) &#34;{0}&#34; unavailable in component registry&#39;.format(key)
                    raise presalytics.lib.exceptions.MissingConfigException(message)
            page_html = page_instance.render()
        except Exception as ex:
            logger.exception(ex)
            t, v, tb = sys.exc_info()
            if not presalytics.settings.DEBUG:  # type: ignore[attr-defined]
                page_html = presalytics.lib.exceptions.RenderExceptionHandler(ex, &#34;page&#34;, traceback=tb).render_exception()
            else:
                six.reraise(t, v, tb)
        return page_html</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.components.Renderer" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer">Renderer</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.ClientSideRenderer.story_outline"><code class="name">var <span class="ident">story_outline</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.ClientSideRenderer.plugins"><code class="name">var <span class="ident">plugins</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.ClientSideRenderer.view_url"><code class="name">var <span class="ident">view_url</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.ClientSideRenderer.manage_url"><code class="name">var <span class="ident">manage_url</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.ClientSideRenderer.package"><code class="name flex">
<span>def <span class="ident">package</span></span>(<span>self, base64=True)</span>
</code></dt>
<dd>
<section class="desc"><p>Prepares a story for rendering via a client-side application</p>
<h2 id="returns">Returns</h2>
<p>A dictionary of lists of html fragments with 3 keys: <code>pages</code>, <code>styles</code> and <code>scripts</code></p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/renderers.py#L80-L100" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def package(self, base64=True) -&gt; typing.Dict:
    &#34;&#34;&#34;
    Prepares a story for rendering via a client-side application

    Returns
    ----------

    A dictionary of lists of html fragments with 3 keys: `pages`, `styles` and `scripts`
    &#34;&#34;&#34;
    pages = self.render()
    scripts = self.plugin_mgr.get_scripts()
    styles = self.plugin_mgr.get_styles()
    if base64:
        pages = presalytics.lib.util.list_to_base64(pages)
        scripts = presalytics.lib.util.list_to_base64(scripts)
        styles = presalytics.lib.util.list_to_base64(styles)
    return {
        &#34;pages&#34;: pages,
        &#34;scripts&#34;: scripts,
        &#34;styles&#34;: styles
    }</code></pre>
</details>
</dd>
<dt id="presalytics.ClientSideRenderer.update_info"><code class="name flex">
<span>def <span class="ident">update_info</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Updates story metadata</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/renderers.py#L102-L107" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def update_info(self):
    &#34;&#34;&#34;
    Updates story metadata
    &#34;&#34;&#34;
    info = self.story_outline.info
    info.date_modified = datetime.datetime.utcnow()</code></pre>
</details>
</dd>
<dt id="presalytics.ClientSideRenderer.render"><code class="name flex">
<span>def <span class="ident">render</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Creates a reveal.js presenation html fragement</p>
<h2 id="returns">Returns:</h2>
<p>A <code>list</code> of <code>str</code> html fragments for each page</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/renderers.py#L109-L124" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def render(self):
    &#34;&#34;&#34;
    Creates a reveal.js presenation html fragement

    Returns:
    ---------
    A `list` of `str` html fragments for each page
    &#34;&#34;&#34;
    slides = []
    for p in range(0, len(self.story_outline.pages)):
        if p in self.pages_to_render:
            page = self.story_outline.pages[p]
            page_html = self.render_page(page)
            slide_fragment = lxml.html.fragment_fromstring(page_html)
            slides.append(slide_fragment)
    return slides</code></pre>
</details>
</dd>
<dt id="presalytics.ClientSideRenderer.render_page"><code class="name flex">
<span>def <span class="ident">render_page</span></span>(<span>self, page)</span>
</code></dt>
<dd>
<section class="desc"><p>Creates a reveal.js slide</p>
<h2 id="returns">Returns</h2>
<p>A <code>str</code> html framgment of the page</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/renderers.py#L126-L155" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def render_page(self, page: &#39;Page&#39;) -&gt; str:
    &#34;&#34;&#34;
    Creates a reveal.js slide

    Returns
    ----------
    A `str` html framgment of the page
    &#34;&#34;&#34;
    class_key = &#34;page.&#34; + page.kind
    key = class_key + &#34;.&#34; + page.name
    try:
        if presalytics.COMPONENTS.get_instance(key):
            page_instance = presalytics.COMPONENTS.get_instance(key)
        else:
            klass = presalytics.COMPONENTS.get(class_key)
            deserialize_method = getattr(klass, &#34;deserialize&#34;, None)
            if callable(deserialize_method):
                page_instance = deserialize_method(page, client_info=self.client_info)
            else:
                message = &#39;Page component instance or class (kind) &#34;{0}&#34; unavailable in component registry&#39;.format(key)
                raise presalytics.lib.exceptions.MissingConfigException(message)
        page_html = page_instance.render()
    except Exception as ex:
        logger.exception(ex)
        t, v, tb = sys.exc_info()
        if not presalytics.settings.DEBUG:  # type: ignore[attr-defined]
            page_html = presalytics.lib.exceptions.RenderExceptionHandler(ex, &#34;page&#34;, traceback=tb).render_exception()
        else:
            six.reraise(t, v, tb)
    return page_html</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.story.components.Renderer" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer">Renderer</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.story.components.Renderer.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.story.components.Renderer.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.story.components.Renderer.get_component_implicit_plugins" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer.get_component_implicit_plugins">get_component_implicit_plugins</a></code></li>
<li><code><a title="presalytics.story.components.Renderer.manage" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer.manage">manage</a></code></li>
<li><code><a title="presalytics.story.components.Renderer.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer.serialize">serialize</a></code></li>
<li><code><a title="presalytics.story.components.Renderer.strip_unauthorized_scripts" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer.strip_unauthorized_scripts">strip_unauthorized_scripts</a></code></li>
<li><code><a title="presalytics.story.components.Renderer.update_outline_from_instances" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer.update_outline_from_instances">update_outline_from_instances</a></code></li>
<li><code><a title="presalytics.story.components.Renderer.update_story" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer.update_story">update_story</a></code></li>
<li><code><a title="presalytics.story.components.Renderer.view" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer.view">view</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.Revealer"><code class="flex name class">
<span>class <span class="ident">Revealer</span></span>
<span>(</span><span>story_outline, pages=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Renders <code><a title="presalytics.story.outline.StoryOutline" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.StoryOutline">StoryOutline</a></code> objects to
<a href="https://github.com/hakimel/reveal.js/">reveal.js</a> presentations</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>story_outline</code></strong> :&ensp;<code><a title="presalytics.story.outline.StoryOutline" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.StoryOutline">StoryOutline</a></code></dt>
<dd>The presalytics StoryOutline to be rendered and presented</dd>
</dl>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>base</code></strong> :&ensp;<code>lxml.etree.Element</code></dt>
<dd>An etree element containing the base html for each slide</dd>
<dt><strong><code>plugins</code></strong> :&ensp;<code>list</code> of <code>dict</code></dt>
<dd>Plugin data that transform to html <code>&lt;script&gt;</code> and <code>&lt;link&gt;</code> tags through
the rendering process</dd>
<dt><strong><code>plugin_mgr</code></strong> :&ensp;<code><a title="presalytics.lib.plugins.base.PluginManager" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginManager">PluginManager</a></code></dt>
<dd>Sorts, validates, and renders plugins</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L34-L304" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class Revealer(presalytics.story.components.Renderer):
    &#34;&#34;&#34;
    Renders `presalytics.story.outline.StoryOutline` objects to
    [reveal.js](https://github.com/hakimel/reveal.js/) presentations

    Parameters
    ----------
    story_outline : presalytics.story.outline.StoryOutline
        The presalytics StoryOutline to be rendered and presented

    Attributes
    -----------
    base : lxml.etree.Element
        An etree element containing the base html for each slide

    plugins : list of dict
        Plugin data that transform to html `&lt;script&gt;` and `&lt;link&gt;` tags through
        the rendering process

    plugin_mgr : presalytics.lib.plugins.base.PluginManager
        Sorts, validates, and renders plugins

    &#34;&#34;&#34;
    base: lxml.etree.Element
    reveal_params: typing.Dict[str, typing.Any]

    __component_kind__ = &#39;revealer&#39;

    def __init__(
            self,
            story_outline: &#39;StoryOutline&#39;,
            pages: typing.List[int] = None,
            **kwargs):
        super(Revealer, self).__init__(story_outline, **kwargs)
        logger.info(&#34;Initializing story render for {}&#34;.format(story_outline.title))
        self.story_outline.validate()
        if isinstance(pages, int):
            pages = [pages]
        elif not pages:
            pages = [p for p in range(0, len(self.story_outline.pages))]
        elif not isinstance(pages, list) or not isinstance(pages[0], int):
            raise presalytics.lib.exceptions.InvalidArgumentException(message=&#39;&#34;pages&#34; must be a list of integers&#39;)
        if len([p for p in pages if p &gt;= len(self.story_outline.pages)]) &gt; 0:
            raise presalytics.lib.exceptions.InvalidArgumentException(message=&#39;&#34;pages&#34; can only contain integers lower than the number of pages in the story&#39;)
        self.pages_to_render = pages
        self.base = self._make_base()
        logger.info(&#34;Loading plugins&#34;)
        reveal_params = {}
        for key, val in kwargs.items():
            if key in presalytics.lib.plugins.reveal.RevealConfigPlugin.default_config.keys():
                reveal_params.update({key: val})
        if len(self.pages_to_render) == 1:
            reveal_params.update({&#39;controls&#39;: False})  # hide controls on single page story
        reveal_plugin_config = {
            &#39;kind&#39;: &#39;script&#39;,
            &#39;name&#39;: &#39;reveal&#39;,
            &#39;config&#39;: {&#34;reveal_params&#34;: reveal_params} if len(reveal_params.keys()) &gt; 0 else {}
        }
        overrides_config = {
            &#39;kind&#39;: &#39;style&#39;,
            &#39;name&#39;: &#39;local&#39;,
            &#39;config&#39;: {
                &#34;css_file_id&#34;: &#34;reveal_overrides&#34;
            }
        }
        self.update_outline_from_instances()
        self.plugins = [reveal_plugin_config, overrides_config]
        self.get_component_implicit_plugins()
        outline_plugins = presalytics.lib.plugins.base.PluginManager.get_plugins_from_nested_dict(source_dict=self.story_outline.to_dict())
        self.plugins.extend(outline_plugins)
        self.plugin_mgr = presalytics.lib.plugins.base.PluginManager(self.plugins)
        logger.info(&#34;Revealer initilized.&#34;)

    def _make_base(self):
        base = lxml.etree.Element(&#34;div&#34;, attrib={
            &#34;class&#34;: &#34;reveal&#34;,
        })
        lxml.etree.SubElement(base, &#34;div&#34;, attrib={&#34;class&#34;: &#34;slides&#34;})

        try:
            story_id = self.story_outline.story_id
            base.attrib[&#39;data-story-id&#39;] = story_id
        except Exception:
            logger.info(&#34;Revealer could not extract story_id from outline.&#34;)
        return base

    def get_meta_tags(self, body=tuple()):
        &#34;&#34;&#34;
        Security Note: If supplying a body, ensure that its already been stripped of unauthorized scripts.
        &#34;&#34;&#34;

        scripts = body.findall(&#34;.//script&#34;)

        srcs = []
        for script in scripts:
            src = script.get(&#34;src&#34;)
            if src:
                root = urllib.parse.urlparse(src).netloc
                if root:
                    srcs.append(root)
        allowed = &#39; &#39;.join(set(srcs))
        hosts = [&#34;https://presalytics.io&#34;, &#34;https://*.presalytics.io&#34;]
        approved = presalytics.lib.plugins.external.ApprovedExternalLinks().attr_dict.flatten()
        approved.update(presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten())
        browser_hosts = {k: v for (k, v) in presalytics.settings.__dict__.items() if &#34;BROWER_API_HOST&#34; in k and v is not None}
        approved.update(browser_hosts)
        for _, val in approved.items():
            url = urllib.parse.urlparse(val)
            host = &#34;{0}://{1}&#34;.format(url.scheme, url.netloc)
            if host not in hosts:
                hosts.append(host)

        allowed_hosts = &#39; &#39;.join(set(hosts))
        frame_hosts = &#39; &#39;.join(set(self.get_embedded_frame_hosts()))
        tags = [
            &#39;&lt;meta charset=&#34;utf-8&#34;&gt;&#39;,
            &#39;&lt;meta http-equiv=&#34;X-UA-Compatible&#34; content=&#34;IE=edge&#34;&gt;&#39;,
            &#39;&lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1, shrink-to-fit=no&#34;&gt;&#39;,
            &#39;&lt;title&gt;Presalytics | &#39; + self.story_outline.title + &#39;&lt;/title&gt;&#39;,
            &#39;&lt;meta name=&#34;description&#34; content=&#34;&#39; + self.story_outline.description + &#39;&#34; /&gt;&#39;,
            &#34;&#34;&#34;&lt;meta http-equiv=&#34;Content-Security-Policy&#34; content=&#34;default-src &#39;self&#39; &#39;unsafe-eval&#39; &#39;unsafe-inline&#39; blob: data: {0}; script-src &#39;self&#39; &#39;unsafe-eval&#39; &#39;unsafe-inline&#39; {0} {1}; frame-src &#39;self&#39; blob: data: {2};&#34;&gt;&#34;&#34;&#34;.format(allowed_hosts, allowed, frame_hosts)
        ]
        return tags

    def get_embedded_frame_hosts(self) -&gt; typing.List[str]:
        frame_hosts = []
        for p in self.story_outline.pages:
            for w in p.widgets:
                if w.kind == &#39;url&#39;:
                    url = w.data.get(&#39;url&#39;)
                    host = urllib.parse.urlparse(url).netloc  # type: ignore
                    frame_hosts.append(&#39;https://{0}&#39;.format(host))  # type: ignore
        return frame_hosts

    def package_as_standalone(self):
        &#34;&#34;&#34;
        Render the story outline as a html document with only the
        reveal.js presentation as conent

        Returns
        ----------
        A `str` containing a complete html document with the presentation
        &#34;&#34;&#34;
        pres = self.render()
        body = E.BODY()
        body.append(pres)
        body = self.strip_unauthorized_scripts(body)
        for scripts in self.plugin_mgr.get_scripts():
            lxml_scripts = lxml.html.fragments_fromstring(scripts)
            for item in lxml_scripts:
                body.append(item)
        head = E.HEAD()
        for meta in self.get_meta_tags(body):
            lxml_meta = lxml.html.fragment_fromstring(meta)
            head.append(lxml_meta)
        for link in self.plugin_mgr.get_styles():
            lxml_links = lxml.html.fragments_fromstring(link)
            for item in lxml_links:
                head.append(item)
        head = self.strip_unauthorized_scripts(head)
        html = E.HTML(
            head,
            body
        )
        return lxml.html.tostring(html, pretty_print=True)

    # def render_plugin(self, plugin):
    #     plugin_type = plugin[&#39;type&#39;]
    #     plugin_config = plugin[&#39;config&#39;]
    #     plugin_class = self.plugin_loader.load(plugin_type)
    #     script_string = plugin_class().to_string(plugin_config)
    #     return lxml.html.fragment_fromstring(script_string)

    def update_info(self):
        &#34;&#34;&#34;
        Updates story metadata
        &#34;&#34;&#34;
        info = self.story_outline.info
        info.date_modified = datetime.datetime.utcnow()

    def render(self):
        &#34;&#34;&#34;
        Creates a reveal.js presenation html fragement

        Returns:
        ---------
        A `str` html fragment containing a reveal.js presentation
        &#34;&#34;&#34;
        reveal_base = self.base
        for p in range(0, len(self.story_outline.pages)):
            if p in self.pages_to_render:
                page = self.story_outline.pages[p]
                slides_container = reveal_base[0]
                slide = lxml.etree.SubElement(slides_container, &#34;section&#34;)
                page_html = self.render_page(page)
                slide_fragment = lxml.html.fragment_fromstring(page_html)
                slide.append(slide_fragment)
        return reveal_base

    def render_page(self, page: &#39;Page&#39;) -&gt; str:
        &#34;&#34;&#34;
        Creates a reveal.js slide

        Returns
        ----------
        A `str` html framgment of the page
        &#34;&#34;&#34;
        class_key = &#34;page.&#34; + page.kind
        key = class_key + &#34;.&#34; + page.name
        try:
            if presalytics.COMPONENTS.get_instance(key):
                page_instance = presalytics.COMPONENTS.get_instance(key)
            else:
                klass = presalytics.COMPONENTS.get(class_key)
                deserialize_method = getattr(klass, &#34;deserialize&#34;, None)
                if callable(deserialize_method):
                    page_instance = deserialize_method(page, client_info=self.client_info)
                else:
                    message = &#39;Page component instance or class (kind) &#34;{0}&#34; unavailable in component registry&#39;.format(key)
                    raise presalytics.lib.exceptions.MissingConfigException(message)
            page_html = page_instance.render()
        except Exception as ex:
            logger.exception(ex)
            t, v, tb = sys.exc_info()
            if not presalytics.settings.DEBUG:  # type: ignore[attr-defined]
                page_html = presalytics.lib.exceptions.RenderExceptionHandler(ex, &#34;page&#34;, traceback=tb).render_exception()
            else:
                six.reraise(t, v, tb)
        return page_html  # type: ignore

    def present(self, files_path=None, debug=True, port=8082, host=&#39;127.0.0.1&#39;):
        &#34;&#34;&#34;
        Creates and opens the rendered story in the browser.  Story files are served by
        a local flask server.  Not for production use.  Press Ctrl + C to close the server.

        Parameters
        ----------
        files_path : str
            filepath to a local folder that will work as root folder for a local flask
            server.  Defaults to the user&#39;s temporary files directory

        debug : str
            Defaults to True.  Indicates whether the flask server should be started
            in debug mode.

        port : str
            The network port to serve the story onto.  Defautls to 8082.

        host : str
            The host to for the local server.  Typically either localhost or the default gateway.
            Defaults to 127.0.0.1 (localhost).

        &#34;&#34;&#34;
        logger.info(&#34;Building story rendering at http://{0}:{1}&#34;.format(host, port))
        if not files_path:
            files_path = tempfile.gettempdir()
        logger.info(&#34;Buidling standalone package for local rendering.&#34;)
        html = self.package_as_standalone().decode(&#39;utf-8&#39;)
        id = presalytics.story.util.to_title_case(self.story_outline.title)
        if id == &#39;&#39;:
            id = &#39;blank&#39;
        server = presalytics.story.server.LocalServer(host=host, debug=debug, port=port, root_path=files_path)
        pkg_templates_dir = os.path.join(os.path.dirname(os.path.dirname(__file__)), &#34;lib&#34;, &#34;templates&#34;)
        shutil.copy(os.path.join(pkg_templates_dir, &#34;favicon.ico&#34;), os.path.join(files_path, &#34;presalytics&#34;, &#34;static&#34;))
        html_file = os.path.join(files_path, &#34;presalytics&#34;, &#34;templates&#34;, id + &#39;.html&#39;)
        with open(html_file, &#39;w&#39;) as file:
            file.write(html)
        address = &#34;http://{}:{}/story/{}&#34;.format(host, port, id)
        logger.info(&#34;Opening browser tab...&#34;)
        presalytics.story.server.Browser(address).start()
        server.run()</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.components.Renderer" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer">Renderer</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.Revealer.base"><code class="name">var <span class="ident">base</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.Revealer.reveal_params"><code class="name">var <span class="ident">reveal_params</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.Revealer.get_meta_tags"><code class="name flex">
<span>def <span class="ident">get_meta_tags</span></span>(<span>self, body=())</span>
</code></dt>
<dd>
<section class="desc"><p>Security Note: If supplying a body, ensure that its already been stripped of unauthorized scripts.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L120-L156" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_meta_tags(self, body=tuple()):
    &#34;&#34;&#34;
    Security Note: If supplying a body, ensure that its already been stripped of unauthorized scripts.
    &#34;&#34;&#34;

    scripts = body.findall(&#34;.//script&#34;)

    srcs = []
    for script in scripts:
        src = script.get(&#34;src&#34;)
        if src:
            root = urllib.parse.urlparse(src).netloc
            if root:
                srcs.append(root)
    allowed = &#39; &#39;.join(set(srcs))
    hosts = [&#34;https://presalytics.io&#34;, &#34;https://*.presalytics.io&#34;]
    approved = presalytics.lib.plugins.external.ApprovedExternalLinks().attr_dict.flatten()
    approved.update(presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten())
    browser_hosts = {k: v for (k, v) in presalytics.settings.__dict__.items() if &#34;BROWER_API_HOST&#34; in k and v is not None}
    approved.update(browser_hosts)
    for _, val in approved.items():
        url = urllib.parse.urlparse(val)
        host = &#34;{0}://{1}&#34;.format(url.scheme, url.netloc)
        if host not in hosts:
            hosts.append(host)

    allowed_hosts = &#39; &#39;.join(set(hosts))
    frame_hosts = &#39; &#39;.join(set(self.get_embedded_frame_hosts()))
    tags = [
        &#39;&lt;meta charset=&#34;utf-8&#34;&gt;&#39;,
        &#39;&lt;meta http-equiv=&#34;X-UA-Compatible&#34; content=&#34;IE=edge&#34;&gt;&#39;,
        &#39;&lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1, shrink-to-fit=no&#34;&gt;&#39;,
        &#39;&lt;title&gt;Presalytics | &#39; + self.story_outline.title + &#39;&lt;/title&gt;&#39;,
        &#39;&lt;meta name=&#34;description&#34; content=&#34;&#39; + self.story_outline.description + &#39;&#34; /&gt;&#39;,
        &#34;&#34;&#34;&lt;meta http-equiv=&#34;Content-Security-Policy&#34; content=&#34;default-src &#39;self&#39; &#39;unsafe-eval&#39; &#39;unsafe-inline&#39; blob: data: {0}; script-src &#39;self&#39; &#39;unsafe-eval&#39; &#39;unsafe-inline&#39; {0} {1}; frame-src &#39;self&#39; blob: data: {2};&#34;&gt;&#34;&#34;&#34;.format(allowed_hosts, allowed, frame_hosts)
    ]
    return tags</code></pre>
</details>
</dd>
<dt id="presalytics.Revealer.get_embedded_frame_hosts"><code class="name flex">
<span>def <span class="ident">get_embedded_frame_hosts</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L158-L166" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_embedded_frame_hosts(self) -&gt; typing.List[str]:
    frame_hosts = []
    for p in self.story_outline.pages:
        for w in p.widgets:
            if w.kind == &#39;url&#39;:
                url = w.data.get(&#39;url&#39;)
                host = urllib.parse.urlparse(url).netloc  # type: ignore
                frame_hosts.append(&#39;https://{0}&#39;.format(host))  # type: ignore
    return frame_hosts</code></pre>
</details>
</dd>
<dt id="presalytics.Revealer.package_as_standalone"><code class="name flex">
<span>def <span class="ident">package_as_standalone</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Render the story outline as a html document with only the
reveal.js presentation as conent</p>
<h2 id="returns">Returns</h2>
<p>A <code>str</code> containing a complete html document with the presentation</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L168-L198" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def package_as_standalone(self):
    &#34;&#34;&#34;
    Render the story outline as a html document with only the
    reveal.js presentation as conent

    Returns
    ----------
    A `str` containing a complete html document with the presentation
    &#34;&#34;&#34;
    pres = self.render()
    body = E.BODY()
    body.append(pres)
    body = self.strip_unauthorized_scripts(body)
    for scripts in self.plugin_mgr.get_scripts():
        lxml_scripts = lxml.html.fragments_fromstring(scripts)
        for item in lxml_scripts:
            body.append(item)
    head = E.HEAD()
    for meta in self.get_meta_tags(body):
        lxml_meta = lxml.html.fragment_fromstring(meta)
        head.append(lxml_meta)
    for link in self.plugin_mgr.get_styles():
        lxml_links = lxml.html.fragments_fromstring(link)
        for item in lxml_links:
            head.append(item)
    head = self.strip_unauthorized_scripts(head)
    html = E.HTML(
        head,
        body
    )
    return lxml.html.tostring(html, pretty_print=True)</code></pre>
</details>
</dd>
<dt id="presalytics.Revealer.update_info"><code class="name flex">
<span>def <span class="ident">update_info</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Updates story metadata</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L207-L212" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def update_info(self):
    &#34;&#34;&#34;
    Updates story metadata
    &#34;&#34;&#34;
    info = self.story_outline.info
    info.date_modified = datetime.datetime.utcnow()</code></pre>
</details>
</dd>
<dt id="presalytics.Revealer.render"><code class="name flex">
<span>def <span class="ident">render</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Creates a reveal.js presenation html fragement</p>
<h2 id="returns">Returns:</h2>
<p>A <code>str</code> html fragment containing a reveal.js presentation</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L214-L231" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def render(self):
    &#34;&#34;&#34;
    Creates a reveal.js presenation html fragement

    Returns:
    ---------
    A `str` html fragment containing a reveal.js presentation
    &#34;&#34;&#34;
    reveal_base = self.base
    for p in range(0, len(self.story_outline.pages)):
        if p in self.pages_to_render:
            page = self.story_outline.pages[p]
            slides_container = reveal_base[0]
            slide = lxml.etree.SubElement(slides_container, &#34;section&#34;)
            page_html = self.render_page(page)
            slide_fragment = lxml.html.fragment_fromstring(page_html)
            slide.append(slide_fragment)
    return reveal_base</code></pre>
</details>
</dd>
<dt id="presalytics.Revealer.render_page"><code class="name flex">
<span>def <span class="ident">render_page</span></span>(<span>self, page)</span>
</code></dt>
<dd>
<section class="desc"><p>Creates a reveal.js slide</p>
<h2 id="returns">Returns</h2>
<p>A <code>str</code> html framgment of the page</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L233-L262" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def render_page(self, page: &#39;Page&#39;) -&gt; str:
    &#34;&#34;&#34;
    Creates a reveal.js slide

    Returns
    ----------
    A `str` html framgment of the page
    &#34;&#34;&#34;
    class_key = &#34;page.&#34; + page.kind
    key = class_key + &#34;.&#34; + page.name
    try:
        if presalytics.COMPONENTS.get_instance(key):
            page_instance = presalytics.COMPONENTS.get_instance(key)
        else:
            klass = presalytics.COMPONENTS.get(class_key)
            deserialize_method = getattr(klass, &#34;deserialize&#34;, None)
            if callable(deserialize_method):
                page_instance = deserialize_method(page, client_info=self.client_info)
            else:
                message = &#39;Page component instance or class (kind) &#34;{0}&#34; unavailable in component registry&#39;.format(key)
                raise presalytics.lib.exceptions.MissingConfigException(message)
        page_html = page_instance.render()
    except Exception as ex:
        logger.exception(ex)
        t, v, tb = sys.exc_info()
        if not presalytics.settings.DEBUG:  # type: ignore[attr-defined]
            page_html = presalytics.lib.exceptions.RenderExceptionHandler(ex, &#34;page&#34;, traceback=tb).render_exception()
        else:
            six.reraise(t, v, tb)
    return page_html  # type: ignore</code></pre>
</details>
</dd>
<dt id="presalytics.Revealer.present"><code class="name flex">
<span>def <span class="ident">present</span></span>(<span>self, files_path=None, debug=True, port=8082, host='127.0.0.1')</span>
</code></dt>
<dd>
<section class="desc"><p>Creates and opens the rendered story in the browser.
Story files are served by
a local flask server.
Not for production use.
Press Ctrl + C to close the server.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>files_path</code></strong> :&ensp;<code>str</code></dt>
<dd>filepath to a local folder that will work as root folder for a local flask
server.
Defaults to the user's temporary files directory</dd>
<dt><strong><code>debug</code></strong> :&ensp;<code>str</code></dt>
<dd>Defaults to True.
Indicates whether the flask server should be started
in debug mode.</dd>
<dt><strong><code>port</code></strong> :&ensp;<code>str</code></dt>
<dd>The network port to serve the story onto.
Defautls to 8082.</dd>
<dt><strong><code>host</code></strong> :&ensp;<code>str</code></dt>
<dd>The host to for the local server.
Typically either localhost or the default gateway.
Defaults to 127.0.0.1 (localhost).</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/revealer.py#L264-L304" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def present(self, files_path=None, debug=True, port=8082, host=&#39;127.0.0.1&#39;):
    &#34;&#34;&#34;
    Creates and opens the rendered story in the browser.  Story files are served by
    a local flask server.  Not for production use.  Press Ctrl + C to close the server.

    Parameters
    ----------
    files_path : str
        filepath to a local folder that will work as root folder for a local flask
        server.  Defaults to the user&#39;s temporary files directory

    debug : str
        Defaults to True.  Indicates whether the flask server should be started
        in debug mode.

    port : str
        The network port to serve the story onto.  Defautls to 8082.

    host : str
        The host to for the local server.  Typically either localhost or the default gateway.
        Defaults to 127.0.0.1 (localhost).

    &#34;&#34;&#34;
    logger.info(&#34;Building story rendering at http://{0}:{1}&#34;.format(host, port))
    if not files_path:
        files_path = tempfile.gettempdir()
    logger.info(&#34;Buidling standalone package for local rendering.&#34;)
    html = self.package_as_standalone().decode(&#39;utf-8&#39;)
    id = presalytics.story.util.to_title_case(self.story_outline.title)
    if id == &#39;&#39;:
        id = &#39;blank&#39;
    server = presalytics.story.server.LocalServer(host=host, debug=debug, port=port, root_path=files_path)
    pkg_templates_dir = os.path.join(os.path.dirname(os.path.dirname(__file__)), &#34;lib&#34;, &#34;templates&#34;)
    shutil.copy(os.path.join(pkg_templates_dir, &#34;favicon.ico&#34;), os.path.join(files_path, &#34;presalytics&#34;, &#34;static&#34;))
    html_file = os.path.join(files_path, &#34;presalytics&#34;, &#34;templates&#34;, id + &#39;.html&#39;)
    with open(html_file, &#39;w&#39;) as file:
        file.write(html)
    address = &#34;http://{}:{}/story/{}&#34;.format(host, port, id)
    logger.info(&#34;Opening browser tab...&#34;)
    presalytics.story.server.Browser(address).start()
    server.run()</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.story.components.Renderer" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer">Renderer</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.story.components.Renderer.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.story.components.Renderer.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.story.components.Renderer.get_component_implicit_plugins" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer.get_component_implicit_plugins">get_component_implicit_plugins</a></code></li>
<li><code><a title="presalytics.story.components.Renderer.manage" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer.manage">manage</a></code></li>
<li><code><a title="presalytics.story.components.Renderer.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer.serialize">serialize</a></code></li>
<li><code><a title="presalytics.story.components.Renderer.strip_unauthorized_scripts" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer.strip_unauthorized_scripts">strip_unauthorized_scripts</a></code></li>
<li><code><a title="presalytics.story.components.Renderer.update_outline_from_instances" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer.update_outline_from_instances">update_outline_from_instances</a></code></li>
<li><code><a title="presalytics.story.components.Renderer.update_story" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer.update_story">update_story</a></code></li>
<li><code><a title="presalytics.story.components.Renderer.view" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer.view">view</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.MatplotlibFigure"><code class="flex name class">
<span>class <span class="ident">MatplotlibFigure</span></span>
<span>(</span><span>figure, name, *args, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>A <code>Widget</code> for rendering <code>matplotlib.pyplot.Figure</code> instances in stories</p>
<p>This class acts as wrapper class for matplotlib figures, allowing their packaging into
<code><a title="presalytics.story.outline.Widget" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.Widget">Widget</a></code> objects and serialization to json.
At render-time,
the figure is converted to a d3.js object via the <a href="https://mpld3.github.io/">mpld3</a>
package.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>figure</code></strong> :&ensp;<code>matplotlib.pyplot.Figure</code></dt>
<dd>the figure to create the widget from</dd>
<dt><strong><code>name</code></strong> :&ensp;<code>str</code></dt>
<dd>the name of widget.
Must be unique within <code><a title="presalytics.COMPONENTS" href="/python-client/presalytics/index.html#presalytics.COMPONENTS">COMPONENTS</a></code></dd>
</dl>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>figure_dict</code></strong> :&ensp;<code>dict</code></dt>
<dd>A <code>dict</code> containing json-serializable data for reconstituting the
<code>matplotlib.pyplot.Figure</code> object.</dd>
<dt><strong><code>figure_id</code></strong> :&ensp;<code>str</code></dt>
<dd>A unique identifier used to render the that figure into a d3.js object</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/matplotlib.py#L16-L93" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class MatplotlibFigure(presalytics.story.components.WidgetBase):
    &#34;&#34;&#34;
    A `Widget` for rendering `matplotlib.pyplot.Figure` instances in stories

    This class acts as wrapper class for matplotlib figures, allowing their packaging into
    `presalytics.story.outline.Widget` objects and serialization to json.  At render-time,
    the figure is converted to a d3.js object via the [mpld3](https://mpld3.github.io/)
    package.

    Parameters
    ----------

    figure : `matplotlib.pyplot.Figure`
        the figure to create the widget from

    name : str
        the name of widget.  Must be unique within `presalytics.COMPONENTS`

    Attributes
    ----------
    figure_dict : dict
        A `dict` containing json-serializable data for reconstituting the
        `matplotlib.pyplot.Figure` object.

    figure_id : str
        A unique identifier used to render the that figure into a d3.js object

    &#34;&#34;&#34;
    __component_kind__ = &#39;matplotlib-figure&#39;
    additional_properties: typing.Dict

    def __init__(self, figure: &#39;Figure&#39;, name: str, *args, **kwargs):
        super().__init__(self, *args, **kwargs)
        self.fig = figure
        self.name = name
        self.figure_dict = None
        if self.fig:
            self.figure_dict = mpld3.fig_to_dict(figure)
        else:
            figure_dict = kwargs.pop(&#34;figure_dict&#34;, None)
            if figure_dict:
                self.figure_dict = figure_dict
        if self.figure_dict is None:
            message = &#34;MatplotlibFigure requires a figure_dict attribute.  Please supply either a valid figure_dict or matplotlib.pyplot.Figure object to __init__&#34;
            raise presalytics.lib.exceptions.ValidationError(message)
        self.figure_id = self.figure_dict[&#34;id&#34;]
        self.additional_properties = {}
        for key, val in kwargs.items():
            self.additional_properties[key] = val
        self.outline_widget = self.serialize()

    def to_html(self):
        return &#39;&lt;div id=&#34;{0}&#34; class=&#34;mpld3&#34;&gt;&lt;/div&gt;&#39;.format(self.figure_id)

    @classmethod
    def deserialize(cls, outline, **kwargs):
        figure_dict = outline.data.get(&#34;figure_dict&#34;)
        kwargs.update(**outline.additional_properties)
        return cls(None, outline.name, figure_dict=figure_dict, id=outline.id, **outline.additional_properties)

    def serialize(self, **kwargs):
        data = {
            &#39;figure_dict&#39;: self.figure_dict,
            &#39;id&#39;: self.figure_id
        }
        plugin_obj = presalytics.story.outline.Plugin(
            name=&#39;mpld3&#39;,
            kind=&#39;script&#39;,
            config=data
        )
        return presalytics.story.outline.Widget(
            name=self.name,
            id=self.id,
            kind=self.__component_kind__,
            plugins=[plugin_obj.to_dict()],
            data=data,
            additional_properties=self.additional_properties
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="presalytics.lib.widgets.matplotlib.MatplotlibResponsiveFigure" href="/python-client/presalytics/lib/widgets/matplotlib.html#presalytics.lib.widgets.matplotlib.MatplotlibResponsiveFigure">MatplotlibResponsiveFigure</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.MatplotlibFigure.additional_properties"><code class="name">var <span class="ident">additional_properties</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.story.components.WidgetBase.create_subdocument" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.create_subdocument">create_subdocument</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.render" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.render">render</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.serialize">serialize</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.to_html" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.to_html">to_html</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.MatplotlibResponsiveFigure"><code class="flex name class">
<span>class <span class="ident">MatplotlibResponsiveFigure</span></span>
<span>(</span><span>figure, name, *args, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>A <code>Widget</code> for rendering <code>matplotlib.pyplot.Figure</code> instances in stories</p>
<p>This class acts as wrapper class for matplotlib figures, allowing their packaging into
<code><a title="presalytics.story.outline.Widget" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.Widget">Widget</a></code> objects and serialization to json.
At render-time,
the figure is converted to a d3.js object via the <a href="https://mpld3.github.io/">mpld3</a>
package.</p>
<p>This class also depends on the static plugin</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>figure</code></strong> :&ensp;<code>matplotlib.pyplot.Figure</code></dt>
<dd>the figure to create the widget from</dd>
<dt><strong><code>name</code></strong> :&ensp;<code>str</code></dt>
<dd>the name of widget.
Must be unique within <code><a title="presalytics.COMPONENTS" href="/python-client/presalytics/index.html#presalytics.COMPONENTS">COMPONENTS</a></code></dd>
<dt><strong><code>story_id</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The story id</dd>
</dl>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>figure_dict</code></strong> :&ensp;<code>dict</code></dt>
<dd>A <code>dict</code> containing json-serializable data for reconstituting the
<code>matplotlib.pyplot.Figure</code> object.</dd>
<dt><strong><code>figure_id</code></strong> :&ensp;<code>str</code></dt>
<dd>A unique identifier used to render the that figure into a d3.js object</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/matplotlib.py#L96-L242" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class MatplotlibResponsiveFigure(MatplotlibFigure):
    &#34;&#34;&#34;
    A `Widget` for rendering `matplotlib.pyplot.Figure` instances in stories

    This class acts as wrapper class for matplotlib figures, allowing their packaging into
    `presalytics.story.outline.Widget` objects and serialization to json.  At render-time,
    the figure is converted to a d3.js object via the [mpld3](https://mpld3.github.io/)
    package.

    This class also depends on the static plugin

    Parameters
    ----------

    figure : `matplotlib.pyplot.Figure`
        the figure to create the widget from

    name : str
        the name of widget.  Must be unique within `presalytics.COMPONENTS`

    story_id : str, optional
        The story id

    Attributes
    ----------
    figure_dict : dict
        A `dict` containing json-serializable data for reconstituting the
        `matplotlib.pyplot.Figure` object.

    figure_id : str
        A unique identifier used to render the that figure into a d3.js object
    &#34;&#34;&#34;

    additional_properties: typing.Dict
    __component_kind__ = &#39;matplotlib-responsive&#39;

    __plugins__ = [
        {
            &#39;name&#39;: &#39;external_scripts&#39;,
            &#39;kind&#39;: &#39;script&#39;,
            &#39;config&#39;: {
                &#39;approved_scripts_key&#39;: &#39;jquery&#39;
            }
        },
        {
            &#39;name&#39;: &#39;external_scripts&#39;,
            &#39;kind&#39;: &#39;script&#39;,
            &#39;config&#39;: {
                &#39;approved_scripts_key&#39;: &#39;mpl-responsive&#39;
            }
        },
        {
            &#39;name&#39;: &#39;external_links&#39;,
            &#39;kind&#39;: &#39;style&#39;,
            &#39;config&#39;: {
                &#39;approved_styles_key&#39;: &#39;preloaders&#39;
            }
        }
    ]  # type: ignore

    def __init__(self, figure: &#39;Figure&#39;, name: str, *args, **kwargs):
        self.story_id = kwargs.get(&#34;story_id&#34;, None)
        super(MatplotlibResponsiveFigure, self).__init__(figure, name, *args, **kwargs)
        self.story_host = self.get_client(delegate_login=True).story.api_client.configuration.host

    def to_html(self):
        html = self.create_container()
        return html

    def create_container(self, **kwargs):
        &#34;&#34;&#34;
        Wraps the Matplotlib Figure in a SVG endpoint load via `&lt;iframe&gt;` that
        will be rendered inside of a story and rescaled to give repsonsive effect
        &#34;&#34;&#34;
        story_host = self.get_client(delegate_login=True).story.api_client.external_root_url
        source_url = &#34;{0}/cache/{1}&#34;.format(story_host, self.nonce)
        empty_parent_div = lxml.html.Element(&#34;div&#34;, {
            &#39;class&#39;: &#39;empty-parent bg-light matplotlib-responsive-container&#39;,
            &#39;style&#39;: &#39;height: 100%; width: 100%, display: block; text-align: left;&#39;
        })
        frame = lxml.html.Element(&#34;iframe&#34;, {
            &#39;src&#39;: source_url,
            &#39;frameborder&#39;: &#34;0&#34;,
            &#39;scrolling&#39;: &#34;no&#34;,
            &#39;class&#39;: &#39;matplotlib-responsive-frame&#39;,
            &#39;style&#39;: &#39;max-height: none; max-width: none;&#39;
        })
        empty_parent_div.append(frame)
        return lxml.html.tostring(empty_parent_div).decode(&#39;utf-8&#39;)

    @classmethod
    def deserialize(cls, outline, **kwargs):
        figure_dict = outline.data.get(&#34;figure_dict&#34;)
        story_id = outline.data.get(&#34;story_id&#34;, None)
        kwargs.update(**outline.additional_properties)
        return cls(None,
                   outline.name,
                   story_id=story_id,
                   figure_dict=figure_dict,
                   **kwargs)

    def serialize(self, **kwargs):
        data = {
            &#39;figure_dict&#39;: self.figure_dict,
            &#39;id&#39;: self.figure_id,
            &#39;story_id&#39;: self.story_id
        }
        return presalytics.story.outline.Widget(
            name=self.name,
            kind=self.__component_kind__,
            data=data,
            additional_properties=self.additional_properties
        )

    def create_subdocument(self, **kwargs):
        return self.standalone_html()

    def standalone_html(self) -&gt; str:
        SIMPLE_HTML = jinja2.Template(&#34;&#34;&#34;&lt;!DOCTYPE html&gt;
        &lt;html&gt;
            &lt;head&gt;
                &lt;meta charset=&#34;UTF-8&#34;&gt;
                &lt;style&gt;
                {{ extra_css }}
                &lt;/style&gt;
            &lt;/head&gt;
            &lt;body&gt;
                &lt;script type=&#34;text/javascript&#34; src=&#34;{{ d3_url }}&#34;&gt;&lt;/script&gt;
                &lt;script type=&#34;text/javascript&#34; src=&#34;{{ mpld3_url }}&#34;&gt;&lt;/script&gt;
                &lt;script type=&#34;text/javascript&#34; src=&#34;{{ events_url }}&#34;&gt;&lt;/script&gt;
                &lt;div id=&#34;{{ figid }}&#34;&gt;&lt;/div&gt;
                &lt;script type=&#34;text/javascript&#34;&gt;

                    mpld3.draw_figure(&#34;{{ figid }}&#34;, {{ figure_json }});

                &lt;/script&gt;
            &lt;/body&gt;
        &lt;/html&gt;&#34;&#34;&#34;)
        figure_json = json.dumps(self.figure_dict, cls=presalytics.lib.plugins.matplotlib.Mpld3NumpyToJson)
        context = {
            &#34;d3_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;d3v3&#39;),
            &#34;mpld3_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;mpld3&#39;),
            &#34;events_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;events&#39;),
            &#34;figid&#34;: self.figure_id,
            &#34;figure_json&#34;: figure_json
        }
        return SIMPLE_HTML.render(**context)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.widgets.matplotlib.MatplotlibFigure" href="/python-client/presalytics/lib/widgets/matplotlib.html#presalytics.lib.widgets.matplotlib.MatplotlibFigure">MatplotlibFigure</a></li>
<li><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.MatplotlibResponsiveFigure.additional_properties"><code class="name">var <span class="ident">additional_properties</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.MatplotlibResponsiveFigure.create_container"><code class="name flex">
<span>def <span class="ident">create_container</span></span>(<span>self, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Wraps the Matplotlib Figure in a SVG endpoint load via <code>&lt;iframe&gt;</code> that
will be rendered inside of a story and rescaled to give repsonsive effect</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/matplotlib.py#L165-L184" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def create_container(self, **kwargs):
    &#34;&#34;&#34;
    Wraps the Matplotlib Figure in a SVG endpoint load via `&lt;iframe&gt;` that
    will be rendered inside of a story and rescaled to give repsonsive effect
    &#34;&#34;&#34;
    story_host = self.get_client(delegate_login=True).story.api_client.external_root_url
    source_url = &#34;{0}/cache/{1}&#34;.format(story_host, self.nonce)
    empty_parent_div = lxml.html.Element(&#34;div&#34;, {
        &#39;class&#39;: &#39;empty-parent bg-light matplotlib-responsive-container&#39;,
        &#39;style&#39;: &#39;height: 100%; width: 100%, display: block; text-align: left;&#39;
    })
    frame = lxml.html.Element(&#34;iframe&#34;, {
        &#39;src&#39;: source_url,
        &#39;frameborder&#39;: &#34;0&#34;,
        &#39;scrolling&#39;: &#34;no&#34;,
        &#39;class&#39;: &#39;matplotlib-responsive-frame&#39;,
        &#39;style&#39;: &#39;max-height: none; max-width: none;&#39;
    })
    empty_parent_div.append(frame)
    return lxml.html.tostring(empty_parent_div).decode(&#39;utf-8&#39;)</code></pre>
</details>
</dd>
<dt id="presalytics.MatplotlibResponsiveFigure.standalone_html"><code class="name flex">
<span>def <span class="ident">standalone_html</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/matplotlib.py#L213-L242" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def standalone_html(self) -&gt; str:
    SIMPLE_HTML = jinja2.Template(&#34;&#34;&#34;&lt;!DOCTYPE html&gt;
    &lt;html&gt;
        &lt;head&gt;
            &lt;meta charset=&#34;UTF-8&#34;&gt;
            &lt;style&gt;
            {{ extra_css }}
            &lt;/style&gt;
        &lt;/head&gt;
        &lt;body&gt;
            &lt;script type=&#34;text/javascript&#34; src=&#34;{{ d3_url }}&#34;&gt;&lt;/script&gt;
            &lt;script type=&#34;text/javascript&#34; src=&#34;{{ mpld3_url }}&#34;&gt;&lt;/script&gt;
            &lt;script type=&#34;text/javascript&#34; src=&#34;{{ events_url }}&#34;&gt;&lt;/script&gt;
            &lt;div id=&#34;{{ figid }}&#34;&gt;&lt;/div&gt;
            &lt;script type=&#34;text/javascript&#34;&gt;

                mpld3.draw_figure(&#34;{{ figid }}&#34;, {{ figure_json }});

            &lt;/script&gt;
        &lt;/body&gt;
    &lt;/html&gt;&#34;&#34;&#34;)
    figure_json = json.dumps(self.figure_dict, cls=presalytics.lib.plugins.matplotlib.Mpld3NumpyToJson)
    context = {
        &#34;d3_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;d3v3&#39;),
        &#34;mpld3_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;mpld3&#39;),
        &#34;events_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;events&#39;),
        &#34;figid&#34;: self.figure_id,
        &#34;figure_json&#34;: figure_json
    }
    return SIMPLE_HTML.render(**context)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.widgets.matplotlib.MatplotlibFigure" href="/python-client/presalytics/lib/widgets/matplotlib.html#presalytics.lib.widgets.matplotlib.MatplotlibFigure">MatplotlibFigure</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.widgets.matplotlib.MatplotlibFigure.create_subdocument" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.create_subdocument">create_subdocument</a></code></li>
<li><code><a title="presalytics.lib.widgets.matplotlib.MatplotlibFigure.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.lib.widgets.matplotlib.MatplotlibFigure.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.lib.widgets.matplotlib.MatplotlibFigure.render" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.render">render</a></code></li>
<li><code><a title="presalytics.lib.widgets.matplotlib.MatplotlibFigure.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.serialize">serialize</a></code></li>
<li><code><a title="presalytics.lib.widgets.matplotlib.MatplotlibFigure.to_html" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.to_html">to_html</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.Mpld3Plugin"><code class="flex name class">
<span>class <span class="ident">Mpld3Plugin</span></span>
<span>(</span><span>**kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>A script plugin incorporates whitelisted or local <code>&lt;script&gt;</code> tags into a
rendered story</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/matplotlib.py#L18-L46" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class Mpld3Plugin(ext.ScriptPlugin, jinja.JinjaPluginMakerMixin):
    __plugin_name__ = &#39;mpld3&#39;

    __dependencies__ = [
        {
            &#39;kind&#39;: &#39;script&#39;,
            &#39;name&#39;: &#39;external_scripts&#39;,
            &#39;config&#39;: {
                &#39;approved_scripts_key&#39;: &#39;d3v3&#39;
            }
        },
        {
            &#39;kind&#39;: &#39;script&#39;,
            &#39;name&#39;: &#39;external_scripts&#39;,
            &#39;config&#39;: {
                &#39;approved_scripts_key&#39;: &#39;mpld3&#39;
            }
        }
    ]

    template = &#39;&lt;script type=&#34;text/javascript&#34;&gt;mpld3.draw_figure(&#34;{{ id|safe }}&#34;,{{ fig_json }});&lt;/script&gt;&#39;

    def to_script(self, config, **kwargs):
        fig_json = json.dumps(config[&#34;figure_dict&#34;], cls=Mpld3NumpyToJson)
        render_config = {
            &#39;id&#39;: config[&#34;id&#34;],
            &#39;fig_json&#39;: fig_json
        }
        return self.render(render_config)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.plugins.base.ScriptPlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.ScriptPlugin">ScriptPlugin</a></li>
<li><a title="presalytics.lib.plugins.base.PluginBase" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase">PluginBase</a></li>
<li>abc.ABC</li>
<li><a title="presalytics.lib.plugins.jinja.JinjaPluginMakerMixin" href="/python-client/presalytics/lib/plugins/jinja.html#presalytics.lib.plugins.jinja.JinjaPluginMakerMixin">JinjaPluginMakerMixin</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.Mpld3Plugin.config"><code class="name">var <span class="ident">config</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.Mpld3Plugin.template"><code class="name">var <span class="ident">template</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.plugins.base.ScriptPlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.ScriptPlugin">ScriptPlugin</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.plugins.base.ScriptPlugin.get_tag" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase.get_tag">get_tag</a></code></li>
<li><code><a title="presalytics.lib.plugins.base.ScriptPlugin.to_script" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.ScriptPlugin.to_script">to_script</a></code></li>
</ul>
</li>
<li><code><b><a title="presalytics.lib.plugins.jinja.JinjaPluginMakerMixin" href="/python-client/presalytics/lib/plugins/jinja.html#presalytics.lib.plugins.jinja.JinjaPluginMakerMixin">JinjaPluginMakerMixin</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.plugins.jinja.JinjaPluginMakerMixin.render" href="/python-client/presalytics/lib/plugins/jinja.html#presalytics.lib.plugins.jinja.JinjaPluginMakerMixin.render">render</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.MarkdownWidget"><code class="flex name class">
<span>class <span class="ident">MarkdownWidget</span></span>
<span>(</span><span>name, markdown_text, css64=None, css_filename=None, *args, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>A <code>Widget</code> for rendering markdown to html objects.</p>
<p>This implementation uses <a href="https://github.github.com/gfm/">Github-flavored Markdown</a>.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>name</code></strong> :&ensp;<code>str</code></dt>
<dd>the name of widget.
Must be unique within <code><a title="presalytics.COMPONENTS" href="/python-client/presalytics/index.html#presalytics.COMPONENTS">COMPONENTS</a></code></dd>
<dt><strong><code>markdown_text</code></strong> :&ensp;<code>str</code></dt>
<dd>A string of markdown text to be converted to html via the <code>to_html</code> method</dd>
<dt><strong><code>css64</code></strong> :&ensp;<code>str. optional</code></dt>
<dd>A base64-encoded string of the css styles to apply to the d3 document.
Used for server-to-server
transport over https.</dd>
<dt><strong><code>css_filename</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>
<p>A css file containing styles that will be applied to d3</p>
<p>Note: Styles <code>html {width: 100%; height:100%;} body {width: 100%; height: 100%; margin: 0px;}</code>
are applied by default if not css is provided</p>
</dd>
</dl>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>md</code></strong> :&ensp;<code>markdown.Markdown</code></dt>
<dd>A markdown renderer. By default this rendered loads <code>py-gfm</code>'s
<code>mdx_gfm.GithubFlavoredMarkdownExtension</code> to extend the renderer</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/markdown.py#L21-L134" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class MarkdownWidget(presalytics.story.components.WidgetBase):
    &#34;&#34;&#34;
    A `Widget` for rendering markdown to html objects.

    This implementation uses [Github-flavored Markdown](https://github.github.com/gfm/).

    Parameters
    ----------

    name : str
        the name of widget.  Must be unique within `presalytics.COMPONENTS`

    markdown_text: str
        A string of markdown text to be converted to html via the `to_html` method

    css64 : str. optional
        A base64-encoded string of the css styles to apply to the d3 document.  Used for server-to-server
        transport over https.

    css_filename: str, optional
        A css file containing styles that will be applied to d3

        Note: Styles `html {width: 100%; height:100%;} body {width: 100%; height: 100%; margin: 0px;}`
        are applied by default if not css is provided


    Attributes
    -----------

    md: `markdown.Markdown`
        A markdown renderer. By default this rendered loads `py-gfm`&#39;s
        `mdx_gfm.GithubFlavoredMarkdownExtension` to extend the renderer

    &#34;&#34;&#34;
    __component_kind__ = &#39;markdown&#39;
    __plugins__ = [
        {
            &#39;name&#39;: &#39;external_links&#39;,
            &#39;kind&#39;: &#39;style&#39;,
            &#39;config&#39;: {
                &#39;approved_styles_key&#39;: &#39;markdown-css&#39;
            }
        }
    ]

    def __init__(self,
                 name: str,
                 markdown_text: str,
                 css64: str = None,
                 css_filename: str = None,
                 *args,
                 **kwargs):
        self.markdown_text = markdown_text
        self.md = markdown.Markdown(extensions=[mdx_gfm.GithubFlavoredMarkdownExtension()])
        super(MarkdownWidget, self).__init__(name, *args, **kwargs)
        self.css64 = self.read_file(css_filename)
        self.css64 = self.css64 if self.css64 else css64
        self.css_filename = css_filename

    def read_file(self, filename) -&gt; typing.Optional[str]:
        &#34;&#34;&#34;
        Find a file named `filename` and return its base64-ecoded content
        &#34;&#34;&#34;
        data64 = None
        if filename:
            search_paths = list(set(presalytics.settings.AUTODISCOVER_PATHS))
            if os.getcwd() not in search_paths:
                search_paths.append(os.getcwd())
            for path in search_paths:
                fpath = os.path.join(path, filename)
                if os.path.exists(fpath):
                    with open(fpath, &#39;rb&#39;) as f:
                        data = f.read()
                        data64 = base64.b64encode(data).decode(&#39;utf-8&#39;)  # type: ignore
                    break
            if not data64:
                logger.debug(&#34;File {0} could not be found&#34;.format(filename))
        return data64

    def to_html(self, data=None, **kwargs) -&gt; str:
        &#34;&#34;&#34;
        Renders the sandboxed iframe with will contain the d3 script widget
        &#34;&#34;&#34;
        html = self.md.convert(self.markdown_text)
        return html

    @classmethod
    def deserialize(cls, outline, **kwargs):
        markdown_text = outline.data.get(&#34;markdown_text&#34;)
        return cls(outline.name,
                   id=outline.id,
                   markdown_text=markdown_text,
                   **kwargs)

    def serialize(self, **kwargs):
        data = {
            &#39;markdown_text&#39;: self.markdown_text,
        }
        return presalytics.story.outline.Widget(
            name=self.name,
            kind=self.__component_kind__,
            id=self.id,
            data=data,
        )

    @classmethod
    def from_file(cls, name, filepath: str, **kwargs):
        &#34;&#34;&#34;
        Loads `markdown_text` via a file, rather than a string object.
        `filepath` can be relative or absolute.
        &#34;&#34;&#34;
        with open(filepath, &#39;r&#39;) as f:
            markdown_text = f.read()
        return cls(name, markdown_text, **kwargs)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.MarkdownWidget.outline_widget"><code class="name">var <span class="ident">outline_widget</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Static methods</h3>
<dl>
<dt id="presalytics.MarkdownWidget.from_file"><code class="name flex">
<span>def <span class="ident">from_file</span></span>(<span>name, filepath, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Loads <code>markdown_text</code> via a file, rather than a string object.
<code>filepath</code> can be relative or absolute.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/markdown.py#L126-L134" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def from_file(cls, name, filepath: str, **kwargs):
    &#34;&#34;&#34;
    Loads `markdown_text` via a file, rather than a string object.
    `filepath` can be relative or absolute.
    &#34;&#34;&#34;
    with open(filepath, &#39;r&#39;) as f:
        markdown_text = f.read()
    return cls(name, markdown_text, **kwargs)</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.MarkdownWidget.read_file"><code class="name flex">
<span>def <span class="ident">read_file</span></span>(<span>self, filename)</span>
</code></dt>
<dd>
<section class="desc"><p>Find a file named <code>filename</code> and return its base64-ecoded content</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/markdown.py#L80-L98" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def read_file(self, filename) -&gt; typing.Optional[str]:
    &#34;&#34;&#34;
    Find a file named `filename` and return its base64-ecoded content
    &#34;&#34;&#34;
    data64 = None
    if filename:
        search_paths = list(set(presalytics.settings.AUTODISCOVER_PATHS))
        if os.getcwd() not in search_paths:
            search_paths.append(os.getcwd())
        for path in search_paths:
            fpath = os.path.join(path, filename)
            if os.path.exists(fpath):
                with open(fpath, &#39;rb&#39;) as f:
                    data = f.read()
                    data64 = base64.b64encode(data).decode(&#39;utf-8&#39;)  # type: ignore
                break
        if not data64:
            logger.debug(&#34;File {0} could not be found&#34;.format(filename))
    return data64</code></pre>
</details>
</dd>
<dt id="presalytics.MarkdownWidget.to_html"><code class="name flex">
<span>def <span class="ident">to_html</span></span>(<span>self, data=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Renders the sandboxed iframe with will contain the d3 script widget</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/markdown.py#L100-L105" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def to_html(self, data=None, **kwargs) -&gt; str:
    &#34;&#34;&#34;
    Renders the sandboxed iframe with will contain the d3 script widget
    &#34;&#34;&#34;
    html = self.md.convert(self.markdown_text)
    return html</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.story.components.WidgetBase.create_subdocument" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.create_subdocument">create_subdocument</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.render" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.render">render</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.serialize">serialize</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.OoxmlFileWidget"><code class="flex name class">
<span>class <span class="ident">OoxmlFileWidget</span></span>
<span>(</span><span>filename, name=None, story_id=None, object_ooxml_id=None, endpoint_map=None, object_name=None, previous_ooxml_version={}, file_last_modified=None, document_ooxml_id=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Builds a <code>widget</code> from a Presentation or Spreadsheet document</p>
<p>This class interacts with the Presalytics API to extract SVG objects from
Presentation and spreadsheet documents, identify them, and render them
into a story. The file is uploaded to Presalytics API Ooxml Automation service,
which then processes the file and scans for objects in the file's object tree
(As seen in the 'Selection Pane' in PowerPoint) for objects matching the 'object_name'.
When rendered, this widget retrieves an SVG of the identified object for rendering within
the story.</p>
<p>Please note that the Presalytics API Ooxml Automation object will be created overwritten
each time this widget is initialized, and replaced within the corresponding
<code><a title="presalytics.story.outline.StoryOutline" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.StoryOutline">StoryOutline</a></code>.
For in-place editing of widgets Ooxml Automation objects
that are already bound to the <code>Story</code>, please see <code><a title="presalytics.lib.widgets.ooxml_editors.OoxmlEditorWidget" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.OoxmlEditorWidget">OoxmlEditorWidget</a></code></p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>filename</code></strong> :&ensp;<code>str</code></dt>
<dd>The local filepath a presentation or spreadsheet file containing
the object to be rendered</dd>
<dt><strong><code>name</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The widget name.
If not provided, attribute will be set as the <code>object_name</code>
or <code>filename</code></dd>
<dt><strong><code>story_id</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The the id of the story in the Presalytics API Story service.
If not provided,
a new story will be created.
Do not supply if this object has not yet been created.</dd>
<dt><strong><code>object_ooxml_id</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The identifier of the Ooxml Automation service object bound the Story. Do not supply if this
object has not yet been created.</dd>
<dt><strong><code>endpoint_map</code></strong> :&ensp;<code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap">OoxmlEndpointMap</a></code>, optional</dt>
<dd>Reference to the Presalytics API Ooxml Automation service endpoint and object type
that for the object of interest</dd>
<dt><strong><code>object_name</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The name of the object in the file's object tree the will be rendered</dd>
<dt><strong><code>previous_ooxml_version</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The id Ooxml Automation service document object that was previously used to
occupy this widget in the <code><a title="presalytics.story.outline.StoryOutline" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.StoryOutline">StoryOutline</a></code></dd>
<dt><strong><code>file_last_modified</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The "last modified" date for the file at the <code>filename</code> path.
Used to ascertain
whether file has been updated since the last time the widget was initialized, and
correspondingly, whether the widget should be updated in the <code><a title="presalytics.story.outline.StoryOutline" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.StoryOutline">StoryOutline</a></code></dd>
<dt><strong><code>document_ooxml_id</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The identifier for the parent "Document" object in the Ooxml Automation service for the object
idenitifiable by a combinatation of <code>object_ooxml_id</code> and <code>endpoint_map</code>.</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L379-L607" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class OoxmlFileWidget(OoxmlWidgetBase):
    &#34;&#34;&#34;
    Builds a `widget` from a Presentation or Spreadsheet document

    This class interacts with the Presalytics API to extract SVG objects from
    Presentation and spreadsheet documents, identify them, and render them
    into a story. The file is uploaded to Presalytics API Ooxml Automation service,
    which then processes the file and scans for objects in the file&#39;s object tree
    (As seen in the &#39;Selection Pane&#39; in PowerPoint) for objects matching the &#39;object_name&#39;.
    When rendered, this widget retrieves an SVG of the identified object for rendering within
    the story.

    Please note that the Presalytics API Ooxml Automation object will be created overwritten
    each time this widget is initialized, and replaced within the corresponding
    `presalytics.story.outline.StoryOutline`.  For in-place editing of widgets Ooxml Automation objects
    that are already bound to the `Story`, please see `presalytics.lib.widgets.ooxml_editors.OoxmlEditorWidget`

    Parameters
    ----------
    filename : str
        The local filepath a presentation or spreadsheet file containing
        the object to be rendered

    name : str, optional
        The widget name.  If not provided, attribute will be set as the `object_name`
        or `filename`

    story_id : str, optional
        The the id of the story in the Presalytics API Story service.  If not provided,
        a new story will be created.  Do not supply if this object has not yet been created.

    object_ooxml_id : str, optional
        The identifier of the Ooxml Automation service object bound the Story. Do not supply if this
        object has not yet been created.

    endpoint_map : presalytics.lib.widgets.ooxml.OoxmlEndpointMap, optional
        Reference to the Presalytics API Ooxml Automation service endpoint and object type
        that for the object of interest

    object_name : str, optional
        The name of the object in the file&#39;s object tree the will be rendered

    previous_ooxml_version : str, optional
        The id Ooxml Automation service document object that was previously used to
        occupy this widget in the `presalytics.story.outline.StoryOutline`

    file_last_modified : str, optional
        The &#34;last modified&#34; date for the file at the `filename` path.  Used to ascertain
        whether file has been updated since the last time the widget was initialized, and
        correspondingly, whether the widget should be updated in the `presalytics.story.outline.StoryOutline`

    document_ooxml_id : str, optional
        The identifier for the parent &#34;Document&#34; object in the Ooxml Automation service for the object
        idenitifiable by a combinatation of `object_ooxml_id` and `endpoint_map`.

    &#34;&#34;&#34;
    object_name: typing.Optional[str]
    ooxml_id: str
    file_last_modified: datetime.datetime
    previous_ooxml_version: typing.Dict[str, str]

    __component_kind__ = &#39;ooxml-file-object&#39;

    def __init__(self,
                 filename,
                 name=None,
                 story_id=None,
                 object_ooxml_id=None,
                 endpoint_map=None,
                 object_name=None,
                 previous_ooxml_version={},
                 file_last_modified=None,
                 document_ooxml_id=None,
                 **kwargs):
        if object_name:
            self.object_name = object_name
        else:
            self.object_name = None
        if not name:
            if self.object_name:
                name = self.object_name
            else:
                name = filename
        super(OoxmlFileWidget, self).__init__(name, story_id, object_ooxml_id, endpoint_map, **kwargs)
        self.filename = os.path.basename(filename)
        if not self.endpoint_map:
            if filename.split(&#34;.&#34;)[-1] in [&#34;pptx&#34;, &#34;ppt&#34;]:
                self.endpoint_map = OoxmlEndpointMap(OoxmlEndpointMap.SLIDE)
        self.previous_ooxml_version = previous_ooxml_version
        if file_last_modified:
            self.file_last_modified = file_last_modified.replace(tzinfo=datetime.timezone.utc)
        else:
            self.file_last_modified = datetime.datetime.utcnow()
        self.document_ooxml_id = document_ooxml_id
        self.update()
        self.svg_html = self.create_container(**kwargs)

    def update(self):
        &#34;&#34;&#34;
        If the file is available locally, this renders that updated file and pushes
        the updated rendering data to the server
        &#34;&#34;&#34;
        story: &#39;ApiStory&#39;
        page: &#39;Page&#39;
        widget: &#39;Widget&#39;

        search_paths = list(set(presalytics.settings.AUTODISCOVER_PATHS))
        if os.getcwd() not in search_paths:
            search_paths.append(os.getcwd())
        for path in search_paths:
            fpath = os.path.join(path, self.filename)
            if os.path.exists(fpath):
                # update only the file has been modified sine last time
                this_file_last_modified = datetime.datetime.utcfromtimestamp(os.path.getmtime(fpath)).astimezone(tz=datetime.timezone.utc)
                if self.file_last_modified is None or self.file_last_modified &lt;= this_file_last_modified:
                    client = self.get_client()
                    story, status, headers = client.story.story_id_file_post_with_http_info(self.story_id, file=fpath, replace_existing=True, obsolete_id=self.document_ooxml_id)
                    if status &gt;= 299:
                        raise presalytics.lib.exceptions.ApiError()
                    self.previous_ooxml_version = {
                        &#34;document_ooxml_id&#34;: self.document_ooxml_id,
                        &#34;object_ooxml_id&#34;: self.object_ooxml_id
                    }
                    new_outline = presalytics.story.outline.StoryOutline.load(story.outline)
                    for page in new_outline.pages:
                        found = False
                        for widget in page.widgets:
                            if widget.name == self.object_name:
                                self.document_ooxml_id = widget.data[&#34;document_ooxml_id&#34;]
                                found = True
                                break
                        if found:
                            break
                    if not found:
                        message = &#34;Unable to find widget object name {0} in new story outline.  Has this widget been deleted?&#34;.format(self.object_name)
                        raise presalytics.lib.exceptions.ValidationError(message)

                    # Get object tree, compare to object name
                    child_tree = client.ooxml_automation.documents_childobjects_get_id(self.document_ooxml_id)
                    target_dto = None

                    try:
                        target_dto = next(x for x in child_tree if x.entity_name == self.object_name)
                    except StopIteration:
                        pass
                    # if name not in object or _object_name is none, get first item of type in end_point id
                    if not target_dto:
                        try:
                            target_dto = next(x for x in child_tree if x.object_type.split(&#34;.&#34;)[1] == self.endpoint_map.endpoint_id)
                        except StopIteration:
                            message = &#34;Child tree of document {0} does not have a child object of type {1} or name {2}.&#34;.format(self.ooxml_id, self.endpoint_map.endpoint_id, self.object_name)
                            raise presalytics.lib.exceptions.InvalidConfigurationError(message)
                    # set widget parameters for recreation server-side (without file)
                    self.object_ooxml_id = target_dto.entity_id
                    self.file_last_modified = presalytics.lib.util.roundup_date_modified(this_file_last_modified)

    @classmethod
    def deserialize(cls, component, **kwargs):
        init_args = {
            &#34;filename&#34;: component.data[&#34;filename&#34;],
            &#34;endpoint_map&#34;: OoxmlEndpointMap(component.data[&#34;endpoint_id&#34;]),
            &#34;object_name&#34;: component.data[&#34;object_name&#34;],
            &#34;name&#34;: component.name,
        }
        if &#34;document_ooxml_id&#34; in component.data:
            init_args.update(
                {
                    &#34;document_ooxml_id&#34;: component.data[&#34;document_ooxml_id&#34;]
                }
            )
        if &#34;object_ooxml_id&#34; in component.data:
            init_args.update(
                {
                    &#34;object_ooxml_id&#34;: component.data[&#34;object_ooxml_id&#34;]
                }
            )
        if &#34;file_last_modified&#34; in component.data:
            init_args.update(
                {
                    &#34;file_last_modified&#34;: dateutil.parser.parse(component.data[&#34;file_last_modified&#34;]).replace(tzinfo=datetime.timezone.utc)
                }
            )
        if &#34;previous_ooxml_version&#34; in component.data:
            init_args.update(
                {
                    &#34;previous_ooxml_version&#34;: component.data[&#34;previous_ooxml_version&#34;]
                }
            )
        if &#34;story_id&#34; in component.data:
            init_args.update(
                {
                    &#34;story_id&#34;: component.data[&#34;story_id&#34;]
                }
            )
        if len(kwargs.keys()) &gt; 0:
            init_args.update(kwargs)
        init_args.update({&#39;id&#39;: component.id})
        return cls(**init_args)

    def serialize(self):
        self.update()
        data = {
            &#34;filename&#34;: self.filename,
            &#34;object_name&#34;: self.object_name,
            &#34;endpoint_id&#34;: self.endpoint_map.endpoint_id,
            &#34;document_ooxml_id&#34;: self.document_ooxml_id,
            &#34;object_ooxml_id&#34;: self.object_ooxml_id,
            &#34;story_id&#34;: self.story_id
        }
        if self.file_last_modified:
            data.update(
                {
                    &#34;file_last_modified&#34;: self.file_last_modified.isoformat()
                }
            )
        if self.previous_ooxml_version:
            data.update(
                {
                    &#34;previous_ooxml_version&#34;: self.previous_ooxml_version
                }
            )
        widget = presalytics.story.outline.Widget(
            name=self.name,
            kind=self.__component_kind__,
            id=self.id,
            data=data,
            plugins=None
        )
        return widget</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase">OoxmlWidgetBase</a></li>
<li><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.OoxmlFileWidget.object_name"><code class="name">var <span class="ident">object_name</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.OoxmlFileWidget.ooxml_id"><code class="name">var <span class="ident">ooxml_id</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.OoxmlFileWidget.file_last_modified"><code class="name">var <span class="ident">file_last_modified</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.OoxmlFileWidget.previous_ooxml_version"><code class="name">var <span class="ident">previous_ooxml_version</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.OoxmlFileWidget.update"><code class="name flex">
<span>def <span class="ident">update</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>If the file is available locally, this renders that updated file and pushes
the updated rendering data to the server</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L476-L533" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def update(self):
    &#34;&#34;&#34;
    If the file is available locally, this renders that updated file and pushes
    the updated rendering data to the server
    &#34;&#34;&#34;
    story: &#39;ApiStory&#39;
    page: &#39;Page&#39;
    widget: &#39;Widget&#39;

    search_paths = list(set(presalytics.settings.AUTODISCOVER_PATHS))
    if os.getcwd() not in search_paths:
        search_paths.append(os.getcwd())
    for path in search_paths:
        fpath = os.path.join(path, self.filename)
        if os.path.exists(fpath):
            # update only the file has been modified sine last time
            this_file_last_modified = datetime.datetime.utcfromtimestamp(os.path.getmtime(fpath)).astimezone(tz=datetime.timezone.utc)
            if self.file_last_modified is None or self.file_last_modified &lt;= this_file_last_modified:
                client = self.get_client()
                story, status, headers = client.story.story_id_file_post_with_http_info(self.story_id, file=fpath, replace_existing=True, obsolete_id=self.document_ooxml_id)
                if status &gt;= 299:
                    raise presalytics.lib.exceptions.ApiError()
                self.previous_ooxml_version = {
                    &#34;document_ooxml_id&#34;: self.document_ooxml_id,
                    &#34;object_ooxml_id&#34;: self.object_ooxml_id
                }
                new_outline = presalytics.story.outline.StoryOutline.load(story.outline)
                for page in new_outline.pages:
                    found = False
                    for widget in page.widgets:
                        if widget.name == self.object_name:
                            self.document_ooxml_id = widget.data[&#34;document_ooxml_id&#34;]
                            found = True
                            break
                    if found:
                        break
                if not found:
                    message = &#34;Unable to find widget object name {0} in new story outline.  Has this widget been deleted?&#34;.format(self.object_name)
                    raise presalytics.lib.exceptions.ValidationError(message)

                # Get object tree, compare to object name
                child_tree = client.ooxml_automation.documents_childobjects_get_id(self.document_ooxml_id)
                target_dto = None

                try:
                    target_dto = next(x for x in child_tree if x.entity_name == self.object_name)
                except StopIteration:
                    pass
                # if name not in object or _object_name is none, get first item of type in end_point id
                if not target_dto:
                    try:
                        target_dto = next(x for x in child_tree if x.object_type.split(&#34;.&#34;)[1] == self.endpoint_map.endpoint_id)
                    except StopIteration:
                        message = &#34;Child tree of document {0} does not have a child object of type {1} or name {2}.&#34;.format(self.ooxml_id, self.endpoint_map.endpoint_id, self.object_name)
                        raise presalytics.lib.exceptions.InvalidConfigurationError(message)
                # set widget parameters for recreation server-side (without file)
                self.object_ooxml_id = target_dto.entity_id
                self.file_last_modified = presalytics.lib.util.roundup_date_modified(this_file_last_modified)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase">OoxmlWidgetBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.create_container" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.create_container">create_container</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.create_subdocument" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.create_subdocument">create_subdocument</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg">get_svg</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg_file" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg_file">get_svg_file</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.render" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.render">render</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.serialize">serialize</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.to_html" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.to_html">to_html</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.OoxmlEndpointMap"><code class="flex name class">
<span>class <span class="ident">OoxmlEndpointMap</span></span>
<span>(</span><span>endpoint_id, baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Mapping class that bridges Presalytics API Ooxml Automation service endpoints
and component class that consume those endpoints (typically subclasses of
<code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase">OoxmlWidgetBase</a></code>)</p>
<p>The classmethods on this class are conveninece methods to help users
quickly inform their widget which endpoint their of a Ooxml Document their
targets.</p>
<p>Instance methods on this class are used by widget to generate urls and
lookup against object tree for target objects.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>endpoint_id</code></strong> :&ensp;<code>str</code></dt>
<dd>A unique string for identifying the object_type related to the enpoint</dd>
<dt><strong><code>baseurl</code></strong> :&ensp;<code>str</code></dt>
<dd>For developer use. Allows this to generate urls for non-standard instances
of the Ooxml Automation service.
Defaults to <a href="https://api.presalytics.io/ooxml-automation/">https://api.presalytics.io/ooxml-automation/</a></dd>
</dl>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>root_url</code></strong> :&ensp;<code>str</code></dt>
<dd>the home url for the class instance.
Typically <code>http://api.presalytics.io/ooxml-automation/{object_type}</code></dd>
<dt><strong><code>OBJECT_TYPE_MAP</code></strong> :&ensp;<code>str</code></dt>
<dd>A mapping table for object_types and object tree lookup keys</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L30-L223" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class OoxmlEndpointMap(object):
    &#34;&#34;&#34;
    Mapping class that bridges Presalytics API Ooxml Automation service endpoints
    and component class that consume those endpoints (typically subclasses of
    `presalytics.lib.widgets.ooxml.OoxmlWidgetBase`)

    The classmethods on this class are conveninece methods to help users
    quickly inform their widget which endpoint their of a Ooxml Document their
    targets.

    Instance methods on this class are used by widget to generate urls and
    lookup against object tree for target objects.

    Parameters
    ----------
    endpoint_id : str
        A unique string for identifying the object_type related to the enpoint

    baseurl : str
        For developer use. Allows this to generate urls for non-standard instances
        of the Ooxml Automation service.  Defaults to https://api.presalytics.io/ooxml-automation/

    Attributes
    ----------
    root_url : str
        the home url for the class instance.  Typically `http://api.presalytics.io/ooxml-automation/{object_type}`

    OBJECT_TYPE_MAP : str
        A mapping table for object_types and object tree lookup keys
    &#34;&#34;&#34;
    _BASE_URL = &#34;https://api.presalytics.io/ooxml-automation&#34;
    _CHART = &#34;Charts&#34;
    _CONNECTION_SHAPE = &#34;ConnectionShapes&#34;
    _DOCUMENT = &#34;Documents&#34;
    _GROUP = &#34;Groups&#34;
    _IMAGE = &#34;Images&#34;
    _SHAPE = &#34;Shapes&#34;
    _SHAPETREE = &#34;ShapeTrees&#34;
    _SLIDE = &#34;Slides&#34;
    _TABLE = &#34;Tables&#34;
    _THEME = &#34;Themes&#34;

    def __init__(self, endpoint_id, baseurl: str = None):
        if endpoint_id not in OoxmlEndpointMap.__dict__.values():
            raise presalytics.lib.exceptions.ValidationError(&#34;{0} is not a valid endpoint ID&#34;.format(endpoint_id))
        self.endpoint_id = endpoint_id
        if not baseurl:
            self.baseurl = OoxmlEndpointMap._BASE_URL
            ooxml_host = presalytics.settings.HOST_OOXML_AUTOMATION  # type: ignore[attr-defined]
            if ooxml_host:
                self.baseurl = ooxml_host

        else:
            self.baseurl = baseurl
        self.root_url = posixpath.join(self.baseurl, self.endpoint_id)
        self.OBJECT_TYPE_MAP = self._build_object_type_map()

    def _build_object_type_map(self):
        return {
            &#34;Chart&#34;: [
                OoxmlEndpointMap._CHART,
            ],
            &#34;Slide&#34;: [
                OoxmlEndpointMap._GROUP,
                OoxmlEndpointMap._SHAPE,
                OoxmlEndpointMap._SHAPETREE,
                OoxmlEndpointMap._CONNECTION_SHAPE,
                OoxmlEndpointMap._SLIDE
            ],
            &#34;Table&#34;: [
                OoxmlEndpointMap._TABLE
            ],
            &#34;Theme&#34;: [
                OoxmlEndpointMap._THEME
            ],
            &#34;Shared&#34;: [
                OoxmlEndpointMap._IMAGE
            ],
            &#34;EMPTY&#34;: [
                OoxmlEndpointMap._DOCUMENT
            ]
        }

    def get_object_type(self):
        &#34;&#34;&#34;
        Returns the Ooxml Automation service object type for this endpoint
        &#34;&#34;&#34;
        for key, val in self.OBJECT_TYPE_MAP.items():
            for test_ep in val:
                if test_ep == self.endpoint_id:
                    if key == &#34;EMPTY&#34;:
                        return self.endpoint_id
                    else:
                        return &#34;{0}.{1}&#34;.format(key, self.endpoint_id)
        message = &#34;Invalid EndpointMap configuration: {0} is not in OBJECT_TYPE_MAP&#34;.format(self.endpoint_id)
        raise presalytics.lib.exceptions.ValidationError(message)

    def get_id_url(self, id):
        &#34;&#34;&#34;
        Returns a url to pull metadata from this Ooxml Automation service endpoint
        &#34;&#34;&#34;
        return posixpath.join(self.root_url, id)

    def get_svg_url(self, id):
        &#34;&#34;&#34;
        Returns a url to download an svg from this Ooxml Automation service endpoint
        &#34;&#34;&#34;
        return posixpath.join(self.root_url, &#34;Svg&#34;, id)

    def get_xml_url(self, id):
        &#34;&#34;&#34;
        Returns a url to pull the Open Office Xml from this Ooxml Automation service endpoint
        &#34;&#34;&#34;
        return posixpath.join(self.root_url, &#34;OpenOfficeXml&#34;, id)

    @classmethod
    def connection_shape(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting ConnectionShape objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._CONNECTION_SHAPE, baseurl)

    @classmethod
    def chart(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Chart objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._CHART, baseurl)

    @classmethod
    def document(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Document objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._DOCUMENT, baseurl)

    @classmethod
    def group(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Group objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._GROUP, baseurl)

    @classmethod
    def image(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Image objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._IMAGE, baseurl)

    @classmethod
    def shape(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Shape objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._SHAPE, baseurl)

    @classmethod
    def shapetree(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting ShapeTree objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._SHAPETREE, baseurl)

    @classmethod
    def slide(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Slide objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._SLIDE, baseurl)

    @classmethod
    def table(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Table objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._TABLE, baseurl)

    @classmethod
    def theme(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Theme objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._THEME, baseurl)</code></pre>
</details>
<h3>Static methods</h3>
<dl>
<dt id="presalytics.OoxmlEndpointMap.connection_shape"><code class="name flex">
<span>def <span class="ident">connection_shape</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Factory method to create an <code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap">OoxmlEndpointMap</a></code> instance
targeting ConnectionShape objects</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L145-L151" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def connection_shape(cls, baseurl=None):
    &#34;&#34;&#34;
    Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
    targeting ConnectionShape objects
    &#34;&#34;&#34;
    return cls(OoxmlEndpointMap._CONNECTION_SHAPE, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.chart"><code class="name flex">
<span>def <span class="ident">chart</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Factory method to create an <code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap">OoxmlEndpointMap</a></code> instance
targeting Chart objects</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L153-L159" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def chart(cls, baseurl=None):
    &#34;&#34;&#34;
    Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
    targeting Chart objects
    &#34;&#34;&#34;
    return cls(OoxmlEndpointMap._CHART, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.document"><code class="name flex">
<span>def <span class="ident">document</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Factory method to create an <code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap">OoxmlEndpointMap</a></code> instance
targeting Document objects</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L161-L167" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def document(cls, baseurl=None):
    &#34;&#34;&#34;
    Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
    targeting Document objects
    &#34;&#34;&#34;
    return cls(OoxmlEndpointMap._DOCUMENT, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.group"><code class="name flex">
<span>def <span class="ident">group</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Factory method to create an <code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap">OoxmlEndpointMap</a></code> instance
targeting Group objects</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L169-L175" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def group(cls, baseurl=None):
    &#34;&#34;&#34;
    Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
    targeting Group objects
    &#34;&#34;&#34;
    return cls(OoxmlEndpointMap._GROUP, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.image"><code class="name flex">
<span>def <span class="ident">image</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Factory method to create an <code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap">OoxmlEndpointMap</a></code> instance
targeting Image objects</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L177-L183" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def image(cls, baseurl=None):
    &#34;&#34;&#34;
    Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
    targeting Image objects
    &#34;&#34;&#34;
    return cls(OoxmlEndpointMap._IMAGE, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.shape"><code class="name flex">
<span>def <span class="ident">shape</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Factory method to create an <code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap">OoxmlEndpointMap</a></code> instance
targeting Shape objects</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L185-L191" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def shape(cls, baseurl=None):
    &#34;&#34;&#34;
    Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
    targeting Shape objects
    &#34;&#34;&#34;
    return cls(OoxmlEndpointMap._SHAPE, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.shapetree"><code class="name flex">
<span>def <span class="ident">shapetree</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Factory method to create an <code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap">OoxmlEndpointMap</a></code> instance
targeting ShapeTree objects</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L193-L199" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def shapetree(cls, baseurl=None):
    &#34;&#34;&#34;
    Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
    targeting ShapeTree objects
    &#34;&#34;&#34;
    return cls(OoxmlEndpointMap._SHAPETREE, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.slide"><code class="name flex">
<span>def <span class="ident">slide</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Factory method to create an <code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap">OoxmlEndpointMap</a></code> instance
targeting Slide objects</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L201-L207" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def slide(cls, baseurl=None):
    &#34;&#34;&#34;
    Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
    targeting Slide objects
    &#34;&#34;&#34;
    return cls(OoxmlEndpointMap._SLIDE, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.table"><code class="name flex">
<span>def <span class="ident">table</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Factory method to create an <code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap">OoxmlEndpointMap</a></code> instance
targeting Table objects</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L209-L215" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def table(cls, baseurl=None):
    &#34;&#34;&#34;
    Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
    targeting Table objects
    &#34;&#34;&#34;
    return cls(OoxmlEndpointMap._TABLE, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.theme"><code class="name flex">
<span>def <span class="ident">theme</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Factory method to create an <code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap">OoxmlEndpointMap</a></code> instance
targeting Theme objects</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L217-L223" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def theme(cls, baseurl=None):
    &#34;&#34;&#34;
    Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
    targeting Theme objects
    &#34;&#34;&#34;
    return cls(OoxmlEndpointMap._THEME, baseurl)</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.OoxmlEndpointMap.get_object_type"><code class="name flex">
<span>def <span class="ident">get_object_type</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Returns the Ooxml Automation service object type for this endpoint</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L113-L125" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_object_type(self):
    &#34;&#34;&#34;
    Returns the Ooxml Automation service object type for this endpoint
    &#34;&#34;&#34;
    for key, val in self.OBJECT_TYPE_MAP.items():
        for test_ep in val:
            if test_ep == self.endpoint_id:
                if key == &#34;EMPTY&#34;:
                    return self.endpoint_id
                else:
                    return &#34;{0}.{1}&#34;.format(key, self.endpoint_id)
    message = &#34;Invalid EndpointMap configuration: {0} is not in OBJECT_TYPE_MAP&#34;.format(self.endpoint_id)
    raise presalytics.lib.exceptions.ValidationError(message)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.get_id_url"><code class="name flex">
<span>def <span class="ident">get_id_url</span></span>(<span>self, id)</span>
</code></dt>
<dd>
<section class="desc"><p>Returns a url to pull metadata from this Ooxml Automation service endpoint</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L127-L131" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_id_url(self, id):
    &#34;&#34;&#34;
    Returns a url to pull metadata from this Ooxml Automation service endpoint
    &#34;&#34;&#34;
    return posixpath.join(self.root_url, id)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.get_svg_url"><code class="name flex">
<span>def <span class="ident">get_svg_url</span></span>(<span>self, id)</span>
</code></dt>
<dd>
<section class="desc"><p>Returns a url to download an svg from this Ooxml Automation service endpoint</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L133-L137" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_svg_url(self, id):
    &#34;&#34;&#34;
    Returns a url to download an svg from this Ooxml Automation service endpoint
    &#34;&#34;&#34;
    return posixpath.join(self.root_url, &#34;Svg&#34;, id)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEndpointMap.get_xml_url"><code class="name flex">
<span>def <span class="ident">get_xml_url</span></span>(<span>self, id)</span>
</code></dt>
<dd>
<section class="desc"><p>Returns a url to pull the Open Office Xml from this Ooxml Automation service endpoint</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L139-L143" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_xml_url(self, id):
    &#34;&#34;&#34;
    Returns a url to pull the Open Office Xml from this Ooxml Automation service endpoint
    &#34;&#34;&#34;
    return posixpath.join(self.root_url, &#34;OpenOfficeXml&#34;, id)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="presalytics.OoxmlWidgetBase"><code class="flex name class">
<span>class <span class="ident">OoxmlWidgetBase</span></span>
<span>(</span><span>name, story_id=None, object_ooxml_id=None, endpoint_map=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Base class for creating widgets from objects at endpoints in the
Presalytics API Ooxml Automation service.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>name</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The widget name.
If not provided, will be the <code>object_name</code> or <code>filename</code></dd>
<dt><strong><code>story_id</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The the id of the story in the Presalytics API Story service.
If not provided,
a new story will be created.
Do not supply if this object has not yet been created.</dd>
<dt><strong><code>object_ooxml_id</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The identifier of the Ooxml Automation service object bound the Story. Do not supply if this
object has not yet been created.</dd>
<dt><strong><code>endpoint_map</code></strong> :&ensp;<code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap">OoxmlEndpointMap</a></code>, optional</dt>
<dd>Reference to the Presalytics API Ooxml Automation service endpoint and object type
that for the object of interest</dd>
</dl>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>svg_html</code></strong> :&ensp;<code>str</code></dt>
<dd>An html fragment containing the svg data</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L226-L376" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class OoxmlWidgetBase(presalytics.story.components.WidgetBase):
    &#34;&#34;&#34;
    Base class for creating widgets from objects at endpoints in the
    Presalytics API Ooxml Automation service.

    Parameters
    ----------
    name : str, optional
        The widget name.  If not provided, will be the `object_name` or `filename`

    story_id : str, optional
        The the id of the story in the Presalytics API Story service.  If not provided,
        a new story will be created.  Do not supply if this object has not yet been created.

    object_ooxml_id : str, optional
        The identifier of the Ooxml Automation service object bound the Story. Do not supply if this
        object has not yet been created.

    endpoint_map : presalytics.lib.widgets.ooxml.OoxmlEndpointMap, optional
        Reference to the Presalytics API Ooxml Automation service endpoint and object type
        that for the object of interest

    Attributes
    ----------
    svg_html : str
        An html fragment containing the svg data
    &#34;&#34;&#34;
    endpoint_map: OoxmlEndpointMap
    data: typing.Dict

    __component_kind__ = &#34;ooxml-base-widget&#34;

    __plugins__ = [
        {
            &#39;name&#39;: &#39;external_scripts&#39;,
            &#39;kind&#39;: &#39;script&#39;,
            &#39;config&#39;: {
                &#39;approved_scripts_key&#39;: &#39;ooxml&#39;
            }
        },
        {
            &#39;name&#39;: &#39;external_links&#39;,
            &#39;kind&#39;: &#39;style&#39;,
            &#39;config&#39;: {
                &#39;approved_styles_key&#39;: &#39;preloaders&#39;
            }
        }
    ]

    def __init__(self,
                 name,
                 story_id=None,
                 object_ooxml_id=None,
                 endpoint_map=None,
                 **kwargs):
        super(OoxmlWidgetBase, self).__init__(name, **kwargs)
        if object_ooxml_id:
            self.object_ooxml_id = object_ooxml_id
        if story_id:
            self.story_id = story_id
        if endpoint_map:
            self.endpoint_map = endpoint_map
        self.svg_html = None

    def create_container(self, **kwargs):
        &#34;&#34;&#34;
        Wraps the Presalytics API Ooxml Automation service SVG endpoint in an `&lt;iframe&gt;` that
        will be rendered inside of a story
        &#34;&#34;&#34;
        svg_container_div = lxml.html.Element(&#34;div&#34;, {
            &#39;class&#39;: &#39;svg-container&#39;,
            &#39;data-object-type&#39;: self.endpoint_map.endpoint_id,
            &#39;data-object-id&#39;: self.object_ooxml_id
        })
        preloader_container_div = lxml.html.Element(&#34;div&#34;, {&#34;class&#34;: &#34;preloader-container&#34;})
        preloader_row_div = lxml.etree.SubElement(preloader_container_div, &#34;div&#34;, attrib={&#34;class&#34;: &#34;preloader-row&#34;})
        preloader_file = os.path.join(os.path.dirname(__file__), &#34;img&#34;, &#34;preloader.svg&#34;)
        svg = lxml.html.parse(preloader_file)
        preloader_row_div.append(svg.getroot())
        empty_parent_div = lxml.html.Element(&#34;div&#34;, {
            &#39;class&#39;: &#39;empty-parent bg-light&#39;
        })
        empty_parent_div.extend([svg_container_div, preloader_container_div])
        return lxml.html.tostring(empty_parent_div)

    def to_html(self, **kwargs):
        &#34;&#34;&#34;
        Returns an html string that will render the object at the endpoint
        &#34;&#34;&#34;
        html = self.create_container()
        try:
            html = html.decode(&#39;utf-8&#39;)
        except Exception:
            pass
        self.svg_html = html
        return self.svg_html

    def get_svg(self, id, timeout_iterator=0) -&gt; str:
        &#34;&#34;&#34;
        Get an svg-formatted version of the object from the Ooxml Automation service
        &#34;&#34;&#34;
        svg_url = self.endpoint_map.get_svg_url(id)
        client = self.get_client()
        headers = client.get_auth_header()
        headers.update(client.get_request_id_header())
        response = requests.get(svg_url, headers=headers)
        svg_data = response.text
        if response.status_code != 200:
            raise presalytics.lib.exceptions.ApiError(message=response.text, status_code=response.status_code)
        if response.text.startswith(&#34;Temp data&#34;):
            if timeout_iterator &gt; 5:
                raise presalytics.lib.exceptions.ApiError(message=&#34;Unable to download svg.  Please check for upstream processing errors.&#34;)
            else:
                time.sleep(2)
                svg_data = self.get_svg(id, timeout_iterator)
        return svg_data

    def get_svg_file(self, filename=None):
        &#34;&#34;&#34;
        Writes an svg representation of the object to current working directory.  Filname is optional.
        &#34;&#34;&#34;
        if not filename:
            filename = self.endpoint_map.get_object_type() + &#34;-&#34; + self.object_ooxml_id + &#34;.pptx&#34;
        with open(filename, &#39;w&#39;) as f:
            f.write(self.get_svg(self.object_ooxml_id))

    def serialize(self):
        data = {
            &#34;story_id&#34;: self.story_id,
            &#34;object_id&#34;: self.object_ooxml_id,
            &#34;endpoint_id&#34;: self.endpoint_map.endpoint_id
        }
        widget = presalytics.story.outline.Widget(
            name=self.name,
            kind=self.__component_kind__,
            id=self.id,
            data=data,
            plugins=None
        )
        return widget

    @classmethod
    def deserialize(cls, component, **kwargs):
        return cls(
            component.name,
            component.data[&#34;story_id&#34;],
            component.data[&#34;object_id&#34;],
            OoxmlEndpointMap(component.data[&#34;endpoint_id&#34;]),
            id=component.id,
            **kwargs
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="presalytics.lib.widgets.ooxml.OoxmlFileWidget" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlFileWidget">OoxmlFileWidget</a></li>
<li><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase">UpdaterWidgetBase</a></li>
<li><a title="presalytics.lib.widgets.ooxml_editors.OoxmlEditorWidget" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.OoxmlEditorWidget">OoxmlEditorWidget</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.OoxmlWidgetBase.endpoint_map"><code class="name">var <span class="ident">endpoint_map</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.OoxmlWidgetBase.data"><code class="name">var <span class="ident">data</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.OoxmlWidgetBase.create_container"><code class="name flex">
<span>def <span class="ident">create_container</span></span>(<span>self, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Wraps the Presalytics API Ooxml Automation service SVG endpoint in an <code>&lt;iframe&gt;</code> that
will be rendered inside of a story</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L290-L309" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def create_container(self, **kwargs):
    &#34;&#34;&#34;
    Wraps the Presalytics API Ooxml Automation service SVG endpoint in an `&lt;iframe&gt;` that
    will be rendered inside of a story
    &#34;&#34;&#34;
    svg_container_div = lxml.html.Element(&#34;div&#34;, {
        &#39;class&#39;: &#39;svg-container&#39;,
        &#39;data-object-type&#39;: self.endpoint_map.endpoint_id,
        &#39;data-object-id&#39;: self.object_ooxml_id
    })
    preloader_container_div = lxml.html.Element(&#34;div&#34;, {&#34;class&#34;: &#34;preloader-container&#34;})
    preloader_row_div = lxml.etree.SubElement(preloader_container_div, &#34;div&#34;, attrib={&#34;class&#34;: &#34;preloader-row&#34;})
    preloader_file = os.path.join(os.path.dirname(__file__), &#34;img&#34;, &#34;preloader.svg&#34;)
    svg = lxml.html.parse(preloader_file)
    preloader_row_div.append(svg.getroot())
    empty_parent_div = lxml.html.Element(&#34;div&#34;, {
        &#39;class&#39;: &#39;empty-parent bg-light&#39;
    })
    empty_parent_div.extend([svg_container_div, preloader_container_div])
    return lxml.html.tostring(empty_parent_div)</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlWidgetBase.to_html"><code class="name flex">
<span>def <span class="ident">to_html</span></span>(<span>self, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Returns an html string that will render the object at the endpoint</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L311-L321" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def to_html(self, **kwargs):
    &#34;&#34;&#34;
    Returns an html string that will render the object at the endpoint
    &#34;&#34;&#34;
    html = self.create_container()
    try:
        html = html.decode(&#39;utf-8&#39;)
    except Exception:
        pass
    self.svg_html = html
    return self.svg_html</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlWidgetBase.get_svg"><code class="name flex">
<span>def <span class="ident">get_svg</span></span>(<span>self, id, timeout_iterator=0)</span>
</code></dt>
<dd>
<section class="desc"><p>Get an svg-formatted version of the object from the Ooxml Automation service</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L323-L341" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_svg(self, id, timeout_iterator=0) -&gt; str:
    &#34;&#34;&#34;
    Get an svg-formatted version of the object from the Ooxml Automation service
    &#34;&#34;&#34;
    svg_url = self.endpoint_map.get_svg_url(id)
    client = self.get_client()
    headers = client.get_auth_header()
    headers.update(client.get_request_id_header())
    response = requests.get(svg_url, headers=headers)
    svg_data = response.text
    if response.status_code != 200:
        raise presalytics.lib.exceptions.ApiError(message=response.text, status_code=response.status_code)
    if response.text.startswith(&#34;Temp data&#34;):
        if timeout_iterator &gt; 5:
            raise presalytics.lib.exceptions.ApiError(message=&#34;Unable to download svg.  Please check for upstream processing errors.&#34;)
        else:
            time.sleep(2)
            svg_data = self.get_svg(id, timeout_iterator)
    return svg_data</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlWidgetBase.get_svg_file"><code class="name flex">
<span>def <span class="ident">get_svg_file</span></span>(<span>self, filename=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Writes an svg representation of the object to current working directory.
Filname is optional.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L343-L350" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_svg_file(self, filename=None):
    &#34;&#34;&#34;
    Writes an svg representation of the object to current working directory.  Filname is optional.
    &#34;&#34;&#34;
    if not filename:
        filename = self.endpoint_map.get_object_type() + &#34;-&#34; + self.object_ooxml_id + &#34;.pptx&#34;
    with open(filename, &#39;w&#39;) as f:
        f.write(self.get_svg(self.object_ooxml_id))</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.story.components.WidgetBase.create_subdocument" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.create_subdocument">create_subdocument</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.render" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.render">render</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.serialize">serialize</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.OoxmlEditorWidget"><code class="flex name class">
<span>class <span class="ident">OoxmlEditorWidget</span></span>
<span>(</span><span>name, story_id, object_ooxml_id, endpoint_map, transform_class, transform_params={}, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Edits a <code>widget</code> from a Presentation or Spreadsheet document and renders
the edited widget.</p>
<p>This class interacts with the Presalytics API to extract SVG objects from
Presentation and spreadsheet documents, from Presaltytics Ooxml Automation
service objects that have already been loaded into the API.
This class requires
that users supply <code>transform_function</code> by subclassing
<code><a title="presalytics.lib.widgets.ooxml_editors.XmlTransformBase" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.XmlTransformBase">XmlTransformBase</a></code>, and an optional set of
parameters to act as variables in the transform function.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>filename</code></strong> :&ensp;<code>str</code></dt>
<dd>The local filepath a presentation or spreadsheet file containing
the object to be rendered</dd>
<dt><strong><code>name</code></strong> :&ensp;<code>str</code></dt>
<dd>The widget name.
If not provided, attribute will be set as the <code>object_name</code>
or <code>filename</code></dd>
<dt><strong><code>story_id</code></strong> :&ensp;<code>str</code></dt>
<dd>The the id of the story in the Presalytics API Story service.
If not provided,
a new story will be created.
Do not supply if this object has not yet been created.</dd>
<dt><strong><code>object_ooxml_id</code></strong> :&ensp;<code>str</code></dt>
<dd>The identifier of the Ooxml Automation service object bound the Story. Do not supply if this
object has not yet been created.</dd>
<dt><strong><code>endpoint_map</code></strong> :&ensp;<code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap">OoxmlEndpointMap</a></code></dt>
<dd>Reference to the Presalytics API Ooxml Automation service endpoint and object type
that for the object of interest</dd>
<dt><strong><code>tranform_class</code></strong> :&ensp;<code>subclass</code> of <code><a title="presalytics.lib.widgets.ooxml_editors.XmlTransformBase" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.XmlTransformBase">XmlTransformBase</a></code></dt>
<dd>A class containing a <code>transform_function</code> method that transforms Open Office Xml via
an <code>lxml.etree.Element</code> instance</dd>
<dt><strong><code>transform_params</code></strong> :&ensp;<code>dict</code>, optional</dt>
<dd>A dictionary of parameters that will be passed to the <code>transform_class</code>'s <code>transform_function</code>
as variables to modify the underlying OpenOfficeXml</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml_editors.py#L402-L519" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class OoxmlEditorWidget(presalytics.lib.widgets.ooxml.OoxmlWidgetBase):
    &#34;&#34;&#34;
    Edits a `widget` from a Presentation or Spreadsheet document and renders
    the edited widget.

    This class interacts with the Presalytics API to extract SVG objects from
    Presentation and spreadsheet documents, from Presaltytics Ooxml Automation
    service objects that have already been loaded into the API.  This class requires
    that users supply `transform_function` by subclassing
    `presalytics.lib.widgets.ooxml_editors.XmlTransformBase`, and an optional set of
    parameters to act as variables in the transform function.

    Parameters
    ----------
    filename : str
        The local filepath a presentation or spreadsheet file containing
        the object to be rendered

    name : str
        The widget name.  If not provided, attribute will be set as the `object_name`
        or `filename`

    story_id : str
        The the id of the story in the Presalytics API Story service.  If not provided,
        a new story will be created.  Do not supply if this object has not yet been created.

    object_ooxml_id : str
        The identifier of the Ooxml Automation service object bound the Story. Do not supply if this
        object has not yet been created.

    endpoint_map : presalytics.lib.widgets.ooxml.OoxmlEndpointMap
        Reference to the Presalytics API Ooxml Automation service endpoint and object type
        that for the object of interest

    tranform_class : subclass of presalytics.lib.widgets.ooxml_editors.XmlTransformBase
        A class containing a `transform_function` method that transforms Open Office Xml via
        an `lxml.etree.Element` instance

    transform_params : dict, optional
        A dictionary of parameters that will be passed to the `transform_class`&#39;s `transform_function`
        as variables to modify the underlying OpenOfficeXml

    &#34;&#34;&#34;
    transform: XmlTransformBase

    __component_kind__ = &#39;ooxml-xml-editor&#39;

    def __init__(self,
                 name: str,
                 story_id,
                 object_ooxml_id,
                 endpoint_map,
                 transform_class,
                 transform_params={},
                 **kwargs):
        super(OoxmlEditorWidget, self).__init__(name, story_id=story_id, object_ooxml_id=object_ooxml_id, endpoint_map=endpoint_map, **kwargs)
        self.name = name
        self.transform = transform_class(transform_params)
        self.update()
        self.svg_html = self.create_container(**self.client_info)
        self.outline_widget = self.serialize()

    def update_xml(self, xml_str) -&gt; str:
        &#34;&#34;&#34;
        Runs the `transform_function` Open Office Xml data downloaded via the Presalytics API
        &#34;&#34;&#34;
        xml = lxml.etree.fromstring(xml_str)
        new_xml = self.transform.execute(xml)
        new_xml_str = lxml.etree.tostring(new_xml)
        return new_xml_str

    def update(self):
        &#34;&#34;&#34;
        Update the widget, include changes to the Xml
        &#34;&#34;&#34;
        client = self.get_client()
        headers = client.get_auth_header()
        headers.update(client.get_request_id_header())
        if self.transform:
            xml_url = self.endpoint_map.get_xml_url(self.object_ooxml_id)
            xml_response = requests.get(xml_url + &#34;?updated=false&#34;, headers=headers)
            if xml_response.status_code != 200:
                raise presalytics.lib.exceptions.ApiError(message=xml_response.text)
            dto = xml_response.json()
            new_xml = self.update_xml(dto[&#34;openOfficeXml&#34;])
            dto[&#34;openOfficeXml&#34;] = new_xml.decode(&#39;utf-8&#39;)
            xml_update_response = requests.put(xml_url, json=dto, headers=headers)
            if xml_response.status_code != 200:
                raise presalytics.lib.exceptions.ApiError(message=xml_update_response.content)

    @classmethod
    def deserialize(cls, component, **kwargs):
        endpoint_map = presalytics.lib.widgets.ooxml.OoxmlEndpointMap(component.data[&#34;endpoint_id&#34;])
        class_key = &#34;XmlTransform.&#34; + component.data.get(&#34;transform_class&#34;, &#34;&#34;)
        transform_class = get_transform_registry().get(class_key)
        transform_params = component.data.get(&#34;transform_params&#34;, {})
        return cls(component.name,
                   component.data[&#34;story_id&#34;],
                   component.data[&#34;object_ooxml_id&#34;],
                   endpoint_map,
                   transform_class=transform_class,
                   transform_params=transform_params,
                   **kwargs)

    def serialize(self, **kwargs):
        data = {
            &#34;story_id&#34;: self.story_id,
            &#34;object_ooxml_id&#34;: self.object_ooxml_id,
            &#34;endpoint_id&#34;: self.endpoint_map.endpoint_id,
            &#34;transform_class&#34;: self.transform.__xml_transform_name__,
            &#34;transform_params&#34;: self.transform.function_params
        }
        widget = presalytics.story.outline.Widget(
            name=self.name,
            data=data,
            kind=self.__component_kind__
        )
        return widget</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase">OoxmlWidgetBase</a></li>
<li><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.OoxmlEditorWidget.transform"><code class="name">var <span class="ident">transform</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.OoxmlEditorWidget.update_xml"><code class="name flex">
<span>def <span class="ident">update_xml</span></span>(<span>self, xml_str)</span>
</code></dt>
<dd>
<section class="desc"><p>Runs the <code>transform_function</code> Open Office Xml data downloaded via the Presalytics API</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml_editors.py#L464-L471" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def update_xml(self, xml_str) -&gt; str:
    &#34;&#34;&#34;
    Runs the `transform_function` Open Office Xml data downloaded via the Presalytics API
    &#34;&#34;&#34;
    xml = lxml.etree.fromstring(xml_str)
    new_xml = self.transform.execute(xml)
    new_xml_str = lxml.etree.tostring(new_xml)
    return new_xml_str</code></pre>
</details>
</dd>
<dt id="presalytics.OoxmlEditorWidget.update"><code class="name flex">
<span>def <span class="ident">update</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Update the widget, include changes to the Xml</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml_editors.py#L473-L490" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def update(self):
    &#34;&#34;&#34;
    Update the widget, include changes to the Xml
    &#34;&#34;&#34;
    client = self.get_client()
    headers = client.get_auth_header()
    headers.update(client.get_request_id_header())
    if self.transform:
        xml_url = self.endpoint_map.get_xml_url(self.object_ooxml_id)
        xml_response = requests.get(xml_url + &#34;?updated=false&#34;, headers=headers)
        if xml_response.status_code != 200:
            raise presalytics.lib.exceptions.ApiError(message=xml_response.text)
        dto = xml_response.json()
        new_xml = self.update_xml(dto[&#34;openOfficeXml&#34;])
        dto[&#34;openOfficeXml&#34;] = new_xml.decode(&#39;utf-8&#39;)
        xml_update_response = requests.put(xml_url, json=dto, headers=headers)
        if xml_response.status_code != 200:
            raise presalytics.lib.exceptions.ApiError(message=xml_update_response.content)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase">OoxmlWidgetBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.create_container" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.create_container">create_container</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.create_subdocument" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.create_subdocument">create_subdocument</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg">get_svg</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg_file" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg_file">get_svg_file</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.render" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.render">render</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.serialize">serialize</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.to_html" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.to_html">to_html</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.D3Widget"><code class="flex name class">
<span>class <span class="ident">D3Widget</span></span>
<span>(</span><span>name, d3_data, id=None, script64=None, script_filename=None, css64=None, css_filename=None, html64=None, html_filename=None, *args, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>A <code>Widget</code> for rendering user-defined d3.js scripts</p>
<p>This class allows users to load <a href="https://d3js.org/">d3.js</a> objects
into widgets in order to create custom and interactive widgets.
User can define d3 scripts in a separate file and load them via <code>script_filename</code>
parameter.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>name</code></strong> :&ensp;<code>str</code></dt>
<dd>the name of widget.
Must be unique within <code><a title="presalytics.COMPONENTS" href="/python-client/presalytics/index.html#presalytics.COMPONENTS">COMPONENTS</a></code></dd>
<dt><strong><code>d3_data</code></strong> :&ensp;<code>dict</code></dt>
<dd>Data that will be loaded into the script when run in the browser. Avaiable
in the script as the <code>data</code> object.</dd>
<dt><strong><code>id</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>A unique identifier the widget.
Automatically generated when the
widget is created or updated.</dd>
<dt><strong><code>story_id</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The story_id of the parent story</dd>
<dt><strong><code>script64</code></strong> :&ensp;<code>str. optional</code></dt>
<dd>A base64-encoded string of the script's text.
Used for server-to-server
transport over https</dd>
<dt><strong><code>script_filename</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Required when updating the script text.
Read into the <code>script64</code> parameter
via the <code>read_file</code> method</dd>
<dt><strong><code>html64</code></strong> :&ensp;<code>str. optional</code></dt>
<dd>A base64-encoded string of the html fragments's text.
Used for server-to-server
transport over https</dd>
<dt><strong><code>html_filename</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The name of file in the local directory with an html framement that should be rendered within the
body (inside element <code>&lt;div id="{{id}}" class="d3-container"&gt;&lt;/div&gt;</code>) of the iframe containing the
d3 script</dd>
<dt><strong><code>css64</code></strong> :&ensp;<code>str. optional</code></dt>
<dd>A base64-encoded string of the css styles to apply to the d3 document.
Used for server-to-server
transport over https.</dd>
<dt><strong><code>css_filename</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>
<p>A css file containing styles that will be applied to d3</p>
<p>Note: Styles <code>html {width: 100%; height:100%;} body {width: 100%; height: 100%; margin: 0px;}</code>
are applied by default if not css is provided</p>
</dd>
</dl>
<h2 id="script-local-variables">Script Local Variables:</h2>
<p>The following vairables are avialable to users when writing scripts:</p>
<p>data: <code>javascript object</code>
The data loaded into the script via <code>d3_data</code> parameter</p>
<p>container: <code>html element</code>
The first div in the body</p>
<p>d3: <code>javascript object</code>
The root d3 object for selecting, creating and editing elements on the DOM</p>
<h2 id="security-note">Security Note:</h2>
<p>Scripts loaded via this widget are <em>Sandboxed</em>.
These script can only interact with
dom elements defined in the widget script loaded via the <code>script_filename</code> parameter.
Fetch and xhr actions are also disabled via a restrictive Content Security Policy.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/d3.py#L21-L279" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class D3Widget(presalytics.story.components.WidgetBase):
    &#34;&#34;&#34;
    A `Widget` for rendering user-defined d3.js scripts

    This class allows users to load [d3.js](https://d3js.org/) objects
    into widgets in order to create custom and interactive widgets.
    User can define d3 scripts in a separate file and load them via `script_filename`
    parameter.

    Parameters
    ----------

    name : str
        the name of widget.  Must be unique within `presalytics.COMPONENTS`

    d3_data: dict
        Data that will be loaded into the script when run in the browser. Avaiable
        in the script as the `data` object.

    id: str, optional
        A unique identifier the widget.  Automatically generated when the
        widget is created or updated.

    story_id : str, optional
        The story_id of the parent story

    script64 : str. optional
        A base64-encoded string of the script&#39;s text.  Used for server-to-server
        transport over https

    script_filename: str, optional
        Required when updating the script text.  Read into the `script64` parameter
        via the `read_file` method

    html64 : str. optional
        A base64-encoded string of the html fragments&#39;s text.  Used for server-to-server
        transport over https

    html_filename: str, optional
        The name of file in the local directory with an html framement that should be rendered within the
        body (inside element `&lt;div id=&#34;{{id}}&#34; class=&#34;d3-container&#34;&gt;&lt;/div&gt;`) of the iframe containing the
        d3 script

    css64 : str. optional
        A base64-encoded string of the css styles to apply to the d3 document.  Used for server-to-server
        transport over https.

    css_filename: str, optional
        A css file containing styles that will be applied to d3

        Note: Styles `html {width: 100%; height:100%;} body {width: 100%; height: 100%; margin: 0px;}`
        are applied by default if not css is provided


    Script Local Variables:
    ----------

    The following vairables are avialable to users when writing scripts:

    data: `javascript object`
        The data loaded into the script via `d3_data` parameter

    container: `html element`
        The first div in the body

    d3: `javascript object`
        The root d3 object for selecting, creating and editing elements on the DOM


    Security Note:
    ----------

    Scripts loaded via this widget are *Sandboxed*.  These script can only interact with
    dom elements defined in the widget script loaded via the `script_filename` parameter.
    Fetch and xhr actions are also disabled via a restrictive Content Security Policy.


    &#34;&#34;&#34;
    __component_kind__ = &#39;d3&#39;

    def __init__(self,
                 name: str,
                 d3_data: typing.Dict,
                 id: str = None,
                 script64: str = None,
                 script_filename: str = None,
                 css64: str = None,
                 css_filename: str = None,
                 html64: str = None,
                 html_filename: str = None,
                 *args, **kwargs):
        if not id:
            id = &#39;d3-&#39; + str(uuid.uuid4())
        self.id = id
        self.d3_data = d3_data
        super(D3Widget, self).__init__(name, *args, **kwargs)
        self.script_filename = script_filename
        self.script64 = self.read_file(script_filename)
        if not self.script64:
            self.script64 = script64
        if not self.script64:
            raise presalytics.lib.exceptions.InvalidConfigurationError(&#34;D3 Widget must be supplied either a script64 or script_filename keyword argument.&#34;)
        self.html64 = self.read_file(html_filename)
        self.html64 = self.html64 if self.html64 else html64
        self.html_filename = html_filename
        self.css64 = self.read_file(css_filename)
        self.css64 = self.css64 if self.css64 else css64
        self.css_filename = css_filename

    def read_file(self, filename) -&gt; typing.Optional[str]:
        &#34;&#34;&#34;
        Find a file named `filename` and return its base64-ecoded content
        &#34;&#34;&#34;
        data64 = None
        if filename:
            search_paths = list(set(presalytics.settings.AUTODISCOVER_PATHS))
            if os.getcwd() not in search_paths:
                search_paths.append(os.getcwd())
            for path in search_paths:
                fpath = os.path.join(path, filename)
                if os.path.exists(fpath):
                    with open(fpath, &#39;rb&#39;) as f:
                        data = f.read()
                        data64 = base64.b64encode(data).decode(&#39;utf-8&#39;)  # type: ignore
                    break
            if not data64:
                logger.debug(&#34;File {0} could not be found&#34;.format(filename))
        return data64

    def to_html(self, data=None, **kwargs) -&gt; str:
        &#34;&#34;&#34;
        Renders the sandboxed iframe with will contain the d3 script widget
        &#34;&#34;&#34;
        html = self.create_container()
        return html

    def create_container(self, **kwargs):
        &#34;&#34;&#34;
        Wraps the D3 objects in an endpoint at the story API load via a sandboxed `&lt;iframe&gt;` that
        will be rendered
        &#34;&#34;&#34;
        story_host = self.get_client(delegate_login=True).story.api_client.external_root_url
        source_url = &#34;{0}/cache/{1}&#34;.format(story_host, self.nonce)
        empty_parent_div = lxml.html.Element(&#34;div&#34;, {
            &#39;class&#39;: &#39;empty-parent bg-light&#39;,
            &#39;style&#39;: &#39;height: 100%; width: 100%, display: block; text-align: left;&#39;
        })
        frame = lxml.html.Element(&#34;iframe&#34;, {
            &#39;src&#39;: source_url,
            &#39;frameborder&#39;: &#34;0&#34;,
            &#39;scrolling&#39;: &#34;auto&#34;,
            &#39;class&#39;: &#39;d3-responsive-frame&#39;,
            &#39;style&#39;: &#39;max-height: none; max-width: none; height:100%; width: 100%;&#39;,
            &#39;sandbox&#39;: &#39;allow-forms allow-scripts allow-same-origin&#39;
        })
        empty_parent_div.append(frame)
        return lxml.html.tostring(empty_parent_div).decode(&#39;utf-8&#39;)

    @classmethod
    def deserialize(cls, outline, **kwargs):
        d3_data = outline.data.get(&#34;d3_data&#34;)
        story_id = outline.data.get(&#34;story_id&#34;, None)
        script_filename = outline.data.get(&#39;script_filename&#39;, None)
        script64 = outline.data.get(&#39;script64&#39;, None)
        html_filename = outline.data.get(&#39;html_filename&#39;, None)
        html64 = outline.data.get(&#39;html64&#39;, None)
        css_filename = outline.data.get(&#39;css_filename&#39;, None)
        css64 = outline.data.get(&#39;css64&#39;, None)
        return cls(outline.name,
                   d3_data,
                   id=outline.id,
                   story_id=story_id,
                   script64=script64,
                   script_filename=script_filename,
                   html64=html64,
                   html_filename=html_filename,
                   css64=css64,
                   css_filename=css_filename,
                   **kwargs)

    def serialize(self, **kwargs):
        data = {
            &#39;d3_data&#39;: self.d3_data,
            &#39;id&#39;: self.id,
            &#39;story_id&#39;: self.story_id,
            &#39;script_filename&#39;: self.script_filename,
            &#39;script64&#39;: self.script64,
            &#39;css64&#39;: self.css64,
            &#39;html64&#39;: self.html64,
            &#39;html_filename&#39;: self.html_filename,
            &#39;css_filename&#39;: self.css_filename
        }
        return presalytics.story.outline.Widget(
            name=self.name,
            kind=self.__component_kind__,
            id=self.id,
            data=data,
        )

    DEFAULT_CSS = &#34;&#34;&#34;
    html {
        height: 100%;
        width: 100%;
    }
    body {
        height: 100%;
        width: 100%;
        margin: 0px;
    }
    &#34;&#34;&#34;

    def create_subdocument(self, **kwargs):
        return self.standalone_html()

    def standalone_html(self) -&gt; str:
        &#34;&#34;&#34;
        Returns string with an html document containing that d3 widget

        Loaded via the Story API d3 endpoint
        &#34;&#34;&#34;
        SIMPLE_HTML = jinja2.Template(&#34;&#34;&#34;&lt;!DOCTYPE html&gt;
        &lt;html&gt;
            &lt;head&gt;
                &lt;meta charset=&#34;UTF-8&#34;&gt;
                &lt;style&gt;
                {{ css }}
                &lt;/style&gt;
            &lt;/head&gt;
            &lt;body&gt;
                &lt;script type=&#34;text/javascript&#34; src=&#34;{{ d3_url }}&#34;&gt;&lt;/script&gt;
                &lt;script type=&#34;text/javascript&#34; src=&#34;{{ events_url }}&#34;&gt;&lt;/script&gt;
                &lt;div id=&#34;{{ id }}&#34; class=&#34;d3-container&#34;&gt;{{ html_fragment }}&lt;/div&gt;
                &lt;script type=&#34;text/javascript&#34;&gt;

                    var id = &#39;{{id}}&#39;;

                    var data = JSON.parse(&#39;{{data|safe}}&#39;);

                    var container = document.getElementById(id);

                    {{script|safe}}

                &lt;/script&gt;
            &lt;/body&gt;
        &lt;/html&gt;&#34;&#34;&#34;)
        data = json.dumps(self.d3_data)  # dont use hyphens in data keys
        script = base64.b64decode(self.script64).decode(&#39;utf-8&#39;)  # type: ignore  #Required
        extra_css = base64.b64decode(self.css64).decode(&#39;utf-8&#39;) if self.css64 else D3Widget.DEFAULT_CSS  # type: ignore
        html_fragment = base64.b64decode(self.html64).decode(&#39;utf-8&#39;) if self.html64 else None  # type: ignore   # disable nested iframes
        context = {
            &#34;id&#34;: self.id,
            &#34;d3_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;d3&#39;),
            &#34;data&#34;: data,
            &#34;script&#34;: script,
            &#34;css&#34;: extra_css,
            &#34;html_fragment&#34;: html_fragment,
            &#34;events_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;events&#39;),
        }
        return SIMPLE_HTML.render(**context)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.D3Widget.outline_widget"><code class="name">var <span class="ident">outline_widget</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.D3Widget.DEFAULT_CSS"><code class="name">var <span class="ident">DEFAULT_CSS</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.D3Widget.read_file"><code class="name flex">
<span>def <span class="ident">read_file</span></span>(<span>self, filename)</span>
</code></dt>
<dd>
<section class="desc"><p>Find a file named <code>filename</code> and return its base64-ecoded content</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/d3.py#L130-L148" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def read_file(self, filename) -&gt; typing.Optional[str]:
    &#34;&#34;&#34;
    Find a file named `filename` and return its base64-ecoded content
    &#34;&#34;&#34;
    data64 = None
    if filename:
        search_paths = list(set(presalytics.settings.AUTODISCOVER_PATHS))
        if os.getcwd() not in search_paths:
            search_paths.append(os.getcwd())
        for path in search_paths:
            fpath = os.path.join(path, filename)
            if os.path.exists(fpath):
                with open(fpath, &#39;rb&#39;) as f:
                    data = f.read()
                    data64 = base64.b64encode(data).decode(&#39;utf-8&#39;)  # type: ignore
                break
        if not data64:
            logger.debug(&#34;File {0} could not be found&#34;.format(filename))
    return data64</code></pre>
</details>
</dd>
<dt id="presalytics.D3Widget.to_html"><code class="name flex">
<span>def <span class="ident">to_html</span></span>(<span>self, data=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Renders the sandboxed iframe with will contain the d3 script widget</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/d3.py#L150-L155" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def to_html(self, data=None, **kwargs) -&gt; str:
    &#34;&#34;&#34;
    Renders the sandboxed iframe with will contain the d3 script widget
    &#34;&#34;&#34;
    html = self.create_container()
    return html</code></pre>
</details>
</dd>
<dt id="presalytics.D3Widget.create_container"><code class="name flex">
<span>def <span class="ident">create_container</span></span>(<span>self, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Wraps the D3 objects in an endpoint at the story API load via a sandboxed <code>&lt;iframe&gt;</code> that
will be rendered</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/d3.py#L157-L177" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def create_container(self, **kwargs):
    &#34;&#34;&#34;
    Wraps the D3 objects in an endpoint at the story API load via a sandboxed `&lt;iframe&gt;` that
    will be rendered
    &#34;&#34;&#34;
    story_host = self.get_client(delegate_login=True).story.api_client.external_root_url
    source_url = &#34;{0}/cache/{1}&#34;.format(story_host, self.nonce)
    empty_parent_div = lxml.html.Element(&#34;div&#34;, {
        &#39;class&#39;: &#39;empty-parent bg-light&#39;,
        &#39;style&#39;: &#39;height: 100%; width: 100%, display: block; text-align: left;&#39;
    })
    frame = lxml.html.Element(&#34;iframe&#34;, {
        &#39;src&#39;: source_url,
        &#39;frameborder&#39;: &#34;0&#34;,
        &#39;scrolling&#39;: &#34;auto&#34;,
        &#39;class&#39;: &#39;d3-responsive-frame&#39;,
        &#39;style&#39;: &#39;max-height: none; max-width: none; height:100%; width: 100%;&#39;,
        &#39;sandbox&#39;: &#39;allow-forms allow-scripts allow-same-origin&#39;
    })
    empty_parent_div.append(frame)
    return lxml.html.tostring(empty_parent_div).decode(&#39;utf-8&#39;)</code></pre>
</details>
</dd>
<dt id="presalytics.D3Widget.standalone_html"><code class="name flex">
<span>def <span class="ident">standalone_html</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Returns string with an html document containing that d3 widget</p>
<p>Loaded via the Story API d3 endpoint</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/d3.py#L235-L279" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def standalone_html(self) -&gt; str:
    &#34;&#34;&#34;
    Returns string with an html document containing that d3 widget

    Loaded via the Story API d3 endpoint
    &#34;&#34;&#34;
    SIMPLE_HTML = jinja2.Template(&#34;&#34;&#34;&lt;!DOCTYPE html&gt;
    &lt;html&gt;
        &lt;head&gt;
            &lt;meta charset=&#34;UTF-8&#34;&gt;
            &lt;style&gt;
            {{ css }}
            &lt;/style&gt;
        &lt;/head&gt;
        &lt;body&gt;
            &lt;script type=&#34;text/javascript&#34; src=&#34;{{ d3_url }}&#34;&gt;&lt;/script&gt;
            &lt;script type=&#34;text/javascript&#34; src=&#34;{{ events_url }}&#34;&gt;&lt;/script&gt;
            &lt;div id=&#34;{{ id }}&#34; class=&#34;d3-container&#34;&gt;{{ html_fragment }}&lt;/div&gt;
            &lt;script type=&#34;text/javascript&#34;&gt;

                var id = &#39;{{id}}&#39;;

                var data = JSON.parse(&#39;{{data|safe}}&#39;);

                var container = document.getElementById(id);

                {{script|safe}}

            &lt;/script&gt;
        &lt;/body&gt;
    &lt;/html&gt;&#34;&#34;&#34;)
    data = json.dumps(self.d3_data)  # dont use hyphens in data keys
    script = base64.b64decode(self.script64).decode(&#39;utf-8&#39;)  # type: ignore  #Required
    extra_css = base64.b64decode(self.css64).decode(&#39;utf-8&#39;) if self.css64 else D3Widget.DEFAULT_CSS  # type: ignore
    html_fragment = base64.b64decode(self.html64).decode(&#39;utf-8&#39;) if self.html64 else None  # type: ignore   # disable nested iframes
    context = {
        &#34;id&#34;: self.id,
        &#34;d3_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;d3&#39;),
        &#34;data&#34;: data,
        &#34;script&#34;: script,
        &#34;css&#34;: extra_css,
        &#34;html_fragment&#34;: html_fragment,
        &#34;events_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;events&#39;),
    }
    return SIMPLE_HTML.render(**context)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.story.components.WidgetBase.create_subdocument" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.create_subdocument">create_subdocument</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.render" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.render">render</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.serialize">serialize</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.ChartWidget"><code class="flex name class">
<span>class <span class="ident">ChartWidget</span></span>
<span>(</span><span>name, chart_data, css64=None, css_filename=None, *args, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>A <code>Widget</code> for rendering chart objects, implemented over the top of c3.js.
For security reasons, charts are loaded via a sandboxed iframe that points
to an endpoint in the Presalytics Story API.</p>
<p>This class allows users to load <a href="https://c3js.org/">c3.js</a> objects
into widgets in order load charts directly off a simple data object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>name</code></strong> :&ensp;<code>str</code></dt>
<dd>the name of widget.
Must be unique within <code><a title="presalytics.COMPONENTS" href="/python-client/presalytics/index.html#presalytics.COMPONENTS">COMPONENTS</a></code></dd>
<dt><strong><code>chart_data</code></strong> :&ensp;<code>dict</code></dt>
<dd>Data that will be loaded into the <code>c3.generate()</code> method.
Please go
to <a href="https://c3js.org/gettingstarted.html">c3js.org</a> for more information
on how to configure this object.</dd>
<dt><strong><code>css64</code></strong> :&ensp;<code>str. optional</code></dt>
<dd>A base64-encoded string of the css styles to apply to the d3 document.
Used for server-to-server
transport over https.</dd>
<dt><strong><code>css_filename</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>
<p>A css file containing styles that will be applied to d3</p>
<p>Note: Styles <code>html {width: 100%; height:100%;} body {width: 100%; height: 100%; margin: 0px;}</code>
are applied by default if not css is provided</p>
</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/chart.py#L20-L229" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class ChartWidget(presalytics.story.components.WidgetBase):
    &#34;&#34;&#34;
    A `Widget` for rendering chart objects, implemented over the top of c3.js.
    For security reasons, charts are loaded via a sandboxed iframe that points
    to an endpoint in the Presalytics Story API.

    This class allows users to load [c3.js](https://c3js.org/) objects
    into widgets in order load charts directly off a simple data object.

    Parameters
    ----------

    name : str
        the name of widget.  Must be unique within `presalytics.COMPONENTS`

    chart_data: dict
        Data that will be loaded into the `c3.generate()` method.  Please go
        to [c3js.org](https://c3js.org/gettingstarted.html) for more information
        on how to configure this object.

    css64 : str. optional
        A base64-encoded string of the css styles to apply to the d3 document.  Used for server-to-server
        transport over https.

    css_filename: str, optional
        A css file containing styles that will be applied to d3

        Note: Styles `html {width: 100%; height:100%;} body {width: 100%; height: 100%; margin: 0px;}`
        are applied by default if not css is provided
    &#34;&#34;&#34;
    __component_kind__ = &#39;chart&#39;

    def __init__(self,
                 name: str,
                 chart_data: typing.Dict,
                 css64: str = None,
                 css_filename: str = None,
                 *args,
                 **kwargs):
        self.chart_data = chart_data
        super(ChartWidget, self).__init__(name, *args, **kwargs)
        self.add_bind_to()
        self.css64 = self.read_file(css_filename)
        self.css64 = self.css64 if self.css64 else css64
        self.css_filename = css_filename

    def read_file(self, filename) -&gt; typing.Optional[str]:
        &#34;&#34;&#34;
        Find a file named `filename` and return its base64-ecoded content
        &#34;&#34;&#34;
        data64 = None
        if filename:
            search_paths = list(set(presalytics.settings.AUTODISCOVER_PATHS))  # type: ignore
            if os.getcwd() not in search_paths:
                search_paths.append(os.getcwd())
            for path in search_paths:
                fpath = os.path.join(path, filename)
                if os.path.exists(fpath):
                    with open(fpath, &#39;rb&#39;) as f:
                        data = f.read()
                        data64 = base64.b64encode(data).decode(&#39;utf-8&#39;)  # type: ignore
                    break
            if not data64:
                logger.debug(&#34;File {0} could not be found&#34;.format(filename))
        return data64

    def add_bind_to(self):
        if &#39;bindto&#39; not in self.chart_data.keys():
            self.chart_data[&#39;bindto&#39;] = &#39;#chart&#39;

    def to_html(self, data=None, **kwargs) -&gt; str:
        &#34;&#34;&#34;
        Renders the sandboxed iframe with will contain the d3 script widget
        &#34;&#34;&#34;
        html = self.create_container()
        return html

    def create_container(self, **kwargs) -&gt; str:
        &#34;&#34;&#34;
        Wraps the D3 objects in an endpoint at the story API load via a sandboxed `&lt;iframe&gt;` that
        will be rendered
        &#34;&#34;&#34;
        story_host = self.get_client(delegate_login=True).story.api_client.external_root_url
        source_url = &#34;{0}/cache/{1}&#34;.format(story_host, self.nonce)
        empty_parent_div = lxml.html.Element(&#34;div&#34;, {
            &#39;class&#39;: &#39;empty-parent bg-light&#39;,
            &#39;style&#39;: &#39;height: 100%; width: 100%, display: block; text-align: left;&#39;
        })
        frame = lxml.html.Element(&#34;iframe&#34;, {
            &#39;src&#39;: source_url,
            &#39;frameborder&#39;: &#34;0&#34;,
            &#39;scrolling&#39;: &#34;auto&#34;,
            &#39;class&#39;: &#39;d3-responsive-frame&#39;,
            &#39;style&#39;: &#39;max-height: none; max-width: none; height:100%; width: 100%;&#39;,
            &#39;sandbox&#39;: &#39;allow-scripts allow-same-origin&#39;
        })
        empty_parent_div.append(frame)
        return lxml.html.tostring(empty_parent_div).decode(&#39;utf-8&#39;)  # type: ignore

    @classmethod
    def deserialize(cls, outline, **kwargs):
        chart_data = outline.data.get(&#34;chart_data&#34;)
        return cls(outline.name,
                   id=outline.id,
                   chart_data=chart_data,
                   **kwargs)

    def serialize(self, **kwargs):
        data = {
            &#39;chart_data&#39;: self.chart_data,
        }
        return presalytics.story.outline.Widget(
            name=self.name,
            kind=self.__component_kind__,
            id=self.id,
            data=data,
        )

    DEFAULT_CSS = &#34;&#34;&#34;
    html {
        height: 100%;
        width: 100%;
    }
    body {
        height: 100%;
        width: 100%;
        margin: 0px;
    }

    .c3-axis-y text,
    .c3-axis-x text,
    .c3-axis-y2 text
    {
        font-size: 1rem;
    }

    .c3-legend-item {
        font-size: 20px;
    }

    #chart {
        margin: 20px;
    }
    &#34;&#34;&#34;

    def create_subdocument(self, **kwargs):
        return self.standalone_html()

    def standalone_html(self) -&gt; str:
        &#34;&#34;&#34;
        Returns string with an html document containing that d3 widget

        Loaded via the Story API d3 endpoint
        &#34;&#34;&#34;
        SIMPLE_HTML = jinja2.Template(&#34;&#34;&#34;&lt;!DOCTYPE html&gt;
        &lt;html&gt;
            &lt;head&gt;
                &lt;meta charset=&#34;UTF-8&#34;&gt;
                &lt;style&gt;
                {{ css }}
                &lt;/style&gt;
            &lt;/head&gt;
            &lt;body&gt;
                &lt;link href=&#34;{{c3_styles_url}}&#34; rel=&#34;stylesheet&#34;/&gt;
                &lt;script type=&#34;text/javascript&#34; src=&#34;{{ d3_url }}&#34;&gt;&lt;/script&gt;
                &lt;script type=&#34;text/javascript&#34; src=&#34;{{ c3_script_url }}&#34;&gt;&lt;/script&gt;
                &lt;script type=&#34;text/javascript&#34; src=&#34;{{ events_url }}&#34;&gt;&lt;/script&gt;
                &lt;div id=&#34;chart&#34; class=&#34;chart-container&#34;&gt;&lt;/div&gt;
                &lt;script type=&#34;text/javascript&#34;&gt;

                    document.addEventListener(&#34;DOMContentLoaded&#34;, (event) =&gt; {
                        var data = JSON.parse(&#39;{{data|safe}}&#39;);

                        var aspectRatio = data.aspectRatio || 0.5625; // 16:9 AR

                        var chart = c3.generate(data);
                        var timeout;

                        var c3Resize = () =&gt; {
                            clearTimeout(timeout);
                            timeout = setTimeout( () =&gt; {
                                timeout = null;
                                var width = document.querySelector(&#39;#chart&#39;).offsetWidth;
                                var newHeight = width * aspectRatio;
                                chart.resize({height: newHeight});
                                chart.internal.selectChart.style(&#39;max-height&#39;, &#39;none&#39;);
                            }, 500);

                        }

                        const observer = new ResizeObserver(c3Resize);

                        observer.observe(document.querySelector(&#39;body&#39;));

                        c3Resize();
                    });
                &lt;/script&gt;
            &lt;/body&gt;
        &lt;/html&gt;&#34;&#34;&#34;)
        data = json.dumps(self.chart_data)  # dont use hyphens in data keys
        extra_css = base64.b64decode(self.css64).decode(&#39;utf-8&#39;) if self.css64 else ChartWidget.DEFAULT_CSS  # type: ignore
        context = {
            &#34;c3_styles_url&#34;: presalytics.lib.plugins.external.ApprovedExternalLinks().attr_dict.flatten().get(&#39;c3&#39;),
            &#34;c3_script_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;c3&#39;),
            &#34;d3_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;d3&#39;),
            &#34;events_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;events&#39;),
            &#34;data&#34;: data,
            &#34;css&#34;: extra_css
        }
        return SIMPLE_HTML.render(**context)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.ChartWidget.outline_widget"><code class="name">var <span class="ident">outline_widget</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.ChartWidget.DEFAULT_CSS"><code class="name">var <span class="ident">DEFAULT_CSS</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.ChartWidget.read_file"><code class="name flex">
<span>def <span class="ident">read_file</span></span>(<span>self, filename)</span>
</code></dt>
<dd>
<section class="desc"><p>Find a file named <code>filename</code> and return its base64-ecoded content</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/chart.py#L66-L84" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def read_file(self, filename) -&gt; typing.Optional[str]:
    &#34;&#34;&#34;
    Find a file named `filename` and return its base64-ecoded content
    &#34;&#34;&#34;
    data64 = None
    if filename:
        search_paths = list(set(presalytics.settings.AUTODISCOVER_PATHS))  # type: ignore
        if os.getcwd() not in search_paths:
            search_paths.append(os.getcwd())
        for path in search_paths:
            fpath = os.path.join(path, filename)
            if os.path.exists(fpath):
                with open(fpath, &#39;rb&#39;) as f:
                    data = f.read()
                    data64 = base64.b64encode(data).decode(&#39;utf-8&#39;)  # type: ignore
                break
        if not data64:
            logger.debug(&#34;File {0} could not be found&#34;.format(filename))
    return data64</code></pre>
</details>
</dd>
<dt id="presalytics.ChartWidget.add_bind_to"><code class="name flex">
<span>def <span class="ident">add_bind_to</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/chart.py#L86-L88" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def add_bind_to(self):
    if &#39;bindto&#39; not in self.chart_data.keys():
        self.chart_data[&#39;bindto&#39;] = &#39;#chart&#39;</code></pre>
</details>
</dd>
<dt id="presalytics.ChartWidget.to_html"><code class="name flex">
<span>def <span class="ident">to_html</span></span>(<span>self, data=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Renders the sandboxed iframe with will contain the d3 script widget</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/chart.py#L90-L95" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def to_html(self, data=None, **kwargs) -&gt; str:
    &#34;&#34;&#34;
    Renders the sandboxed iframe with will contain the d3 script widget
    &#34;&#34;&#34;
    html = self.create_container()
    return html</code></pre>
</details>
</dd>
<dt id="presalytics.ChartWidget.create_container"><code class="name flex">
<span>def <span class="ident">create_container</span></span>(<span>self, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Wraps the D3 objects in an endpoint at the story API load via a sandboxed <code>&lt;iframe&gt;</code> that
will be rendered</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/chart.py#L97-L117" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def create_container(self, **kwargs) -&gt; str:
    &#34;&#34;&#34;
    Wraps the D3 objects in an endpoint at the story API load via a sandboxed `&lt;iframe&gt;` that
    will be rendered
    &#34;&#34;&#34;
    story_host = self.get_client(delegate_login=True).story.api_client.external_root_url
    source_url = &#34;{0}/cache/{1}&#34;.format(story_host, self.nonce)
    empty_parent_div = lxml.html.Element(&#34;div&#34;, {
        &#39;class&#39;: &#39;empty-parent bg-light&#39;,
        &#39;style&#39;: &#39;height: 100%; width: 100%, display: block; text-align: left;&#39;
    })
    frame = lxml.html.Element(&#34;iframe&#34;, {
        &#39;src&#39;: source_url,
        &#39;frameborder&#39;: &#34;0&#34;,
        &#39;scrolling&#39;: &#34;auto&#34;,
        &#39;class&#39;: &#39;d3-responsive-frame&#39;,
        &#39;style&#39;: &#39;max-height: none; max-width: none; height:100%; width: 100%;&#39;,
        &#39;sandbox&#39;: &#39;allow-scripts allow-same-origin&#39;
    })
    empty_parent_div.append(frame)
    return lxml.html.tostring(empty_parent_div).decode(&#39;utf-8&#39;)  # type: ignore</code></pre>
</details>
</dd>
<dt id="presalytics.ChartWidget.standalone_html"><code class="name flex">
<span>def <span class="ident">standalone_html</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Returns string with an html document containing that d3 widget</p>
<p>Loaded via the Story API d3 endpoint</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/chart.py#L168-L229" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def standalone_html(self) -&gt; str:
    &#34;&#34;&#34;
    Returns string with an html document containing that d3 widget

    Loaded via the Story API d3 endpoint
    &#34;&#34;&#34;
    SIMPLE_HTML = jinja2.Template(&#34;&#34;&#34;&lt;!DOCTYPE html&gt;
    &lt;html&gt;
        &lt;head&gt;
            &lt;meta charset=&#34;UTF-8&#34;&gt;
            &lt;style&gt;
            {{ css }}
            &lt;/style&gt;
        &lt;/head&gt;
        &lt;body&gt;
            &lt;link href=&#34;{{c3_styles_url}}&#34; rel=&#34;stylesheet&#34;/&gt;
            &lt;script type=&#34;text/javascript&#34; src=&#34;{{ d3_url }}&#34;&gt;&lt;/script&gt;
            &lt;script type=&#34;text/javascript&#34; src=&#34;{{ c3_script_url }}&#34;&gt;&lt;/script&gt;
            &lt;script type=&#34;text/javascript&#34; src=&#34;{{ events_url }}&#34;&gt;&lt;/script&gt;
            &lt;div id=&#34;chart&#34; class=&#34;chart-container&#34;&gt;&lt;/div&gt;
            &lt;script type=&#34;text/javascript&#34;&gt;

                document.addEventListener(&#34;DOMContentLoaded&#34;, (event) =&gt; {
                    var data = JSON.parse(&#39;{{data|safe}}&#39;);

                    var aspectRatio = data.aspectRatio || 0.5625; // 16:9 AR

                    var chart = c3.generate(data);
                    var timeout;

                    var c3Resize = () =&gt; {
                        clearTimeout(timeout);
                        timeout = setTimeout( () =&gt; {
                            timeout = null;
                            var width = document.querySelector(&#39;#chart&#39;).offsetWidth;
                            var newHeight = width * aspectRatio;
                            chart.resize({height: newHeight});
                            chart.internal.selectChart.style(&#39;max-height&#39;, &#39;none&#39;);
                        }, 500);

                    }

                    const observer = new ResizeObserver(c3Resize);

                    observer.observe(document.querySelector(&#39;body&#39;));

                    c3Resize();
                });
            &lt;/script&gt;
        &lt;/body&gt;
    &lt;/html&gt;&#34;&#34;&#34;)
    data = json.dumps(self.chart_data)  # dont use hyphens in data keys
    extra_css = base64.b64decode(self.css64).decode(&#39;utf-8&#39;) if self.css64 else ChartWidget.DEFAULT_CSS  # type: ignore
    context = {
        &#34;c3_styles_url&#34;: presalytics.lib.plugins.external.ApprovedExternalLinks().attr_dict.flatten().get(&#39;c3&#39;),
        &#34;c3_script_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;c3&#39;),
        &#34;d3_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;d3&#39;),
        &#34;events_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;events&#39;),
        &#34;data&#34;: data,
        &#34;css&#34;: extra_css
    }
    return SIMPLE_HTML.render(**context)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.story.components.WidgetBase.create_subdocument" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.create_subdocument">create_subdocument</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.render" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.render">render</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.serialize">serialize</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.DataTableWidget"><code class="flex name class">
<span>class <span class="ident">DataTableWidget</span></span>
<span>(</span><span>name, table_data, css64=None, css_filename=None, *args, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>A <code>Widget</code> for rendering data tables, implemented over the top of bootstrap-table.
For security reasons, data tables are loaded via a sandboxed iframe that points
to an endpoint in the Presalytics Story API.</p>
<p>This class allows users to load <a href="https://bootstrap-table.com">bootstrap-table</a> objects
into widgets in order to create responsive data tables directly off a simple data object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>name</code></strong> :&ensp;<code>str</code></dt>
<dd>the name of widget.
Must be unique within <code><a title="presalytics.COMPONENTS" href="/python-client/presalytics/index.html#presalytics.COMPONENTS">COMPONENTS</a></code></dd>
<dt><strong><code>data</code></strong> :&ensp;<code>dict</code></dt>
<dd>Data that will be loaded into the <code>c3.generate()</code> method.
Please go
to <a href="https://c3js.org/gettingstarted.html">c3js.org</a> for more information
on how to configure this object.</dd>
<dt><strong><code>css64</code></strong> :&ensp;<code>str. optional</code></dt>
<dd>A base64-encoded string of the css styles to apply to the d3 document.
Used for server-to-server
transport over https.</dd>
<dt><strong><code>css_filename</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>
<p>A css file containing styles that will be applied to d3</p>
<p>Note: Styles <code>html {width: 100%; height:100%;} body {width: 100%; height: 100%; margin: 0px;}</code>
are applied by default if not css is provided</p>
</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/data_table.py#L21-L214" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class DataTableWidget(presalytics.story.components.WidgetBase):
    &#34;&#34;&#34;
    A `Widget` for rendering data tables, implemented over the top of bootstrap-table.
    For security reasons, data tables are loaded via a sandboxed iframe that points
    to an endpoint in the Presalytics Story API.

    This class allows users to load [bootstrap-table](https://bootstrap-table.com) objects
    into widgets in order to create responsive data tables directly off a simple data object.

    Parameters
    ----------

    name : str
        the name of widget.  Must be unique within `presalytics.COMPONENTS`

    data: dict
        Data that will be loaded into the `c3.generate()` method.  Please go
        to [c3js.org](https://c3js.org/gettingstarted.html) for more information
        on how to configure this object.

    css64 : str. optional
        A base64-encoded string of the css styles to apply to the d3 document.  Used for server-to-server
        transport over https.

    css_filename: str, optional
        A css file containing styles that will be applied to d3

        Note: Styles `html {width: 100%; height:100%;} body {width: 100%; height: 100%; margin: 0px;}`
        are applied by default if not css is provided

    &#34;&#34;&#34;
    __component_kind__ = &#39;data-table&#39;

    def __init__(self,
                 name: str,
                 table_data: typing.Dict,
                 css64: str = None,
                 css_filename: str = None,
                 *args,
                 **kwargs):
        self.table_data = table_data
        super(DataTableWidget, self).__init__(name, *args, **kwargs)
        self.css64 = self.read_file(css_filename)
        self.css64 = self.css64 if self.css64 else css64
        self.css_filename = css_filename

    def read_file(self, filename) -&gt; typing.Optional[str]:
        &#34;&#34;&#34;
        Find a file named `filename` and return its base64-ecoded content
        &#34;&#34;&#34;
        data64 = None
        if filename:
            search_paths = list(set(presalytics.settings.AUTODISCOVER_PATHS))
            if os.getcwd() not in search_paths:
                search_paths.append(os.getcwd())
            for path in search_paths:
                fpath = os.path.join(path, filename)
                if os.path.exists(fpath):
                    with open(fpath, &#39;rb&#39;) as f:
                        data = f.read()
                        data64 = base64.b64encode(data).decode(&#39;utf-8&#39;)  # type: ignore
                    break
            if not data64:
                logger.debug(&#34;File {0} could not be found&#34;.format(filename))
        return data64

    def to_html(self, data=None, **kwargs) -&gt; str:
        &#34;&#34;&#34;
        Renders the sandboxed iframe with will contain the d3 script widget
        &#34;&#34;&#34;
        html = self.create_container()
        return html

    def create_container(self, **kwargs):
        &#34;&#34;&#34;
        Wraps the D3 objects in an endpoint at the story API load via a sandboxed `&lt;iframe&gt;` that
        will be rendered
        &#34;&#34;&#34;
        story_host = self.get_client(delegate_login=True).story.api_client.external_root_url
        source_url = &#34;{0}/cache/{1}&#34;.format(story_host, self.nonce)
        empty_parent_div = lxml.html.Element(&#34;div&#34;, {
            &#39;class&#39;: &#39;empty-parent bg-light&#39;,
            &#39;style&#39;: &#39;height: 100%; width: 100%, display: block; text-align: left;&#39;
        })
        frame = lxml.html.Element(&#34;iframe&#34;, {
            &#39;src&#39;: source_url,
            &#39;frameborder&#39;: &#34;0&#34;,
            &#39;scrolling&#39;: &#34;auto&#34;,
            &#39;class&#39;: &#39;d3-responsive-frame&#39;,
            &#39;style&#39;: &#39;max-height: none; max-width: none; height:100%; width: 100%;&#39;,
            &#39;sandbox&#39;: &#39;allow-scripts allow-same-origin&#39;
        })
        empty_parent_div.append(frame)
        return lxml.html.tostring(empty_parent_div).decode(&#39;utf-8&#39;)

    @classmethod
    def deserialize(cls, outline, **kwargs):
        table_data = outline.data.get(&#34;table_data&#34;)
        return cls(outline.name,
                   id=outline.id,
                   table_data=table_data,
                   **kwargs)

    def serialize(self, **kwargs):
        data = {
            &#39;table_data&#39;: self.table_data,
        }
        return presalytics.story.outline.Widget(
            name=self.name,
            kind=self.__component_kind__,
            id=self.id,
            data=data,
        )

    DEFAULT_CSS = &#34;&#34;&#34;
    html {
        height: 100%;
        width: 100%;
    }
    body {
        height: 100%;
        width: 100%;
        margin: 0px;
        background-color: #f8f9fa !important;
    }

    .data-table-container {
        border: none !important;
        display: table;
        width: 100%;
    }

    .data-table-container tbody {
        background-color: #fff;
    }

    .data-table-container thead {
        background-color: #199ec7;
        color: white;
    }


    &#34;&#34;&#34;

    def create_subdocument(self, **kwargs):
        return self.standalone_html()

    def standalone_html(self) -&gt; str:
        &#34;&#34;&#34;
        Returns string with an html document containing that d3 widget

        Loaded via the Story API d3 endpoint
        &#34;&#34;&#34;
        SIMPLE_HTML = jinja2.Template(&#34;&#34;&#34;&lt;!DOCTYPE html&gt;
        &lt;html&gt;
            &lt;head&gt;
                &lt;meta charset=&#34;UTF-8&#34;&gt;
                &lt;style&gt;
                {{ css }}
                &lt;/style&gt;
            &lt;/head&gt;
            &lt;body&gt;
                &lt;link href=&#34;{{bootstrap4_css_url}}&#34; rel=&#34;stylesheet&#34;/&gt;
                &lt;link href=&#34;{{font_awesome_url}}&#34; rel=&#34;stylesheet&#34;/&gt;
                &lt;link href=&#34;{{bootstrap_table_css_url}}&#34; rel=&#34;stylesheet&#34;/&gt;
                &lt;script type=&#34;text/javascript&#34; src=&#34;{{ events_url }}&#34;&gt;&lt;/script&gt;
                &lt;div id=&#34;table&#34; class=&#34;data-table-container&#34;&gt;&lt;/div&gt;
                &lt;script type=&#34;text/javascript&#34; src=&#34;{{ jquery_url }}&#34;&gt;&lt;/script&gt;
                &lt;script type=&#34;text/javascript&#34; src=&#34;{{ popper_url }}&#34;&gt;&lt;/script&gt;
                &lt;script type=&#34;text/javascript&#34; src=&#34;{{ bootstrap4_js_url }}&#34;&gt;&lt;/script&gt;
                &lt;script type=&#34;text/javascript&#34; src=&#34;{{ boostrap_table_js_url }}&#34;&gt;&lt;/script&gt;
                &lt;script type=&#34;text/javascript&#34;&gt;
                    $(document).ready(function() {
                        var data = JSON.parse(&#39;{{data|safe}}&#39;);
                        $(&#34;#table&#34;).bootstrapTable(data);
                    });
                &lt;/script&gt;
            &lt;/body&gt;
        &lt;/html&gt;&#34;&#34;&#34;)
        data = json.dumps(self.table_data, cls=presalytics.story.outline.OutlineEncoder)  # dont use hyphens in data keys
        extra_css = base64.b64decode(self.css64).decode(&#39;utf-8&#39;) if self.css64 else DataTableWidget.DEFAULT_CSS  # type: ignore
        context = {
            &#34;bootstrap4_css_url&#34;: presalytics.lib.plugins.external.ApprovedExternalLinks().attr_dict.flatten().get(&#39;bootstrap4&#39;),
            &#34;font_awesome_url&#34;: presalytics.lib.plugins.external.ApprovedExternalLinks().attr_dict.flatten().get(&#39;font-awesome&#39;),
            &#34;bootstrap_table_css_url&#34;: presalytics.lib.plugins.external.ApprovedExternalLinks().attr_dict.flatten().get(&#39;bootstrap-table&#39;),
            &#34;jquery_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;jquery&#39;),
            &#34;popper_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;popper&#39;),
            &#34;boostrap_table_js_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;bootstrap-table&#39;),
            &#34;d3_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;d3&#39;),
            &#34;events_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;events&#39;),
            &#34;data&#34;: data,
            &#34;css&#34;: extra_css
        }
        return SIMPLE_HTML.render(**context)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.DataTableWidget.outline_widget"><code class="name">var <span class="ident">outline_widget</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.DataTableWidget.DEFAULT_CSS"><code class="name">var <span class="ident">DEFAULT_CSS</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.DataTableWidget.read_file"><code class="name flex">
<span>def <span class="ident">read_file</span></span>(<span>self, filename)</span>
</code></dt>
<dd>
<section class="desc"><p>Find a file named <code>filename</code> and return its base64-ecoded content</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/data_table.py#L67-L85" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def read_file(self, filename) -&gt; typing.Optional[str]:
    &#34;&#34;&#34;
    Find a file named `filename` and return its base64-ecoded content
    &#34;&#34;&#34;
    data64 = None
    if filename:
        search_paths = list(set(presalytics.settings.AUTODISCOVER_PATHS))
        if os.getcwd() not in search_paths:
            search_paths.append(os.getcwd())
        for path in search_paths:
            fpath = os.path.join(path, filename)
            if os.path.exists(fpath):
                with open(fpath, &#39;rb&#39;) as f:
                    data = f.read()
                    data64 = base64.b64encode(data).decode(&#39;utf-8&#39;)  # type: ignore
                break
        if not data64:
            logger.debug(&#34;File {0} could not be found&#34;.format(filename))
    return data64</code></pre>
</details>
</dd>
<dt id="presalytics.DataTableWidget.to_html"><code class="name flex">
<span>def <span class="ident">to_html</span></span>(<span>self, data=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Renders the sandboxed iframe with will contain the d3 script widget</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/data_table.py#L87-L92" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def to_html(self, data=None, **kwargs) -&gt; str:
    &#34;&#34;&#34;
    Renders the sandboxed iframe with will contain the d3 script widget
    &#34;&#34;&#34;
    html = self.create_container()
    return html</code></pre>
</details>
</dd>
<dt id="presalytics.DataTableWidget.create_container"><code class="name flex">
<span>def <span class="ident">create_container</span></span>(<span>self, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Wraps the D3 objects in an endpoint at the story API load via a sandboxed <code>&lt;iframe&gt;</code> that
will be rendered</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/data_table.py#L94-L114" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def create_container(self, **kwargs):
    &#34;&#34;&#34;
    Wraps the D3 objects in an endpoint at the story API load via a sandboxed `&lt;iframe&gt;` that
    will be rendered
    &#34;&#34;&#34;
    story_host = self.get_client(delegate_login=True).story.api_client.external_root_url
    source_url = &#34;{0}/cache/{1}&#34;.format(story_host, self.nonce)
    empty_parent_div = lxml.html.Element(&#34;div&#34;, {
        &#39;class&#39;: &#39;empty-parent bg-light&#39;,
        &#39;style&#39;: &#39;height: 100%; width: 100%, display: block; text-align: left;&#39;
    })
    frame = lxml.html.Element(&#34;iframe&#34;, {
        &#39;src&#39;: source_url,
        &#39;frameborder&#39;: &#34;0&#34;,
        &#39;scrolling&#39;: &#34;auto&#34;,
        &#39;class&#39;: &#39;d3-responsive-frame&#39;,
        &#39;style&#39;: &#39;max-height: none; max-width: none; height:100%; width: 100%;&#39;,
        &#39;sandbox&#39;: &#39;allow-scripts allow-same-origin&#39;
    })
    empty_parent_div.append(frame)
    return lxml.html.tostring(empty_parent_div).decode(&#39;utf-8&#39;)</code></pre>
</details>
</dd>
<dt id="presalytics.DataTableWidget.standalone_html"><code class="name flex">
<span>def <span class="ident">standalone_html</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Returns string with an html document containing that d3 widget</p>
<p>Loaded via the Story API d3 endpoint</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/data_table.py#L168-L214" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def standalone_html(self) -&gt; str:
    &#34;&#34;&#34;
    Returns string with an html document containing that d3 widget

    Loaded via the Story API d3 endpoint
    &#34;&#34;&#34;
    SIMPLE_HTML = jinja2.Template(&#34;&#34;&#34;&lt;!DOCTYPE html&gt;
    &lt;html&gt;
        &lt;head&gt;
            &lt;meta charset=&#34;UTF-8&#34;&gt;
            &lt;style&gt;
            {{ css }}
            &lt;/style&gt;
        &lt;/head&gt;
        &lt;body&gt;
            &lt;link href=&#34;{{bootstrap4_css_url}}&#34; rel=&#34;stylesheet&#34;/&gt;
            &lt;link href=&#34;{{font_awesome_url}}&#34; rel=&#34;stylesheet&#34;/&gt;
            &lt;link href=&#34;{{bootstrap_table_css_url}}&#34; rel=&#34;stylesheet&#34;/&gt;
            &lt;script type=&#34;text/javascript&#34; src=&#34;{{ events_url }}&#34;&gt;&lt;/script&gt;
            &lt;div id=&#34;table&#34; class=&#34;data-table-container&#34;&gt;&lt;/div&gt;
            &lt;script type=&#34;text/javascript&#34; src=&#34;{{ jquery_url }}&#34;&gt;&lt;/script&gt;
            &lt;script type=&#34;text/javascript&#34; src=&#34;{{ popper_url }}&#34;&gt;&lt;/script&gt;
            &lt;script type=&#34;text/javascript&#34; src=&#34;{{ bootstrap4_js_url }}&#34;&gt;&lt;/script&gt;
            &lt;script type=&#34;text/javascript&#34; src=&#34;{{ boostrap_table_js_url }}&#34;&gt;&lt;/script&gt;
            &lt;script type=&#34;text/javascript&#34;&gt;
                $(document).ready(function() {
                    var data = JSON.parse(&#39;{{data|safe}}&#39;);
                    $(&#34;#table&#34;).bootstrapTable(data);
                });
            &lt;/script&gt;
        &lt;/body&gt;
    &lt;/html&gt;&#34;&#34;&#34;)
    data = json.dumps(self.table_data, cls=presalytics.story.outline.OutlineEncoder)  # dont use hyphens in data keys
    extra_css = base64.b64decode(self.css64).decode(&#39;utf-8&#39;) if self.css64 else DataTableWidget.DEFAULT_CSS  # type: ignore
    context = {
        &#34;bootstrap4_css_url&#34;: presalytics.lib.plugins.external.ApprovedExternalLinks().attr_dict.flatten().get(&#39;bootstrap4&#39;),
        &#34;font_awesome_url&#34;: presalytics.lib.plugins.external.ApprovedExternalLinks().attr_dict.flatten().get(&#39;font-awesome&#39;),
        &#34;bootstrap_table_css_url&#34;: presalytics.lib.plugins.external.ApprovedExternalLinks().attr_dict.flatten().get(&#39;bootstrap-table&#39;),
        &#34;jquery_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;jquery&#39;),
        &#34;popper_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;popper&#39;),
        &#34;boostrap_table_js_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;bootstrap-table&#39;),
        &#34;d3_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;d3&#39;),
        &#34;events_url&#34;: presalytics.lib.plugins.external.ApprovedExternalScripts().attr_dict.flatten().get(&#39;events&#39;),
        &#34;data&#34;: data,
        &#34;css&#34;: extra_css
    }
    return SIMPLE_HTML.render(**context)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.story.components.WidgetBase.create_subdocument" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.create_subdocument">create_subdocument</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.render" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.render">render</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.serialize">serialize</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.UrlWidget"><code class="flex name class">
<span>class <span class="ident">UrlWidget</span></span>
<span>(</span><span>name, url, *args, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>A <code>Widget</code> for rendering urls in an iframe.
Allows users
load 3rd party site and applications natively within a presalytics
story.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>name</code></strong> :&ensp;<code>str</code></dt>
<dd>the name of widget.
Must be unique within <code><a title="presalytics.COMPONENTS" href="/python-client/presalytics/index.html#presalytics.COMPONENTS">COMPONENTS</a></code></dd>
<dt><strong><code>url</code></strong> :&ensp;<code>str</code></dt>
<dd>The url to be loaded in the <code>&lt;iframe&gt;</code>.
For secutriy reasons, it must be https.</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/url.py#L21-L100" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class UrlWidget(presalytics.story.components.WidgetBase):
    &#34;&#34;&#34;
    A `Widget` for rendering urls in an iframe.  Allows users
    load 3rd party site and applications natively within a presalytics
    story.

    Parameters
    ----------

    name : str
        the name of widget.  Must be unique within `presalytics.COMPONENTS`

    url: str
        The url to be loaded in the `&lt;iframe&gt;`.  For secutriy reasons, it must be https.

    &#34;&#34;&#34;
    __component_kind__ = &#39;url&#39;

    def __init__(self,
                 name: str,
                 url: str,
                 *args,
                 **kwargs):
        self.url = url
        super(UrlWidget, self).__init__(name, *args, **kwargs)

    def to_html(self, data=None, **kwargs) -&gt; str:
        &#34;&#34;&#34;
        Renders url to a sandboxed iframe
        &#34;&#34;&#34;
        return self.create_container()

    def create_container(self, **kwargs):
        &#34;&#34;&#34;
        Wraps the D3 objects in an endpoint at the story API load via a sandboxed `&lt;iframe&gt;` that
        will be rendered
        &#34;&#34;&#34;

        empty_parent_div = lxml.html.Element(&#34;div&#34;, {
            &#39;class&#39;: &#39;empty-parent bg-light&#39;,
            &#39;style&#39;: &#39;height: 100%; width: 100%, display: block; text-align: left;&#39;
        })
        frame = lxml.html.Element(&#34;iframe&#34;, {
            &#39;src&#39;: self.url,
            &#39;frameborder&#39;: &#34;0&#34;,
            &#39;scrolling&#39;: &#34;auto&#34;,
            &#39;class&#39;: &#39;d3-responsive-frame&#39;,
            &#39;style&#39;: &#39;max-height: none; max-width: none; height:100%; width: 100%;&#39;,
            &#39;sandbox&#39;: &#39;allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox&#39;
        })
        empty_parent_div.append(frame)
        return lxml.html.tostring(empty_parent_div).decode(&#39;utf-8&#39;)

    @classmethod
    def deserialize(cls, outline, **kwargs):
        return cls(outline.name,
                   outline.data.get(&#39;url&#39;),
                   **kwargs)

    def serialize(self, **kwargs):
        data = {
            &#39;url&#39;: self.url
        }
        return presalytics.story.outline.Widget(
            name=self.name,
            kind=self.__component_kind__,
            data=data,
        )

    DEFAULT_CSS = &#34;&#34;&#34;
    html {
        height: 100%;
        width: 100%;
    }
    body {
        height: 100%;
        width: 100%;
        margin: 0px;
    }
    &#34;&#34;&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.UrlWidget.outline_widget"><code class="name">var <span class="ident">outline_widget</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.UrlWidget.DEFAULT_CSS"><code class="name">var <span class="ident">DEFAULT_CSS</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.UrlWidget.to_html"><code class="name flex">
<span>def <span class="ident">to_html</span></span>(<span>self, data=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Renders url to a sandboxed iframe</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/url.py#L47-L51" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def to_html(self, data=None, **kwargs) -&gt; str:
    &#34;&#34;&#34;
    Renders url to a sandboxed iframe
    &#34;&#34;&#34;
    return self.create_container()</code></pre>
</details>
</dd>
<dt id="presalytics.UrlWidget.create_container"><code class="name flex">
<span>def <span class="ident">create_container</span></span>(<span>self, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Wraps the D3 objects in an endpoint at the story API load via a sandboxed <code>&lt;iframe&gt;</code> that
will be rendered</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/url.py#L53-L72" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def create_container(self, **kwargs):
    &#34;&#34;&#34;
    Wraps the D3 objects in an endpoint at the story API load via a sandboxed `&lt;iframe&gt;` that
    will be rendered
    &#34;&#34;&#34;

    empty_parent_div = lxml.html.Element(&#34;div&#34;, {
        &#39;class&#39;: &#39;empty-parent bg-light&#39;,
        &#39;style&#39;: &#39;height: 100%; width: 100%, display: block; text-align: left;&#39;
    })
    frame = lxml.html.Element(&#34;iframe&#34;, {
        &#39;src&#39;: self.url,
        &#39;frameborder&#39;: &#34;0&#34;,
        &#39;scrolling&#39;: &#34;auto&#34;,
        &#39;class&#39;: &#39;d3-responsive-frame&#39;,
        &#39;style&#39;: &#39;max-height: none; max-width: none; height:100%; width: 100%;&#39;,
        &#39;sandbox&#39;: &#39;allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox&#39;
    })
    empty_parent_div.append(frame)
    return lxml.html.tostring(empty_parent_div).decode(&#39;utf-8&#39;)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.story.components.WidgetBase.create_subdocument" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.create_subdocument">create_subdocument</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.render" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.render">render</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.serialize">serialize</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.ChartUpdaterWidget"><code class="flex name class">
<span>class <span class="ident">ChartUpdaterWidget</span></span>
<span>(</span><span>name, story_id, chart_id, dto=None, data_table=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Updates a Chart in the Ooxml Automation service API at the the endpoint '/Chart/ChartUpdate/'</p>
<p>This class simplifies chart updates, for charts residing in the Ooxml Automation Service,
allowing updates to ooxml object data and its underlying xml either via a list of lists or
the <code><a title="presalytics.client.ooxml_automation.models.chart_chart_data_dto.ChartChartDataDTO" href="/python-client/presalytics/client/ooxml_automation/models/chart_chart_data_dto.html#presalytics.client.ooxml_automation.models.chart_chart_data_dto.ChartChartDataDTO">ChartChartDataDTO</a></code>
object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>name</code></strong> :&ensp;<code>str</code></dt>
<dd>A name for the widget.</dd>
<dt><strong><code>story_id</code></strong> :&ensp;<code>str</code></dt>
<dd>The the id of the story in the Presalytics API Story service.</dd>
<dt><strong><code>chart_id</code></strong> :&ensp;<code>str</code></dt>
<dd>The identifier of the Ooxml Automation Chart service object.</dd>
<dt><strong><code>dto</code></strong> :&ensp;<code><a title="presalytics.client.ooxml_automation.models.chart_chart_data_dto.ChartChartDataDTO" href="/python-client/presalytics/client/ooxml_automation/models/chart_chart_data_dto.html#presalytics.client.ooxml_automation.models.chart_chart_data_dto.ChartChartDataDTO">ChartChartDataDTO</a></code>, optional</dt>
<dd>A an instance of the data transfer object model. The class of this object is defined by the
<code>_get_dto_class()</code> method.
Represents the current state of the data of the data in the service.</dd>
<dt><strong><code>data_table</code></strong> :&ensp;<code>list</code> of <code>lists</code>, optional</dt>
<dd>A representation of a data table that will be incorporates into a dto object's property defined by
the subclass' <code>_get_dto_table_name</code> method.</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L762-L834" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class ChartUpdaterWidget(UpdaterWidgetBase):
    &#34;&#34;&#34;
    Updates a Chart in the Ooxml Automation service API at the the endpoint &#39;/Chart/ChartUpdate/&#39;

    This class simplifies chart updates, for charts residing in the Ooxml Automation Service,
    allowing updates to ooxml object data and its underlying xml either via a list of lists or
    the `presalytics.client.ooxml_automation.models.chart_chart_data_dto.ChartChartDataDTO`
    object.

    Parameters
    ----------
    name : str
        A name for the widget.

    story_id : str
        The the id of the story in the Presalytics API Story service.

    chart_id : str
        The identifier of the Ooxml Automation Chart service object.

    dto: presalytics.client.ooxml_automation.models.chart_chart_data_dto.ChartChartDataDTO, optional
        A an instance of the data transfer object model. The class of this object is defined by the
        `_get_dto_class()` method.  Represents the current state of the data of the data in the service.

    data_table: list of lists, optional
        A representation of a data table that will be incorporates into a dto object&#39;s property defined by
        the subclass&#39; `_get_dto_table_name` method.

    &#34;&#34;&#34;
    __component_kind__ = &#34;chart-updater&#34;

    def __init__(self,
                 name,
                 story_id: str,
                 chart_id: str,
                 dto: &#39;ChartChartDataDTO&#39; = None,
                 data_table: typing.Sequence[typing.Sequence] = None,
                 **kwargs):
        super().__init__(name, story_id, chart_id, OoxmlEndpointMap.chart(), dto=dto, data_table=data_table, **kwargs)
        self.chart_id = chart_id

    def _get_dto_class(self):
        return presalytics.client.ooxml_automation.models.chart_chart_data_dto.ChartChartDataDTO

    def _get_endpoint_path(self):
        return &#34;ChartUpdate&#34;

    def _get_dto_table_name(self):
        return &#34;data_points&#34;

    def get_dataframe(self) -&gt; pandas.DataFrame:
        &#34;&#34;&#34;
        Returns a panda datagrame of the
        &#34;&#34;&#34;
        data: collections.OrderedDict

        if not self.dto:
            self.dto = self.get_dto()
        data = collections.OrderedDict()
        for i in range(0, len(self.dto.series_names)):
            data.update({
                self.dto.series_names[i]: pandas.Series(self.dto.data_points[i], self.dto.category_names)
            })
        return pandas.DataFrame(data)

    def put_dataframe(self, df: pandas.DataFrame):
        data_dict = df.to_dict(&#39;split&#39;)
        data_points = list(map(list, zip(*data_dict[&#39;data&#39;])))
        dto = self._get_dto_class()(chart_id=self.chart_id,
                                    series_names=data_dict[&#34;columns&#34;],
                                    category_names=data_dict[&#34;index&#34;],
                                    data_points=data_points)
        self._put_dto(dto)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase">UpdaterWidgetBase</a></li>
<li><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase">OoxmlWidgetBase</a></li>
<li><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.ChartUpdaterWidget.endpoint_map"><code class="name">var <span class="ident">endpoint_map</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.ChartUpdaterWidget.data"><code class="name">var <span class="ident">data</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.ChartUpdaterWidget.get_dataframe"><code class="name flex">
<span>def <span class="ident">get_dataframe</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Returns a panda datagrame of the</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L812-L825" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_dataframe(self) -&gt; pandas.DataFrame:
    &#34;&#34;&#34;
    Returns a panda datagrame of the
    &#34;&#34;&#34;
    data: collections.OrderedDict

    if not self.dto:
        self.dto = self.get_dto()
    data = collections.OrderedDict()
    for i in range(0, len(self.dto.series_names)):
        data.update({
            self.dto.series_names[i]: pandas.Series(self.dto.data_points[i], self.dto.category_names)
        })
    return pandas.DataFrame(data)</code></pre>
</details>
</dd>
<dt id="presalytics.ChartUpdaterWidget.put_dataframe"><code class="name flex">
<span>def <span class="ident">put_dataframe</span></span>(<span>self, df)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L827-L834" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def put_dataframe(self, df: pandas.DataFrame):
    data_dict = df.to_dict(&#39;split&#39;)
    data_points = list(map(list, zip(*data_dict[&#39;data&#39;])))
    dto = self._get_dto_class()(chart_id=self.chart_id,
                                series_names=data_dict[&#34;columns&#34;],
                                category_names=data_dict[&#34;index&#34;],
                                data_points=data_points)
    self._put_dto(dto)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase">UpdaterWidgetBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.build_endpoint" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase.build_endpoint">build_endpoint</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.create_container" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.create_container">create_container</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.create_subdocument" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.create_subdocument">create_subdocument</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.get_dto" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase.get_dto">get_dto</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.get_svg" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg">get_svg</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.get_svg_file" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg_file">get_svg_file</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.render" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.render">render</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.serialize">serialize</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.to_html" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.to_html">to_html</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.update_from_data_table" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase.update_from_data_table">update_from_data_table</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.update_from_dto" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase.update_from_dto">update_from_dto</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.TableUpdaterWidget"><code class="flex name class">
<span>class <span class="ident">TableUpdaterWidget</span></span>
<span>(</span><span>name, story_id, table_id, dto=None, data_table=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Updates a Table in the Ooxml Automation service API at the the endpoint '/Table/TableUpdate/'</p>
<p>This class simplifies table updates, for tables residing in the Ooxml Automation Service,
allowing updates to ooxml object data and its underlying xml either via a list of lists or
the <code><a title="presalytics.client.ooxml_automation.models.table_table_data_dto.TableTableDataDTO" href="/python-client/presalytics/client/ooxml_automation/models/table_table_data_dto.html#presalytics.client.ooxml_automation.models.table_table_data_dto.TableTableDataDTO">TableTableDataDTO</a></code>
object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>name</code></strong> :&ensp;<code>str</code></dt>
<dd>A name for the widget.</dd>
<dt><strong><code>story_id</code></strong> :&ensp;<code>str</code></dt>
<dd>The the id of the story in the Presalytics API Story service.</dd>
<dt><strong><code>table_id</code></strong> :&ensp;<code>str</code></dt>
<dd>The identifier of the Ooxml Automation Table service object.</dd>
<dt><strong><code>dto</code></strong> :&ensp;<code><a title="presalytics.client.ooxml_automation.models.table_table_data_dto.TableTableDataDTO" href="/python-client/presalytics/client/ooxml_automation/models/table_table_data_dto.html#presalytics.client.ooxml_automation.models.table_table_data_dto.TableTableDataDTO">TableTableDataDTO</a></code>, optional</dt>
<dd>A an instance of the data transfer object model. The class of this object is defined by the
<code>_get_dto_class()</code> method.
Represents the current state of the data of the data in the service.</dd>
<dt><strong><code>data_table</code></strong> :&ensp;<code>list</code> of <code>lists</code>, optional</dt>
<dd>A representation of a data table that will be incorporates into a dto object's property defined by
the subclass' <code>_get_dto_table_name</code> method.</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L837-L885" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class TableUpdaterWidget(UpdaterWidgetBase):
    &#34;&#34;&#34;
    Updates a Table in the Ooxml Automation service API at the the endpoint &#39;/Table/TableUpdate/&#39;

    This class simplifies table updates, for tables residing in the Ooxml Automation Service,
    allowing updates to ooxml object data and its underlying xml either via a list of lists or
    the `presalytics.client.ooxml_automation.models.table_table_data_dto.TableTableDataDTO`
    object.

    Parameters
    ----------
    name : str
        A name for the widget.

    story_id : str
        The the id of the story in the Presalytics API Story service.

    table_id : str
        The identifier of the Ooxml Automation Table service object.

    dto: presalytics.client.ooxml_automation.models.table_table_data_dto.TableTableDataDTO, optional
        A an instance of the data transfer object model. The class of this object is defined by the
        `_get_dto_class()` method.  Represents the current state of the data of the data in the service.

    data_table: list of lists, optional
        A representation of a data table that will be incorporates into a dto object&#39;s property defined by
        the subclass&#39; `_get_dto_table_name` method.

    &#34;&#34;&#34;
    __component_kind__ = &#34;table-updater&#34;

    def __init__(self,
                 name,
                 story_id: str,
                 table_id: str,
                 dto: &#39;TableTableDataDTO&#39; = None,
                 data_table: typing.Sequence[typing.Sequence] = None,
                 **kwargs):
        super().__init__(name, story_id, table_id, OoxmlEndpointMap.table(), dto=dto, data_table=data_table, **kwargs)
        self.table_id = table_id

    def _get_dto_class(self):
        return presalytics.client.ooxml_automation.models.table_table_data_dto.TableTableDataDTO

    def _get_endpoint_path(self):
        return &#34;TableUpdate&#34;

    def _get_dto_table_name(self):
        return &#34;table_data&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase">UpdaterWidgetBase</a></li>
<li><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase">OoxmlWidgetBase</a></li>
<li><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.TableUpdaterWidget.endpoint_map"><code class="name">var <span class="ident">endpoint_map</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.TableUpdaterWidget.data"><code class="name">var <span class="ident">data</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase">UpdaterWidgetBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.build_endpoint" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase.build_endpoint">build_endpoint</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.create_container" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.create_container">create_container</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.create_subdocument" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.create_subdocument">create_subdocument</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.get_dto" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase.get_dto">get_dto</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.get_svg" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg">get_svg</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.get_svg_file" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg_file">get_svg_file</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.render" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.render">render</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.serialize">serialize</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.to_html" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.to_html">to_html</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.update_from_data_table" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase.update_from_data_table">update_from_data_table</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.update_from_dto" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase.update_from_dto">update_from_dto</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.BootstrapCustomTemplate"><code class="flex name class">
<span>class <span class="ident">BootstrapCustomTemplate</span></span>
<span>(</span><span>page, name=None, template_file=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Build customer repsonsive tempaltes using bootstrap to layout widgets</p>
<p>The <code><a title="presalytics.story.outline.Page" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.Page">Page</a></code> must contain an entry named "template_file" in the its data dictionary.
The values of the "template_file" varialble must a file path to an html file in the
current working directory</p>
<h2 id="parameters">Parameters:</h2>
<p>name: str
the page instance name</p>
<p>page: presalytics.story.outline.Page
A story outline page object to create the widget from</p>
<p>template_file: str
A local file path to an html file that wil be used as a template for rendering the page.
The file path is relative to the current working directory.</p>
<p>kwargs: dict, optional
**kwargs can include parameters to pass to the template rendering context. For example,
when kwargs is passed <code>title="An Example Title"</code>, during rendering, the template's
<code>{{title}}</code> place holder will be replaced with with <code>An Example Title</code></p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/templates/base.py#L262-L344" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class BootstrapCustomTemplate(JinjaTemplateBuilder):
    &#34;&#34;&#34;
    Build customer repsonsive tempaltes using bootstrap to layout widgets

    The `presalytics.story.outline.Page` must contain an entry named &#34;template_file&#34; in the its data dictionary.
    The values of the &#34;template_file&#34; varialble must a file path to an html file in the
    current working directory

    Parameters:
    ----------
    name: str
        the page instance name

    page: presalytics.story.outline.Page
        A story outline page object to create the widget from

    template_file: str
        A local file path to an html file that wil be used as a template for rendering the page.
        The file path is relative to the current working directory.

    kwargs: dict, optional
        **kwargs can include parameters to pass to the template rendering context. For example,
        when kwargs is passed `title=&#34;An Example Title&#34;`, during rendering, the template&#39;s
         `{{title}}` place holder will be replaced with with `An Example Title`

    &#34;&#34;&#34;
    template_file: str

    __component_kind__ = &#34;bootstrap-custom&#34;

    __plugins__ = [
        {
            &#39;name&#39;: &#39;external_scripts&#39;,
            &#39;kind&#39;: &#39;script&#39;,
            &#39;config&#39;: {
                &#39;approved_scripts_key&#39;: &#39;jquery&#39;
            }
        },
        {
            &#39;name&#39;: &#39;external_scripts&#39;,
            &#39;kind&#39;: &#39;script&#39;,
            &#39;config&#39;: {
                &#39;approved_scripts_key&#39;: &#39;popper&#39;
            }
        },
        {
            &#39;name&#39;: &#39;external_scripts&#39;,
            &#39;kind&#39;: &#39;script&#39;,
            &#39;config&#39;: {
                &#39;approved_scripts_key&#39;: &#39;bootstrap4&#39;
            }
        },
        {
            &#39;name&#39;: &#39;external_links&#39;,
            &#39;kind&#39;: &#39;style&#39;,
            &#39;config&#39;: {
                &#39;approved_styles_key&#39;: &#39;bootstrap4&#39;
            }
        },
    ]

    def __init__(self, page: &#39;Page&#39;, name=None, template_file=None, **kwargs) -&gt; None:
        try:
            self.template_file = template_file
            if not self.template_file:
                self.template_file = page.additional_properties[&#34;template_file&#34;]
        except (KeyError, AttributeError):
            raise presalytics.lib.exceptions.InvalidConfigurationError(message=&#34;BootstrapCustomTemplate requires a &#39;template_file&#39; passed either via &#39;additional_properties` or a keyword argument&#34;)
        super(BootstrapCustomTemplate, self).__init__(page, **kwargs)
        self.outline_page.additional_properties[&#34;template_file&#34;] = self.template_file
        self.name = name
        if not self.name:
            self.name = page.name
        self.outline_page.name = self.name
        self.outline_page.kind = self.__component_kind__

    def get_template_name(self):
        return self.template_file

    def serialize(self):
        if self.template_string:
            self.outline_page.additional_properties[&#34;template_string&#34;] = self.template_string
        return self.outline_page</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.templates.base.JinjaTemplateBuilder" href="/python-client/presalytics/lib/templates/base.html#presalytics.lib.templates.base.JinjaTemplateBuilder">JinjaTemplateBuilder</a></li>
<li><a title="presalytics.story.components.PageTemplateBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.PageTemplateBase">PageTemplateBase</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.BootstrapCustomTemplate.template_file"><code class="name">var <span class="ident">template_file</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.templates.base.JinjaTemplateBuilder" href="/python-client/presalytics/lib/templates/base.html#presalytics.lib.templates.base.JinjaTemplateBuilder">JinjaTemplateBuilder</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.templates.base.JinjaTemplateBuilder.WidgetIndexer" href="/python-client/presalytics/lib/templates/base.html#presalytics.lib.templates.base.JinjaTemplateBuilder.WidgetIndexer">WidgetIndexer</a></code></li>
<li><code><a title="presalytics.lib.templates.base.JinjaTemplateBuilder.check_for_file" href="/python-client/presalytics/lib/templates/base.html#presalytics.lib.templates.base.JinjaTemplateBuilder.check_for_file">check_for_file</a></code></li>
<li><code><a title="presalytics.lib.templates.base.JinjaTemplateBuilder.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.lib.templates.base.JinjaTemplateBuilder.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.lib.templates.base.JinjaTemplateBuilder.get_page_widgets" href="/python-client/presalytics/story/components.html#presalytics.story.components.PageTemplateBase.get_page_widgets">get_page_widgets</a></code></li>
<li><code><a title="presalytics.lib.templates.base.JinjaTemplateBuilder.get_template_name" href="/python-client/presalytics/lib/templates/base.html#presalytics.lib.templates.base.JinjaTemplateBuilder.get_template_name">get_template_name</a></code></li>
<li><code><a title="presalytics.lib.templates.base.JinjaTemplateBuilder.load_jinja_template" href="/python-client/presalytics/lib/templates/base.html#presalytics.lib.templates.base.JinjaTemplateBuilder.load_jinja_template">load_jinja_template</a></code></li>
<li><code><a title="presalytics.lib.templates.base.JinjaTemplateBuilder.load_widget" href="/python-client/presalytics/story/components.html#presalytics.story.components.PageTemplateBase.load_widget">load_widget</a></code></li>
<li><code><a title="presalytics.lib.templates.base.JinjaTemplateBuilder.read_template_string" href="/python-client/presalytics/lib/templates/base.html#presalytics.lib.templates.base.JinjaTemplateBuilder.read_template_string">read_template_string</a></code></li>
<li><code><a title="presalytics.lib.templates.base.JinjaTemplateBuilder.render" href="/python-client/presalytics/lib/templates/base.html#presalytics.lib.templates.base.JinjaTemplateBuilder.render">render</a></code></li>
<li><code><a title="presalytics.lib.templates.base.JinjaTemplateBuilder.render_from_backup_string" href="/python-client/presalytics/lib/templates/base.html#presalytics.lib.templates.base.JinjaTemplateBuilder.render_from_backup_string">render_from_backup_string</a></code></li>
<li><code><a title="presalytics.lib.templates.base.JinjaTemplateBuilder.render_from_file" href="/python-client/presalytics/lib/templates/base.html#presalytics.lib.templates.base.JinjaTemplateBuilder.render_from_file">render_from_file</a></code></li>
<li><code><a title="presalytics.lib.templates.base.JinjaTemplateBuilder.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.serialize">serialize</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.XmlTransformBase"><code class="flex name class">
<span>class <span class="ident">XmlTransformBase</span></span>
<span>(</span><span>function_params, *args, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Base class for writing Open Office Xml tranform functions to be implemented
by <code><a title="presalytics.lib.widgets.ooxml_editors.OoxmlEditorWidget" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.OoxmlEditorWidget">OoxmlEditorWidget</a></code></p>
<p>*For more information about Open Office Xml Schema that underlies
.pptx and .xlsx files, see <a href="http://officeopenxml.com/">http://officeopenxml.com/</a></p>
<p>*For more information on how to lxml to write transforms, consult <a href="https://lxml.de/">https://lxml.de/</a></p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>function_params</code></strong> :&ensp;<code>dict</code></dt>
<dd>A dictionary containing variables that will be used when the <code>transform_function</code>
is executed</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml_editors.py#L19-L53" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class XmlTransformBase(abc.ABC):
    &#34;&#34;&#34;
    Base class for writing Open Office Xml tranform functions to be implemented
    by `presalytics.lib.widgets.ooxml_editors.OoxmlEditorWidget`

    *For more information about Open Office Xml Schema that underlies
    .pptx and .xlsx files, see http://officeopenxml.com/

    *For more information on how to lxml to write transforms, consult https://lxml.de/

    Parameters
    ----------
    function_params : dict
        A dictionary containing variables that will be used when the `transform_function`
        is executed
    &#34;&#34;&#34;
    __xml_transform_kind__ = &#39;XmlTransform&#39;

    def __init__(self, function_params: typing.Dict, *args, **kwargs):
        self.function_params = function_params

    @abc.abstractmethod
    def transform_function(self, lxml_element: lxml.etree.Element, params: typing.Dict) -&gt; lxml.etree.Element:
        &#34;&#34;&#34;
        Modifies Open Office Xml via transforming `lxml.etree.Element` using a params `dict` containing
        variables. Must be overridden in subclasses.
        &#34;&#34;&#34;
        pass

    def execute(self, lxml_element: lxml.etree.Element):
        &#34;&#34;&#34;
        Called by widget classes (e.g., `presalytics.lib.widgets.ooxml_editors.OoxmlEditorWidget`) to
        perform the updates prescribed in the `transform_function`
        &#34;&#34;&#34;
        return self.transform_function(lxml_element, self.function_params)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="presalytics.lib.widgets.ooxml_editors.ChangeShapeColor" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.ChangeShapeColor">ChangeShapeColor</a></li>
<li><a title="presalytics.lib.widgets.ooxml_editors.MultiXmlTransform" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.MultiXmlTransform">MultiXmlTransform</a></li>
<li><a title="presalytics.lib.widgets.ooxml_editors.TextReplace" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.TextReplace">TextReplace</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="presalytics.XmlTransformBase.transform_function"><code class="name flex">
<span>def <span class="ident">transform_function</span></span>(<span>self, lxml_element, params)</span>
</code></dt>
<dd>
<section class="desc"><p>Modifies Open Office Xml via transforming <code>lxml.etree.Element</code> using a params <code>dict</code> containing
variables. Must be overridden in subclasses.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml_editors.py#L40-L46" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@abc.abstractmethod
def transform_function(self, lxml_element: lxml.etree.Element, params: typing.Dict) -&gt; lxml.etree.Element:
    &#34;&#34;&#34;
    Modifies Open Office Xml via transforming `lxml.etree.Element` using a params `dict` containing
    variables. Must be overridden in subclasses.
    &#34;&#34;&#34;
    pass</code></pre>
</details>
</dd>
<dt id="presalytics.XmlTransformBase.execute"><code class="name flex">
<span>def <span class="ident">execute</span></span>(<span>self, lxml_element)</span>
</code></dt>
<dd>
<section class="desc"><p>Called by widget classes (e.g., <code><a title="presalytics.lib.widgets.ooxml_editors.OoxmlEditorWidget" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.OoxmlEditorWidget">OoxmlEditorWidget</a></code>) to
perform the updates prescribed in the <code>transform_function</code></p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml_editors.py#L48-L53" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def execute(self, lxml_element: lxml.etree.Element):
    &#34;&#34;&#34;
    Called by widget classes (e.g., `presalytics.lib.widgets.ooxml_editors.OoxmlEditorWidget`) to
    perform the updates prescribed in the `transform_function`
    &#34;&#34;&#34;
    return self.transform_function(lxml_element, self.function_params)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="presalytics.ChangeShapeColor"><code class="flex name class">
<span>class <span class="ident">ChangeShapeColor</span></span>
<span>(</span><span>function_params, *args, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Changes the color of a set of <a href="http://officeopenxml.com/drwShape.php">Open Office Xml Shapes</a></p>
<h2 id="function-parameters-dictionary">Function Parameters Dictionary</h2>
<p>hex_color : str
The six-digit hexadecimal-format color string (e.g., ffa500 for orange).
See
<a href="https://www.color-hex.com/">https://www.color-hex.com/</a> for an example color calculator</p>
<p>object_name : str, optional
The object tree name of the target shape.
If not supplied, all descendent shapes will
have their color changed.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml_editors.py#L56-L131" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class ChangeShapeColor(XmlTransformBase):
    &#34;&#34;&#34;
    Changes the color of a set of [Open Office Xml Shapes](http://officeopenxml.com/drwShape.php)

    Function Parameters Dictionary
    ----------
    hex_color : str
        The six-digit hexadecimal-format color string (e.g., ffa500 for orange).  See
        https://www.color-hex.com/ for an example color calculator

    object_name : str, optional
        The object tree name of the target shape.  If not supplied, all descendent shapes will
        have their color changed.
    &#34;&#34;&#34;
    __xml_transform_name__ = &#34;ChangeShapeColor&#34;

    @staticmethod
    def replace_color_on_target_shape(shape_xml: lxml.etree.Element, new_color: str) -&gt; lxml.etree.Element:
        &#34;&#34;&#34;
        Changes the color of an [Open Office Xml Shape](http://officeopenxml.com/drwShape.php)
        &#34;&#34;&#34;
        new_fill = lxml.etree.Element(&#34;solidFill&#34;)
        lxml.etree.SubElement(new_fill, &#34;srbgClr&#34;, {&#34;val&#34;: new_color})
        fill_tags = [
            &#39;noFill&#39;,
            &#39;blipFill&#39;,
            &#39;gradFill&#39;,
            &#39;pattFill&#39;,
            &#39;solidFill&#39;
        ]
        props = shape_xml.find(&#39;.//{*}spPr&#39;)
        for child in props.getchildren():
            if any(re.search(&#39;{*}&#39; + r, child.tag) for r in fill_tags):
                current_nsmap = child.nsmap
                current_index = props.index(child)
                current_prefix = child.prefix
                current_ns = current_nsmap.get(current_prefix, None)
                new_fill = lxml.etree.Element(lxml.etree.QName(current_ns, &#34;solidFill&#34;), nsmap=current_nsmap)
                lxml.etree.SubElement(new_fill, lxml.etree.QName(current_ns, &#34;srgbClr&#34;), {&#34;val&#34;: new_color}, nsmap=current_nsmap)
                child.getparent().remove(child)
                props.insert(current_index, new_fill)
        return shape_xml

    def transform_function(self, lxml_element, params):
        &#34;&#34;&#34;
        Changes the color of an [Open Office Xml Shape](http://officeopenxml.com/drwShape.php)

        Parameters
        -----------
        lxml_element : lxml.etree.Element
            An element containing as least one an `&lt;sp&gt;` element

        params : dict
            See the `Function Parameters Dictionary` for required entries
        &#34;&#34;&#34;

        if re.match(&#39;{.*}sp&#39;, lxml_element.tag):
            shapes = [lxml_element]
        else:
            shapes = lxml_element.findall(&#39;.//{*}sp&#39;)
        object_name = params.get(&#34;object_name&#34;, None)
        color = params.get(&#34;hex_color&#34;).lstrip(&#34;#&#34;).upper()
        if object_name:
            for shape in shapes:
                is_target = False
                nvprops = shape.find(&#39;.//{*}nvSpPr&#39;)
                if len(nvprops) &gt; 0:
                    name = nvprops.find(&#39;.//*[@name]&#39;).get(&#34;name&#34;)
                    if name == object_name:
                        is_target = True
                if is_target:
                    shape = ChangeShapeColor.replace_color_on_target_shape(shape, color)
        else:
            for shape in shapes:
                shape = ChangeShapeColor.replace_color_on_target_shape(shape, color)
        return lxml_element</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.widgets.ooxml_editors.XmlTransformBase" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.XmlTransformBase">XmlTransformBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Static methods</h3>
<dl>
<dt id="presalytics.ChangeShapeColor.replace_color_on_target_shape"><code class="name flex">
<span>def <span class="ident">replace_color_on_target_shape</span></span>(<span>shape_xml, new_color)</span>
</code></dt>
<dd>
<section class="desc"><p>Changes the color of an <a href="http://officeopenxml.com/drwShape.php">Open Office Xml Shape</a></p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml_editors.py#L72-L97" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@staticmethod
def replace_color_on_target_shape(shape_xml: lxml.etree.Element, new_color: str) -&gt; lxml.etree.Element:
    &#34;&#34;&#34;
    Changes the color of an [Open Office Xml Shape](http://officeopenxml.com/drwShape.php)
    &#34;&#34;&#34;
    new_fill = lxml.etree.Element(&#34;solidFill&#34;)
    lxml.etree.SubElement(new_fill, &#34;srbgClr&#34;, {&#34;val&#34;: new_color})
    fill_tags = [
        &#39;noFill&#39;,
        &#39;blipFill&#39;,
        &#39;gradFill&#39;,
        &#39;pattFill&#39;,
        &#39;solidFill&#39;
    ]
    props = shape_xml.find(&#39;.//{*}spPr&#39;)
    for child in props.getchildren():
        if any(re.search(&#39;{*}&#39; + r, child.tag) for r in fill_tags):
            current_nsmap = child.nsmap
            current_index = props.index(child)
            current_prefix = child.prefix
            current_ns = current_nsmap.get(current_prefix, None)
            new_fill = lxml.etree.Element(lxml.etree.QName(current_ns, &#34;solidFill&#34;), nsmap=current_nsmap)
            lxml.etree.SubElement(new_fill, lxml.etree.QName(current_ns, &#34;srgbClr&#34;), {&#34;val&#34;: new_color}, nsmap=current_nsmap)
            child.getparent().remove(child)
            props.insert(current_index, new_fill)
    return shape_xml</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.ChangeShapeColor.transform_function"><code class="name flex">
<span>def <span class="ident">transform_function</span></span>(<span>self, lxml_element, params)</span>
</code></dt>
<dd>
<section class="desc"><p>Changes the color of an <a href="http://officeopenxml.com/drwShape.php">Open Office Xml Shape</a></p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>lxml_element</code></strong> :&ensp;<code>lxml.etree.Element</code></dt>
<dd>An element containing as least one an <code>&lt;sp&gt;</code> element</dd>
<dt><strong><code>params</code></strong> :&ensp;<code>dict</code></dt>
<dd>See the <code>Function Parameters Dictionary</code> for required entries</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml_editors.py#L99-L131" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def transform_function(self, lxml_element, params):
    &#34;&#34;&#34;
    Changes the color of an [Open Office Xml Shape](http://officeopenxml.com/drwShape.php)

    Parameters
    -----------
    lxml_element : lxml.etree.Element
        An element containing as least one an `&lt;sp&gt;` element

    params : dict
        See the `Function Parameters Dictionary` for required entries
    &#34;&#34;&#34;

    if re.match(&#39;{.*}sp&#39;, lxml_element.tag):
        shapes = [lxml_element]
    else:
        shapes = lxml_element.findall(&#39;.//{*}sp&#39;)
    object_name = params.get(&#34;object_name&#34;, None)
    color = params.get(&#34;hex_color&#34;).lstrip(&#34;#&#34;).upper()
    if object_name:
        for shape in shapes:
            is_target = False
            nvprops = shape.find(&#39;.//{*}nvSpPr&#39;)
            if len(nvprops) &gt; 0:
                name = nvprops.find(&#39;.//*[@name]&#39;).get(&#34;name&#34;)
                if name == object_name:
                    is_target = True
            if is_target:
                shape = ChangeShapeColor.replace_color_on_target_shape(shape, color)
    else:
        for shape in shapes:
            shape = ChangeShapeColor.replace_color_on_target_shape(shape, color)
    return lxml_element</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.widgets.ooxml_editors.XmlTransformBase" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.XmlTransformBase">XmlTransformBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.widgets.ooxml_editors.XmlTransformBase.execute" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.XmlTransformBase.execute">execute</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.TextReplace"><code class="flex name class">
<span>class <span class="ident">TextReplace</span></span>
<span>(</span><span>function_params, *args, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Replaces text in a template built into an Office Office Xml object that has
been uploaded to the Presalytics Ooxml Automation service.
Text to be should
be in the format of a "template tag", which is a string enclosed in handlebars
as such: '{{template_tag}}'</p>
<h2 id="function-parameters-dictionary">Function Parameters Dictionary</h2>
<p>replace_map: dict
A dictionary that maps template tags to the new strings that will replace the
tags in the rendered widget.
The the dictionary keys should not be enclosed in handlebars.</p>
<p>object_name: str, optional
The name of a sub object will be the target of this function.
If not includes, this will
default to the parent object.
Allows different replace map to be applied to multiple elements in
a widget</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml_editors.py#L134-L296" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class TextReplace(XmlTransformBase):
    &#34;&#34;&#34;
    Replaces text in a template built into an Office Office Xml object that has
    been uploaded to the Presalytics Ooxml Automation service.  Text to be should
    be in the format of a &#34;template tag&#34;, which is a string enclosed in handlebars
    as such: &#39;{{template_tag}}&#39;

    Function Parameters Dictionary
    ----------

    replace_map: dict
        A dictionary that maps template tags to the new strings that will replace the
        tags in the rendered widget.  The the dictionary keys should not be enclosed in handlebars.

    object_name: str, optional
        The name of a sub object will be the target of this function.  If not includes, this will
        default to the parent object.  Allows different replace map to be applied to multiple elements in
        a widget

    &#34;&#34;&#34;
    __xml_transform_name__ = &#34;TextReplace&#34;

    class TextElementInfo(object):
        &#34;&#34;&#34;
        Holds metadata for a list of `&lt;t&gt;` tags from an Office Open Xml document.
        &#34;&#34;&#34;

        def __init__(self, element: lxml.etree.Element, start_position: int):
            self.element = element
            self.text = &#34;&#34; if not element.text else element.text
            self.length = len(self.text)
            self.start_position = start_position
            self.end_position = self.start_position + self.length - 1

    class TextList(object):
        &#34;&#34;&#34;
        Class for managing a list of `TextElementInfo` objects
        &#34;&#34;&#34;
        _list: typing.List[&#39;TextReplace.TextElementInfo&#39;]

        def __init__(self):
            self._list = []

        def append(self, text_element_info):
            if isinstance(text_element_info, globals()[&#39;TextReplace&#39;].TextElementInfo):
                self._list.append(text_element_info)
            else:
                raise presalytics.lib.exceptions.InvalidArgumentException(message=&#34;Argument must be an instance of class &#39;TextElementInfo&#39;&#34;)

        def set_text(self, index, new_string):
            self._list[index].text = new_string
            self._list[index].element.text = new_string

        def get_text(self, index):
            return self._list[index].text

        def get_plaintext_string(self):
            ret = &#34;&#34;
            for item in self._list:
                ret += item.text
            return ret

        def get_position(self, match_strings):
            for potential_match in match_strings:
                i = self.get_plaintext_string().find(potential_match)
                if i &gt;= 0:
                    break
            return i, potential_match

        def get_list_index_of_position(self, position: int):
            for item in self._list:
                if item.start_position &lt;= position and item.end_position &gt;= position:
                    return self.get_index(item)
            raise presalytics.lib.exceptions.InvalidArgumentException(message=&#34;Position {} out of range&#34;.format(position))

        def get_index(self, text_element_info: &#39;TextReplace.TextElementInfo&#39;):
            for i in range(len(self._list)):
                if self._list[i] == text_element_info:
                    return i
            raise presalytics.lib.exceptions.InvalidArgumentException(message=&#34;Supplied argument on in self._list&#34;)

        def set_text_to_empty_string(self, index):
            self._list[index].text = &#34;&#34;
            self._list[index].element.text = &#34;&#34;

        def set_start_to_new_value(self, index, new_value):
            start_text, remainder = self._list[index].text.split(&#34;{{&#34;, 1)
            end = &#34;&#34;
            if &#34;}}&#34; in remainder:
                end = remainder.split(&#34;}}&#34;, 1)[1]
            new_text = &#34;{0}{1}{2}&#34;.format(start_text, new_value, end)
            self._list[index].text = new_text
            self._list[index].element.text = new_text

        def truncate_end(self, index):
            end_text = self._list[index].text.split(&#34;}}&#34;, 1)[-1]
            self._list[index].text = end_text
            self._list[index].element.text = end_text

        def plaintext_string_list(self):
            return [x.text for x in self._list]

        def reset(self):
            for i in range(0, len(self._list)):
                start_position = 0 if i == 0 else self._list[i - 1].end_position + 1
                self._list[i] = TextReplace.TextElementInfo(self._list[i].element, start_position)

    def replace_handlebars(self, info_list, params):
        &#34;&#34;&#34;
        Method that finds template tags and replaces them

        TODO: Upgrade to Liquid Syntax (or similar)
        &#34;&#34;&#34;
        for key, val in params.items():
            match_keys = [&#34;{{&#34; + key + &#34;}}&#34;, &#34;{{ &#34; + key + &#34; }}&#34;]
            match_start_position, match_key = info_list.get_position(match_keys)
            if match_start_position &gt; -1:
                match_end_position = match_start_position + len(match_key) - 1
                match_start_index = info_list.get_list_index_of_position(match_start_position)
                match_end_index = info_list.get_list_index_of_position(match_end_position)
                if match_start_index &lt; match_end_index:
                    info_list.truncate_end(match_end_index)
                for i in range(match_start_index + 1, match_end_index):
                    info_list.set_text_to_empty_string(i)
                info_list.set_start_to_new_value(match_start_index, val)
                info_list.reset()
                self.replace_handlebars(info_list, params)

    def transform_function(self, lxml_element, params):
        &#34;&#34;&#34;
        Replaces template tags located {{inside_handlebars}} that match keys in the
        `params` dict with values from the `params` dict.

        This method searches for match for plain text strings, so that if template
        tags are split across xml `&lt;t&gt;` elements, they are still identified and replaced.

        Parameters
        -----------
        lxml_element : lxml.etree.Element
            An element containing as least one an `&lt;t&gt;` element

        params : dict
            A dictionary that maps template tags (no handlebars) to their respective
            replacement values.
        &#34;&#34;&#34;
        target_object = lxml_element
        target_object_name = params.get(&#34;object_name&#34;, None)
        if target_object_name:
            nvProps = lxml_element.findall(&#39;.//{*}cNvPr&#39;)
            for ele in nvProps:
                if ele.get(&#34;name&#34;, None) == target_object_name:
                    target_object = ele.getparent().getparent()
                    break

        text_list = target_object.findall(&#39;.//{*}t&#39;)
        info_list = TextReplace.TextList()
        position = 0
        for tag in text_list:
            info = self.TextElementInfo(tag, position)
            position = info.end_position + 1
            info_list.append(info)
        self.replace_handlebars(info_list, params.get(&#34;replace_map&#34;))
        return lxml_element</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.widgets.ooxml_editors.XmlTransformBase" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.XmlTransformBase">XmlTransformBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.TextReplace.TextElementInfo"><code class="name">var <span class="ident">TextElementInfo</span></code></dt>
<dd>
<section class="desc"><p>Holds metadata for a list of <code>&lt;t&gt;</code> tags from an Office Open Xml document.</p></section>
</dd>
<dt id="presalytics.TextReplace.TextList"><code class="name">var <span class="ident">TextList</span></code></dt>
<dd>
<section class="desc"><p>Class for managing a list of <code>TextElementInfo</code> objects</p></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.TextReplace.replace_handlebars"><code class="name flex">
<span>def <span class="ident">replace_handlebars</span></span>(<span>self, info_list, params)</span>
</code></dt>
<dd>
<section class="desc"><p>Method that finds template tags and replaces them</p>
<p>TODO: Upgrade to Liquid Syntax (or similar)</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml_editors.py#L241-L260" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def replace_handlebars(self, info_list, params):
    &#34;&#34;&#34;
    Method that finds template tags and replaces them

    TODO: Upgrade to Liquid Syntax (or similar)
    &#34;&#34;&#34;
    for key, val in params.items():
        match_keys = [&#34;{{&#34; + key + &#34;}}&#34;, &#34;{{ &#34; + key + &#34; }}&#34;]
        match_start_position, match_key = info_list.get_position(match_keys)
        if match_start_position &gt; -1:
            match_end_position = match_start_position + len(match_key) - 1
            match_start_index = info_list.get_list_index_of_position(match_start_position)
            match_end_index = info_list.get_list_index_of_position(match_end_position)
            if match_start_index &lt; match_end_index:
                info_list.truncate_end(match_end_index)
            for i in range(match_start_index + 1, match_end_index):
                info_list.set_text_to_empty_string(i)
            info_list.set_start_to_new_value(match_start_index, val)
            info_list.reset()
            self.replace_handlebars(info_list, params)</code></pre>
</details>
</dd>
<dt id="presalytics.TextReplace.transform_function"><code class="name flex">
<span>def <span class="ident">transform_function</span></span>(<span>self, lxml_element, params)</span>
</code></dt>
<dd>
<section class="desc"><p>Replaces template tags located {{inside_handlebars}} that match keys in the
<code>params</code> dict with values from the <code>params</code> dict.</p>
<p>This method searches for match for plain text strings, so that if template
tags are split across xml <code>&lt;t&gt;</code> elements, they are still identified and replaced.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>lxml_element</code></strong> :&ensp;<code>lxml.etree.Element</code></dt>
<dd>An element containing as least one an <code>&lt;t&gt;</code> element</dd>
<dt><strong><code>params</code></strong> :&ensp;<code>dict</code></dt>
<dd>A dictionary that maps template tags (no handlebars) to their respective
replacement values.</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml_editors.py#L262-L296" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def transform_function(self, lxml_element, params):
    &#34;&#34;&#34;
    Replaces template tags located {{inside_handlebars}} that match keys in the
    `params` dict with values from the `params` dict.

    This method searches for match for plain text strings, so that if template
    tags are split across xml `&lt;t&gt;` elements, they are still identified and replaced.

    Parameters
    -----------
    lxml_element : lxml.etree.Element
        An element containing as least one an `&lt;t&gt;` element

    params : dict
        A dictionary that maps template tags (no handlebars) to their respective
        replacement values.
    &#34;&#34;&#34;
    target_object = lxml_element
    target_object_name = params.get(&#34;object_name&#34;, None)
    if target_object_name:
        nvProps = lxml_element.findall(&#39;.//{*}cNvPr&#39;)
        for ele in nvProps:
            if ele.get(&#34;name&#34;, None) == target_object_name:
                target_object = ele.getparent().getparent()
                break

    text_list = target_object.findall(&#39;.//{*}t&#39;)
    info_list = TextReplace.TextList()
    position = 0
    for tag in text_list:
        info = self.TextElementInfo(tag, position)
        position = info.end_position + 1
        info_list.append(info)
    self.replace_handlebars(info_list, params.get(&#34;replace_map&#34;))
    return lxml_element</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.widgets.ooxml_editors.XmlTransformBase" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.XmlTransformBase">XmlTransformBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.widgets.ooxml_editors.XmlTransformBase.execute" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.XmlTransformBase.execute">execute</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.MultiXmlTransform"><code class="flex name class">
<span>class <span class="ident">MultiXmlTransform</span></span>
<span>(</span><span>transforms, fail_quietly=True, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>This class allow users to run mutiple transforms on multiple targets in a single widget.
<code><a title="presalytics.MultiXmlTransform" href="/python-client/presalytics/index.html#presalytics.MultiXmlTransform">MultiXmlTransform</a></code>
wraps multiple subclasses of <code><a title="presalytics.lib.widgets.ooxml_editors.XmlTransformBase" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.XmlTransformBase">XmlTransformBase</a></code>, creates instances of
them, and feeds them into an <code><a title="presalytics.lib.widgets.ooxml_editors.OoxmlEditorWidget" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.OoxmlEditorWidget">OoxmlEditorWidget</a></code> instance.
To do this,
the <code><a title="presalytics.lib.widgets.ooxml_editors.XmlTransformBase" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.XmlTransformBase">XmlTransformBase</a></code> subclasses must be loaded into the
<code><a title="presalytics.lib.widgets.ooxml_editors.XML_TRANSFORM_REGISTRY" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.XML_TRANSFORM_REGISTRY">XML_TRANSFORM_REGISTRY</a></code> when called.</p>
<p>The function parameters for the</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>fail_quietly</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Defaults to false.
Indicates whether an exception should be raised when a subclass specified
in the function parameters cannot not be found in the <code><a title="presalytics.lib.widgets.ooxml_editors.XML_TRANSFORM_REGISTRY" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.XML_TRANSFORM_REGISTRY">XML_TRANSFORM_REGISTRY</a></code>
instance.</dd>
</dl>
<h2 id="function-parameters-dictionary">Function Parameters Dictionary</h2>
<p>transforms_list: list of dict
A list of dictionaries, with each item in the list consiting of a dictionary of two entries.
The entries are as follows:</p>
<pre><code> * name: [str]
    The name of the the subclass of &lt;code&gt;&lt;a title="presalytics.lib.widgets.ooxml_editors.XmlTransformBase" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.XmlTransformBase"&gt;XmlTransformBase&lt;/a&gt;&lt;/code&gt; that
    will be that will be initialized

 * function_params: [dict]
    The &lt;code&gt;params&lt;/code&gt; that will be the loaded into the instance's &lt;code&gt;transform\_function&lt;/code&gt;
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml_editors.py#L342-L399" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class MultiXmlTransform(XmlTransformBase):
    &#34;&#34;&#34;
    This class allow users to run mutiple transforms on multiple targets in a single widget.  `MultiXmlTransform`
    wraps multiple subclasses of `presalytics.lib.widgets.ooxml_editors.XmlTransformBase`, creates instances of
    them, and feeds them into an `presalytics.lib.widgets.ooxml_editors.OoxmlEditorWidget` instance.  To do this,
    the `presalytics.lib.widgets.ooxml_editors.XmlTransformBase` subclasses must be loaded into the
    `presalytics.lib.widgets.ooxml_editors.XML_TRANSFORM_REGISTRY` when called.

    The function parameters for the

    Parameters
    ----------
    fail_quietly: bool, optional
        Defaults to false.  Indicates whether an exception should be raised when a subclass specified
        in the function parameters cannot not be found in the `presalytics.lib.widgets.ooxml_editors.XML_TRANSFORM_REGISTRY`
        instance.


    Function Parameters Dictionary
    ----------
    transforms_list: list of dict
        A list of dictionaries, with each item in the list consiting of a dictionary of two entries.
        The entries are as follows:

         * name: [str]
            The name of the the subclass of `presalytics.lib.widgets.ooxml_editors.XmlTransformBase` that
            will be that will be initialized

         * function_params: [dict]
            The `params` that will be the loaded into the instance&#39;s `transform_function`
    &#34;&#34;&#34;
    transform_instances: typing.List[XmlTransformBase]

    __xml_transform_name__ = &#34;MultiXmlTransform&#34;

    def __init__(self, transforms: typing.Dict[str, typing.List[typing.Dict[str, typing.Any]]], fail_quietly=True, **kwargs):
        super(MultiXmlTransform, self).__init__(transforms, **kwargs)
        transforms_list = transforms.get(&#34;transforms_list&#34;, None)
        self.fail_quietly = fail_quietly
        self.transform_instances = []
        self.transform_registry = get_transform_registry()
        for _transform in transforms_list:  # type: ignore
            key = &#34;XmlTransform.&#34; + _transform[&#34;name&#34;]
            transform_class = self.transform_registry.get(key)
            if not transform_class:
                message = &#34;Could not find XmlTransform with name &#39;{}&#39;&#34;.format(_transform[&#34;name&#34;])
                if self.fail_quietly:
                    logging.info(message)
                else:
                    raise self.transform_registry.raise_error(message)  # noqa
            else:
                inst = transform_class(_transform[&#34;function_params&#34;])
                self.transform_instances.append(inst)

    def transform_function(self, lxml_element, params):
        for inst in self.transform_instances:
            lxml_element = inst.execute(lxml_element)
        return lxml_element</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.widgets.ooxml_editors.XmlTransformBase" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.XmlTransformBase">XmlTransformBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.MultiXmlTransform.transform_instances"><code class="name">var <span class="ident">transform_instances</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.widgets.ooxml_editors.XmlTransformBase" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.XmlTransformBase">XmlTransformBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.widgets.ooxml_editors.XmlTransformBase.execute" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.XmlTransformBase.execute">execute</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml_editors.XmlTransformBase.transform_function" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.XmlTransformBase.transform_function">transform_function</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.ApprovedExternalLinks"><code class="flex name class">
<span>class <span class="ident">ApprovedExternalLinks</span></span>
<span>(</span><span>**kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p><code><a title="presalytics.lib.plugins.base.StylePlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.StylePlugin">StylePlugin</a></code> subclass for converting a <code><a title="presalytics.story.outline.Plugin" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.Plugin">Plugin</a></code>
config into an html <code>&lt;link&gt;</code> fragment.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>attr_dict</code></strong> :&ensp;<code><a title="presalytics.lib.plugins.external.AttrDict" href="/python-client/presalytics/lib/plugins/external.html#presalytics.lib.plugins.external.AttrDict">AttrDict</a></code></dt>
<dd>Performs nested lookups on the <code>STYLES_MAP</code></dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/external.py#L42-L101" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class ApprovedExternalLinks(presalytics.lib.plugins.base.StylePlugin):
    &#34;&#34;&#34;
    `presalytics.lib.plugins.base.StylePlugin` subclass for converting a `presalytics.story.outline.Plugin`
    config into an html `&lt;link&gt;` fragment.

    Attributes
    ----------
    attr_dict: presalytics.lib.plugins.external.AttrDict
        Performs nested lookups on the `STYLES_MAP`
    &#34;&#34;&#34;
    __plugin_name__ = &#39;external_links&#39;

    STYLES_MAP = {
        &#39;c3&#39;: &#39;{0}/static/vendor/c3/c3.min.css&#39;.format(site_host),
        &#39;reveal&#39;: {
            &#39;base&#39;: &#39;{0}/static/vendor/reveal/reveal.css&#39;.format(site_host),
            &#39;themes&#39;: {
                &#39;beige&#39;: &#39;{0}/static/vendor/reveal/theme/beige.css&#39;.format(site_host),
                &#39;black&#39;: &#39;{0}/static/vendor/reveal/theme/black.css&#39;.format(site_host),
                &#39;blood&#39;: &#39;{0}/static/vendor/reveal/theme/blood.css&#39;.format(site_host),
                &#39;league&#39;: &#39;{0}/static/vendor/reveal/theme/league.css&#39;.format(site_host),
                &#39;moon&#39;: &#39;{0}/static/vendor/reveal/theme/moon.css&#39;.format(site_host),
                &#39;night&#39;: &#39;{0}/static/vendor/reveal/theme/night.css&#39;.format(site_host),
                &#39;serif&#39;: &#39;{0}/static/vendor/reveal/theme/serif.css&#39;.format(site_host),
                &#39;simple&#39;: &#39;{0}/static/vendor/reveal/theme/simple.css&#39;.format(site_host),
                &#39;sky&#39;: &#39;{0}/static/vendor/reveal/theme/sky.min.css&#39;.format(site_host),
                &#39;solarized&#39;: &#39;{0}/static/vendor/reveal/theme/solarized.css&#39;.format(site_host),
                &#39;white&#39;: &#39;{0}/static/vendor/reveal/theme/white.css&#39;.format(site_host)
            },
            &#39;print&#39;: &#39;https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.6.0/css/print/pdf.min.css&#39;,
            &#39;toolbar&#39;: &#39;{0}/static/css/toolbar.css&#39;.format(site_host),
        },
        &#39;preloaders&#39;: &#39;{0}/static/css/preloaders.css&#39;.format(site_host),
        &#39;bootstrap4&#39;: &#34;https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css&#34;,
        &#39;font-awesome&#39;: &#39;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css&#39;,
        &#39;bootstrap-table&#39;: &#39;https://unpkg.com/bootstrap-table@1.18.0/dist/bootstrap-table.min.css&#39;,
        &#39;markdown-css&#39;: &#39;https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/4.0.0/github-markdown.min.css&#39;

    }
    &#34;&#34;&#34;
    Static nested dictionary containing links to external stylesheets that will be rendered alongside this plugin
    &#34;&#34;&#34;

    def __init__(self, **kwargs):
        super(ApprovedExternalLinks, self).__init__(**kwargs)
        self.attr_dict = AttrDict(self.STYLES_MAP)

    def to_style(self, config, **kwargs):
        &#34;&#34;&#34;
        Converts a dot-notation key for nested dictionaries (e.g., &#39;reveal.base&#39;) into a
        string contain an html fragement with `&lt;link&gt;` tag.  The dot-notation key
        is pulled from the &#39;approved_styles_key&#39; of the &#39;config&#39; attrubte of subclass
        of a `presalytics.story.outline.Plugin` object.
        &#34;&#34;&#34;
        key = config[&#39;approved_styles_key&#39;]
        link = self.attr_dict.flatten()[key]
        if link is None:
            message = &#34;Key {0} does not reference a link in the APPROVED_STYLES dictionary&#34;.format(key)
            raise presalytics.lib.exceptions.MissingConfigException(message)
        return &#39;&lt;link rel=&#34;stylesheet&#34; href=&#34;{0}&#34;/&gt;&#39;.format(link)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.plugins.base.StylePlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.StylePlugin">StylePlugin</a></li>
<li><a title="presalytics.lib.plugins.base.PluginBase" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase">PluginBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.ApprovedExternalLinks.config"><code class="name">var <span class="ident">config</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.ApprovedExternalLinks.STYLES_MAP"><code class="name">var <span class="ident">STYLES_MAP</span></code></dt>
<dd>
<section class="desc"><p>Static nested dictionary containing links to external stylesheets that will be rendered alongside this plugin</p></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.ApprovedExternalLinks.to_style"><code class="name flex">
<span>def <span class="ident">to_style</span></span>(<span>self, config, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Converts a dot-notation key for nested dictionaries (e.g., 'reveal.base') into a
string contain an html fragement with <code>&lt;link&gt;</code> tag.
The dot-notation key
is pulled from the 'approved_styles_key' of the 'config' attrubte of subclass
of a <code><a title="presalytics.story.outline.Plugin" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.Plugin">Plugin</a></code> object.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/external.py#L89-L101" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def to_style(self, config, **kwargs):
    &#34;&#34;&#34;
    Converts a dot-notation key for nested dictionaries (e.g., &#39;reveal.base&#39;) into a
    string contain an html fragement with `&lt;link&gt;` tag.  The dot-notation key
    is pulled from the &#39;approved_styles_key&#39; of the &#39;config&#39; attrubte of subclass
    of a `presalytics.story.outline.Plugin` object.
    &#34;&#34;&#34;
    key = config[&#39;approved_styles_key&#39;]
    link = self.attr_dict.flatten()[key]
    if link is None:
        message = &#34;Key {0} does not reference a link in the APPROVED_STYLES dictionary&#34;.format(key)
        raise presalytics.lib.exceptions.MissingConfigException(message)
    return &#39;&lt;link rel=&#34;stylesheet&#34; href=&#34;{0}&#34;/&gt;&#39;.format(link)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.plugins.base.StylePlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.StylePlugin">StylePlugin</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.plugins.base.StylePlugin.get_tag" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase.get_tag">get_tag</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.ApprovedExternalScripts"><code class="flex name class">
<span>class <span class="ident">ApprovedExternalScripts</span></span>
<span>(</span><span>**kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p><code><a title="presalytics.lib.plugins.base.ScriptPlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.ScriptPlugin">ScriptPlugin</a></code> subclass for converting a <code><a title="presalytics.story.outline.Plugin" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.Plugin">Plugin</a></code>
config into an html <code>&lt;script&gt;</code> fragment.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>attr_dict</code></strong> :&ensp;<code><a title="presalytics.lib.plugins.external.AttrDict" href="/python-client/presalytics/lib/plugins/external.html#presalytics.lib.plugins.external.AttrDict">AttrDict</a></code></dt>
<dd>Performs nested lookups on the <code>SCRIPT_MAP</code></dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/external.py#L104-L161" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class ApprovedExternalScripts(presalytics.lib.plugins.base.ScriptPlugin):
    &#34;&#34;&#34;
    `presalytics.lib.plugins.base.ScriptPlugin` subclass for converting a `presalytics.story.outline.Plugin`
    config into an html `&lt;script&gt;` fragment.

    Attributes
    ----------
    attr_dict: presalytics.lib.plugins.external.AttrDict
        Performs nested lookups on the `SCRIPT_MAP`
    &#34;&#34;&#34;
    __plugin_name__ = &#39;external_scripts&#39;

    SCRIPT_MAP = {
        &#39;c3&#39;: &#39;{0}/static/vendor/c3/c3.min.js&#39;.format(site_host),
        &#39;d3&#39;: &#39;https://d3js.org/d3.v5.min.js&#39;,
        &#39;d3v3&#39;: &#39;https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js&#39;,
        &#39;reveal&#39;: {
            &#39;base&#39;: &#39;{0}/static/vendor/reveal/reveal.js&#39;.format(site_host),
            # &#39;markdown&#39;: &#39;https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.6.0/plugin/markdown/markdown.min.js&#39;,
            # &#39;highlight&#39;: &#39;https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.6.0/plugin/highlight/highlight.min.js&#39;,
            # &#39;math&#39;: &#39;https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.6.0/plugin/math/math.min.js&#39;,
            # &#39;zoom&#39;: &#39;https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.6.0/plugin/zoom-js/zoom.min.js&#39;,
            # &#39;notes&#39;: &#39;https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.6.0/plugin/notes/notes.min.js&#39;,
            # &#39;print&#39;: &#39;https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.6.0/plugin/print-pdf/print-pdf.min.js&#39;,
            &#39;toolbar&#39;: &#39;{0}/static/js/toolbar.js&#39;.format(site_host),
            &#39;screenfull&#39;: &#39;{0}/static/vendor/screenfull/screenfull.min.js&#39;.format(site_host),

        },
        &#39;mpld3&#39;: &#39;{0}/static/mpld3/mpld3.min.js&#39;.format(site_host),
        &#39;ooxml&#39;: &#39;{0}/static/js/ooxml.js&#39;.format(site_host),
        &#39;mpl-responsive&#39;: &#39;{0}/static/js/mpl-responsive.js&#39;.format(site_host),
        &#39;events&#39;: &#39;{0}/static/js/events.js&#39;.format(site_host),
        &#39;jquery&#39;: &#39;https://code.jquery.com/jquery-3.4.1.min.js&#39;,
        &#39;popper&#39;: &#39;https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js&#39;,
        &#39;bootstrap4&#39;: &#39;https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js&#39;,
        &#39;bootstrap-table&#39;: &#39;https://unpkg.com/bootstrap-table@1.18.0/dist/bootstrap-table.min.js&#39;
    }
    &#34;&#34;&#34;
    Static nested dictionary containing links to external scripts that will be rendered alongside this plugin
    &#34;&#34;&#34;

    def __init__(self, **kwargs):
        super(ApprovedExternalScripts, self).__init__(**kwargs)
        self.attr_dict = AttrDict(self.SCRIPT_MAP)

    def to_script(self, config, **kwargs):
        &#34;&#34;&#34;
        Converts a dot-notation key for nested dictionaries (e.g., &#39;reveal.base&#39;) into a
        string containing an html fragement with `&lt;script&gt;` tags.  The dot-notation key
        is pulled from the &#39;approved_styles_key&#39; of the &#39;config&#39; attrubte of subclass
        of a `presalytics.story.outline.Plugin` object.
        &#34;&#34;&#34;
        key = config[&#39;approved_scripts_key&#39;]
        link = self.attr_dict.flatten()[key]
        if link is None:
            message = &#34;Key {0} does not reference a link in the APPROVED_SCRIPTS dictionary&#34;.format(key)
            raise presalytics.lib.exceptions.MissingConfigException(message)
        return &#39;&lt;script type=&#34;text/javascript&#34; src=&#34;{0}&#34;&gt;&lt;/script&gt;&#39;.format(link)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.plugins.base.ScriptPlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.ScriptPlugin">ScriptPlugin</a></li>
<li><a title="presalytics.lib.plugins.base.PluginBase" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase">PluginBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.ApprovedExternalScripts.config"><code class="name">var <span class="ident">config</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.ApprovedExternalScripts.SCRIPT_MAP"><code class="name">var <span class="ident">SCRIPT_MAP</span></code></dt>
<dd>
<section class="desc"><p>Static nested dictionary containing links to external scripts that will be rendered alongside this plugin</p></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.ApprovedExternalScripts.to_script"><code class="name flex">
<span>def <span class="ident">to_script</span></span>(<span>self, config, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Converts a dot-notation key for nested dictionaries (e.g., 'reveal.base') into a
string containing an html fragement with <code>&lt;script&gt;</code> tags.
The dot-notation key
is pulled from the 'approved_styles_key' of the 'config' attrubte of subclass
of a <code><a title="presalytics.story.outline.Plugin" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.Plugin">Plugin</a></code> object.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/external.py#L149-L161" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def to_script(self, config, **kwargs):
    &#34;&#34;&#34;
    Converts a dot-notation key for nested dictionaries (e.g., &#39;reveal.base&#39;) into a
    string containing an html fragement with `&lt;script&gt;` tags.  The dot-notation key
    is pulled from the &#39;approved_styles_key&#39; of the &#39;config&#39; attrubte of subclass
    of a `presalytics.story.outline.Plugin` object.
    &#34;&#34;&#34;
    key = config[&#39;approved_scripts_key&#39;]
    link = self.attr_dict.flatten()[key]
    if link is None:
        message = &#34;Key {0} does not reference a link in the APPROVED_SCRIPTS dictionary&#34;.format(key)
        raise presalytics.lib.exceptions.MissingConfigException(message)
    return &#39;&lt;script type=&#34;text/javascript&#34; src=&#34;{0}&#34;&gt;&lt;/script&gt;&#39;.format(link)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.plugins.base.ScriptPlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.ScriptPlugin">ScriptPlugin</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.plugins.base.ScriptPlugin.get_tag" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase.get_tag">get_tag</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.LocalStylesPlugin"><code class="flex name class">
<span>class <span class="ident">LocalStylesPlugin</span></span>
<span>(</span><span>**kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Plugin incorporate styles from a css stylesheet in a local filepath</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/local.py#L9-L52" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class LocalStylesPlugin(presalytics.lib.plugins.base.StylePlugin):
    &#34;&#34;&#34;
    Plugin incorporate styles from a css stylesheet in a local filepath
    &#34;&#34;&#34;
    __plugin_name__ = &#39;local&#39;

    LOCAL_STYLES_MAP = {
        &#34;single_item_grid&#34;: os.path.join(css_path, &#34;single-item-grid.css&#34;),
        &#34;flex_row&#34;: os.path.join(css_path, &#34;flex-row.css&#34;),
        &#34;light_grey&#34;: os.path.join(css_path, &#34;light-grey.css&#34;),
        &#34;responsive_title&#34;: os.path.join(css_path, &#34;responsive-title.css&#34;),
        &#34;reveal_overrides&#34;: os.path.join(css_path, &#34;reveal-overrides-base.css&#34;)
    }
    &#34;&#34;&#34;
    Dictionary containing a map configuration keys to css files that are
    member of the Presalytics Python Library manifest
    &#34;&#34;&#34;

    def to_style(self, config, **kwargs):
        &#34;&#34;&#34;
        Renders a css stylesheet as an inline style tag in a story

        Parameters
        ----------
        config : dict
            A dictionary containing either a &#34;css_file_path&#34; key, which points
            to a local file path, or a &#34;css_file_id&#34; refers to a css file included
            in the Presalytics Python Library&#39;s manifest
        &#34;&#34;&#34;
        id = config.get(&#34;css_file_id&#34;, None)
        if not id:
            file_path = config.get(&#34;css_file_path&#34;, None)
            if not file_path:
                message = &#39;Plugin requires &#34;css_file_id&#34; or &#34;css_file_path&#34; in its configuration dictionary&#39;
                raise presalytics.lib.exceptions.MissingConfigException(message)
            if not os.path.exists(file_path):
                message = &#39;Path {0} in plugin configuration does not exist&#39;.format(file_path)
                raise presalytics.lib.exceptions.MissingConfigException(message)
        else:
            file_path = LocalStylesPlugin.LOCAL_STYLES_MAP[id]
        with open(file_path, &#39;r&#39;) as f:
            style_data = f.read()
        tag = &#34;&lt;style&gt;{0}&lt;/style&gt;&#34;.format(style_data)
        return tag</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.plugins.base.StylePlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.StylePlugin">StylePlugin</a></li>
<li><a title="presalytics.lib.plugins.base.PluginBase" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase">PluginBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.LocalStylesPlugin.config"><code class="name">var <span class="ident">config</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.LocalStylesPlugin.LOCAL_STYLES_MAP"><code class="name">var <span class="ident">LOCAL_STYLES_MAP</span></code></dt>
<dd>
<section class="desc"><p>Dictionary containing a map configuration keys to css files that are
member of the Presalytics Python Library manifest</p></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.LocalStylesPlugin.to_style"><code class="name flex">
<span>def <span class="ident">to_style</span></span>(<span>self, config, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Renders a css stylesheet as an inline style tag in a story</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>config</code></strong> :&ensp;<code>dict</code></dt>
<dd>A dictionary containing either a "css_file_path" key, which points
to a local file path, or a "css_file_id" refers to a css file included
in the Presalytics Python Library's manifest</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/local.py#L27-L52" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def to_style(self, config, **kwargs):
    &#34;&#34;&#34;
    Renders a css stylesheet as an inline style tag in a story

    Parameters
    ----------
    config : dict
        A dictionary containing either a &#34;css_file_path&#34; key, which points
        to a local file path, or a &#34;css_file_id&#34; refers to a css file included
        in the Presalytics Python Library&#39;s manifest
    &#34;&#34;&#34;
    id = config.get(&#34;css_file_id&#34;, None)
    if not id:
        file_path = config.get(&#34;css_file_path&#34;, None)
        if not file_path:
            message = &#39;Plugin requires &#34;css_file_id&#34; or &#34;css_file_path&#34; in its configuration dictionary&#39;
            raise presalytics.lib.exceptions.MissingConfigException(message)
        if not os.path.exists(file_path):
            message = &#39;Path {0} in plugin configuration does not exist&#39;.format(file_path)
            raise presalytics.lib.exceptions.MissingConfigException(message)
    else:
        file_path = LocalStylesPlugin.LOCAL_STYLES_MAP[id]
    with open(file_path, &#39;r&#39;) as f:
        style_data = f.read()
    tag = &#34;&lt;style&gt;{0}&lt;/style&gt;&#34;.format(style_data)
    return tag</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.plugins.base.StylePlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.StylePlugin">StylePlugin</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.plugins.base.StylePlugin.get_tag" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase.get_tag">get_tag</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.OoxmlTheme"><code class="flex name class">
<span>class <span class="ident">OoxmlTheme</span></span>
<span>(</span><span>**kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>This class takes theme data from an Presalytics API Ooxml Automation service Theme object
and feeds those values into the <code><a title="presalytics.lib.plugins.reveal_theme.RevealCustomTheme" href="/python-client/presalytics/lib/plugins/reveal_theme.html#presalytics.lib.plugins.reveal_theme.RevealCustomTheme">RevealCustomTheme</a></code></p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/ooxml.py#L10-L41" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class OoxmlTheme(presalytics.lib.plugins.reveal_theme.RevealCustomTheme):
    &#34;&#34;&#34;
    This class takes theme data from an Presalytics API Ooxml Automation service Theme object
    and feeds those values into the `presalytics.lib.plugins.reveal_theme.RevealCustomTheme`
    &#34;&#34;&#34;
    __plugin_name__ = &#39;ooxml-theme&#39;

    def to_style(self, config, **kwargs):
        base_path = os.path.join(os.path.dirname(__file__), &#39;scss&#39;)
        if os.name == &#34;nt&#34;:
            import_path = posixpath.join(*base_path.split(&#39;\\&#39;))
        else:
            import_path = base_path
        scss_file = os.path.join(base_path, &#39;overrides.tmpl&#39;)
        config.update({&#39;path&#39;: import_path})
        with open(scss_file, &#39;r&#39;) as file:
            scss_template_string = file.read()
        config = self.config_to_camelCase(config)
        scss_string = scss_template_string.format(**config)
        new_css = sass.compile(string=scss_string)
        style_string = &#34;&lt;style&gt;\n{0}\n&lt;/style&gt;&#34;.format(new_css)
        font_names = [config[&#34;headingFont&#34;], config[&#34;bodyFont&#34;]]
        links = self.get_fonts(font_names)
        return links + style_string

    def config_to_camelCase(self, config: typing.Dict) -&gt; typing.Dict:
        new_dict = dict()
        for key, val in config.items():
            new_dict.update({
                presalytics.story.util.to_camel_case(key): val
            })
        return new_dict</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.plugins.reveal_theme.RevealCustomTheme" href="/python-client/presalytics/lib/plugins/reveal_theme.html#presalytics.lib.plugins.reveal_theme.RevealCustomTheme">RevealCustomTheme</a></li>
<li><a title="presalytics.lib.plugins.base.StylePlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.StylePlugin">StylePlugin</a></li>
<li><a title="presalytics.lib.plugins.base.PluginBase" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase">PluginBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="presalytics.OoxmlTheme.config_to_camelCase"><code class="name flex">
<span>def <span class="ident">config_to_camelCase</span></span>(<span>self, config)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/ooxml.py#L35-L41" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def config_to_camelCase(self, config: typing.Dict) -&gt; typing.Dict:
    new_dict = dict()
    for key, val in config.items():
        new_dict.update({
            presalytics.story.util.to_camel_case(key): val
        })
    return new_dict</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.plugins.reveal_theme.RevealCustomTheme" href="/python-client/presalytics/lib/plugins/reveal_theme.html#presalytics.lib.plugins.reveal_theme.RevealCustomTheme">RevealCustomTheme</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.plugins.reveal_theme.RevealCustomTheme.defaults" href="/python-client/presalytics/lib/plugins/reveal_theme.html#presalytics.lib.plugins.reveal_theme.RevealCustomTheme.defaults">defaults</a></code></li>
<li><code><a title="presalytics.lib.plugins.reveal_theme.RevealCustomTheme.fonts_base_url" href="/python-client/presalytics/lib/plugins/reveal_theme.html#presalytics.lib.plugins.reveal_theme.RevealCustomTheme.fonts_base_url">fonts_base_url</a></code></li>
<li><code><a title="presalytics.lib.plugins.reveal_theme.RevealCustomTheme.get_base_scss" href="/python-client/presalytics/lib/plugins/reveal_theme.html#presalytics.lib.plugins.reveal_theme.RevealCustomTheme.get_base_scss">get_base_scss</a></code></li>
<li><code><a title="presalytics.lib.plugins.reveal_theme.RevealCustomTheme.get_font_link" href="/python-client/presalytics/lib/plugins/reveal_theme.html#presalytics.lib.plugins.reveal_theme.RevealCustomTheme.get_font_link">get_font_link</a></code></li>
<li><code><a title="presalytics.lib.plugins.reveal_theme.RevealCustomTheme.get_fonts" href="/python-client/presalytics/lib/plugins/reveal_theme.html#presalytics.lib.plugins.reveal_theme.RevealCustomTheme.get_fonts">get_fonts</a></code></li>
<li><code><a title="presalytics.lib.plugins.reveal_theme.RevealCustomTheme.get_tag" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase.get_tag">get_tag</a></code></li>
<li><code><a title="presalytics.lib.plugins.reveal_theme.RevealCustomTheme.to_style" href="/python-client/presalytics/lib/plugins/reveal_theme.html#presalytics.lib.plugins.reveal_theme.RevealCustomTheme.to_style">to_style</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.RevealConfigPlugin"><code class="flex name class">
<span>class <span class="ident">RevealConfigPlugin</span></span>
<span>(</span><span>**kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Allows users configure reveal.js initialization settings for when their
story is rendered via <code><a title="presalytics.story.revealer.Revealer" href="/python-client/presalytics/story/revealer.html#presalytics.story.revealer.Revealer">Revealer</a></code></p>
<p>For more information regarding reveal.js' initialization settings, please
refer to <a href="https://github.com/hakimel/reveal.js/#configuration">https://github.com/hakimel/reveal.js/#configuration</a></p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/reveal.py#L7-L284" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class RevealConfigPlugin(ext.ScriptPlugin, jinja.JinjaPluginMakerMixin):
    &#34;&#34;&#34;
    Allows users configure reveal.js initialization settings for when their
    story is rendered via `presalytics.story.revealer.Revealer`

    For more information regarding reveal.js&#39; initialization settings, please
    refer to https://github.com/hakimel/reveal.js/#configuration
    &#34;&#34;&#34;
    __plugin_name__ = &#39;reveal&#39;

    __dependencies__ = [
        {
            &#39;kind&#39;: &#39;script&#39;,
            &#39;name&#39;: &#39;external_scripts&#39;,
            &#39;config&#39;: {
                &#39;approved_scripts_key&#39;: &#39;reveal.base&#39;
            }
        },
        {
            &#39;kind&#39;: &#39;style&#39;,
            &#39;name&#39;: &#39;external_links&#39;,
            &#39;config&#39;: {
                &#39;approved_styles_key&#39;: &#39;reveal.base&#39;
            }
        },
        {
            &#39;kind&#39;: &#39;script&#39;,
            &#39;name&#39;: &#39;external_scripts&#39;,
            &#39;config&#39;: {
                &#39;approved_scripts_key&#39;: &#39;reveal.screenfull&#39;
            }
        },
        {
            &#39;kind&#39;: &#39;style&#39;,
            &#39;name&#39;: &#39;external_links&#39;,
            &#39;config&#39;: {
                &#39;approved_styles_key&#39;: &#39;reveal.toolbar&#39;
            }
        },
        {
            &#39;kind&#39;: &#39;style&#39;,
            &#39;name&#39;: &#39;external_links&#39;,
            &#39;config&#39;: {
                &#39;approved_styles_key&#39;: &#39;font-awesome&#39;
            }
        },
        {
            &#39;kind&#39;: &#39;script&#39;,
            &#39;name&#39;: &#39;external_scripts&#39;,
            &#39;config&#39;: {
                &#39;approved_scripts_key&#39;: &#39;reveal.toolbar&#39;
            }
        },
        {
            &#39;kind&#39;: &#39;style&#39;,
            &#39;name&#39;: &#39;external_links&#39;,
            &#39;config&#39;: {
                &#39;approved_styles_key&#39;: &#39;reveal.themes.white&#39;
            }
        }
    ]

    def to_script(self, config, **kwargs):
        reveal_config = copy.deepcopy(self.default_config)
        if config.get(&#34;reveal_params&#34;, None):
            reveal_config.update(config.pop(&#34;reveal_params&#34;))
        config.update({&#39;reveal_config&#39;: reveal_config})
        return self.render(config)

    template = &#34;&#34;&#34;
    &lt;script type=&#34;text/javascript&#34;&gt;
        window.addEventListener(&#39;toolbar-initialized&#39;, function(e) {
            var config = {{ reveal_config|tojson(indent=4) }};
            config.plugins = [window.presalyticsToolbar];
            Reveal.initialize(config);
        });
    &lt;/script&gt;
    &#34;&#34;&#34;
    &#34;&#34;&#34;
    The `&lt;script&gt;` fragment that get populated with a initialization data
    via the `presalytics.lib.plugins.jinja.JinjaPluginMakerMixin`
    &#34;&#34;&#34;

    default_config = {
        &#39;controls&#39;: True,  # Display presentation control arrows
        # Help the user learn the controls by providing hints, for example by
        # bouncing the down arrow when they first encounter a vertical slide
        &#39;controlsTutorial&#39;: True,

        # Determines where controls appear, &#34;edges&#34; or &#34;bottom-right&#34; #
        &#39;controlsLayout&#39;: &#39;bottom-right&#39;,

        # Visibility rule for backwards navigation arrows; &#34;faded&#34;, &#34;hidden&#34;
        # or &#34;visible&#34;
        &#39;controlsBackArrows&#39;: &#39;faded&#39;,

        # Display a presentation progress bar
        &#39;progress&#39;: True,

        # Display the page number of the current slide
        &#39;slideNumber&#39;: False,

        # Add the current slide number to the URL hash so that reloading the
        # page/copying the URL will return you to the same slide
        &#39;hash&#39;: False,

        # Push each slide change to the browser history. Implies `hash: true`
        &#39;history&#39;: False,

        # Enable keyboard shortcuts for navigation
        &#39;keyboard&#39;: True,

        # Enable the slide overview mode
        &#39;overview&#39;: True,

        # Vertical centering of slides
        &#39;center&#39;: True,

        # Enables touch navigation on devices with touch input
        &#39;touch&#39;: True,

        # Loop the presentation
        &#39;loop&#39;: True,

        # Change the presentation direction to be RTL
        &#39;rtl&#39;: False,

        # See https://github.com/hakimel/reveal.js/#navigation-mode
        &#39;navigationMode&#39;: &#39;default&#39;,

        # Randomizes the order of slides each time the presentation loads
        &#39;shuffle&#39;: False,

        # Turns fragments on and off globally
        &#39;fragments&#39;: True,

        # Flags whether to include the current fragment in the URL,
        # so that reloading brings you to the same fragment position #}
        &#39;fragmentInURL&#39;: False,

        # Flags if the presentation is running in an embedded mode,
        # i.e. contained within a limited portion of the screen #}
        &#39;embedded&#39;: False,

        # Flags if we should show a help overlay when the questionmark
        # key is pressed #}
        &#39;help&#39;: True,

        # Flags if speaker notes should be visible to all viewers
        &#39;showNotes&#39;: False,

        # Global override for autoplaying embedded media (video/audio/iframe)
        # - null: Media will only autoplay if data-autoplay is present
        # - true: All media will autoplay, regardless of individual setting
        # - false: No media will autoplay, regardless of individual setting
        &#39;autoPlayMedia&#39;: &#39;null&#39;,

        # Global override for preloading lazy-loaded iframes
        # - null: Iframes with data-src AND data-preload will be loaded when within
        #   the viewDistance, iframes with only data-src will be loaded when visible
        # - true: All iframes with data-src will be loaded when within the viewDistance
        # - false: All iframes with data-src will be loaded only when visible #}
        &#39;preloadIframes&#39;: &#39;null&#39;,

        # Number of milliseconds between automatically proceeding to the
        # next slide, disabled when set to 0, this value can be overwritten
        # by using a data-autoslide attribute on your slides #}
        &#39;autoSlide&#39;: 0,

        # Stop auto-sliding after user input
        &#39;autoSlideStoppable&#39;: True,

        # Use this method for navigation when auto-sliding
        &#39;autoSlideMethod&#39;: &#39;Reveal.navigateNext&#39;,

        # Specify the average time in seconds that you think you will spend
        # presenting each slide. This is used to show a pacing timer in the
        # speaker view
        &#39;defaultTiming&#39;: 120,

        # Enable slide navigation via mouse wheel
        &#39;mouseWheel&#39;: False,

        # Hide cursor if inactive
        &#39;hideInactiveCursor&#39;: True,

        # Time before the cursor is hidden (in ms)
        &#39;hideCursorTime&#39;: 5000,

        # Hides the address bar on mobile devices
        &#39;hideAddressBar&#39;: True,

        # Opens links in an iframe preview overlay
        #  Add `data-preview-link` and `data-preview-link=&#34;false&#34;` to customise each link
        # individually
        &#39;previewLinks&#39;: False,

        # Transition style
        &#39;transition&#39;: &#39;slide&#39;,  # none/fade/slide/convex/concave/zoom

        # Transition speed
        &#39;transitionSpeed&#39;: &#39;default&#39;,  # default/fast/slow

        # Transition style for full page slide backgrounds
        &#39;backgroundTransition&#39;: &#39;fade&#39;,  # none/fade/slide/convex/concave/zoom

        # Number of slides away from the current that are visible
        &#39;viewDistance&#39;: 3,

        # Parallax background image
        &#39;parallaxBackgroundImage&#39;: &#39;&#39;,  # e.g. &#34;&#39;https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg&#39;&#34;

        # Parallax background size
        &#39;parallaxBackgroundSize&#39;: &#39;&#39;,  # CSS syntax, e.g. &#34;2100px 900px&#34;

        # Number of pixels to move the parallax background per slide
        # - Calculated automatically unless specified
        # - Set to 0 to disable movement along an axis
        &#39;parallaxBackgroundHorizontal&#39;: &#39;null&#39;,
        &#39;parallaxBackgroundVertical&#39;: &#39;null&#39;,

        # The display mode that will be used to show slides
        &#39;display&#39;: &#39;block&#39;,

        # Allow for responsive presenation formats
        &#39;width&#39;: &#34;100%&#34;,
        &#39;height&#39;: &#34;100%&#34;,
        &#39;margin&#39;: 0,
        &#39;minScale&#39;: 1,
        &#39;maxScale&#39;: 1,

        # Presalytics toolbar
        &#39;showToolbar&#39;: True,

        &#39;toolbar&#39;: {
            # Specifies where the toolbar will be shown: &#39;top&#39; or &#39;bottom&#39;
            &#39;position&#39;: &#39;bottom&#39;,

            # Add button to toggle fullscreen mode for the presentation
            &#39;fullscreen&#39;: True,

            # Add button to toggle the overview mode on and off
            &#39;overview&#39;: True,

            # Add button to pause (hide) the presentation display
            &#39;pause&#39;: True,

            # Add button to show the speaker notes
            &#39;notes&#39;: False,

            # Add button to show the help overlay
            &#39;help&#39;: False,

            # If true, the reveal.js-menu will be moved into the toolbar.
            # Set to false to leave the menu on its own.
            &#39;captureMenu&#39;: True,

            # If true, the playback control will be moved into the toolbar.
            # This is only relevant if the presentation is configured to autoSlide.
            # Set to false to leave the menu on its own.
            &#39;capturePlaybackControl&#39;: True,

            # By default the menu will load it&#39;s own font-awesome library
            # icons. If your presentation needs to load a different
            # font-awesome library the &#39;loadIcons&#39; option can be set to false
            # and the menu will not attempt to load the font-awesome library.
            &#39;loadIcons&#39;: True,

            # Instructs the toolbar to load the Presaytics chat interface
            &#39;chat&#39;: True,

            # Shows the make pdf button
            &#39;pdf&#39;: True,
        }
    }
    &#34;&#34;&#34;
    A dictionary containing default values for rendering presalytics stories
    &#34;&#34;&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.plugins.base.ScriptPlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.ScriptPlugin">ScriptPlugin</a></li>
<li><a title="presalytics.lib.plugins.base.PluginBase" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase">PluginBase</a></li>
<li>abc.ABC</li>
<li><a title="presalytics.lib.plugins.jinja.JinjaPluginMakerMixin" href="/python-client/presalytics/lib/plugins/jinja.html#presalytics.lib.plugins.jinja.JinjaPluginMakerMixin">JinjaPluginMakerMixin</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.RevealConfigPlugin.config"><code class="name">var <span class="ident">config</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.RevealConfigPlugin.template"><code class="name">var <span class="ident">template</span></code></dt>
<dd>
<section class="desc"><p>The <code>&lt;script&gt;</code> fragment that get populated with a initialization data
via the <code><a title="presalytics.lib.plugins.jinja.JinjaPluginMakerMixin" href="/python-client/presalytics/lib/plugins/jinja.html#presalytics.lib.plugins.jinja.JinjaPluginMakerMixin">JinjaPluginMakerMixin</a></code></p></section>
</dd>
<dt id="presalytics.RevealConfigPlugin.default_config"><code class="name">var <span class="ident">default_config</span></code></dt>
<dd>
<section class="desc"><p>A dictionary containing default values for rendering presalytics stories</p></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.plugins.base.ScriptPlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.ScriptPlugin">ScriptPlugin</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.plugins.base.ScriptPlugin.get_tag" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase.get_tag">get_tag</a></code></li>
<li><code><a title="presalytics.lib.plugins.base.ScriptPlugin.to_script" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.ScriptPlugin.to_script">to_script</a></code></li>
</ul>
</li>
<li><code><b><a title="presalytics.lib.plugins.jinja.JinjaPluginMakerMixin" href="/python-client/presalytics/lib/plugins/jinja.html#presalytics.lib.plugins.jinja.JinjaPluginMakerMixin">JinjaPluginMakerMixin</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.plugins.jinja.JinjaPluginMakerMixin.render" href="/python-client/presalytics/lib/plugins/jinja.html#presalytics.lib.plugins.jinja.JinjaPluginMakerMixin.render">render</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.RevealCustomTheme"><code class="flex name class">
<span>class <span class="ident">RevealCustomTheme</span></span>
<span>(</span><span>**kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Plugin to for customizing reveal.js settings for a given story</p>
<p>This plugin's configuration dictionary keys and that load them in
as variable to a _variables.scss file and compiles the scss using the
sass python package.</p>
<p>See reveal.js' <a href="https://github.com/hakimel/reveal.js/blob/8a54118f43b91030f3965088d5e1c1c7598a5cd3/css/theme/README.md">Creating a Theme</a>
page for more information regarding configuration values.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/reveal_theme.py#L9-L131" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class RevealCustomTheme(presalytics.lib.plugins.base.StylePlugin):
    &#34;&#34;&#34;
    Plugin to for customizing reveal.js settings for a given story

    This plugin&#39;s configuration dictionary keys and that load them in
    as variable to a _variables.scss file and compiles the scss using the
    sass python package.

    See reveal.js&#39; [Creating a Theme](https://github.com/hakimel/reveal.js/blob/8a54118f43b91030f3965088d5e1c1c7598a5cd3/css/theme/README.md)
    page for more information regarding configuration values.
    &#34;&#34;&#34;
    __plugin_name__ = &#39;reveal_custom_theme&#39;
    defaults: typing.Dict[str, str]

    fonts_base_url = &#39;https://fonts.googleapis.com/css?family={0}&#39;
    &#34;&#34;&#34;
    Google fonts base url for loading fonts via a `&lt;link&gt;` tag
    &#34;&#34;&#34;

    def to_style(self, config, **kwargs):
        &#34;&#34;&#34;
        Returns compiled scss and links to download fonts
        &#34;&#34;&#34;
        scss_variables = self.defaults
        scss_variables.update(config)
        scss_string = self.get_base_scss(scss_variables)
        new_css = sass.compile(string=scss_string)
        style_string = &#34;&lt;style&gt;\n{0}\n&lt;/style&gt;&#34;.format(new_css)
        links = self.get_fonts(config[&#34;fonts&#34;])
        return links + style_string

    def get_fonts(self, fonts: typing.List[str]):
        &#34;&#34;&#34;
        Creates `&lt;link&gt;` tags from font names
        &#34;&#34;&#34;
        links = &#34;&#34;
        for font in fonts:
            link = self.get_font_link(font)
            if link:
                links = links + link + &#34;\n&#34;
        return links

    def get_font_link(self, font_name) -&gt; typing.Optional[str]:
        &#34;&#34;&#34;
        Tests whether a given font is available for download form google fonts.  Returns
        the link tag if available
        &#34;&#34;&#34;
        test_url = self.fonts_base_url.format(font_name)
        r = requests.get(test_url)
        if r.status_code == 200:
            return &#39;&lt;link href=&#34;{0}&#34; rel=&#34;stylesheet&#34;&gt;&#39;.format(test_url)
        else:
            return None

    def get_base_scss(self, scss_variables):
        &#34;&#34;&#34;
        loads the reveal.js scss files into string to be compiled by the sass module
        &#34;&#34;&#34;
        scss_folder = os.path.join(os.path.dirname(__file__), &#34;scss&#34;)
        mixins_file = os.path.join(scss_folder, &#34;reveal-mixins.scss&#34;)
        settings_file = os.path.join(scss_folder, &#34;reveal-settings.scss&#34;)
        theme_file = os.path.join(scss_folder, &#34;reveal-theme.scss&#34;)
        overrides_file = os.path.join(scss_folder, &#34;overrides.scss.tmpl&#34;)

        with open(mixins_file, &#39;r&#39;) as m:
            mixins = m.read()

        with open(settings_file, &#39;r&#39;) as s:
            settings = s.read()

        with open(theme_file, &#39;r&#39;) as t:
            theme = t.read()

        with open(overrides_file, &#39;r&#39;) as o:
            overrides_template = o.read()

        overrides = overrides_template.format(**scss_variables)

        scss_string = &#34;{0}\n{1}\n{2}\n{3}&#34;.format(mixins, settings, overrides, theme)
        return scss_string

    # Defaults to white theme parameters
    defaults = {
        # Background of the presentation
        &#34;background_color&#34;: &#34;#2b2b2b&#34;,

        # Primary/body text
        &#34;main_font&#34;: &#39;Lato&#39;,
        &#34;main_font_size&#34;: &#34;inherit&#34;,
        &#34;main_color&#34;: &#34;#eee&#34;,

        # Vertical spacing between blocks of text
        &#34;block_margin&#34;: &#34;20px&#34;,

        # Headings
        &#34;heading_margin&#34;: &#34;0 0 $blockMargin 0&#34;,
        &#34;heading_font&#34;: &#39;Lato&#39;,
        &#34;heading_color&#34;: &#34;#eee&#34;,
        &#34;heading_line_height&#34;: &#34;1.2&#34;,
        &#34;heading_letter_spacing&#34;: &#34;normal&#34;,
        &#34;heading_text_transform&#34;: &#34;none&#34;,
        &#34;heading_text_shadow&#34;: &#34;none&#34;,
        &#34;heading_font_weight&#34;: &#34;normal&#34;,

        &#34;heading_one_text_shadow&#34;: &#34;$headingTextShadow&#34;,
        &#34;heading_one_size&#34;: &#34;3.77em&#34;,
        &#34;heading_two_size&#34;: &#34;2.11em&#34;,
        &#34;heading_three_size&#34;: &#34;1.55em&#34;,
        &#34;heading_four_size&#34;: &#34;1.00em&#34;,

        &#34;code_font&#34;: &#34;monospace&#34;,

        # Links and actions
        &#34;link_color&#34;: &#34;#13DAEC&#34;,
        &#34;linkColorHover&#34;: &#34;lighten( $linkColor, 20% )&#34;,

        # Text selection
        &#34;selection_background_color&#34;: &#34;#FF5E99&#34;,
        &#34;selection_color&#34;: &#34;#fff&#34;
    }
    &#34;&#34;&#34;
    Default reveal.js theme configuration for presalytics stories
    &#34;&#34;&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.plugins.base.StylePlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.StylePlugin">StylePlugin</a></li>
<li><a title="presalytics.lib.plugins.base.PluginBase" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase">PluginBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="presalytics.lib.plugins.ooxml.OoxmlTheme" href="/python-client/presalytics/lib/plugins/ooxml.html#presalytics.lib.plugins.ooxml.OoxmlTheme">OoxmlTheme</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.RevealCustomTheme.fonts_base_url"><code class="name">var <span class="ident">fonts_base_url</span></code></dt>
<dd>
<section class="desc"><p>Google fonts base url for loading fonts via a <code>&lt;link&gt;</code> tag</p></section>
</dd>
<dt id="presalytics.RevealCustomTheme.defaults"><code class="name">var <span class="ident">defaults</span></code></dt>
<dd>
<section class="desc"><p>Default reveal.js theme configuration for presalytics stories</p></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.RevealCustomTheme.to_style"><code class="name flex">
<span>def <span class="ident">to_style</span></span>(<span>self, config, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Returns compiled scss and links to download fonts</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/reveal_theme.py#L28-L38" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def to_style(self, config, **kwargs):
    &#34;&#34;&#34;
    Returns compiled scss and links to download fonts
    &#34;&#34;&#34;
    scss_variables = self.defaults
    scss_variables.update(config)
    scss_string = self.get_base_scss(scss_variables)
    new_css = sass.compile(string=scss_string)
    style_string = &#34;&lt;style&gt;\n{0}\n&lt;/style&gt;&#34;.format(new_css)
    links = self.get_fonts(config[&#34;fonts&#34;])
    return links + style_string</code></pre>
</details>
</dd>
<dt id="presalytics.RevealCustomTheme.get_fonts"><code class="name flex">
<span>def <span class="ident">get_fonts</span></span>(<span>self, fonts)</span>
</code></dt>
<dd>
<section class="desc"><p>Creates <code>&lt;link&gt;</code> tags from font names</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/reveal_theme.py#L40-L49" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_fonts(self, fonts: typing.List[str]):
    &#34;&#34;&#34;
    Creates `&lt;link&gt;` tags from font names
    &#34;&#34;&#34;
    links = &#34;&#34;
    for font in fonts:
        link = self.get_font_link(font)
        if link:
            links = links + link + &#34;\n&#34;
    return links</code></pre>
</details>
</dd>
<dt id="presalytics.RevealCustomTheme.get_font_link"><code class="name flex">
<span>def <span class="ident">get_font_link</span></span>(<span>self, font_name)</span>
</code></dt>
<dd>
<section class="desc"><p>Tests whether a given font is available for download form google fonts.
Returns
the link tag if available</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/reveal_theme.py#L51-L61" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_font_link(self, font_name) -&gt; typing.Optional[str]:
    &#34;&#34;&#34;
    Tests whether a given font is available for download form google fonts.  Returns
    the link tag if available
    &#34;&#34;&#34;
    test_url = self.fonts_base_url.format(font_name)
    r = requests.get(test_url)
    if r.status_code == 200:
        return &#39;&lt;link href=&#34;{0}&#34; rel=&#34;stylesheet&#34;&gt;&#39;.format(test_url)
    else:
        return None</code></pre>
</details>
</dd>
<dt id="presalytics.RevealCustomTheme.get_base_scss"><code class="name flex">
<span>def <span class="ident">get_base_scss</span></span>(<span>self, scss_variables)</span>
</code></dt>
<dd>
<section class="desc"><p>loads the reveal.js scss files into string to be compiled by the sass module</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/reveal_theme.py#L63-L88" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_base_scss(self, scss_variables):
    &#34;&#34;&#34;
    loads the reveal.js scss files into string to be compiled by the sass module
    &#34;&#34;&#34;
    scss_folder = os.path.join(os.path.dirname(__file__), &#34;scss&#34;)
    mixins_file = os.path.join(scss_folder, &#34;reveal-mixins.scss&#34;)
    settings_file = os.path.join(scss_folder, &#34;reveal-settings.scss&#34;)
    theme_file = os.path.join(scss_folder, &#34;reveal-theme.scss&#34;)
    overrides_file = os.path.join(scss_folder, &#34;overrides.scss.tmpl&#34;)

    with open(mixins_file, &#39;r&#39;) as m:
        mixins = m.read()

    with open(settings_file, &#39;r&#39;) as s:
        settings = s.read()

    with open(theme_file, &#39;r&#39;) as t:
        theme = t.read()

    with open(overrides_file, &#39;r&#39;) as o:
        overrides_template = o.read()

    overrides = overrides_template.format(**scss_variables)

    scss_string = &#34;{0}\n{1}\n{2}\n{3}&#34;.format(mixins, settings, overrides, theme)
    return scss_string</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.plugins.base.StylePlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.StylePlugin">StylePlugin</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.plugins.base.StylePlugin.get_tag" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase.get_tag">get_tag</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.JinjaTemplateBuilder"><code class="flex name class">
<span>class <span class="ident">JinjaTemplateBuilder</span></span>
<span>(</span><span>page, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Base class for building objects that render html from <code><a title="presalytics.story.outline.Page" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.Page">Page</a></code>
objects that implementing the <a href="https://jinja.palletsprojects.com/">Jinja2</a>
python library.</p>
<p>Instances of this class will look for templates located at file location identified by the
<code>__template_file__</code> attribute.
If not template is found, the content in the <code>template_string</code>
attribute will be used. Templates should call each widget's <code>to_html()</code> method in a placeholder
in order to generate valid html for the page.</p>
<p><em>About building templates</em>: Templates are passed a <code>widgets</code> attribute and a <code>widget_index</code>
integer (initialized at 0) as part of the context during rendering,. To render
multiple widgets on a page, the following pattern can be used inside of templates to
increment through the widgets as the jinja2 rendering engine moves through the template:</p>
<pre><code>{{ widgets[widget_index.next()].render() }}  // renders widget and increments widget_index
</code></pre>
<p>Please also note that if <code>&lt;script&gt;</code> tags are included in the template, they will be
stripped out downstream by a <code><a title="presalytics.story.components.Renderer" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer">Renderer</a></code> for security
reasons.
Scripts included in templates will not make it to the browser.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>page</code></strong> :&ensp;<code><a title="presalytics.story.outline.Page" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.Page">Page</a></code></dt>
<dd>The page to be rendered</dd>
</dl>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>__template_file__</code></strong> :&ensp;<code>str</code></dt>
<dd>The filename to an html file containing a fragment that will be rendered into
a page by a <code><a title="presalytics.story.components.Renderer" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer">Renderer</a></code></dd>
<dt><strong><code>__template_paths__</code></strong> :&ensp;<code>list</code> of <code>str</code></dt>
<dd>user-defined filepaths to directories where Jinja2 should look for the <code>__template_file__</code></dd>
<dt><strong><code>__css__</code></strong> :&ensp;<code>list</code> of <code>str</code></dt>
<dd>Each str in this list is a key that maps to an entry in the
<code><a title="presalytics.lib.plugins.local.LocalStylesPlugin.LOCAL_STYLES_MAP" href="/python-client/presalytics/lib/plugins/local.html#presalytics.lib.plugins.local.LocalStylesPlugin.LOCAL_STYLES_MAP">LocalStylesPlugin.LOCAL_STYLES_MAP</a></code>. Ids matched here
load the css files as a dependent plugin.</dd>
<dt><strong><code>template_paths</code></strong> :&ensp;<code>list</code> of <code>str</code></dt>
<dd>The folders Jinja2 will look in. Includes that html directory adjacent to this <code>__file__</code>,
appending with the files in the <code>__template_paths__</code></dd>
<dt><strong><code>widgets</code></strong> :&ensp;<code>list</code> of <code>subclass instances</code> of <code><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></code></dt>
<dd>Widget to be rendered into the placeholders in the template identified by <code>__template_file__</code></dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/templates/base.py#L41-L241" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class JinjaTemplateBuilder(presalytics.story.components.PageTemplateBase):
    &#34;&#34;&#34;
    Base class for building objects that render html from `presalytics.story.outline.Page`
    objects that implementing the [Jinja2](https://jinja.palletsprojects.com/)
    python library.

    Instances of this class will look for templates located at file location identified by the
    `__template_file__` attribute.  If not template is found, the content in the `template_string`
    attribute will be used. Templates should call each widget&#39;s `to_html()` method in a placeholder
    in order to generate valid html for the page.

    *About building templates*: Templates are passed a `widgets` attribute and a `widget_index`
    integer (initialized at 0) as part of the context during rendering,. To render
    multiple widgets on a page, the following pattern can be used inside of templates to
    increment through the widgets as the jinja2 rendering engine moves through the template:

        {{ widgets[widget_index.next()].render() }}  // renders widget and increments widget_index

    Please also note that if `&lt;script&gt;` tags are included in the template, they will be
    stripped out downstream by a `presalytics.story.components.Renderer` for security
    reasons.  Scripts included in templates will not make it to the browser.

    Parameters
    ----------
    page : presalytics.story.outline.Page
        The page to be rendered

    Attributes
    ----------
    __template_file__ : str
        The filename to an html file containing a fragment that will be rendered into
        a page by a `presalytics.story.components.Renderer`

    __template_paths__ : list of str
        user-defined filepaths to directories where Jinja2 should look for the `__template_file__`

    __css__ : list of str
        Each str in this list is a key that maps to an entry in the
        `presalytics.lib.plugins.local.LocalStylesPlugin.LOCAL_STYLES_MAP`. Ids matched here
        load the css files as a dependent plugin.

    template_paths : list of str
        The folders Jinja2 will look in. Includes that html directory adjacent to this `__file__`,
        appending with the files in the `__template_paths__`

    widgets : list of subclass instances of presalytics.story.components.WidgetBase
        Widget to be rendered into the placeholders in the template identified by `__template_file__`

    &#34;&#34;&#34;
    __css__: typing.Sequence[str]
    __template_file__: str
    __template_paths__: typing.List[str]
    template_paths: typing.List[str]

    __template_paths__ = []
    __css__ = []

    class WidgetIndexer(object):
        &#34;&#34;&#34;
        A counter class for

        call `widgetindex.next()` in html templates to move this the widget list
        &#34;&#34;&#34;

        def __init__(self):
            self._val = 0

        def next(self):
            &#34;&#34;&#34;
            Returns the current widget index and increments the value for the next call
            &#34;&#34;&#34;
            cur = self._val
            self._val += 1
            return cur

    def __init__(self, page: &#39;Page&#39;, **kwargs) -&gt; None:
        super().__init__(page, **kwargs)
        pkg_templates = os.path.join(os.path.dirname(__file__), &#34;html&#34;)
        self.template_paths = [pkg_templates, os.getcwd()]
        if len(self.__template_paths__) &gt; 0:
            self.template_paths[0:0] = self.__template_paths__
        self.is_template_local = self.check_for_file()
        if self.is_template_local:
            self.template_string = self.read_template_string()
        elif self.outline_page.additional_properties.get(&#34;template_string&#34;, None):
            self.template_string = self.outline_page.additional_properties.get(&#34;template_string&#34;)
        else:
            self.template_string = None
        if len(kwargs.keys()) &gt; 0:
            self.outline_page.additional_properties.update(kwargs)

    @classmethod
    def deserialize(cls, component, **kwargs):
        return cls(component, **kwargs)

    @util.classproperty
    def __plugins__(cls):
        plugin_list = []
        for id in cls.__css__:
            new_item = {
                &#39;kind&#39;: &#39;style&#39;,
                &#39;name&#39;: &#39;local&#39;,
                &#39;config&#39;: {
                    &#39;css_file_id&#39;: id
                }
            }
            plugin_list.append(new_item)
        return plugin_list

    def serialize(self):
        updated_plugins = []
        for plugin_data in self.__plugins__:
            updated_plugins.append(presalytics.story.outline.Plugin(**plugin_data))
        self.outline_page.plugins = updated_plugins
        if self.template_string:
            self.outline_page.additional_properties[&#34;template_string&#34;] = self.template_string
        return self.outline_page

    def get_template_name(self):
        &#34;&#34;&#34;
        Requires subclasses have either a `__template_file__` class property, or override this method
        &#34;&#34;&#34;
        if self.__template_file__:
            return self.__template_file__
        else:
            raise NotImplementedError

    def render(self, **kwargs):
        &#34;&#34;&#34;
        Renders the widgets to html
        &#34;&#34;&#34;
        if self.is_template_local:
            return self.render_from_file(**kwargs)
        elif self.template_string:
            return self.render_from_backup_string(**kwargs)
        else:
            raise presalytics.lib.exceptions.MissingConfigException(&#34;Missing __template_file__: {}&#34;.format(self.get_template_name()))

    def _make_context(self):
        context = {
            &#34;widgets&#34;: self.widgets,
            &#34;widget_index&#34;: self.WidgetIndexer()
        }
        if self.outline_page.additional_properties:
            context.update(self.outline_page.additional_properties)
            context.pop(&#34;template_string&#34;, None)
        return context

    def render_from_file(self, **kwargs) -&gt; str:
        &#34;&#34;&#34;
        Returns rendered html with widgets rendered into template placeholders
        &#34;&#34;&#34;
        template = self.load_jinja_template()
        context = self._make_context()
        return template.render(**context)

    def render_from_backup_string(self, **kwargs):
        &#34;&#34;&#34;
        Returns rendered html with widgets rendered into template placeholders
        &#34;&#34;&#34;
        context = self._make_context()
        options = {
            &#34;loader&#34;: jinja2.BaseLoader()
        }
        if context.get(&#34;jinja_options&#34;, None):
            options.update(context.pop(&#34;jinja_options&#34;))
        env = jinja2.Environment(**options)
        env.filters[&#39;htmlize&#39;] = htmlize
        template = env.from_string(self.template_string)
        return template.render(**context)

    def read_template_string(self) -&gt; typing.Optional[str]:
        &#34;&#34;&#34;
        Finds the template file and reads it into a string
        &#34;&#34;&#34;
        for _dir in self.template_paths:
            fpath = os.path.join(_dir, self.get_template_name())
            if os.path.exists(fpath):
                with open(fpath, &#39;r&#39;) as f:
                    template_string = f.read()
                return template_string
        return None

    def load_jinja_template(self) -&gt; jinja2.Template:
        &#34;&#34;&#34;
        Uses the fileloader to load a local template file into the jinja2 environment
        &#34;&#34;&#34;
        loader = jinja2.FileSystemLoader(self.template_paths)
        env = jinja2.Environment(loader=loader)
        env.filters[&#39;htmlize&#39;] = htmlize
        return env.get_template(self.get_template_name())

    def check_for_file(self):
        &#34;&#34;&#34;
        Checks whether `__template_file__` exists locally
        &#34;&#34;&#34;
        for _dir in self.template_paths:
            fpath = os.path.join(_dir, self.get_template_name())
            if os.path.exists(fpath):
                return True
        return False</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.components.PageTemplateBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.PageTemplateBase">PageTemplateBase</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="presalytics.lib.templates.base.BootstrapCustomTemplate" href="/python-client/presalytics/lib/templates/base.html#presalytics.lib.templates.base.BootstrapCustomTemplate">BootstrapCustomTemplate</a></li>
<li><a title="presalytics.lib.templates.base.TitleWithSingleItem" href="/python-client/presalytics/lib/templates/base.html#presalytics.lib.templates.base.TitleWithSingleItem">TitleWithSingleItem</a></li>
<li><a title="presalytics.lib.templates.base.TwoUpWithTitle" href="/python-client/presalytics/lib/templates/base.html#presalytics.lib.templates.base.TwoUpWithTitle">TwoUpWithTitle</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.JinjaTemplateBuilder.template_paths"><code class="name">var <span class="ident">template_paths</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.JinjaTemplateBuilder.WidgetIndexer"><code class="name">var <span class="ident">WidgetIndexer</span></code></dt>
<dd>
<section class="desc"><p>A counter class for</p>
<p>call <code>widgetindex.next()</code> in html templates to move this the widget list</p></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.JinjaTemplateBuilder.get_template_name"><code class="name flex">
<span>def <span class="ident">get_template_name</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Requires subclasses have either a <code>__template_file__</code> class property, or override this method</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/templates/base.py#L159-L166" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_template_name(self):
    &#34;&#34;&#34;
    Requires subclasses have either a `__template_file__` class property, or override this method
    &#34;&#34;&#34;
    if self.__template_file__:
        return self.__template_file__
    else:
        raise NotImplementedError</code></pre>
</details>
</dd>
<dt id="presalytics.JinjaTemplateBuilder.render"><code class="name flex">
<span>def <span class="ident">render</span></span>(<span>self, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Renders the widgets to html</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/templates/base.py#L168-L177" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def render(self, **kwargs):
    &#34;&#34;&#34;
    Renders the widgets to html
    &#34;&#34;&#34;
    if self.is_template_local:
        return self.render_from_file(**kwargs)
    elif self.template_string:
        return self.render_from_backup_string(**kwargs)
    else:
        raise presalytics.lib.exceptions.MissingConfigException(&#34;Missing __template_file__: {}&#34;.format(self.get_template_name()))</code></pre>
</details>
</dd>
<dt id="presalytics.JinjaTemplateBuilder.render_from_file"><code class="name flex">
<span>def <span class="ident">render_from_file</span></span>(<span>self, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Returns rendered html with widgets rendered into template placeholders</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/templates/base.py#L189-L195" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def render_from_file(self, **kwargs) -&gt; str:
    &#34;&#34;&#34;
    Returns rendered html with widgets rendered into template placeholders
    &#34;&#34;&#34;
    template = self.load_jinja_template()
    context = self._make_context()
    return template.render(**context)</code></pre>
</details>
</dd>
<dt id="presalytics.JinjaTemplateBuilder.render_from_backup_string"><code class="name flex">
<span>def <span class="ident">render_from_backup_string</span></span>(<span>self, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Returns rendered html with widgets rendered into template placeholders</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/templates/base.py#L197-L210" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def render_from_backup_string(self, **kwargs):
    &#34;&#34;&#34;
    Returns rendered html with widgets rendered into template placeholders
    &#34;&#34;&#34;
    context = self._make_context()
    options = {
        &#34;loader&#34;: jinja2.BaseLoader()
    }
    if context.get(&#34;jinja_options&#34;, None):
        options.update(context.pop(&#34;jinja_options&#34;))
    env = jinja2.Environment(**options)
    env.filters[&#39;htmlize&#39;] = htmlize
    template = env.from_string(self.template_string)
    return template.render(**context)</code></pre>
</details>
</dd>
<dt id="presalytics.JinjaTemplateBuilder.read_template_string"><code class="name flex">
<span>def <span class="ident">read_template_string</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Finds the template file and reads it into a string</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/templates/base.py#L212-L222" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def read_template_string(self) -&gt; typing.Optional[str]:
    &#34;&#34;&#34;
    Finds the template file and reads it into a string
    &#34;&#34;&#34;
    for _dir in self.template_paths:
        fpath = os.path.join(_dir, self.get_template_name())
        if os.path.exists(fpath):
            with open(fpath, &#39;r&#39;) as f:
                template_string = f.read()
            return template_string
    return None</code></pre>
</details>
</dd>
<dt id="presalytics.JinjaTemplateBuilder.load_jinja_template"><code class="name flex">
<span>def <span class="ident">load_jinja_template</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Uses the fileloader to load a local template file into the jinja2 environment</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/templates/base.py#L224-L231" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def load_jinja_template(self) -&gt; jinja2.Template:
    &#34;&#34;&#34;
    Uses the fileloader to load a local template file into the jinja2 environment
    &#34;&#34;&#34;
    loader = jinja2.FileSystemLoader(self.template_paths)
    env = jinja2.Environment(loader=loader)
    env.filters[&#39;htmlize&#39;] = htmlize
    return env.get_template(self.get_template_name())</code></pre>
</details>
</dd>
<dt id="presalytics.JinjaTemplateBuilder.check_for_file"><code class="name flex">
<span>def <span class="ident">check_for_file</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Checks whether <code>__template_file__</code> exists locally</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/templates/base.py#L233-L241" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def check_for_file(self):
    &#34;&#34;&#34;
    Checks whether `__template_file__` exists locally
    &#34;&#34;&#34;
    for _dir in self.template_paths:
        fpath = os.path.join(_dir, self.get_template_name())
        if os.path.exists(fpath):
            return True
    return False</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.story.components.PageTemplateBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.PageTemplateBase">PageTemplateBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.story.components.PageTemplateBase.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.story.components.PageTemplateBase.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.story.components.PageTemplateBase.get_page_widgets" href="/python-client/presalytics/story/components.html#presalytics.story.components.PageTemplateBase.get_page_widgets">get_page_widgets</a></code></li>
<li><code><a title="presalytics.story.components.PageTemplateBase.load_widget" href="/python-client/presalytics/story/components.html#presalytics.story.components.PageTemplateBase.load_widget">load_widget</a></code></li>
<li><code><a title="presalytics.story.components.PageTemplateBase.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.serialize">serialize</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.WidgetBase"><code class="flex name class">
<span>class <span class="ident">WidgetBase</span></span>
<span>(</span><span>name, *args, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Inherit from this base class to create widget components that can be rendered to html via the
<code><a title="presalytics.story.components.Renderer" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer">Renderer</a></code> class.
This component also needs to build a method
that allows the widget to be serialzed into a <code><a title="presalytics.story.outline.Widget" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.Widget">Widget</a></code> object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>widget</code></strong> :&ensp;<code>Widget</code></dt>
<dd>A <code><a title="presalytics.story.outline.Widget" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.Widget">Widget</a></code> object use for initialized the component class.</dd>
</dl>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>outline_widget</code></strong> :&ensp;<code>Widget</code></dt>
<dd>A <code><a title="presalytics.story.outline.Widget" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.Widget">Widget</a></code> object</dd>
<dt><strong><code>nonce</code></strong> :&ensp;<code>str</code></dt>
<dd>A "Number used ONCE" that will be used as cache key for rendering subdocuments.
The nonce is included the Url that pulls the story from the Presalytics Story API.
This nonce is to be used during the rendering process by the <code>to_html</code> method for
widgets that implement this feature.</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L124-L261" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class WidgetBase(ComponentBase):
    &#34;&#34;&#34;
    Inherit from this base class to create widget components that can be rendered to html via the
    `presalytics.story.components.Renderer` class.  This component also needs to build a method
    that allows the widget to be serialzed into a `presalytics.story.outline.Widget` object.

    Parameters
    ----------
    widget: Widget
        A `presalytics.story.outline.Widget` object use for initialized the component class.

    Attributes
    ----------
    outline_widget: Widget
        A `presalytics.story.outline.Widget` object

    nonce: str
        A &#34;Number used ONCE&#34; that will be used as cache key for rendering subdocuments.
        The nonce is included the Url that pulls the story from the Presalytics Story API.
        This nonce is to be used during the rendering process by the `to_html` method for
        widgets that implement this feature.
    &#34;&#34;&#34;
    outline_widget: typing.Optional[&#39;Widget&#39;]

    __component_type__ = &#39;widget&#39;

    def __init__(self, name, *args, **kwargs) -&gt; None:
        super(WidgetBase, self).__init__(*args, **kwargs)
        self.name = name
        self.id = kwargs.get(&#39;id&#39;, None)
        self.outline_widget = None
        self.nonce = str(uuid.uuid4())

    def render(self, **kwargs):
        subdocument = self.create_subdocument(**kwargs)
        if subdocument:
            try:
                self.cache_subdocument(subdocument)
            except Exception as ex:
                logger.exception(ex)
        return self.to_html(**kwargs)

    def cache_subdocument(self, subdocument: str) -&gt; bool:
        subdocument_encoded = base64.b64encode(subdocument.encode(&#39;utf-8&#39;)).decode(&#39;utf-8&#39;)
        client = self.get_client()
        access_token = client.token_util.token.get(&#39;access_token&#39;, None)
        if access_token:
            api_user_id = client.oidc.get_user_id(access_token)
            payload = {
                &#39;user_id&#39;: api_user_id,
                &#39;subdocument&#39;: subdocument_encoded,
                &#39;nonce&#39;: self.nonce
            }
            client.story.cache_post(payload)
            return True
        return False

    def create_subdocument(self, **kwargs) -&gt; typing.Optional[str]:
        &#34;&#34;&#34;
        Returns an html document that will be rendered by browser.  If a `str` is returned,
        then the html subdocument is cached into the story API for retreival by the browser after
        rendering.  Widgets that render `&lt;iframe&gt;`, `&lt;object&gt;`, or `&lt;embed&gt;` tags should override
        this method to return the subdocument that will be rendered by the browser.

        Returns
        ----------

        An `str` containing an html document if implemented, otherwise None.
        &#34;&#34;&#34;
        return None

    @abc.abstractmethod
    def to_html(self, data: typing.Dict = None, **kwargs) -&gt; str:
        &#34;&#34;&#34;
        Returns valid html that renders the widget in a browser.

        Parameters
        ----------
        data: dict
            The data parameter is a dictionary should contain the minimum amount of that is required to
            successfully render the object.  As the widget is update, data control how the display of
            information changes.

        **kwargs:
            Optional keyword arguments can be used in subclass to modify the behavior of the `to_html` function.
            these keyword arguments should be invariant through successive updates to the chart.  For example,
            keyword arguments could control the styling of the widget, which should not change as the data in
            the object (e.g., a chart) is updated.  Keyword arguments are loaded via `additional_properties`
            parameter in in the `presalytics.story.outline.Widget` object.

        Returns
        ----------
        A str of containing an html fragment that will be loaded into a template in successive operations
        &#34;&#34;&#34;
        raise NotImplementedError

    @abc.abstractmethod
    def serialize(self, **kwargs) -&gt; &#39;Widget&#39;:
        &#34;&#34;&#34;
        Creates `presalytics.story.outline.Widget` object from instance data. This widget should
        have the correct `name`, `data` and `additional_properties` so the same widget can be reconstituted
        via the to_html method, given the same set of data.

        Typically, this method will call an update method that run a local script with updates this
        Widget&#39;s data Dictionary prior being loading into the Widget outline object for serialization.

        Parameters
        ----------
        **kwargs:
            Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.
            these keyword arguments should be be invariant through successive updates to the chart. Overrides
            for this widgets default additional_properties should be loaded via these keyword arguments.

        &#34;&#34;&#34;
        raise NotImplementedError

    @classmethod
    def deserialize(cls, component: &#39;Widget&#39;, **kwargs) -&gt; &#39;WidgetBase&#39;:
        &#34;&#34;&#34;
        Creates an instance of the widget from the data object in the `presalytics.story.outline.Widget`
        object. This method exists to ensure widgets can be portable across environments.  To clarify,
        widgets built on the client-side via the `__init__` method can be reconstructed server-side via
        the deserialize method.  This allows decoupling of the widget generation/updating of data and
        the rendering of the widget in a UI.  Renderers (e.g., `presalytics.story.revealer.Revealer` object)
        need not know about how the data get updated, but can update the graphic with data generated by
        the widget when the serialize method is called.

        Parameters
        ----------

        widget: Widget
            A `presalytics.story.outline.Widget` object

        Returns
        ----------
        `presalytics.story.components.WidgetBase` subclass instance
        &#34;&#34;&#34;
        raise NotImplementedError</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="presalytics.lib.widgets.chart.ChartWidget" href="/python-client/presalytics/lib/widgets/chart.html#presalytics.lib.widgets.chart.ChartWidget">ChartWidget</a></li>
<li><a title="presalytics.lib.widgets.d3.D3Widget" href="/python-client/presalytics/lib/widgets/d3.html#presalytics.lib.widgets.d3.D3Widget">D3Widget</a></li>
<li><a title="presalytics.lib.widgets.data_table.DataTableWidget" href="/python-client/presalytics/lib/widgets/data_table.html#presalytics.lib.widgets.data_table.DataTableWidget">DataTableWidget</a></li>
<li><a title="presalytics.lib.widgets.markdown.MarkdownWidget" href="/python-client/presalytics/lib/widgets/markdown.html#presalytics.lib.widgets.markdown.MarkdownWidget">MarkdownWidget</a></li>
<li><a title="presalytics.lib.widgets.matplotlib.MatplotlibFigure" href="/python-client/presalytics/lib/widgets/matplotlib.html#presalytics.lib.widgets.matplotlib.MatplotlibFigure">MatplotlibFigure</a></li>
<li><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase">OoxmlWidgetBase</a></li>
<li><a title="presalytics.lib.widgets.url.UrlWidget" href="/python-client/presalytics/lib/widgets/url.html#presalytics.lib.widgets.url.UrlWidget">UrlWidget</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.WidgetBase.outline_widget"><code class="name">var <span class="ident">outline_widget</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Static methods</h3>
<dl>
<dt id="presalytics.WidgetBase.deserialize"><code class="name flex">
<span>def <span class="ident">deserialize</span></span>(<span>component, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Creates an instance of the widget from the data object in the <code><a title="presalytics.story.outline.Widget" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.Widget">Widget</a></code>
object. This method exists to ensure widgets can be portable across environments.
To clarify,
widgets built on the client-side via the <code>__init__</code> method can be reconstructed server-side via
the deserialize method.
This allows decoupling of the widget generation/updating of data and
the rendering of the widget in a UI.
Renderers (e.g., <code><a title="presalytics.story.revealer.Revealer" href="/python-client/presalytics/story/revealer.html#presalytics.story.revealer.Revealer">Revealer</a></code> object)
need not know about how the data get updated, but can update the graphic with data generated by
the widget when the serialize method is called.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>widget</code></strong> :&ensp;<code>Widget</code></dt>
<dd>A <code><a title="presalytics.story.outline.Widget" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.Widget">Widget</a></code> object</dd>
</dl>
<h2 id="returns">Returns</h2>
<p><code><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></code> subclass instance</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L240-L261" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def deserialize(cls, component: &#39;Widget&#39;, **kwargs) -&gt; &#39;WidgetBase&#39;:
    &#34;&#34;&#34;
    Creates an instance of the widget from the data object in the `presalytics.story.outline.Widget`
    object. This method exists to ensure widgets can be portable across environments.  To clarify,
    widgets built on the client-side via the `__init__` method can be reconstructed server-side via
    the deserialize method.  This allows decoupling of the widget generation/updating of data and
    the rendering of the widget in a UI.  Renderers (e.g., `presalytics.story.revealer.Revealer` object)
    need not know about how the data get updated, but can update the graphic with data generated by
    the widget when the serialize method is called.

    Parameters
    ----------

    widget: Widget
        A `presalytics.story.outline.Widget` object

    Returns
    ----------
    `presalytics.story.components.WidgetBase` subclass instance
    &#34;&#34;&#34;
    raise NotImplementedError</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.WidgetBase.cache_subdocument"><code class="name flex">
<span>def <span class="ident">cache_subdocument</span></span>(<span>self, subdocument)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L166-L179" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def cache_subdocument(self, subdocument: str) -&gt; bool:
    subdocument_encoded = base64.b64encode(subdocument.encode(&#39;utf-8&#39;)).decode(&#39;utf-8&#39;)
    client = self.get_client()
    access_token = client.token_util.token.get(&#39;access_token&#39;, None)
    if access_token:
        api_user_id = client.oidc.get_user_id(access_token)
        payload = {
            &#39;user_id&#39;: api_user_id,
            &#39;subdocument&#39;: subdocument_encoded,
            &#39;nonce&#39;: self.nonce
        }
        client.story.cache_post(payload)
        return True
    return False</code></pre>
</details>
</dd>
<dt id="presalytics.WidgetBase.create_subdocument"><code class="name flex">
<span>def <span class="ident">create_subdocument</span></span>(<span>self, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Returns an html document that will be rendered by browser.
If a <code>str</code> is returned,
then the html subdocument is cached into the story API for retreival by the browser after
rendering.
Widgets that render <code>&lt;iframe&gt;</code>, <code>&lt;object&gt;</code>, or <code>&lt;embed&gt;</code> tags should override
this method to return the subdocument that will be rendered by the browser.</p>
<h2 id="returns">Returns</h2>
<p>An <code>str</code> containing an html document if implemented, otherwise None.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L181-L193" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def create_subdocument(self, **kwargs) -&gt; typing.Optional[str]:
    &#34;&#34;&#34;
    Returns an html document that will be rendered by browser.  If a `str` is returned,
    then the html subdocument is cached into the story API for retreival by the browser after
    rendering.  Widgets that render `&lt;iframe&gt;`, `&lt;object&gt;`, or `&lt;embed&gt;` tags should override
    this method to return the subdocument that will be rendered by the browser.

    Returns
    ----------

    An `str` containing an html document if implemented, otherwise None.
    &#34;&#34;&#34;
    return None</code></pre>
</details>
</dd>
<dt id="presalytics.WidgetBase.to_html"><code class="name flex">
<span>def <span class="ident">to_html</span></span>(<span>self, data=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Returns valid html that renders the widget in a browser.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>data</code></strong> :&ensp;<code>dict</code></dt>
<dd>The data parameter is a dictionary should contain the minimum amount of that is required to
successfully render the object.
As the widget is update, data control how the display of
information changes.</dd>
</dl>
<p>**kwargs:
Optional keyword arguments can be used in subclass to modify the behavior of the <code>to_html</code> function.
these keyword arguments should be invariant through successive updates to the chart.
For example,
keyword arguments could control the styling of the widget, which should not change as the data in
the object (e.g., a chart) is updated.
Keyword arguments are loaded via <code>additional_properties</code>
parameter in in the <code><a title="presalytics.story.outline.Widget" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.Widget">Widget</a></code> object.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>A str</code> of <code>containing an html fragment that will be loaded into a template in successive operations</code></dt>
<dd>&nbsp;</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L195-L218" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@abc.abstractmethod
def to_html(self, data: typing.Dict = None, **kwargs) -&gt; str:
    &#34;&#34;&#34;
    Returns valid html that renders the widget in a browser.

    Parameters
    ----------
    data: dict
        The data parameter is a dictionary should contain the minimum amount of that is required to
        successfully render the object.  As the widget is update, data control how the display of
        information changes.

    **kwargs:
        Optional keyword arguments can be used in subclass to modify the behavior of the `to_html` function.
        these keyword arguments should be invariant through successive updates to the chart.  For example,
        keyword arguments could control the styling of the widget, which should not change as the data in
        the object (e.g., a chart) is updated.  Keyword arguments are loaded via `additional_properties`
        parameter in in the `presalytics.story.outline.Widget` object.

    Returns
    ----------
    A str of containing an html fragment that will be loaded into a template in successive operations
    &#34;&#34;&#34;
    raise NotImplementedError</code></pre>
</details>
</dd>
<dt id="presalytics.WidgetBase.serialize"><code class="name flex">
<span>def <span class="ident">serialize</span></span>(<span>self, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Creates <code><a title="presalytics.story.outline.Widget" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.Widget">Widget</a></code> object from instance data. This widget should
have the correct <code>name</code>, <code>data</code> and <code>additional_properties</code> so the same widget can be reconstituted
via the to_html method, given the same set of data.</p>
<p>Typically, this method will call an update method that run a local script with updates this
Widget's data Dictionary prior being loading into the Widget outline object for serialization.</p>
<h2 id="parameters">Parameters</h2>
<p>**kwargs:
Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.
these keyword arguments should be be invariant through successive updates to the chart. Overrides
for this widgets default additional_properties should be loaded via these keyword arguments.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L220-L238" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@abc.abstractmethod
def serialize(self, **kwargs) -&gt; &#39;Widget&#39;:
    &#34;&#34;&#34;
    Creates `presalytics.story.outline.Widget` object from instance data. This widget should
    have the correct `name`, `data` and `additional_properties` so the same widget can be reconstituted
    via the to_html method, given the same set of data.

    Typically, this method will call an update method that run a local script with updates this
    Widget&#39;s data Dictionary prior being loading into the Widget outline object for serialization.

    Parameters
    ----------
    **kwargs:
        Optional keyword arguments can be used in subclass to modify the behavior of the to_html function.
        these keyword arguments should be be invariant through successive updates to the chart. Overrides
        for this widgets default additional_properties should be loaded via these keyword arguments.

    &#34;&#34;&#34;
    raise NotImplementedError</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.story.components.ComponentBase.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.story.components.ComponentBase.render" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.render">render</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.PageTemplateBase"><code class="flex name class">
<span>class <span class="ident">PageTemplateBase</span></span>
<span>(</span><span>page, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Inherit from this base class to render templates to html via the
<code><a title="presalytics.story.revealer.Revealer" href="/python-client/presalytics/story/revealer.html#presalytics.story.revealer.Revealer">Revealer</a></code> class.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>page</code></strong> :&ensp;<code>Page</code></dt>
<dd>A presalytics.story.outline.Page object for instalizing the class</dd>
</dl>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>outline_page</code></strong> :&ensp;<code><a title="presalytics.story.outline.Page" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.Page">Page</a></code></dt>
<dd>The page data</dd>
<dt><strong><code>widgets</code></strong> :&ensp;<code>list</code> of <code>subclasses</code> of <code><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></code></dt>
<dd>A list widget that will be loaded into templates and rendered via placeholders.
These widgets must have a "to_html(self, data, **kwargs)" method.</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L264-L347" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class PageTemplateBase(ComponentBase):
    &#34;&#34;&#34;
    Inherit from this base class to render templates to html via the
    `presalytics.story.revealer.Revealer` class.

    Parameters
    ----------
    page: Page
        A presalytics.story.outline.Page object for instalizing the class

    Attributes
    ----------
    outline_page: presalytics.story.outline.Page
        The page data

    widgets: list of subclasses of presalytics.story.components.WidgetBase
        A list widget that will be loaded into templates and rendered via placeholders.
        These widgets must have a &#34;to_html(self, data, **kwargs)&#34; method.

    &#34;&#34;&#34;

    outline_page: &#39;Page&#39;
    widgets: typing.List[&#39;WidgetBase&#39;]
    plugins: typing.List[typing.Dict]

    __component_type__ = &#39;page&#39;

    def __init__(self, page: &#39;Page&#39;, **kwargs) -&gt; None:
        super(PageTemplateBase, self).__init__(**kwargs)
        self.outline_page = page
        self.id = page.id
        self.widgets = self.get_page_widgets(self.outline_page)

    @abc.abstractmethod
    def render(self, **kwargs) -&gt; str:
        &#34;&#34;&#34;
        Returns valid html that renders the template in a broswer with data loaded from widgets.
        &#34;&#34;&#34;
        raise NotImplementedError

    def load_widget(self, widget: &#39;Widget&#39;):
        &#34;&#34;&#34;
        Converts a presalytics.story.outline.Widget object to a subclass of WidgetComponentBase
        via the `presalytics.COMPONENTS` registry.
        &#34;&#34;&#34;
        class_key = &#34;widget.&#34; + widget.kind
        key = class_key + &#34;.&#34; + widget.name
        try:
            if presalytics.COMPONENTS.get_instance(key):
                widget_instance = presalytics.COMPONENTS.get_instance(key)
            else:
                klass = presalytics.COMPONENTS.get(class_key)
                deserialize_method = getattr(klass, &#34;deserialize&#34;, None)
                if callable(deserialize_method):
                    widget_instance = deserialize_method(widget, client_info=self.client_info)
                else:
                    message = &#34;Widget component instance or class (kind) {0} unavailable in component registry&#34;.format(key)
                    raise presalytics.lib.exceptions.MissingConfigException(message)
        except Exception as ex:
            logger.exception(ex)
            if not presalytics.settings.DEBUG:
                widget_instance = presalytics.lib.exceptions.RenderExceptionHandler(ex)
            else:
                t, v, tb = sys.exc_info()
                six.reraise(t, v, tb)
        return widget_instance

    def get_page_widgets(self, page: &#39;Page&#39;):
        &#34;&#34;&#34;
        Converts the widgets within a `presalytics.story.outline.Page` object to a list
        of widgets subclassed from `presalytics.story.components.WidgetBase`
        &#34;&#34;&#34;
        widget_instances = []
        for widget_outline in page.widgets:
            next_widget = self.load_widget(widget_outline)
            widget_instances.append(next_widget)
        return widget_instances

    def serialize(self):
        return self.outline_page.dump()

    @classmethod
    def deseriailize(cls, component, **kwargs):
        return cls(page=component)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="presalytics.lib.templates.base.JinjaTemplateBuilder" href="/python-client/presalytics/lib/templates/base.html#presalytics.lib.templates.base.JinjaTemplateBuilder">JinjaTemplateBuilder</a></li>
<li><a title="presalytics.lib.templates.base.WidgetPage" href="/python-client/presalytics/lib/templates/base.html#presalytics.lib.templates.base.WidgetPage">WidgetPage</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.PageTemplateBase.outline_page"><code class="name">var <span class="ident">outline_page</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.PageTemplateBase.widgets"><code class="name">var <span class="ident">widgets</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="presalytics.PageTemplateBase.plugins"><code class="name">var <span class="ident">plugins</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Static methods</h3>
<dl>
<dt id="presalytics.PageTemplateBase.deseriailize"><code class="name flex">
<span>def <span class="ident">deseriailize</span></span>(<span>component, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L345-L347" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def deseriailize(cls, component, **kwargs):
    return cls(page=component)</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.PageTemplateBase.render"><code class="name flex">
<span>def <span class="ident">render</span></span>(<span>self, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Returns valid html that renders the template in a broswer with data loaded from widgets.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L297-L302" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@abc.abstractmethod
def render(self, **kwargs) -&gt; str:
    &#34;&#34;&#34;
    Returns valid html that renders the template in a broswer with data loaded from widgets.
    &#34;&#34;&#34;
    raise NotImplementedError</code></pre>
</details>
</dd>
<dt id="presalytics.PageTemplateBase.load_widget"><code class="name flex">
<span>def <span class="ident">load_widget</span></span>(<span>self, widget)</span>
</code></dt>
<dd>
<section class="desc"><p>Converts a presalytics.story.outline.Widget object to a subclass of WidgetComponentBase
via the <code><a title="presalytics.COMPONENTS" href="/python-client/presalytics/index.html#presalytics.COMPONENTS">COMPONENTS</a></code> registry.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L304-L329" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def load_widget(self, widget: &#39;Widget&#39;):
    &#34;&#34;&#34;
    Converts a presalytics.story.outline.Widget object to a subclass of WidgetComponentBase
    via the `presalytics.COMPONENTS` registry.
    &#34;&#34;&#34;
    class_key = &#34;widget.&#34; + widget.kind
    key = class_key + &#34;.&#34; + widget.name
    try:
        if presalytics.COMPONENTS.get_instance(key):
            widget_instance = presalytics.COMPONENTS.get_instance(key)
        else:
            klass = presalytics.COMPONENTS.get(class_key)
            deserialize_method = getattr(klass, &#34;deserialize&#34;, None)
            if callable(deserialize_method):
                widget_instance = deserialize_method(widget, client_info=self.client_info)
            else:
                message = &#34;Widget component instance or class (kind) {0} unavailable in component registry&#34;.format(key)
                raise presalytics.lib.exceptions.MissingConfigException(message)
    except Exception as ex:
        logger.exception(ex)
        if not presalytics.settings.DEBUG:
            widget_instance = presalytics.lib.exceptions.RenderExceptionHandler(ex)
        else:
            t, v, tb = sys.exc_info()
            six.reraise(t, v, tb)
    return widget_instance</code></pre>
</details>
</dd>
<dt id="presalytics.PageTemplateBase.get_page_widgets"><code class="name flex">
<span>def <span class="ident">get_page_widgets</span></span>(<span>self, page)</span>
</code></dt>
<dd>
<section class="desc"><p>Converts the widgets within a <code><a title="presalytics.story.outline.Page" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.Page">Page</a></code> object to a list
of widgets subclassed from <code><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></code></p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L331-L340" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_page_widgets(self, page: &#39;Page&#39;):
    &#34;&#34;&#34;
    Converts the widgets within a `presalytics.story.outline.Page` object to a list
    of widgets subclassed from `presalytics.story.components.WidgetBase`
    &#34;&#34;&#34;
    widget_instances = []
    for widget_outline in page.widgets:
        next_widget = self.load_widget(widget_outline)
        widget_instances.append(next_widget)
    return widget_instances</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.story.components.ComponentBase.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.story.components.ComponentBase.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.story.components.ComponentBase.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.serialize">serialize</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.ScssPlugin"><code class="flex name class">
<span>class <span class="ident">ScssPlugin</span></span>
<span>(</span><span>**kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Compiles scss from files and a <code>dict</code> of variables and loads
them into a script tag</p>
<p>*Note: Any <code>&lt;script&gt;</code> tags nested into the resultant style tag will
be removed at render-time by a <code><a title="presalytics.story.components.Renderer" href="/python-client/presalytics/story/components.html#presalytics.story.components.Renderer">Renderer</a></code>.
These script tags will not make it to the browser.</p>
<h2 id="configuration-values">Configuration Values</h2>
<p>filenames : list of str
A list of scss filenames that will get compiled to css if
all files are present</p>
<p>rendered_css : str, optional
If the files are not present, this string will be placed in the
resultant style tag</p>
<p>variables : dict, optional
Scss variables to include. Dictionary keys should be prefixed with a
<code>$</code> to indicate that they are scss variable names.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/scss.py#L8-L107" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class ScssPlugin(presalytics.lib.plugins.base.StylePlugin):
    &#34;&#34;&#34;
    Compiles scss from files and a `dict` of variables and loads
    them into a script tag

    *Note: Any `&lt;script&gt;` tags nested into the resultant style tag will
    be removed at render-time by a `presalytics.story.components.Renderer`.
    These script tags will not make it to the browser.

    Configuration Values
    ----------
    filenames : list of str
        A list of scss filenames that will get compiled to css if
        all files are present

    rendered_css : str, optional
        If the files are not present, this string will be placed in the
        resultant style tag

    variables : dict, optional
        Scss variables to include. Dictionary keys should be prefixed with a
        `$` to indicate that they are scss variable names.
    &#34;&#34;&#34;
    __plugin_name__ = &#34;scss_files&#34;

    def __init__(self, **kwargs):
        super(ScssPlugin, self).__init__(**kwargs)

    def _files_are_local(self, filenames):
        for fname in filenames:
            if not os.path.exists(fname):
                return False
        return True

    def _create_variables_string(self, variables):
        _vars = &#34;&#34;
        for key, val in variables.items():
            _vars = _vars + key + &#34;: &#34; + val + &#34;; &#34;
        return _vars

    def _load_files_to_string(self, filenames):
        scss_string = &#34;&#34;
        for fname in filenames:
            with open(fname, &#39;r&#39;) as f:
                addl_scss = f.read()
            scss_string = scss_string + addl_scss
        return scss_string

    def make_css(self, filenames: typing.List[str], variables: typing.Dict[str, str]):
        &#34;&#34;&#34;
        Compiles the scss in filenames to an html fragment using variables

        Returns
        ----------
        A `&lt;style&gt;` tag html fragment in a string
        &#34;&#34;&#34;
        _scss = self._create_variables_string(variables) + self._load_files_to_string(filenames)
        return sass.compile(string=_scss)

    def to_style(self, config, **kwargs):
        &#34;&#34;&#34;
        Renders a config containing `Configuration Values` to a style tag
        &#34;&#34;&#34;
        filenames = config.get(&#34;filenames&#34;, None)
        if not filenames:
            raise presalytics.lib.exceptions.MissingConfigException(&#34;Filenames are required in the config.&#34;)
        variables = config.get(&#34;variables&#34;, {})
        if self._files_are_local(filenames):
            rendered_css = self.make_css(filenames, variables)
        elif config.get(&#34;rendered_css&#34;, None):
            rendered_css = config.get(&#34;rendered_css&#34;)
        else:
            raise presalytics.lib.exceptions.MissingConfigException(&#34;A file referenced by this plugin could not be found.&#34;)
        return &#34;&lt;style&gt;{0}&lt;/style&gt;&#34;.format(rendered_css)

    @classmethod
    def configure(cls, filenames: typing.List[str], variables: typing.Dict = {}, old_css: str = None) -&gt; typing.Dict:
        &#34;&#34;&#34;
        Call this method when serializing a subclass of `presalytics.story.components.ComponentBase`
        to generate a configuration for the plugin with a valid `rendered_css` entry
        &#34;&#34;&#34;
        inst = cls()
        if not filenames:
            raise presalytics.lib.exceptions.MissingConfigException(&#34;Filenames are required in the config.&#34;)
        if inst._files_are_local(filenames):
            rendered_css = inst.make_css(filenames, variables)
        elif old_css:
            rendered_css = old_css
        else:
            raise presalytics.lib.exceptions.MissingConfigException(&#34;A file referenced by this plugin could not be found.&#34;)
        ret = {
            &#34;name&#34;: inst.__plugin_name__,
            &#34;kind&#34;: inst.__plugin_kind__,
            &#34;config&#34;: {
                &#34;filenames&#34;: filenames,
                &#34;variables&#34;: variables,
                &#34;rendered_css&#34;: rendered_css
            }
        }
        return ret</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.plugins.base.StylePlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.StylePlugin">StylePlugin</a></li>
<li><a title="presalytics.lib.plugins.base.PluginBase" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase">PluginBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.ScssPlugin.config"><code class="name">var <span class="ident">config</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Static methods</h3>
<dl>
<dt id="presalytics.ScssPlugin.configure"><code class="name flex">
<span>def <span class="ident">configure</span></span>(<span>filenames, variables={}, old_css=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Call this method when serializing a subclass of <code><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></code>
to generate a configuration for the plugin with a valid <code>rendered_css</code> entry</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/scss.py#L83-L107" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def configure(cls, filenames: typing.List[str], variables: typing.Dict = {}, old_css: str = None) -&gt; typing.Dict:
    &#34;&#34;&#34;
    Call this method when serializing a subclass of `presalytics.story.components.ComponentBase`
    to generate a configuration for the plugin with a valid `rendered_css` entry
    &#34;&#34;&#34;
    inst = cls()
    if not filenames:
        raise presalytics.lib.exceptions.MissingConfigException(&#34;Filenames are required in the config.&#34;)
    if inst._files_are_local(filenames):
        rendered_css = inst.make_css(filenames, variables)
    elif old_css:
        rendered_css = old_css
    else:
        raise presalytics.lib.exceptions.MissingConfigException(&#34;A file referenced by this plugin could not be found.&#34;)
    ret = {
        &#34;name&#34;: inst.__plugin_name__,
        &#34;kind&#34;: inst.__plugin_kind__,
        &#34;config&#34;: {
            &#34;filenames&#34;: filenames,
            &#34;variables&#34;: variables,
            &#34;rendered_css&#34;: rendered_css
        }
    }
    return ret</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.ScssPlugin.make_css"><code class="name flex">
<span>def <span class="ident">make_css</span></span>(<span>self, filenames, variables)</span>
</code></dt>
<dd>
<section class="desc"><p>Compiles the scss in filenames to an html fragment using variables</p>
<h2 id="returns">Returns</h2>
<p>A <code>&lt;style&gt;</code> tag html fragment in a string</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/scss.py#L56-L65" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def make_css(self, filenames: typing.List[str], variables: typing.Dict[str, str]):
    &#34;&#34;&#34;
    Compiles the scss in filenames to an html fragment using variables

    Returns
    ----------
    A `&lt;style&gt;` tag html fragment in a string
    &#34;&#34;&#34;
    _scss = self._create_variables_string(variables) + self._load_files_to_string(filenames)
    return sass.compile(string=_scss)</code></pre>
</details>
</dd>
<dt id="presalytics.ScssPlugin.to_style"><code class="name flex">
<span>def <span class="ident">to_style</span></span>(<span>self, config, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Renders a config containing <code>Configuration Values</code> to a style tag</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/plugins/scss.py#L67-L81" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def to_style(self, config, **kwargs):
    &#34;&#34;&#34;
    Renders a config containing `Configuration Values` to a style tag
    &#34;&#34;&#34;
    filenames = config.get(&#34;filenames&#34;, None)
    if not filenames:
        raise presalytics.lib.exceptions.MissingConfigException(&#34;Filenames are required in the config.&#34;)
    variables = config.get(&#34;variables&#34;, {})
    if self._files_are_local(filenames):
        rendered_css = self.make_css(filenames, variables)
    elif config.get(&#34;rendered_css&#34;, None):
        rendered_css = config.get(&#34;rendered_css&#34;)
    else:
        raise presalytics.lib.exceptions.MissingConfigException(&#34;A file referenced by this plugin could not be found.&#34;)
    return &#34;&lt;style&gt;{0}&lt;/style&gt;&#34;.format(rendered_css)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.plugins.base.StylePlugin" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.StylePlugin">StylePlugin</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.plugins.base.StylePlugin.get_tag" href="/python-client/presalytics/lib/plugins/base.html#presalytics.lib.plugins.base.PluginBase.get_tag">get_tag</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.ThemeBase"><code class="flex name class">
<span>class <span class="ident">ThemeBase</span></span>
<span>(</span><span>**kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Themes are containers for plugins should be rendered once
across the entire document.
The init method should configure
parameters with get passed to plugins via serialization and
deserialization.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/story/components.py#L350-L365" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class ThemeBase(ComponentBase):
    &#34;&#34;&#34;
    Themes are containers for plugins should be rendered once
    across the entire document.  The init method should configure
    parameters with get passed to plugins via serialization and
    deserialization.
    &#34;&#34;&#34;
    plugins: typing.Optional[typing.List[&#39;Plugin&#39;]]

    __component_type__ = &#39;theme&#39;

    def __init__(self, **kwargs):
        pass

    def render(self, **kwargs):
        pass</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="presalytics.lib.themes.ooxml.OoxmlTheme" href="/python-client/presalytics/lib/themes/ooxml.html#presalytics.lib.themes.ooxml.OoxmlTheme">OoxmlTheme</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="presalytics.ThemeBase.plugins"><code class="name">var <span class="ident">plugins</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.story.components.ComponentBase.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.story.components.ComponentBase.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.story.components.ComponentBase.render" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.render">render</a></code></li>
<li><code><a title="presalytics.story.components.ComponentBase.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.serialize">serialize</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul>
<li><a href="#presalytics-python-library">Presalytics Python Library</a></li>
<li><a href="#overview">Overview</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#contributing">Contributing</a></li>
<li><a href="#license">License</a></li>
</ul>
</div>
<ul id="index">
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="presalytics.cli" href="/python-client/presalytics/cli.html">presalytics.cli</a></code></li>
<li><code><a title="presalytics.client" href="/python-client/presalytics/client/index.html">presalytics.client</a></code></li>
<li><code><a title="presalytics.lib" href="/python-client/presalytics/lib/index.html">presalytics.lib</a></code></li>
<li><code><a title="presalytics.story" href="/python-client/presalytics/story/index.html">presalytics.story</a></code></li>
</ul>
</li>
<li><h3><a href="#header-variables">Global variables</a></h3>
<ul class="">
<li><code><a title="presalytics.COMPONENTS" href="/python-client/presalytics/index.html#presalytics.COMPONENTS">COMPONENTS</a></code></li>
<li><code><a title="presalytics.PLUGINS" href="/python-client/presalytics/index.html#presalytics.PLUGINS">PLUGINS</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="presalytics.create_story_from_ooxml_file" href="/python-client/presalytics/index.html#presalytics.create_story_from_ooxml_file">create_story_from_ooxml_file</a></code></li>
<li><code><a title="presalytics.story_post_file_bytes" href="/python-client/presalytics/index.html#presalytics.story_post_file_bytes">story_post_file_bytes</a></code></li>
<li><code><a title="presalytics.create_outline_from_page" href="/python-client/presalytics/index.html#presalytics.create_outline_from_page">create_outline_from_page</a></code></li>
<li><code><a title="presalytics.create_outline_from_widget" href="/python-client/presalytics/index.html#presalytics.create_outline_from_widget">create_outline_from_widget</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="presalytics.Client" href="/python-client/presalytics/index.html#presalytics.Client">Client</a></code></h4>
<ul class="">
<li><code><a title="presalytics.Client.login" href="/python-client/presalytics/index.html#presalytics.Client.login">login</a></code></li>
<li><code><a title="presalytics.Client.refresh_token" href="/python-client/presalytics/index.html#presalytics.Client.refresh_token">refresh_token</a></code></li>
<li><code><a title="presalytics.Client.get_auth_header" href="/python-client/presalytics/index.html#presalytics.Client.get_auth_header">get_auth_header</a></code></li>
<li><code><a title="presalytics.Client.get_access_token" href="/python-client/presalytics/index.html#presalytics.Client.get_access_token">get_access_token</a></code></li>
<li><code><a title="presalytics.Client.get_request_id_header" href="/python-client/presalytics/index.html#presalytics.Client.get_request_id_header">get_request_id_header</a></code></li>
<li><code><a title="presalytics.Client.download_file" href="/python-client/presalytics/index.html#presalytics.Client.download_file">download_file</a></code></li>
<li><code><a title="presalytics.Client.get_client_info" href="/python-client/presalytics/index.html#presalytics.Client.get_client_info">get_client_info</a></code></li>
<li><code><a title="presalytics.Client.upload_file_and_await_outline" href="/python-client/presalytics/index.html#presalytics.Client.upload_file_and_await_outline">upload_file_and_await_outline</a></code></li>
<li><code><a title="presalytics.Client.await_outline" href="/python-client/presalytics/index.html#presalytics.Client.await_outline">await_outline</a></code></li>
<li><code><a title="presalytics.Client.STATUS_REPOLL_SECONDS" href="/python-client/presalytics/index.html#presalytics.Client.STATUS_REPOLL_SECONDS">STATUS_REPOLL_SECONDS</a></code></li>
<li><code><a title="presalytics.Client.STATUS_REPOLL_MAX_CYCLES" href="/python-client/presalytics/index.html#presalytics.Client.STATUS_REPOLL_MAX_CYCLES">STATUS_REPOLL_MAX_CYCLES</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.StoryOutline" href="/python-client/presalytics/index.html#presalytics.StoryOutline">StoryOutline</a></code></h4>
<ul class="two-column">
<li><code><a title="presalytics.StoryOutline.outline_version" href="/python-client/presalytics/index.html#presalytics.StoryOutline.outline_version">outline_version</a></code></li>
<li><code><a title="presalytics.StoryOutline.info" href="/python-client/presalytics/index.html#presalytics.StoryOutline.info">info</a></code></li>
<li><code><a title="presalytics.StoryOutline.pages" href="/python-client/presalytics/index.html#presalytics.StoryOutline.pages">pages</a></code></li>
<li><code><a title="presalytics.StoryOutline.description" href="/python-client/presalytics/index.html#presalytics.StoryOutline.description">description</a></code></li>
<li><code><a title="presalytics.StoryOutline.title" href="/python-client/presalytics/index.html#presalytics.StoryOutline.title">title</a></code></li>
<li><code><a title="presalytics.StoryOutline.themes" href="/python-client/presalytics/index.html#presalytics.StoryOutline.themes">themes</a></code></li>
<li><code><a title="presalytics.StoryOutline.id" href="/python-client/presalytics/index.html#presalytics.StoryOutline.id">id</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.Renderer" href="/python-client/presalytics/index.html#presalytics.Renderer">Renderer</a></code></h4>
<ul class="">
<li><code><a title="presalytics.Renderer.deserialize" href="/python-client/presalytics/index.html#presalytics.Renderer.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.Renderer.render" href="/python-client/presalytics/index.html#presalytics.Renderer.render">render</a></code></li>
<li><code><a title="presalytics.Renderer.strip_unauthorized_scripts" href="/python-client/presalytics/index.html#presalytics.Renderer.strip_unauthorized_scripts">strip_unauthorized_scripts</a></code></li>
<li><code><a title="presalytics.Renderer.serialize" href="/python-client/presalytics/index.html#presalytics.Renderer.serialize">serialize</a></code></li>
<li><code><a title="presalytics.Renderer.update_outline_from_instances" href="/python-client/presalytics/index.html#presalytics.Renderer.update_outline_from_instances">update_outline_from_instances</a></code></li>
<li><code><a title="presalytics.Renderer.get_component_implicit_plugins" href="/python-client/presalytics/index.html#presalytics.Renderer.get_component_implicit_plugins">get_component_implicit_plugins</a></code></li>
<li><code><a title="presalytics.Renderer.update_story" href="/python-client/presalytics/index.html#presalytics.Renderer.update_story">update_story</a></code></li>
<li><code><a title="presalytics.Renderer.view" href="/python-client/presalytics/index.html#presalytics.Renderer.view">view</a></code></li>
<li><code><a title="presalytics.Renderer.manage" href="/python-client/presalytics/index.html#presalytics.Renderer.manage">manage</a></code></li>
<li><code><a title="presalytics.Renderer.story_outline" href="/python-client/presalytics/index.html#presalytics.Renderer.story_outline">story_outline</a></code></li>
<li><code><a title="presalytics.Renderer.plugins" href="/python-client/presalytics/index.html#presalytics.Renderer.plugins">plugins</a></code></li>
<li><code><a title="presalytics.Renderer.view_url" href="/python-client/presalytics/index.html#presalytics.Renderer.view_url">view_url</a></code></li>
<li><code><a title="presalytics.Renderer.manage_url" href="/python-client/presalytics/index.html#presalytics.Renderer.manage_url">manage_url</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.ClientSideRenderer" href="/python-client/presalytics/index.html#presalytics.ClientSideRenderer">ClientSideRenderer</a></code></h4>
<ul class="two-column">
<li><code><a title="presalytics.ClientSideRenderer.package" href="/python-client/presalytics/index.html#presalytics.ClientSideRenderer.package">package</a></code></li>
<li><code><a title="presalytics.ClientSideRenderer.update_info" href="/python-client/presalytics/index.html#presalytics.ClientSideRenderer.update_info">update_info</a></code></li>
<li><code><a title="presalytics.ClientSideRenderer.render" href="/python-client/presalytics/index.html#presalytics.ClientSideRenderer.render">render</a></code></li>
<li><code><a title="presalytics.ClientSideRenderer.render_page" href="/python-client/presalytics/index.html#presalytics.ClientSideRenderer.render_page">render_page</a></code></li>
<li><code><a title="presalytics.ClientSideRenderer.story_outline" href="/python-client/presalytics/index.html#presalytics.ClientSideRenderer.story_outline">story_outline</a></code></li>
<li><code><a title="presalytics.ClientSideRenderer.plugins" href="/python-client/presalytics/index.html#presalytics.ClientSideRenderer.plugins">plugins</a></code></li>
<li><code><a title="presalytics.ClientSideRenderer.view_url" href="/python-client/presalytics/index.html#presalytics.ClientSideRenderer.view_url">view_url</a></code></li>
<li><code><a title="presalytics.ClientSideRenderer.manage_url" href="/python-client/presalytics/index.html#presalytics.ClientSideRenderer.manage_url">manage_url</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.Revealer" href="/python-client/presalytics/index.html#presalytics.Revealer">Revealer</a></code></h4>
<ul class="">
<li><code><a title="presalytics.Revealer.get_meta_tags" href="/python-client/presalytics/index.html#presalytics.Revealer.get_meta_tags">get_meta_tags</a></code></li>
<li><code><a title="presalytics.Revealer.get_embedded_frame_hosts" href="/python-client/presalytics/index.html#presalytics.Revealer.get_embedded_frame_hosts">get_embedded_frame_hosts</a></code></li>
<li><code><a title="presalytics.Revealer.package_as_standalone" href="/python-client/presalytics/index.html#presalytics.Revealer.package_as_standalone">package_as_standalone</a></code></li>
<li><code><a title="presalytics.Revealer.update_info" href="/python-client/presalytics/index.html#presalytics.Revealer.update_info">update_info</a></code></li>
<li><code><a title="presalytics.Revealer.render" href="/python-client/presalytics/index.html#presalytics.Revealer.render">render</a></code></li>
<li><code><a title="presalytics.Revealer.render_page" href="/python-client/presalytics/index.html#presalytics.Revealer.render_page">render_page</a></code></li>
<li><code><a title="presalytics.Revealer.present" href="/python-client/presalytics/index.html#presalytics.Revealer.present">present</a></code></li>
<li><code><a title="presalytics.Revealer.base" href="/python-client/presalytics/index.html#presalytics.Revealer.base">base</a></code></li>
<li><code><a title="presalytics.Revealer.reveal_params" href="/python-client/presalytics/index.html#presalytics.Revealer.reveal_params">reveal_params</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.MatplotlibFigure" href="/python-client/presalytics/index.html#presalytics.MatplotlibFigure">MatplotlibFigure</a></code></h4>
<ul class="">
<li><code><a title="presalytics.MatplotlibFigure.additional_properties" href="/python-client/presalytics/index.html#presalytics.MatplotlibFigure.additional_properties">additional_properties</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.MatplotlibResponsiveFigure" href="/python-client/presalytics/index.html#presalytics.MatplotlibResponsiveFigure">MatplotlibResponsiveFigure</a></code></h4>
<ul class="">
<li><code><a title="presalytics.MatplotlibResponsiveFigure.create_container" href="/python-client/presalytics/index.html#presalytics.MatplotlibResponsiveFigure.create_container">create_container</a></code></li>
<li><code><a title="presalytics.MatplotlibResponsiveFigure.standalone_html" href="/python-client/presalytics/index.html#presalytics.MatplotlibResponsiveFigure.standalone_html">standalone_html</a></code></li>
<li><code><a title="presalytics.MatplotlibResponsiveFigure.additional_properties" href="/python-client/presalytics/index.html#presalytics.MatplotlibResponsiveFigure.additional_properties">additional_properties</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.Mpld3Plugin" href="/python-client/presalytics/index.html#presalytics.Mpld3Plugin">Mpld3Plugin</a></code></h4>
<ul class="">
<li><code><a title="presalytics.Mpld3Plugin.config" href="/python-client/presalytics/index.html#presalytics.Mpld3Plugin.config">config</a></code></li>
<li><code><a title="presalytics.Mpld3Plugin.template" href="/python-client/presalytics/index.html#presalytics.Mpld3Plugin.template">template</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.MarkdownWidget" href="/python-client/presalytics/index.html#presalytics.MarkdownWidget">MarkdownWidget</a></code></h4>
<ul class="">
<li><code><a title="presalytics.MarkdownWidget.from_file" href="/python-client/presalytics/index.html#presalytics.MarkdownWidget.from_file">from_file</a></code></li>
<li><code><a title="presalytics.MarkdownWidget.read_file" href="/python-client/presalytics/index.html#presalytics.MarkdownWidget.read_file">read_file</a></code></li>
<li><code><a title="presalytics.MarkdownWidget.to_html" href="/python-client/presalytics/index.html#presalytics.MarkdownWidget.to_html">to_html</a></code></li>
<li><code><a title="presalytics.MarkdownWidget.outline_widget" href="/python-client/presalytics/index.html#presalytics.MarkdownWidget.outline_widget">outline_widget</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.OoxmlFileWidget" href="/python-client/presalytics/index.html#presalytics.OoxmlFileWidget">OoxmlFileWidget</a></code></h4>
<ul class="">
<li><code><a title="presalytics.OoxmlFileWidget.update" href="/python-client/presalytics/index.html#presalytics.OoxmlFileWidget.update">update</a></code></li>
<li><code><a title="presalytics.OoxmlFileWidget.object_name" href="/python-client/presalytics/index.html#presalytics.OoxmlFileWidget.object_name">object_name</a></code></li>
<li><code><a title="presalytics.OoxmlFileWidget.ooxml_id" href="/python-client/presalytics/index.html#presalytics.OoxmlFileWidget.ooxml_id">ooxml_id</a></code></li>
<li><code><a title="presalytics.OoxmlFileWidget.file_last_modified" href="/python-client/presalytics/index.html#presalytics.OoxmlFileWidget.file_last_modified">file_last_modified</a></code></li>
<li><code><a title="presalytics.OoxmlFileWidget.previous_ooxml_version" href="/python-client/presalytics/index.html#presalytics.OoxmlFileWidget.previous_ooxml_version">previous_ooxml_version</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.OoxmlEndpointMap" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap">OoxmlEndpointMap</a></code></h4>
<ul class="two-column">
<li><code><a title="presalytics.OoxmlEndpointMap.connection_shape" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.connection_shape">connection_shape</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.chart" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.chart">chart</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.document" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.document">document</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.group" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.group">group</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.image" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.image">image</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.shape" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.shape">shape</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.shapetree" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.shapetree">shapetree</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.slide" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.slide">slide</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.table" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.table">table</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.theme" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.theme">theme</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.get_object_type" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.get_object_type">get_object_type</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.get_id_url" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.get_id_url">get_id_url</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.get_svg_url" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.get_svg_url">get_svg_url</a></code></li>
<li><code><a title="presalytics.OoxmlEndpointMap.get_xml_url" href="/python-client/presalytics/index.html#presalytics.OoxmlEndpointMap.get_xml_url">get_xml_url</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.OoxmlWidgetBase" href="/python-client/presalytics/index.html#presalytics.OoxmlWidgetBase">OoxmlWidgetBase</a></code></h4>
<ul class="two-column">
<li><code><a title="presalytics.OoxmlWidgetBase.create_container" href="/python-client/presalytics/index.html#presalytics.OoxmlWidgetBase.create_container">create_container</a></code></li>
<li><code><a title="presalytics.OoxmlWidgetBase.to_html" href="/python-client/presalytics/index.html#presalytics.OoxmlWidgetBase.to_html">to_html</a></code></li>
<li><code><a title="presalytics.OoxmlWidgetBase.get_svg" href="/python-client/presalytics/index.html#presalytics.OoxmlWidgetBase.get_svg">get_svg</a></code></li>
<li><code><a title="presalytics.OoxmlWidgetBase.get_svg_file" href="/python-client/presalytics/index.html#presalytics.OoxmlWidgetBase.get_svg_file">get_svg_file</a></code></li>
<li><code><a title="presalytics.OoxmlWidgetBase.endpoint_map" href="/python-client/presalytics/index.html#presalytics.OoxmlWidgetBase.endpoint_map">endpoint_map</a></code></li>
<li><code><a title="presalytics.OoxmlWidgetBase.data" href="/python-client/presalytics/index.html#presalytics.OoxmlWidgetBase.data">data</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.OoxmlEditorWidget" href="/python-client/presalytics/index.html#presalytics.OoxmlEditorWidget">OoxmlEditorWidget</a></code></h4>
<ul class="">
<li><code><a title="presalytics.OoxmlEditorWidget.update_xml" href="/python-client/presalytics/index.html#presalytics.OoxmlEditorWidget.update_xml">update_xml</a></code></li>
<li><code><a title="presalytics.OoxmlEditorWidget.update" href="/python-client/presalytics/index.html#presalytics.OoxmlEditorWidget.update">update</a></code></li>
<li><code><a title="presalytics.OoxmlEditorWidget.transform" href="/python-client/presalytics/index.html#presalytics.OoxmlEditorWidget.transform">transform</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.D3Widget" href="/python-client/presalytics/index.html#presalytics.D3Widget">D3Widget</a></code></h4>
<ul class="two-column">
<li><code><a title="presalytics.D3Widget.read_file" href="/python-client/presalytics/index.html#presalytics.D3Widget.read_file">read_file</a></code></li>
<li><code><a title="presalytics.D3Widget.to_html" href="/python-client/presalytics/index.html#presalytics.D3Widget.to_html">to_html</a></code></li>
<li><code><a title="presalytics.D3Widget.create_container" href="/python-client/presalytics/index.html#presalytics.D3Widget.create_container">create_container</a></code></li>
<li><code><a title="presalytics.D3Widget.standalone_html" href="/python-client/presalytics/index.html#presalytics.D3Widget.standalone_html">standalone_html</a></code></li>
<li><code><a title="presalytics.D3Widget.outline_widget" href="/python-client/presalytics/index.html#presalytics.D3Widget.outline_widget">outline_widget</a></code></li>
<li><code><a title="presalytics.D3Widget.DEFAULT_CSS" href="/python-client/presalytics/index.html#presalytics.D3Widget.DEFAULT_CSS">DEFAULT_CSS</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.ChartWidget" href="/python-client/presalytics/index.html#presalytics.ChartWidget">ChartWidget</a></code></h4>
<ul class="two-column">
<li><code><a title="presalytics.ChartWidget.read_file" href="/python-client/presalytics/index.html#presalytics.ChartWidget.read_file">read_file</a></code></li>
<li><code><a title="presalytics.ChartWidget.add_bind_to" href="/python-client/presalytics/index.html#presalytics.ChartWidget.add_bind_to">add_bind_to</a></code></li>
<li><code><a title="presalytics.ChartWidget.to_html" href="/python-client/presalytics/index.html#presalytics.ChartWidget.to_html">to_html</a></code></li>
<li><code><a title="presalytics.ChartWidget.create_container" href="/python-client/presalytics/index.html#presalytics.ChartWidget.create_container">create_container</a></code></li>
<li><code><a title="presalytics.ChartWidget.standalone_html" href="/python-client/presalytics/index.html#presalytics.ChartWidget.standalone_html">standalone_html</a></code></li>
<li><code><a title="presalytics.ChartWidget.outline_widget" href="/python-client/presalytics/index.html#presalytics.ChartWidget.outline_widget">outline_widget</a></code></li>
<li><code><a title="presalytics.ChartWidget.DEFAULT_CSS" href="/python-client/presalytics/index.html#presalytics.ChartWidget.DEFAULT_CSS">DEFAULT_CSS</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.DataTableWidget" href="/python-client/presalytics/index.html#presalytics.DataTableWidget">DataTableWidget</a></code></h4>
<ul class="two-column">
<li><code><a title="presalytics.DataTableWidget.read_file" href="/python-client/presalytics/index.html#presalytics.DataTableWidget.read_file">read_file</a></code></li>
<li><code><a title="presalytics.DataTableWidget.to_html" href="/python-client/presalytics/index.html#presalytics.DataTableWidget.to_html">to_html</a></code></li>
<li><code><a title="presalytics.DataTableWidget.create_container" href="/python-client/presalytics/index.html#presalytics.DataTableWidget.create_container">create_container</a></code></li>
<li><code><a title="presalytics.DataTableWidget.standalone_html" href="/python-client/presalytics/index.html#presalytics.DataTableWidget.standalone_html">standalone_html</a></code></li>
<li><code><a title="presalytics.DataTableWidget.outline_widget" href="/python-client/presalytics/index.html#presalytics.DataTableWidget.outline_widget">outline_widget</a></code></li>
<li><code><a title="presalytics.DataTableWidget.DEFAULT_CSS" href="/python-client/presalytics/index.html#presalytics.DataTableWidget.DEFAULT_CSS">DEFAULT_CSS</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.UrlWidget" href="/python-client/presalytics/index.html#presalytics.UrlWidget">UrlWidget</a></code></h4>
<ul class="">
<li><code><a title="presalytics.UrlWidget.to_html" href="/python-client/presalytics/index.html#presalytics.UrlWidget.to_html">to_html</a></code></li>
<li><code><a title="presalytics.UrlWidget.create_container" href="/python-client/presalytics/index.html#presalytics.UrlWidget.create_container">create_container</a></code></li>
<li><code><a title="presalytics.UrlWidget.outline_widget" href="/python-client/presalytics/index.html#presalytics.UrlWidget.outline_widget">outline_widget</a></code></li>
<li><code><a title="presalytics.UrlWidget.DEFAULT_CSS" href="/python-client/presalytics/index.html#presalytics.UrlWidget.DEFAULT_CSS">DEFAULT_CSS</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.ChartUpdaterWidget" href="/python-client/presalytics/index.html#presalytics.ChartUpdaterWidget">ChartUpdaterWidget</a></code></h4>
<ul class="">
<li><code><a title="presalytics.ChartUpdaterWidget.get_dataframe" href="/python-client/presalytics/index.html#presalytics.ChartUpdaterWidget.get_dataframe">get_dataframe</a></code></li>
<li><code><a title="presalytics.ChartUpdaterWidget.put_dataframe" href="/python-client/presalytics/index.html#presalytics.ChartUpdaterWidget.put_dataframe">put_dataframe</a></code></li>
<li><code><a title="presalytics.ChartUpdaterWidget.endpoint_map" href="/python-client/presalytics/index.html#presalytics.ChartUpdaterWidget.endpoint_map">endpoint_map</a></code></li>
<li><code><a title="presalytics.ChartUpdaterWidget.data" href="/python-client/presalytics/index.html#presalytics.ChartUpdaterWidget.data">data</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.TableUpdaterWidget" href="/python-client/presalytics/index.html#presalytics.TableUpdaterWidget">TableUpdaterWidget</a></code></h4>
<ul class="">
<li><code><a title="presalytics.TableUpdaterWidget.endpoint_map" href="/python-client/presalytics/index.html#presalytics.TableUpdaterWidget.endpoint_map">endpoint_map</a></code></li>
<li><code><a title="presalytics.TableUpdaterWidget.data" href="/python-client/presalytics/index.html#presalytics.TableUpdaterWidget.data">data</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.BootstrapCustomTemplate" href="/python-client/presalytics/index.html#presalytics.BootstrapCustomTemplate">BootstrapCustomTemplate</a></code></h4>
<ul class="">
<li><code><a title="presalytics.BootstrapCustomTemplate.template_file" href="/python-client/presalytics/index.html#presalytics.BootstrapCustomTemplate.template_file">template_file</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.XmlTransformBase" href="/python-client/presalytics/index.html#presalytics.XmlTransformBase">XmlTransformBase</a></code></h4>
<ul class="">
<li><code><a title="presalytics.XmlTransformBase.transform_function" href="/python-client/presalytics/index.html#presalytics.XmlTransformBase.transform_function">transform_function</a></code></li>
<li><code><a title="presalytics.XmlTransformBase.execute" href="/python-client/presalytics/index.html#presalytics.XmlTransformBase.execute">execute</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.ChangeShapeColor" href="/python-client/presalytics/index.html#presalytics.ChangeShapeColor">ChangeShapeColor</a></code></h4>
<ul class="">
<li><code><a title="presalytics.ChangeShapeColor.replace_color_on_target_shape" href="/python-client/presalytics/index.html#presalytics.ChangeShapeColor.replace_color_on_target_shape">replace_color_on_target_shape</a></code></li>
<li><code><a title="presalytics.ChangeShapeColor.transform_function" href="/python-client/presalytics/index.html#presalytics.ChangeShapeColor.transform_function">transform_function</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.TextReplace" href="/python-client/presalytics/index.html#presalytics.TextReplace">TextReplace</a></code></h4>
<ul class="">
<li><code><a title="presalytics.TextReplace.replace_handlebars" href="/python-client/presalytics/index.html#presalytics.TextReplace.replace_handlebars">replace_handlebars</a></code></li>
<li><code><a title="presalytics.TextReplace.transform_function" href="/python-client/presalytics/index.html#presalytics.TextReplace.transform_function">transform_function</a></code></li>
<li><code><a title="presalytics.TextReplace.TextElementInfo" href="/python-client/presalytics/index.html#presalytics.TextReplace.TextElementInfo">TextElementInfo</a></code></li>
<li><code><a title="presalytics.TextReplace.TextList" href="/python-client/presalytics/index.html#presalytics.TextReplace.TextList">TextList</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.MultiXmlTransform" href="/python-client/presalytics/index.html#presalytics.MultiXmlTransform">MultiXmlTransform</a></code></h4>
<ul class="">
<li><code><a title="presalytics.MultiXmlTransform.transform_instances" href="/python-client/presalytics/index.html#presalytics.MultiXmlTransform.transform_instances">transform_instances</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.ApprovedExternalLinks" href="/python-client/presalytics/index.html#presalytics.ApprovedExternalLinks">ApprovedExternalLinks</a></code></h4>
<ul class="">
<li><code><a title="presalytics.ApprovedExternalLinks.to_style" href="/python-client/presalytics/index.html#presalytics.ApprovedExternalLinks.to_style">to_style</a></code></li>
<li><code><a title="presalytics.ApprovedExternalLinks.config" href="/python-client/presalytics/index.html#presalytics.ApprovedExternalLinks.config">config</a></code></li>
<li><code><a title="presalytics.ApprovedExternalLinks.STYLES_MAP" href="/python-client/presalytics/index.html#presalytics.ApprovedExternalLinks.STYLES_MAP">STYLES_MAP</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.ApprovedExternalScripts" href="/python-client/presalytics/index.html#presalytics.ApprovedExternalScripts">ApprovedExternalScripts</a></code></h4>
<ul class="">
<li><code><a title="presalytics.ApprovedExternalScripts.to_script" href="/python-client/presalytics/index.html#presalytics.ApprovedExternalScripts.to_script">to_script</a></code></li>
<li><code><a title="presalytics.ApprovedExternalScripts.config" href="/python-client/presalytics/index.html#presalytics.ApprovedExternalScripts.config">config</a></code></li>
<li><code><a title="presalytics.ApprovedExternalScripts.SCRIPT_MAP" href="/python-client/presalytics/index.html#presalytics.ApprovedExternalScripts.SCRIPT_MAP">SCRIPT_MAP</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.LocalStylesPlugin" href="/python-client/presalytics/index.html#presalytics.LocalStylesPlugin">LocalStylesPlugin</a></code></h4>
<ul class="">
<li><code><a title="presalytics.LocalStylesPlugin.to_style" href="/python-client/presalytics/index.html#presalytics.LocalStylesPlugin.to_style">to_style</a></code></li>
<li><code><a title="presalytics.LocalStylesPlugin.config" href="/python-client/presalytics/index.html#presalytics.LocalStylesPlugin.config">config</a></code></li>
<li><code><a title="presalytics.LocalStylesPlugin.LOCAL_STYLES_MAP" href="/python-client/presalytics/index.html#presalytics.LocalStylesPlugin.LOCAL_STYLES_MAP">LOCAL_STYLES_MAP</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.OoxmlTheme" href="/python-client/presalytics/index.html#presalytics.OoxmlTheme">OoxmlTheme</a></code></h4>
<ul class="">
<li><code><a title="presalytics.OoxmlTheme.config_to_camelCase" href="/python-client/presalytics/index.html#presalytics.OoxmlTheme.config_to_camelCase">config_to_camelCase</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.RevealConfigPlugin" href="/python-client/presalytics/index.html#presalytics.RevealConfigPlugin">RevealConfigPlugin</a></code></h4>
<ul class="">
<li><code><a title="presalytics.RevealConfigPlugin.config" href="/python-client/presalytics/index.html#presalytics.RevealConfigPlugin.config">config</a></code></li>
<li><code><a title="presalytics.RevealConfigPlugin.template" href="/python-client/presalytics/index.html#presalytics.RevealConfigPlugin.template">template</a></code></li>
<li><code><a title="presalytics.RevealConfigPlugin.default_config" href="/python-client/presalytics/index.html#presalytics.RevealConfigPlugin.default_config">default_config</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.RevealCustomTheme" href="/python-client/presalytics/index.html#presalytics.RevealCustomTheme">RevealCustomTheme</a></code></h4>
<ul class="two-column">
<li><code><a title="presalytics.RevealCustomTheme.to_style" href="/python-client/presalytics/index.html#presalytics.RevealCustomTheme.to_style">to_style</a></code></li>
<li><code><a title="presalytics.RevealCustomTheme.get_fonts" href="/python-client/presalytics/index.html#presalytics.RevealCustomTheme.get_fonts">get_fonts</a></code></li>
<li><code><a title="presalytics.RevealCustomTheme.get_font_link" href="/python-client/presalytics/index.html#presalytics.RevealCustomTheme.get_font_link">get_font_link</a></code></li>
<li><code><a title="presalytics.RevealCustomTheme.get_base_scss" href="/python-client/presalytics/index.html#presalytics.RevealCustomTheme.get_base_scss">get_base_scss</a></code></li>
<li><code><a title="presalytics.RevealCustomTheme.fonts_base_url" href="/python-client/presalytics/index.html#presalytics.RevealCustomTheme.fonts_base_url">fonts_base_url</a></code></li>
<li><code><a title="presalytics.RevealCustomTheme.defaults" href="/python-client/presalytics/index.html#presalytics.RevealCustomTheme.defaults">defaults</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.JinjaTemplateBuilder" href="/python-client/presalytics/index.html#presalytics.JinjaTemplateBuilder">JinjaTemplateBuilder</a></code></h4>
<ul class="">
<li><code><a title="presalytics.JinjaTemplateBuilder.get_template_name" href="/python-client/presalytics/index.html#presalytics.JinjaTemplateBuilder.get_template_name">get_template_name</a></code></li>
<li><code><a title="presalytics.JinjaTemplateBuilder.render" href="/python-client/presalytics/index.html#presalytics.JinjaTemplateBuilder.render">render</a></code></li>
<li><code><a title="presalytics.JinjaTemplateBuilder.render_from_file" href="/python-client/presalytics/index.html#presalytics.JinjaTemplateBuilder.render_from_file">render_from_file</a></code></li>
<li><code><a title="presalytics.JinjaTemplateBuilder.render_from_backup_string" href="/python-client/presalytics/index.html#presalytics.JinjaTemplateBuilder.render_from_backup_string">render_from_backup_string</a></code></li>
<li><code><a title="presalytics.JinjaTemplateBuilder.read_template_string" href="/python-client/presalytics/index.html#presalytics.JinjaTemplateBuilder.read_template_string">read_template_string</a></code></li>
<li><code><a title="presalytics.JinjaTemplateBuilder.load_jinja_template" href="/python-client/presalytics/index.html#presalytics.JinjaTemplateBuilder.load_jinja_template">load_jinja_template</a></code></li>
<li><code><a title="presalytics.JinjaTemplateBuilder.check_for_file" href="/python-client/presalytics/index.html#presalytics.JinjaTemplateBuilder.check_for_file">check_for_file</a></code></li>
<li><code><a title="presalytics.JinjaTemplateBuilder.template_paths" href="/python-client/presalytics/index.html#presalytics.JinjaTemplateBuilder.template_paths">template_paths</a></code></li>
<li><code><a title="presalytics.JinjaTemplateBuilder.WidgetIndexer" href="/python-client/presalytics/index.html#presalytics.JinjaTemplateBuilder.WidgetIndexer">WidgetIndexer</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.WidgetBase" href="/python-client/presalytics/index.html#presalytics.WidgetBase">WidgetBase</a></code></h4>
<ul class="two-column">
<li><code><a title="presalytics.WidgetBase.deserialize" href="/python-client/presalytics/index.html#presalytics.WidgetBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.WidgetBase.cache_subdocument" href="/python-client/presalytics/index.html#presalytics.WidgetBase.cache_subdocument">cache_subdocument</a></code></li>
<li><code><a title="presalytics.WidgetBase.create_subdocument" href="/python-client/presalytics/index.html#presalytics.WidgetBase.create_subdocument">create_subdocument</a></code></li>
<li><code><a title="presalytics.WidgetBase.to_html" href="/python-client/presalytics/index.html#presalytics.WidgetBase.to_html">to_html</a></code></li>
<li><code><a title="presalytics.WidgetBase.serialize" href="/python-client/presalytics/index.html#presalytics.WidgetBase.serialize">serialize</a></code></li>
<li><code><a title="presalytics.WidgetBase.outline_widget" href="/python-client/presalytics/index.html#presalytics.WidgetBase.outline_widget">outline_widget</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.PageTemplateBase" href="/python-client/presalytics/index.html#presalytics.PageTemplateBase">PageTemplateBase</a></code></h4>
<ul class="two-column">
<li><code><a title="presalytics.PageTemplateBase.deseriailize" href="/python-client/presalytics/index.html#presalytics.PageTemplateBase.deseriailize">deseriailize</a></code></li>
<li><code><a title="presalytics.PageTemplateBase.render" href="/python-client/presalytics/index.html#presalytics.PageTemplateBase.render">render</a></code></li>
<li><code><a title="presalytics.PageTemplateBase.load_widget" href="/python-client/presalytics/index.html#presalytics.PageTemplateBase.load_widget">load_widget</a></code></li>
<li><code><a title="presalytics.PageTemplateBase.get_page_widgets" href="/python-client/presalytics/index.html#presalytics.PageTemplateBase.get_page_widgets">get_page_widgets</a></code></li>
<li><code><a title="presalytics.PageTemplateBase.outline_page" href="/python-client/presalytics/index.html#presalytics.PageTemplateBase.outline_page">outline_page</a></code></li>
<li><code><a title="presalytics.PageTemplateBase.widgets" href="/python-client/presalytics/index.html#presalytics.PageTemplateBase.widgets">widgets</a></code></li>
<li><code><a title="presalytics.PageTemplateBase.plugins" href="/python-client/presalytics/index.html#presalytics.PageTemplateBase.plugins">plugins</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.ScssPlugin" href="/python-client/presalytics/index.html#presalytics.ScssPlugin">ScssPlugin</a></code></h4>
<ul class="">
<li><code><a title="presalytics.ScssPlugin.configure" href="/python-client/presalytics/index.html#presalytics.ScssPlugin.configure">configure</a></code></li>
<li><code><a title="presalytics.ScssPlugin.make_css" href="/python-client/presalytics/index.html#presalytics.ScssPlugin.make_css">make_css</a></code></li>
<li><code><a title="presalytics.ScssPlugin.to_style" href="/python-client/presalytics/index.html#presalytics.ScssPlugin.to_style">to_style</a></code></li>
<li><code><a title="presalytics.ScssPlugin.config" href="/python-client/presalytics/index.html#presalytics.ScssPlugin.config">config</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.ThemeBase" href="/python-client/presalytics/index.html#presalytics.ThemeBase">ThemeBase</a></code></h4>
<ul class="">
<li><code><a title="presalytics.ThemeBase.plugins" href="/python-client/presalytics/index.html#presalytics.ThemeBase.plugins">plugins</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>