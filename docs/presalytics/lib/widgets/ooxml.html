<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.7.4" />
<title>presalytics.lib.widgets.ooxml API documentation</title>
<meta name="description" content="" />
<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css' rel='stylesheet'>
<link href='https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css' rel='stylesheet'>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{font-weight:bold}#index h4 + ul{margin-bottom:.6em}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>presalytics.lib.widgets.ooxml</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L0-L898" class="git-link">Browse git</a>
</summary>
<pre><code class="python">import typing
import time
import abc
import urllib.parse
import requests
import os
import datetime
import dateutil.parser
import lxml
import lxml.etree
import posixpath
import pandas
import collections
import presalytics
import presalytics.client.api
import presalytics.story.components
import presalytics.client
import presalytics.lib.exceptions
import presalytics.story.outline
import presalytics.lib.util
import presalytics.lib.plugins.ooxml
import presalytics.client.presalytics_ooxml_automation.models.chart_chart_data_dto
import presalytics.client.presalytics_ooxml_automation.models.table_table_data_dto
if typing.TYPE_CHECKING:
    from presalytics.story.outline import StoryOutline, Page, Widget
    from presalytics.client.presalytics_story import Story as ApiStory
    from presalytics.client.presalytics_ooxml_automation.models.chart_chart_data_dto import ChartChartDataDTO
    from presalytics.client.presalytics_ooxml_automation.models.table_table_data_dto import TableTableDataDTO


class OoxmlEndpointMap(object):
    &#34;&#34;&#34;
    Mapping class that bridges Presalytics API Ooxml Automation service endpoints
    and component class that consume those endpoints (typically subclasses of 
    `presalytics.lib.widgets.ooxml.OoxmlWidgetBase`)

    The classmethods on this class are conveninece methods to help users 
    quickly inform their widget which endpoint their of a Ooxml Document their
    targets.

    Instance methods on this class are used by widget to generate urls and 
    lookup against object tree for target objects.

    Parameters
    ----------
    endpoint_id : str
        A unique string for identifying the object_type related to the enpoint
    
    baseurl : str
        For developer use. Allows this to generate urls for non-standard instances
        of the Ooxml Automation service.  Defaults to https://api.presalytics.io/ooxml-automation/

    Attributes
    ----------
    root_url : str
        the home url for the class instance.  Typically `http://api.presalytics.io/ooxml-automation/{object_type}`
    
    OBJECT_TYPE_MAP : str
        A mapping table for object_types and object tree lookup keys
    &#34;&#34;&#34;
    _BASE_URL = &#34;https://api.presalytics.io/ooxml-automation&#34;
    _CHART = &#34;Charts&#34;
    _CONNECTION_SHAPE = &#34;ConnectionShapes&#34;
    _DOCUMENT = &#34;Documents&#34;
    _GROUP = &#34;Groups&#34;
    _IMAGE = &#34;Images&#34;
    _SHAPE = &#34;Shapes&#34;
    _SHAPETREE = &#34;ShapeTrees&#34;
    _SLIDE = &#34;Slides&#34;
    _TABLE = &#34;Tables&#34;
    _THEME = &#34;Themes&#34;

    def __init__(self, endpoint_id, baseurl: str = None):
        if endpoint_id not in OoxmlEndpointMap.__dict__.values():
            raise presalytics.lib.exceptions.ValidationError(&#34;{0} is not a valid endpoint ID&#34;.format(endpoint_id))
        self.endpoint_id = endpoint_id
        if not baseurl:
            self.baseurl = OoxmlEndpointMap._BASE_URL
            custom_hosts = presalytics.CONFIG.get(&#34;HOSTS&#34;, None)
            if custom_hosts:
                ooxml_host = custom_hosts.get(&#34;OOXML_AUTOMATION&#34;, None)
                if ooxml_host:
                    self.baseurl = ooxml_host
                
        else:
            self.baseurl = baseurl
        self.root_url = posixpath.join(self.baseurl, self.endpoint_id)
        self.OBJECT_TYPE_MAP = self._build_object_type_map()
    


    def _build_object_type_map(self):
        return {
            &#34;Chart&#34;: [
                OoxmlEndpointMap._CHART,
            ],
            &#34;Slide&#34;: [
                OoxmlEndpointMap._GROUP,
                OoxmlEndpointMap._SHAPE,
                OoxmlEndpointMap._SHAPETREE, 
                OoxmlEndpointMap._CONNECTION_SHAPE,
                OoxmlEndpointMap._SLIDE
            ],
            &#34;Table&#34;: [
                OoxmlEndpointMap._TABLE
            ],
            &#34;Theme&#34;: [
                OoxmlEndpointMap._THEME
            ],
            &#34;Shared&#34;: [
                OoxmlEndpointMap._IMAGE
            ],
            &#34;EMPTY&#34;: [
                OoxmlEndpointMap._DOCUMENT
            ]
        }
    
    def get_object_type(self):
        &#34;&#34;&#34;
        Returns the Ooxml Automation service object type for this endpoint
        &#34;&#34;&#34;
        for key, val in self.OBJECT_TYPE_MAP.items():
            for test_ep in val:
                if test_ep == self.endpoint_id:
                    if key == &#34;EMPTY&#34;:
                        return self.endpoint_id
                    else:
                        return &#34;{0}.{1}&#34;.format(key, self.endpoint_id)
        message = &#34;Invalid EndpointMap configuration: {0} is not in OBJECT_TYPE_MAP&#34;.format(self.endpoint_id)
        raise presalytics.lib.exceptions.ValidationError(message)

    def get_id_url(self, id):
        &#34;&#34;&#34;
        Returns a url to pull metadata from this Ooxml Automation service endpoint
        &#34;&#34;&#34;
        return posixpath.join(self.root_url, id)

    def get_svg_url(self, id):
        &#34;&#34;&#34;
        Returns a url to download an svg from this Ooxml Automation service endpoint
        &#34;&#34;&#34;
        return posixpath.join(self.root_url, &#34;Svg&#34;, id)

    def get_xml_url(self, id):
        &#34;&#34;&#34;
        Returns a url to pull the Open Office Xml from this Ooxml Automation service endpoint
        &#34;&#34;&#34;
        return posixpath.join(self.root_url, &#34;OpenOfficeXml&#34;, id)

    @classmethod
    def connection_shape(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting ConnectionShape objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._CONNECTION_SHAPE, baseurl)

    @classmethod
    def chart(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Chart objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._CHART, baseurl)

    @classmethod
    def document(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Document objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._DOCUMENT, baseurl)
    
    @classmethod
    def group(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Group objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._GROUP, baseurl)

    @classmethod
    def image(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Image objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._IMAGE, baseurl)

    @classmethod
    def shape(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Shape objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._SHAPE, baseurl)

    @classmethod
    def shapetree(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting ShapeTree objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._SHAPETREE, baseurl)

    @classmethod
    def slide(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Slide objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._SLIDE, baseurl)

    @classmethod
    def table(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Table objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._TABLE, baseurl)

    @classmethod
    def theme(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Theme objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._THEME, baseurl)


class OoxmlWidgetBase(presalytics.story.components.WidgetBase):
    &#34;&#34;&#34;
    Base class for creating widgets from objects at endpoints in the 
    Presalytics API Ooxml Automation service.

    Parameters
    ----------
    name : str, optional
        The widget name.  If not provided, will be the `object_name` or `filename`

    story_id : str, optional
        The the id of the story in the Presalytics API Story service.  If not provided, 
        a new story will be created.  Do not supply if this object has not yet been created. 
    
    object_ooxml_id : str, optional
        The identifier of the Ooxml Automation service object bound the Story. Do not supply if this 
        object has not yet been created.

    endpoint_map : presalytics.lib.widgets.ooxml.OoxmlEndpointMap, optional
        Reference to the Presalytics API Ooxml Automation service endpoint and object type
        that for the object of interest

    Attributes
    ----------
    svg_html : str
        An html fragment containing the svg data
    &#34;&#34;&#34;
    endpoint_map: OoxmlEndpointMap
    data: typing.Dict

    __component_kind__ = &#34;ooxml-base-widget&#34;

    __plugins__ = [
        {
            &#39;name&#39;: &#39;external_scripts&#39;,
            &#39;kind&#39;: &#39;script&#39;,
            &#39;config&#39;: {
                &#39;approved_scripts_key&#39;: &#39;jquery&#39;
            }
        },
        {
            &#39;name&#39;: &#39;external_scripts&#39;,
            &#39;kind&#39;: &#39;script&#39;,
            &#39;config&#39;: {
                &#39;approved_scripts_key&#39;: &#39;ooxml&#39;
            }
        },
        {
            &#39;name&#39;: &#39;external_links&#39;,
            &#39;kind&#39;: &#39;style&#39;,
            &#39;config&#39;: {
                &#39;approved_styles_key&#39;: &#39;preloaders&#39;
            }
        }
    ]

    def __init__(self, 
                 name,
                 story_id=None,
                 object_ooxml_id=None,
                 endpoint_map=None,
                 **kwargs):
        super(OoxmlWidgetBase, self).__init__(name, **kwargs)
        if object_ooxml_id:
            self.object_ooxml_id = object_ooxml_id
        if story_id:
            self.story_id = story_id
        if endpoint_map:
            self.endpoint_map = endpoint_map
        self.svg_html = None

    def create_container(self, **kwargs):
        &#34;&#34;&#34;
        Wraps the Presalytics API Ooxml Automation service SVG endpoint in an `&lt;iframe&gt;` that
        will be rendered inside of a story
        &#34;&#34;&#34;
        svg_container_div = lxml.html.Element(&#34;div&#34;, {
            &#39;class&#39;: &#39;svg-container&#39;,
            &#39;data-object-type&#39;: self.endpoint_map.endpoint_id,
            &#39;data-object-id&#39;: self.object_ooxml_id
        })
        preloader_container_div = lxml.html.Element( &#34;div&#34;, {&#34;class&#34;:&#34;preloader-container&#34;})
        preloader_row_div = lxml.etree.SubElement(preloader_container_div, &#34;div&#34;, attrib={&#34;class&#34;:&#34;preloader-row&#34;})
        preloader_file = os.path.join(os.path.dirname(__file__), &#34;img&#34;, &#34;preloader.svg&#34;)
        svg = lxml.html.parse(preloader_file)
        preloader_row_div.append(svg.getroot())
        empty_parent_div = lxml.html.Element(&#34;div&#34;, {
            &#39;class&#39;: &#39;empty-parent bg-light&#39;
        })
        empty_parent_div.extend([svg_container_div, preloader_container_div])
        return lxml.html.tostring(empty_parent_div)


    def to_html(self, **kwargs):
        &#34;&#34;&#34;
        Returns an html string that will render the object at the endpoint
        &#34;&#34;&#34;
        html = self.create_container()
        try:
            html = html.decode(&#39;utf-8&#39;)
        except Exception:
            pass
        self.svg_html = html
        return self.svg_html

    def get_svg(self, id, timeout_iterator=0) -&gt; str:
        &#34;&#34;&#34;
        Get an svg-formatted version of the object from the Ooxml Automation service
        &#34;&#34;&#34;
        svg_url = self.endpoint_map.get_svg_url(id)
        client = self.get_client()
        headers = client.get_auth_header()
        headers.update(client.get_request_id_header())
        response = requests.get(svg_url, headers=headers)
        svg_data = response.text
        if response.status_code != 200:
            raise presalytics.lib.exceptions.ApiError(message=response.text, status_code=response.status_code)
        if response.text.startswith(&#34;Temp data&#34;):
            if timeout_iterator &gt; 5:
                raise presalytics.lib.exceptions.ApiError(message=&#34;Unable to download svg.  Please check for upstream processing errors.&#34;)
            else:
                time.sleep(2)
                svg_data = self.get_svg(id, timeout_iterator)
        return svg_data

    def get_svg_file(self, filename=None):
        &#34;&#34;&#34;
        Writes an svg representation of the object to current working directory.  Filname is optional.
        &#34;&#34;&#34;
        if not filename:
            filename = self.endpoint_map.get_object_type() + &#34;-&#34; + self.object_ooxml_id + &#34;.pptx&#34;
        with open(filename, &#39;w&#39;) as f:
            f.write(self.get_svg(self.object_ooxml_id))

    def serialize(self):
        data = {
            &#34;story_id&#34;: self.story_id,
            &#34;object_id&#34;: self.object_ooxml_id,
            &#34;endpoint_id&#34;: self.endpoint_map.endpoint_id
        }
        widget = presalytics.story.outline.Widget(
            name=self.name,
            kind=self.__component_kind__,
            data=data,
            plugins=None
        )
        return widget

    @classmethod
    def deserialize(cls, component, **kwargs):
        return cls(
            component.name, 
            component.data[&#34;story_id&#34;], 
            component.data[&#34;object_id&#34;],
            OoxmlEndpointMap(component.data[&#34;endpoint_id&#34;]),
            **kwargs
        )


class OoxmlFileWidget(OoxmlWidgetBase):
    &#34;&#34;&#34;
    Builds a `widget` from a Presentation or Spreadsheet document

    This class interacts with the Presalytics API to extract SVG objects from
    Presentation and spreadsheet documents, identify them, and render them 
    into a story. The file is uploaded to Presalytics API Ooxml Automation service,
    which then processes the file and scans for objects in the file&#39;s object tree 
    (As seen in the &#39;Selection Pane&#39; in PowerPoint) for objects matching the &#39;object_name&#39;.
    When rendered, this widget retrieves an SVG of the identified object for rendering within 
    the story. 

    Please note that the Presalytics API Ooxml Automation object will be created overwritten 
    each time this widget is initialized, and replaced within the corresponding 
    `presalytics.story.outline.StoryOutline`.  For in-place editing of widgets Ooxml Automation objects 
    that are already bound to the `Story`, please see `presalytics.lib.widgets.ooxml_editors.OoxmlEditorWidget`

    Parameters
    ----------
    filename : str
        The local filepath a presentation or spreadsheet file containing
        the object to be rendered

    name : str, optional
        The widget name.  If not provided, attribute will be set as the `object_name` 
        or `filename`

    story_id : str, optional
        The the id of the story in the Presalytics API Story service.  If not provided, 
        a new story will be created.  Do not supply if this object has not yet been created. 
    
    object_ooxml_id : str, optional
        The identifier of the Ooxml Automation service object bound the Story. Do not supply if this 
        object has not yet been created.

    endpoint_map : presalytics.lib.widgets.ooxml.OoxmlEndpointMap, optional
        Reference to the Presalytics API Ooxml Automation service endpoint and object type
        that for the object of interest

    object_name : str, optional
        The name of the object in the file&#39;s object tree the will be rendered

    previous_ooxml_version : str, optional
        The id Ooxml Automation service document object that was previously used to 
        occupy this widget in the `presalytics.story.outline.StoryOutline`

    file_last_modified : str, optional
        The &#34;last modified&#34; date for the file at the `filename` path.  Used to ascertain
        whether file has been updated since the last time the widget was initialized, and
        correspondingly, whether the widget should be updated in the `presalytics.story.outline.StoryOutline`

    document_ooxml_id : str, optional
        The identifier for the parent &#34;Document&#34; object in the Ooxml Automation service for the object
        idenitifiable by a combinatation of `object_ooxml_id` and `endpoint_map`.
    
    &#34;&#34;&#34;
    object_name: typing.Optional[str]
    ooxml_id: str
    file_last_modified: datetime.datetime
    previous_ooxml_version: typing.Dict[str, str]

    __component_kind__ = &#39;ooxml-file-object&#39;

    def __init__(self,
                 filename,
                 name=None,
                 story_id=None,
                 object_ooxml_id=None,
                 endpoint_map=None,
                 object_name=None,
                 previous_ooxml_version={},
                 file_last_modified=None,
                 document_ooxml_id=None,
                 **kwargs):
        if object_name:
            self.object_name = object_name
        else:
            self.object_name = None
        if not name:
            if self.object_name:
                name = self.object_name
            else:
                name = filename
        super(OoxmlFileWidget, self).__init__(name, story_id, object_ooxml_id, endpoint_map, **kwargs)
        self.filename = os.path.basename(filename)
        if not self.endpoint_map:
            if filename.split(&#34;.&#34;)[-1] in [&#34;pptx&#34;, &#34;ppt&#34;]:
                self.endpoint_map = OoxmlEndpointMap(OoxmlEndpointMap.SLIDE)
        self.previous_ooxml_version = previous_ooxml_version
        if file_last_modified:
            self.file_last_modified = file_last_modified.replace(tzinfo=datetime.timezone.utc)
        else:
            self.file_last_modified = datetime.datetime.utcnow()
        self.document_ooxml_id = document_ooxml_id
        self.update()
        self.svg_html = self.create_container(**kwargs)

    def update(self):
        &#34;&#34;&#34;
        If the file is available locally, this renders that updated file and pushes
        the updated rendering data to the server
        &#34;&#34;&#34;
        story: &#39;ApiStory&#39;
        page: &#39;Page&#39;
        widget: &#39;Widget&#39;

        search_paths = list(set(presalytics.autodiscover_paths))
        if os.getcwd() not in search_paths:
            search_paths.append(os.getcwd())
        for path in search_paths:
            fpath = os.path.join(path, self.filename)
            if os.path.exists(fpath):
                # update only the file has been modified sine last time
                this_file_last_modified = datetime.datetime.utcfromtimestamp(os.path.getmtime(fpath)).astimezone(tz=datetime.timezone.utc)
                if self.file_last_modified is None or self.file_last_modified &lt;= this_file_last_modified:
                    client = self.get_client()
                    story, status, headers = client.story.story_id_file_post_with_http_info(self.story_id, file=fpath, replace_existing=True, obsolete_id=self.document_ooxml_id)
                    if status &gt;= 299:
                        raise presalytics.lib.exceptions.ApiError()
                    self.previous_ooxml_version = {
                        &#34;document_ooxml_id&#34;: self.document_ooxml_id,
                        &#34;object_ooxml_id&#34;: self.object_ooxml_id
                    }
                    new_outline = presalytics.story.outline.StoryOutline.load(story.outline)
                    for page in new_outline.pages:
                        found = False
                        for widget in page.widgets:
                            if widget.name == self.object_name:
                                self.document_ooxml_id = widget.data[&#34;document_ooxml_id&#34;]
                                found = True
                                break
                        if found:
                            break
                    if not found:
                        message = &#34;Unable to find widget object name {0} in new story outline.  Has this widget been deleted?&#34;.format(self.object_name)
                        raise presalytics.lib.exceptions.ValidationError(message)

                    # Get object tree, compare to object name
                    child_tree = client.ooxml_automation.documents_childobjects_get_id(self.document_ooxml_id)
                    target_dto = None

                    try:
                        target_dto = next(x for x in child_tree if x.entity_name == self.object_name)
                    except StopIteration:
                        pass
                    # if name not in object or _object_name is none, get first item of type in end_point id
                    if not target_dto:
                        try:
                            target_dto = next(x for x in child_tree if x.object_type.split(&#34;.&#34;)[1] == self.endpoint_map.endpoint_id)
                        except StopIteration:
                            message = &#34;Child tree of document {0} does not have a child object of type {1} or name {2}.&#34;.format(self.ooxml_id, self.endpoint_map.endpoint_id, self.object_name)
                            raise presalytics.lib.exceptions.InvalidConfigurationError(message)
                    # set widget parameters for recreation server-side (without file)
                    self.object_ooxml_id = target_dto.entity_id
                    self.file_last_modified = presalytics.lib.util.roundup_date_modified(this_file_last_modified)


    @classmethod
    def deserialize(cls, component, **kwargs):
        init_args = {
            &#34;filename&#34;: component.data[&#34;filename&#34;],
            &#34;endpoint_map&#34;: OoxmlEndpointMap(component.data[&#34;endpoint_id&#34;]),
            &#34;object_name&#34;: component.data[&#34;object_name&#34;],
            &#34;name&#34;: component.name,
        }
        if &#34;document_ooxml_id&#34; in component.data:
            init_args.update(
                {
                    &#34;document_ooxml_id&#34;: component.data[&#34;document_ooxml_id&#34;]
                }
            )
        if &#34;object_ooxml_id&#34; in component.data:
            init_args.update(
                {
                    &#34;object_ooxml_id&#34;: component.data[&#34;object_ooxml_id&#34;]
                }
            )
        if &#34;file_last_modified&#34; in component.data:
            init_args.update(
                {
                    &#34;file_last_modified&#34;: dateutil.parser.parse(component.data[&#34;file_last_modified&#34;]).replace(tzinfo=datetime.timezone.utc)
                }
            )
        if &#34;previous_ooxml_version&#34; in component.data:
            init_args.update(
                {
                    &#34;previous_ooxml_version&#34;: component.data[&#34;previous_ooxml_version&#34;]
                }
            )
        if &#34;story_id&#34; in component.data:
            init_args.update(
                {
                    &#34;story_id&#34;: component.data[&#34;story_id&#34;]
                }
            )
        if len(kwargs.keys()) &gt; 0:
            init_args.update(kwargs)
        return cls(**init_args)

    def serialize(self):
        self.update()
        data = {
            &#34;filename&#34;: self.filename,
            &#34;object_name&#34;: self.object_name,
            &#34;endpoint_id&#34;: self.endpoint_map.endpoint_id,
            &#34;document_ooxml_id&#34;: self.document_ooxml_id,
            &#34;object_ooxml_id&#34;: self.object_ooxml_id,
            &#34;story_id&#34;: self.story_id
        }
        if self.file_last_modified:
            data.update(
                {
                    &#34;file_last_modified&#34;: self.file_last_modified.isoformat()
                }
            )
        if self.previous_ooxml_version:
            data.update(
                {
                    &#34;previous_ooxml_version&#34;: self.previous_ooxml_version
                }
            )
        widget = presalytics.story.outline.Widget(
            name=self.name,
            kind=self.__component_kind__,
            data=data,
            plugins=None
        )
        return widget


class UpdaterWidgetBase(OoxmlWidgetBase):
    &#34;&#34;&#34;
    Abstract class for create simple interfaces to update widgets from a simple data table. 

    This class simplifies updates to Ooxml Automation service endpoints, allowing updates to 
    ooxml object data and its underlying xml via simple data transfer objects definted in the 
    Presalytics Ooxml Automation server.  

    Inheriting classes must override the `_get_dto_class`, `_get_endpoint_path`, and `_get_dto_table_name`
    methods

    Parameters
    ----------
    name : str
        The widget name.  If not provided, will be the `object_name` or `filename`

    story_id : str
        The the id of the story in the Presalytics API Story service.  If not provided, 
        a new story will be created.  Do not supply if this object has not yet been created. 
    
    object_id : str
        The identifier of the Ooxml Automation service object bound the Story. Do not supply if this 
        object has not yet been created.

    endpoint_map : presalytics.lib.widgets.ooxml.OoxmlEndpointMap
        Reference to the Presalytics API Ooxml Automation service endpoint and object type
        that for the object of interest

    dto: object, optional
        A an instance of the data transfer object model. The class of this object is defined by the
        `_get_dto_class()` method.  Represents the current state of the data of the data in the service.

    data_table: list of lists, optional
        A representation of a data table that will be incorporates into a dto object&#39;s property defined by
        the subclass&#39; `_get_dto_table_name` method.

    &#34;&#34;&#34;
    def __init__(self, 
                name,
                story_id: str,
                object_id: str,
                endpoint_map: OoxmlEndpointMap,
                dto=None, 
                data_table=None,
                **kwargs):
        super(UpdaterWidgetBase, self).__init__(name, story_id, object_id, endpoint_map, **kwargs)
        self.dto = dto
        self.data_table = data_table
        self.object_id = object_id
    
    
    @abc.abstractmethod
    def _get_dto_class(self) -&gt; typing.Type:
        &#34;&#34;&#34;
        Returns the Class of instances that will used for dtos
        &#34;&#34;&#34;
        return NotImplemented

    @abc.abstractmethod
    def _get_endpoint_path(self) -&gt; str:
        &#34;&#34;&#34;
        Returns the relative path to the the endpoint used , starting from the `root_url` of the 
        `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` object. 
        &#34;&#34;&#34;
        return NotImplemented

    @abc.abstractmethod
    def _get_dto_table_name(self) -&gt; str:
        &#34;&#34;&#34;
        Returns the attribute name in the object returned by `_get_dto_class()` that the `data_table` parameter
        should be mapped to.
        &#34;&#34;&#34;
        return NotImplemented

    def build_endpoint(self) -&gt; str:
        &#34;&#34;&#34;
        Returns the endpoints used for Api calls
        &#34;&#34;&#34;
        return posixpath.join(self.endpoint_map.root_url, self._get_endpoint_path(), self.object_ooxml_id)
    
    def get_dto(self):
        &#34;&#34;&#34;
        Returns an instance of the dto object from the OoxmlAutomation Service API
        &#34;&#34;&#34;
        client = self.get_client()
        headers = client.get_auth_header()
        headers.update(client.get_request_id_header())
        resp = requests.get(self.build_endpoint(), headers=headers)
        if resp.status_code &gt; 299:
            raise presalytics.lib.exceptions.ApiError(message=resp.text)
        dto = client.ooxml_automation.api_client._ApiClient__deserialize(resp.json(), self._get_dto_class())
        self.dto = dto
        return dto

    def _put_dto(self, dto):
        &#34;&#34;&#34;
        Updates the Endpoint in the Ooxml Automation Service from a dto object
        &#34;&#34;&#34;
        client = self.get_client()
        headers = client.get_auth_header()
        headers.update(client.get_request_id_header())
        data = client.ooxml_automation.api_client.sanitize_for_serialization(dto)
        resp = requests.put(self.build_endpoint(), json=data, headers=headers)
        if resp.status_code &gt; 299:
            raise presalytics.lib.exceptions.ApiError(message=resp.text)
        else:
            self.dto = dto

    def update_from_dto(self, dto):
        &#34;&#34;&#34;
        Updates the Endpoint in the Ooxml Automation Service from a dto object, and updates
        the `svg_html` attribute
        &#34;&#34;&#34;
        self._put_dto(dto)
        self.svg_html = self.create_container()

    def update_from_data_table(self, data_table):
        &#34;&#34;&#34;
        Updates the Endpoint in the Ooxml Automation Service from a the `data_table`, and updates
        the `svg_html` attribute
        &#34;&#34;&#34;
        dto = self.get_dto()
        setattr(dto, self._get_dto_table_name(), data_table)
        self.put_dto(dto)

    def serialize(self):
        data = {
            &#34;story_id&#34;: self.story_id,
            &#34;object_id&#34;: self.object_ooxml_id,
            &#34;dto&#34;: self.dto.to_dict(),
            &#34;data_table&#34;: self.data_table
        }
        widget = presalytics.story.outline.Widget(
            name=self.name,
            kind=self.__component_kind__,
            data=data,
            plugins=None
        )
        return widget

    @classmethod
    def deserialize(cls, component, **kwargs):
        return cls(
            component.name, 
            component.data[&#34;story_id&#34;], 
            component.data[&#34;object_id&#34;],
            component.data.get(&#34;dto&#34;, None),
            component.data.get(&#34;data_table&#34;, None),
            **kwargs
        )

        
class ChartUpdaterWidget(UpdaterWidgetBase):
    &#34;&#34;&#34;
    Updates a Chart in the Ooxml Automation service API at the the endpoint &#39;/Chart/ChartUpdate/&#39;

    This class simplifies chart updates, for charts residing in the Ooxml Automation Service, 
    allowing updates to ooxml object data and its underlying xml either via a list of lists or
    the `presalytics.client.presalytics_ooxml_automation.models.chart_chart_data_dto.ChartChartDataDTO`
    object.  

    Parameters
    ----------
    name : str
        A name for the widget.

    story_id : str
        The the id of the story in the Presalytics API Story service. 
    
    chart_id : str
        The identifier of the Ooxml Automation Chart service object. 

    dto: presalytics.client.presalytics_ooxml_automation.models.chart_chart_data_dto.ChartChartDataDTO, optional
        A an instance of the data transfer object model. The class of this object is defined by the
        `_get_dto_class()` method.  Represents the current state of the data of the data in the service.

    data_table: list of lists, optional
        A representation of a data table that will be incorporates into a dto object&#39;s property defined by
        the subclass&#39; `_get_dto_table_name` method.

    &#34;&#34;&#34;
    __component_kind__ = &#34;chart-updater&#34;
    
    def __init__(self, 
                name,
                story_id: str,
                chart_id: str,
                dto: &#39;ChartChartDataDTO&#39; = None, 
                data_table: typing.Sequence[typing.Sequence] = None,
                **kwargs):
        super().__init__(name, story_id, chart_id, OoxmlEndpointMap.chart(), dto=dto, data_table=data_table, **kwargs)
        self.chart_id = chart_id


    def _get_dto_class(self):
        return presalytics.client.presalytics_ooxml_automation.models.chart_chart_data_dto.ChartChartDataDTO

    def _get_endpoint_path(self):
        return &#34;ChartUpdate&#34;

    def _get_dto_table_name(self):
        return &#34;data_points&#34;

    def get_dataframe(self) -&gt; pandas.DataFrame:
        &#34;&#34;&#34;
        Returns a panda datagrame of the 
        &#34;&#34;&#34;
        data: collections.OrderedDict
        
        if not self.dto:
            self.dto = self.get_dto()
        data = collections.OrderedDict()
        for i in range(0, len(self.dto.series_names)):
            data.update({
                self.dto.series_names[i]: pandas.Series(self.dto.data_points[i], self.dto.category_names)
            })
        return pandas.DataFrame(data)
    
    def put_dataframe(self, df: pandas.DataFrame):
        data_dict = df.to_dict(&#39;split&#39;)
        data_points = list(map(list, zip(*data_dict[&#39;data&#39;])))
        dto = self._get_dto_class()(chart_id=self.chart_id, 
                                 series_names=data_dict[&#34;columns&#34;], 
                                 category_names=data_dict[&#34;index&#34;],
                                 data_points=data_points)
        self._put_dto(dto)

        

class TableUpdaterWidget(UpdaterWidgetBase):
    &#34;&#34;&#34;
    Updates a Table in the Ooxml Automation service API at the the endpoint &#39;/Table/TableUpdate/&#39;

    This class simplifies table updates, for tables residing in the Ooxml Automation Service, 
    allowing updates to ooxml object data and its underlying xml either via a list of lists or
    the `presalytics.client.presalytics_ooxml_automation.models.table_table_data_dto.TableTableDataDTO`
    object.  

    Parameters
    ----------
    name : str
        A name for the widget.

    story_id : str
        The the id of the story in the Presalytics API Story service. 
    
    table_id : str
        The identifier of the Ooxml Automation Table service object. 

    dto: presalytics.client.presalytics_ooxml_automation.models.table_table_data_dto.TableTableDataDTO, optional
        A an instance of the data transfer object model. The class of this object is defined by the
        `_get_dto_class()` method.  Represents the current state of the data of the data in the service.

    data_table: list of lists, optional
        A representation of a data table that will be incorporates into a dto object&#39;s property defined by
        the subclass&#39; `_get_dto_table_name` method.

    &#34;&#34;&#34;
    __component_kind__ = &#34;table-updater&#34;
    
    def __init__(self, 
                name,
                story_id: str,
                table_id: str,
                dto: &#39;TableTableDataDTO&#39; = None, 
                data_table: typing.Sequence[typing.Sequence] = None,
                **kwargs):
        super().__init__(name, story_id, table_id, OoxmlEndpointMap.table(), dto=dto, data_table=data_table, **kwargs)
        self.table_id = table_id


    def _get_dto_class(self):
        return presalytics.client.presalytics_ooxml_automation.models.table_table_data_dto.TableTableDataDTO

    def _get_endpoint_path(self):
        return &#34;TableUpdate&#34;

    def _get_dto_table_name(self):
        return &#34;table_data&#34;
    </code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="presalytics.lib.widgets.ooxml.OoxmlEndpointMap"><code class="flex name class">
<span>class <span class="ident">OoxmlEndpointMap</span></span>
<span>(</span><span>endpoint_id, baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Mapping class that bridges Presalytics API Ooxml Automation service endpoints
and component class that consume those endpoints (typically subclasses of
<a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase"><code>OoxmlWidgetBase</code></a>)</p>
<p>The classmethods on this class are conveninece methods to help users
quickly inform their widget which endpoint their of a Ooxml Document their
targets.</p>
<p>Instance methods on this class are used by widget to generate urls and
lookup against object tree for target objects.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>endpoint_id</code></strong> :&ensp;<code>str</code></dt>
<dd>A unique string for identifying the object_type related to the enpoint</dd>
<dt><strong><code>baseurl</code></strong> :&ensp;<code>str</code></dt>
<dd>For developer use. Allows this to generate urls for non-standard instances
of the Ooxml Automation service.
Defaults to <a href="https://api.presalytics.io/ooxml-automation/">https://api.presalytics.io/ooxml-automation/</a></dd>
</dl>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>root_url</code></strong> :&ensp;<code>str</code></dt>
<dd>the home url for the class instance.
Typically <code>&lt;http://api.presalytics.io/ooxml-automation/{object_type}</code>&gt;</dd>
<dt><strong><code>OBJECT_TYPE_MAP</code></strong> :&ensp;<code>str</code></dt>
<dd>A mapping table for object_types and object tree lookup keys</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L31-L228" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class OoxmlEndpointMap(object):
    &#34;&#34;&#34;
    Mapping class that bridges Presalytics API Ooxml Automation service endpoints
    and component class that consume those endpoints (typically subclasses of 
    `presalytics.lib.widgets.ooxml.OoxmlWidgetBase`)

    The classmethods on this class are conveninece methods to help users 
    quickly inform their widget which endpoint their of a Ooxml Document their
    targets.

    Instance methods on this class are used by widget to generate urls and 
    lookup against object tree for target objects.

    Parameters
    ----------
    endpoint_id : str
        A unique string for identifying the object_type related to the enpoint
    
    baseurl : str
        For developer use. Allows this to generate urls for non-standard instances
        of the Ooxml Automation service.  Defaults to https://api.presalytics.io/ooxml-automation/

    Attributes
    ----------
    root_url : str
        the home url for the class instance.  Typically `http://api.presalytics.io/ooxml-automation/{object_type}`
    
    OBJECT_TYPE_MAP : str
        A mapping table for object_types and object tree lookup keys
    &#34;&#34;&#34;
    _BASE_URL = &#34;https://api.presalytics.io/ooxml-automation&#34;
    _CHART = &#34;Charts&#34;
    _CONNECTION_SHAPE = &#34;ConnectionShapes&#34;
    _DOCUMENT = &#34;Documents&#34;
    _GROUP = &#34;Groups&#34;
    _IMAGE = &#34;Images&#34;
    _SHAPE = &#34;Shapes&#34;
    _SHAPETREE = &#34;ShapeTrees&#34;
    _SLIDE = &#34;Slides&#34;
    _TABLE = &#34;Tables&#34;
    _THEME = &#34;Themes&#34;

    def __init__(self, endpoint_id, baseurl: str = None):
        if endpoint_id not in OoxmlEndpointMap.__dict__.values():
            raise presalytics.lib.exceptions.ValidationError(&#34;{0} is not a valid endpoint ID&#34;.format(endpoint_id))
        self.endpoint_id = endpoint_id
        if not baseurl:
            self.baseurl = OoxmlEndpointMap._BASE_URL
            custom_hosts = presalytics.CONFIG.get(&#34;HOSTS&#34;, None)
            if custom_hosts:
                ooxml_host = custom_hosts.get(&#34;OOXML_AUTOMATION&#34;, None)
                if ooxml_host:
                    self.baseurl = ooxml_host
                
        else:
            self.baseurl = baseurl
        self.root_url = posixpath.join(self.baseurl, self.endpoint_id)
        self.OBJECT_TYPE_MAP = self._build_object_type_map()
    


    def _build_object_type_map(self):
        return {
            &#34;Chart&#34;: [
                OoxmlEndpointMap._CHART,
            ],
            &#34;Slide&#34;: [
                OoxmlEndpointMap._GROUP,
                OoxmlEndpointMap._SHAPE,
                OoxmlEndpointMap._SHAPETREE, 
                OoxmlEndpointMap._CONNECTION_SHAPE,
                OoxmlEndpointMap._SLIDE
            ],
            &#34;Table&#34;: [
                OoxmlEndpointMap._TABLE
            ],
            &#34;Theme&#34;: [
                OoxmlEndpointMap._THEME
            ],
            &#34;Shared&#34;: [
                OoxmlEndpointMap._IMAGE
            ],
            &#34;EMPTY&#34;: [
                OoxmlEndpointMap._DOCUMENT
            ]
        }
    
    def get_object_type(self):
        &#34;&#34;&#34;
        Returns the Ooxml Automation service object type for this endpoint
        &#34;&#34;&#34;
        for key, val in self.OBJECT_TYPE_MAP.items():
            for test_ep in val:
                if test_ep == self.endpoint_id:
                    if key == &#34;EMPTY&#34;:
                        return self.endpoint_id
                    else:
                        return &#34;{0}.{1}&#34;.format(key, self.endpoint_id)
        message = &#34;Invalid EndpointMap configuration: {0} is not in OBJECT_TYPE_MAP&#34;.format(self.endpoint_id)
        raise presalytics.lib.exceptions.ValidationError(message)

    def get_id_url(self, id):
        &#34;&#34;&#34;
        Returns a url to pull metadata from this Ooxml Automation service endpoint
        &#34;&#34;&#34;
        return posixpath.join(self.root_url, id)

    def get_svg_url(self, id):
        &#34;&#34;&#34;
        Returns a url to download an svg from this Ooxml Automation service endpoint
        &#34;&#34;&#34;
        return posixpath.join(self.root_url, &#34;Svg&#34;, id)

    def get_xml_url(self, id):
        &#34;&#34;&#34;
        Returns a url to pull the Open Office Xml from this Ooxml Automation service endpoint
        &#34;&#34;&#34;
        return posixpath.join(self.root_url, &#34;OpenOfficeXml&#34;, id)

    @classmethod
    def connection_shape(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting ConnectionShape objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._CONNECTION_SHAPE, baseurl)

    @classmethod
    def chart(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Chart objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._CHART, baseurl)

    @classmethod
    def document(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Document objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._DOCUMENT, baseurl)
    
    @classmethod
    def group(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Group objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._GROUP, baseurl)

    @classmethod
    def image(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Image objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._IMAGE, baseurl)

    @classmethod
    def shape(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Shape objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._SHAPE, baseurl)

    @classmethod
    def shapetree(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting ShapeTree objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._SHAPETREE, baseurl)

    @classmethod
    def slide(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Slide objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._SLIDE, baseurl)

    @classmethod
    def table(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Table objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._TABLE, baseurl)

    @classmethod
    def theme(cls, baseurl=None):
        &#34;&#34;&#34;
        Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
        targeting Theme objects
        &#34;&#34;&#34;
        return cls(OoxmlEndpointMap._THEME, baseurl)</code></pre>
</details>
<h3>Static methods</h3>
<dl>
<dt id="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.connection_shape"><code class="name flex">
<span>def <span class="ident">connection_shape</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Factory method to create an <a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap"><code>OoxmlEndpointMap</code></a> instance
targeting ConnectionShape objects</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L150-L156" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def connection_shape(cls, baseurl=None):
    &#34;&#34;&#34;
    Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
    targeting ConnectionShape objects
    &#34;&#34;&#34;
    return cls(OoxmlEndpointMap._CONNECTION_SHAPE, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.chart"><code class="name flex">
<span>def <span class="ident">chart</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Factory method to create an <a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap"><code>OoxmlEndpointMap</code></a> instance
targeting Chart objects</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L158-L164" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def chart(cls, baseurl=None):
    &#34;&#34;&#34;
    Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
    targeting Chart objects
    &#34;&#34;&#34;
    return cls(OoxmlEndpointMap._CHART, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.document"><code class="name flex">
<span>def <span class="ident">document</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Factory method to create an <a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap"><code>OoxmlEndpointMap</code></a> instance
targeting Document objects</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L166-L172" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def document(cls, baseurl=None):
    &#34;&#34;&#34;
    Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
    targeting Document objects
    &#34;&#34;&#34;
    return cls(OoxmlEndpointMap._DOCUMENT, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.group"><code class="name flex">
<span>def <span class="ident">group</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Factory method to create an <a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap"><code>OoxmlEndpointMap</code></a> instance
targeting Group objects</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L174-L180" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def group(cls, baseurl=None):
    &#34;&#34;&#34;
    Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
    targeting Group objects
    &#34;&#34;&#34;
    return cls(OoxmlEndpointMap._GROUP, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.image"><code class="name flex">
<span>def <span class="ident">image</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Factory method to create an <a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap"><code>OoxmlEndpointMap</code></a> instance
targeting Image objects</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L182-L188" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def image(cls, baseurl=None):
    &#34;&#34;&#34;
    Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
    targeting Image objects
    &#34;&#34;&#34;
    return cls(OoxmlEndpointMap._IMAGE, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.shape"><code class="name flex">
<span>def <span class="ident">shape</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Factory method to create an <a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap"><code>OoxmlEndpointMap</code></a> instance
targeting Shape objects</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L190-L196" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def shape(cls, baseurl=None):
    &#34;&#34;&#34;
    Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
    targeting Shape objects
    &#34;&#34;&#34;
    return cls(OoxmlEndpointMap._SHAPE, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.shapetree"><code class="name flex">
<span>def <span class="ident">shapetree</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Factory method to create an <a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap"><code>OoxmlEndpointMap</code></a> instance
targeting ShapeTree objects</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L198-L204" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def shapetree(cls, baseurl=None):
    &#34;&#34;&#34;
    Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
    targeting ShapeTree objects
    &#34;&#34;&#34;
    return cls(OoxmlEndpointMap._SHAPETREE, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.slide"><code class="name flex">
<span>def <span class="ident">slide</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Factory method to create an <a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap"><code>OoxmlEndpointMap</code></a> instance
targeting Slide objects</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L206-L212" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def slide(cls, baseurl=None):
    &#34;&#34;&#34;
    Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
    targeting Slide objects
    &#34;&#34;&#34;
    return cls(OoxmlEndpointMap._SLIDE, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.table"><code class="name flex">
<span>def <span class="ident">table</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Factory method to create an <a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap"><code>OoxmlEndpointMap</code></a> instance
targeting Table objects</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L214-L220" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def table(cls, baseurl=None):
    &#34;&#34;&#34;
    Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
    targeting Table objects
    &#34;&#34;&#34;
    return cls(OoxmlEndpointMap._TABLE, baseurl)</code></pre>
</details>
</dd>
<dt id="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.theme"><code class="name flex">
<span>def <span class="ident">theme</span></span>(<span>baseurl=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Factory method to create an <a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap"><code>OoxmlEndpointMap</code></a> instance
targeting Theme objects</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L222-L228" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def theme(cls, baseurl=None):
    &#34;&#34;&#34;
    Factory method to create an `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` instance
    targeting Theme objects
    &#34;&#34;&#34;
    return cls(OoxmlEndpointMap._THEME, baseurl)</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.get_object_type"><code class="name flex">
<span>def <span class="ident">get_object_type</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Returns the Ooxml Automation service object type for this endpoint</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L118-L130" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_object_type(self):
    &#34;&#34;&#34;
    Returns the Ooxml Automation service object type for this endpoint
    &#34;&#34;&#34;
    for key, val in self.OBJECT_TYPE_MAP.items():
        for test_ep in val:
            if test_ep == self.endpoint_id:
                if key == &#34;EMPTY&#34;:
                    return self.endpoint_id
                else:
                    return &#34;{0}.{1}&#34;.format(key, self.endpoint_id)
    message = &#34;Invalid EndpointMap configuration: {0} is not in OBJECT_TYPE_MAP&#34;.format(self.endpoint_id)
    raise presalytics.lib.exceptions.ValidationError(message)</code></pre>
</details>
</dd>
<dt id="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.get_id_url"><code class="name flex">
<span>def <span class="ident">get_id_url</span></span>(<span>self, id)</span>
</code></dt>
<dd>
<section class="desc"><p>Returns a url to pull metadata from this Ooxml Automation service endpoint</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L132-L136" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_id_url(self, id):
    &#34;&#34;&#34;
    Returns a url to pull metadata from this Ooxml Automation service endpoint
    &#34;&#34;&#34;
    return posixpath.join(self.root_url, id)</code></pre>
</details>
</dd>
<dt id="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.get_svg_url"><code class="name flex">
<span>def <span class="ident">get_svg_url</span></span>(<span>self, id)</span>
</code></dt>
<dd>
<section class="desc"><p>Returns a url to download an svg from this Ooxml Automation service endpoint</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L138-L142" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_svg_url(self, id):
    &#34;&#34;&#34;
    Returns a url to download an svg from this Ooxml Automation service endpoint
    &#34;&#34;&#34;
    return posixpath.join(self.root_url, &#34;Svg&#34;, id)</code></pre>
</details>
</dd>
<dt id="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.get_xml_url"><code class="name flex">
<span>def <span class="ident">get_xml_url</span></span>(<span>self, id)</span>
</code></dt>
<dd>
<section class="desc"><p>Returns a url to pull the Open Office Xml from this Ooxml Automation service endpoint</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L144-L148" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_xml_url(self, id):
    &#34;&#34;&#34;
    Returns a url to pull the Open Office Xml from this Ooxml Automation service endpoint
    &#34;&#34;&#34;
    return posixpath.join(self.root_url, &#34;OpenOfficeXml&#34;, id)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="presalytics.lib.widgets.ooxml.OoxmlWidgetBase"><code class="flex name class">
<span>class <span class="ident">OoxmlWidgetBase</span></span>
<span>(</span><span>name, story_id=None, object_ooxml_id=None, endpoint_map=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Base class for creating widgets from objects at endpoints in the
Presalytics API Ooxml Automation service.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>name</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The widget name.
If not provided, will be the <code>object_name</code> or <code>filename</code></dd>
<dt><strong><code>story_id</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The the id of the story in the Presalytics API Story service.
If not provided,
a new story will be created.
Do not supply if this object has not yet been created.</dd>
<dt><strong><code>object_ooxml_id</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The identifier of the Ooxml Automation service object bound the Story. Do not supply if this
object has not yet been created.</dd>
<dt><strong><code>endpoint_map</code></strong> :&ensp;<a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap"><code>OoxmlEndpointMap</code></a>, optional</dt>
<dd>Reference to the Presalytics API Ooxml Automation service endpoint and object type
that for the object of interest</dd>
</dl>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>svg_html</code></strong> :&ensp;<code>str</code></dt>
<dd>An html fragment containing the svg data</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L231-L387" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class OoxmlWidgetBase(presalytics.story.components.WidgetBase):
    &#34;&#34;&#34;
    Base class for creating widgets from objects at endpoints in the 
    Presalytics API Ooxml Automation service.

    Parameters
    ----------
    name : str, optional
        The widget name.  If not provided, will be the `object_name` or `filename`

    story_id : str, optional
        The the id of the story in the Presalytics API Story service.  If not provided, 
        a new story will be created.  Do not supply if this object has not yet been created. 
    
    object_ooxml_id : str, optional
        The identifier of the Ooxml Automation service object bound the Story. Do not supply if this 
        object has not yet been created.

    endpoint_map : presalytics.lib.widgets.ooxml.OoxmlEndpointMap, optional
        Reference to the Presalytics API Ooxml Automation service endpoint and object type
        that for the object of interest

    Attributes
    ----------
    svg_html : str
        An html fragment containing the svg data
    &#34;&#34;&#34;
    endpoint_map: OoxmlEndpointMap
    data: typing.Dict

    __component_kind__ = &#34;ooxml-base-widget&#34;

    __plugins__ = [
        {
            &#39;name&#39;: &#39;external_scripts&#39;,
            &#39;kind&#39;: &#39;script&#39;,
            &#39;config&#39;: {
                &#39;approved_scripts_key&#39;: &#39;jquery&#39;
            }
        },
        {
            &#39;name&#39;: &#39;external_scripts&#39;,
            &#39;kind&#39;: &#39;script&#39;,
            &#39;config&#39;: {
                &#39;approved_scripts_key&#39;: &#39;ooxml&#39;
            }
        },
        {
            &#39;name&#39;: &#39;external_links&#39;,
            &#39;kind&#39;: &#39;style&#39;,
            &#39;config&#39;: {
                &#39;approved_styles_key&#39;: &#39;preloaders&#39;
            }
        }
    ]

    def __init__(self, 
                 name,
                 story_id=None,
                 object_ooxml_id=None,
                 endpoint_map=None,
                 **kwargs):
        super(OoxmlWidgetBase, self).__init__(name, **kwargs)
        if object_ooxml_id:
            self.object_ooxml_id = object_ooxml_id
        if story_id:
            self.story_id = story_id
        if endpoint_map:
            self.endpoint_map = endpoint_map
        self.svg_html = None

    def create_container(self, **kwargs):
        &#34;&#34;&#34;
        Wraps the Presalytics API Ooxml Automation service SVG endpoint in an `&lt;iframe&gt;` that
        will be rendered inside of a story
        &#34;&#34;&#34;
        svg_container_div = lxml.html.Element(&#34;div&#34;, {
            &#39;class&#39;: &#39;svg-container&#39;,
            &#39;data-object-type&#39;: self.endpoint_map.endpoint_id,
            &#39;data-object-id&#39;: self.object_ooxml_id
        })
        preloader_container_div = lxml.html.Element( &#34;div&#34;, {&#34;class&#34;:&#34;preloader-container&#34;})
        preloader_row_div = lxml.etree.SubElement(preloader_container_div, &#34;div&#34;, attrib={&#34;class&#34;:&#34;preloader-row&#34;})
        preloader_file = os.path.join(os.path.dirname(__file__), &#34;img&#34;, &#34;preloader.svg&#34;)
        svg = lxml.html.parse(preloader_file)
        preloader_row_div.append(svg.getroot())
        empty_parent_div = lxml.html.Element(&#34;div&#34;, {
            &#39;class&#39;: &#39;empty-parent bg-light&#39;
        })
        empty_parent_div.extend([svg_container_div, preloader_container_div])
        return lxml.html.tostring(empty_parent_div)


    def to_html(self, **kwargs):
        &#34;&#34;&#34;
        Returns an html string that will render the object at the endpoint
        &#34;&#34;&#34;
        html = self.create_container()
        try:
            html = html.decode(&#39;utf-8&#39;)
        except Exception:
            pass
        self.svg_html = html
        return self.svg_html

    def get_svg(self, id, timeout_iterator=0) -&gt; str:
        &#34;&#34;&#34;
        Get an svg-formatted version of the object from the Ooxml Automation service
        &#34;&#34;&#34;
        svg_url = self.endpoint_map.get_svg_url(id)
        client = self.get_client()
        headers = client.get_auth_header()
        headers.update(client.get_request_id_header())
        response = requests.get(svg_url, headers=headers)
        svg_data = response.text
        if response.status_code != 200:
            raise presalytics.lib.exceptions.ApiError(message=response.text, status_code=response.status_code)
        if response.text.startswith(&#34;Temp data&#34;):
            if timeout_iterator &gt; 5:
                raise presalytics.lib.exceptions.ApiError(message=&#34;Unable to download svg.  Please check for upstream processing errors.&#34;)
            else:
                time.sleep(2)
                svg_data = self.get_svg(id, timeout_iterator)
        return svg_data

    def get_svg_file(self, filename=None):
        &#34;&#34;&#34;
        Writes an svg representation of the object to current working directory.  Filname is optional.
        &#34;&#34;&#34;
        if not filename:
            filename = self.endpoint_map.get_object_type() + &#34;-&#34; + self.object_ooxml_id + &#34;.pptx&#34;
        with open(filename, &#39;w&#39;) as f:
            f.write(self.get_svg(self.object_ooxml_id))

    def serialize(self):
        data = {
            &#34;story_id&#34;: self.story_id,
            &#34;object_id&#34;: self.object_ooxml_id,
            &#34;endpoint_id&#34;: self.endpoint_map.endpoint_id
        }
        widget = presalytics.story.outline.Widget(
            name=self.name,
            kind=self.__component_kind__,
            data=data,
            plugins=None
        )
        return widget

    @classmethod
    def deserialize(cls, component, **kwargs):
        return cls(
            component.name, 
            component.data[&#34;story_id&#34;], 
            component.data[&#34;object_id&#34;],
            OoxmlEndpointMap(component.data[&#34;endpoint_id&#34;]),
            **kwargs
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="presalytics.lib.widgets.ooxml.OoxmlFileWidget" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlFileWidget">OoxmlFileWidget</a></li>
<li><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase">UpdaterWidgetBase</a></li>
<li><a title="presalytics.lib.widgets.ooxml_editors.OoxmlEditorWidget" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.OoxmlEditorWidget">OoxmlEditorWidget</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.create_container"><code class="name flex">
<span>def <span class="ident">create_container</span></span>(<span>self, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Wraps the Presalytics API Ooxml Automation service SVG endpoint in an <code>&lt;iframe&gt;</code> that
will be rendered inside of a story</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L302-L321" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def create_container(self, **kwargs):
    &#34;&#34;&#34;
    Wraps the Presalytics API Ooxml Automation service SVG endpoint in an `&lt;iframe&gt;` that
    will be rendered inside of a story
    &#34;&#34;&#34;
    svg_container_div = lxml.html.Element(&#34;div&#34;, {
        &#39;class&#39;: &#39;svg-container&#39;,
        &#39;data-object-type&#39;: self.endpoint_map.endpoint_id,
        &#39;data-object-id&#39;: self.object_ooxml_id
    })
    preloader_container_div = lxml.html.Element( &#34;div&#34;, {&#34;class&#34;:&#34;preloader-container&#34;})
    preloader_row_div = lxml.etree.SubElement(preloader_container_div, &#34;div&#34;, attrib={&#34;class&#34;:&#34;preloader-row&#34;})
    preloader_file = os.path.join(os.path.dirname(__file__), &#34;img&#34;, &#34;preloader.svg&#34;)
    svg = lxml.html.parse(preloader_file)
    preloader_row_div.append(svg.getroot())
    empty_parent_div = lxml.html.Element(&#34;div&#34;, {
        &#39;class&#39;: &#39;empty-parent bg-light&#39;
    })
    empty_parent_div.extend([svg_container_div, preloader_container_div])
    return lxml.html.tostring(empty_parent_div)</code></pre>
</details>
</dd>
<dt id="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.to_html"><code class="name flex">
<span>def <span class="ident">to_html</span></span>(<span>self, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Returns an html string that will render the object at the endpoint</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L324-L334" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def to_html(self, **kwargs):
    &#34;&#34;&#34;
    Returns an html string that will render the object at the endpoint
    &#34;&#34;&#34;
    html = self.create_container()
    try:
        html = html.decode(&#39;utf-8&#39;)
    except Exception:
        pass
    self.svg_html = html
    return self.svg_html</code></pre>
</details>
</dd>
<dt id="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg"><code class="name flex">
<span>def <span class="ident">get_svg</span></span>(<span>self, id, timeout_iterator=0)</span>
</code></dt>
<dd>
<section class="desc"><p>Get an svg-formatted version of the object from the Ooxml Automation service</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L336-L354" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_svg(self, id, timeout_iterator=0) -&gt; str:
    &#34;&#34;&#34;
    Get an svg-formatted version of the object from the Ooxml Automation service
    &#34;&#34;&#34;
    svg_url = self.endpoint_map.get_svg_url(id)
    client = self.get_client()
    headers = client.get_auth_header()
    headers.update(client.get_request_id_header())
    response = requests.get(svg_url, headers=headers)
    svg_data = response.text
    if response.status_code != 200:
        raise presalytics.lib.exceptions.ApiError(message=response.text, status_code=response.status_code)
    if response.text.startswith(&#34;Temp data&#34;):
        if timeout_iterator &gt; 5:
            raise presalytics.lib.exceptions.ApiError(message=&#34;Unable to download svg.  Please check for upstream processing errors.&#34;)
        else:
            time.sleep(2)
            svg_data = self.get_svg(id, timeout_iterator)
    return svg_data</code></pre>
</details>
</dd>
<dt id="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg_file"><code class="name flex">
<span>def <span class="ident">get_svg_file</span></span>(<span>self, filename=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Writes an svg representation of the object to current working directory.
Filname is optional.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L356-L363" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_svg_file(self, filename=None):
    &#34;&#34;&#34;
    Writes an svg representation of the object to current working directory.  Filname is optional.
    &#34;&#34;&#34;
    if not filename:
        filename = self.endpoint_map.get_object_type() + &#34;-&#34; + self.object_ooxml_id + &#34;.pptx&#34;
    with open(filename, &#39;w&#39;) as f:
        f.write(self.get_svg(self.object_ooxml_id))</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.story.components.WidgetBase.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.render" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.render">render</a></code></li>
<li><code><a title="presalytics.story.components.WidgetBase.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.serialize">serialize</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.lib.widgets.ooxml.OoxmlFileWidget"><code class="flex name class">
<span>class <span class="ident">OoxmlFileWidget</span></span>
<span>(</span><span>filename, name=None, story_id=None, object_ooxml_id=None, endpoint_map=None, object_name=None, previous_ooxml_version={}, file_last_modified=None, document_ooxml_id=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Builds a <code>widget</code> from a Presentation or Spreadsheet document</p>
<p>This class interacts with the Presalytics API to extract SVG objects from
Presentation and spreadsheet documents, identify them, and render them
into a story. The file is uploaded to Presalytics API Ooxml Automation service,
which then processes the file and scans for objects in the file's object tree
(As seen in the 'Selection Pane' in PowerPoint) for objects matching the 'object_name'.
When rendered, this widget retrieves an SVG of the identified object for rendering within
the story. </p>
<p>Please note that the Presalytics API Ooxml Automation object will be created overwritten
each time this widget is initialized, and replaced within the corresponding
<a title="presalytics.story.outline.StoryOutline" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.StoryOutline"><code>StoryOutline</code></a>.
For in-place editing of widgets Ooxml Automation objects
that are already bound to the <code>Story</code>, please see <a title="presalytics.lib.widgets.ooxml_editors.OoxmlEditorWidget" href="/python-client/presalytics/lib/widgets/ooxml_editors.html#presalytics.lib.widgets.ooxml_editors.OoxmlEditorWidget"><code>OoxmlEditorWidget</code></a></p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>filename</code></strong> :&ensp;<code>str</code></dt>
<dd>The local filepath a presentation or spreadsheet file containing
the object to be rendered</dd>
<dt><strong><code>name</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The widget name.
If not provided, attribute will be set as the <code>object_name</code>
or <code>filename</code></dd>
<dt><strong><code>story_id</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The the id of the story in the Presalytics API Story service.
If not provided,
a new story will be created.
Do not supply if this object has not yet been created.</dd>
<dt><strong><code>object_ooxml_id</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The identifier of the Ooxml Automation service object bound the Story. Do not supply if this
object has not yet been created.</dd>
<dt><strong><code>endpoint_map</code></strong> :&ensp;<a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap"><code>OoxmlEndpointMap</code></a>, optional</dt>
<dd>Reference to the Presalytics API Ooxml Automation service endpoint and object type
that for the object of interest</dd>
<dt><strong><code>object_name</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The name of the object in the file's object tree the will be rendered</dd>
<dt><strong><code>previous_ooxml_version</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The id Ooxml Automation service document object that was previously used to
occupy this widget in the <a title="presalytics.story.outline.StoryOutline" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.StoryOutline"><code>StoryOutline</code></a></dd>
<dt><strong><code>file_last_modified</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The "last modified" date for the file at the <code>filename</code> path.
Used to ascertain
whether file has been updated since the last time the widget was initialized, and
correspondingly, whether the widget should be updated in the <a title="presalytics.story.outline.StoryOutline" href="/python-client/presalytics/story/outline.html#presalytics.story.outline.StoryOutline"><code>StoryOutline</code></a></dd>
<dt><strong><code>document_ooxml_id</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The identifier for the parent "Document" object in the Ooxml Automation service for the object
idenitifiable by a combinatation of <code>object_ooxml_id</code> and <code>endpoint_map</code>.</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L390-L617" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class OoxmlFileWidget(OoxmlWidgetBase):
    &#34;&#34;&#34;
    Builds a `widget` from a Presentation or Spreadsheet document

    This class interacts with the Presalytics API to extract SVG objects from
    Presentation and spreadsheet documents, identify them, and render them 
    into a story. The file is uploaded to Presalytics API Ooxml Automation service,
    which then processes the file and scans for objects in the file&#39;s object tree 
    (As seen in the &#39;Selection Pane&#39; in PowerPoint) for objects matching the &#39;object_name&#39;.
    When rendered, this widget retrieves an SVG of the identified object for rendering within 
    the story. 

    Please note that the Presalytics API Ooxml Automation object will be created overwritten 
    each time this widget is initialized, and replaced within the corresponding 
    `presalytics.story.outline.StoryOutline`.  For in-place editing of widgets Ooxml Automation objects 
    that are already bound to the `Story`, please see `presalytics.lib.widgets.ooxml_editors.OoxmlEditorWidget`

    Parameters
    ----------
    filename : str
        The local filepath a presentation or spreadsheet file containing
        the object to be rendered

    name : str, optional
        The widget name.  If not provided, attribute will be set as the `object_name` 
        or `filename`

    story_id : str, optional
        The the id of the story in the Presalytics API Story service.  If not provided, 
        a new story will be created.  Do not supply if this object has not yet been created. 
    
    object_ooxml_id : str, optional
        The identifier of the Ooxml Automation service object bound the Story. Do not supply if this 
        object has not yet been created.

    endpoint_map : presalytics.lib.widgets.ooxml.OoxmlEndpointMap, optional
        Reference to the Presalytics API Ooxml Automation service endpoint and object type
        that for the object of interest

    object_name : str, optional
        The name of the object in the file&#39;s object tree the will be rendered

    previous_ooxml_version : str, optional
        The id Ooxml Automation service document object that was previously used to 
        occupy this widget in the `presalytics.story.outline.StoryOutline`

    file_last_modified : str, optional
        The &#34;last modified&#34; date for the file at the `filename` path.  Used to ascertain
        whether file has been updated since the last time the widget was initialized, and
        correspondingly, whether the widget should be updated in the `presalytics.story.outline.StoryOutline`

    document_ooxml_id : str, optional
        The identifier for the parent &#34;Document&#34; object in the Ooxml Automation service for the object
        idenitifiable by a combinatation of `object_ooxml_id` and `endpoint_map`.
    
    &#34;&#34;&#34;
    object_name: typing.Optional[str]
    ooxml_id: str
    file_last_modified: datetime.datetime
    previous_ooxml_version: typing.Dict[str, str]

    __component_kind__ = &#39;ooxml-file-object&#39;

    def __init__(self,
                 filename,
                 name=None,
                 story_id=None,
                 object_ooxml_id=None,
                 endpoint_map=None,
                 object_name=None,
                 previous_ooxml_version={},
                 file_last_modified=None,
                 document_ooxml_id=None,
                 **kwargs):
        if object_name:
            self.object_name = object_name
        else:
            self.object_name = None
        if not name:
            if self.object_name:
                name = self.object_name
            else:
                name = filename
        super(OoxmlFileWidget, self).__init__(name, story_id, object_ooxml_id, endpoint_map, **kwargs)
        self.filename = os.path.basename(filename)
        if not self.endpoint_map:
            if filename.split(&#34;.&#34;)[-1] in [&#34;pptx&#34;, &#34;ppt&#34;]:
                self.endpoint_map = OoxmlEndpointMap(OoxmlEndpointMap.SLIDE)
        self.previous_ooxml_version = previous_ooxml_version
        if file_last_modified:
            self.file_last_modified = file_last_modified.replace(tzinfo=datetime.timezone.utc)
        else:
            self.file_last_modified = datetime.datetime.utcnow()
        self.document_ooxml_id = document_ooxml_id
        self.update()
        self.svg_html = self.create_container(**kwargs)

    def update(self):
        &#34;&#34;&#34;
        If the file is available locally, this renders that updated file and pushes
        the updated rendering data to the server
        &#34;&#34;&#34;
        story: &#39;ApiStory&#39;
        page: &#39;Page&#39;
        widget: &#39;Widget&#39;

        search_paths = list(set(presalytics.autodiscover_paths))
        if os.getcwd() not in search_paths:
            search_paths.append(os.getcwd())
        for path in search_paths:
            fpath = os.path.join(path, self.filename)
            if os.path.exists(fpath):
                # update only the file has been modified sine last time
                this_file_last_modified = datetime.datetime.utcfromtimestamp(os.path.getmtime(fpath)).astimezone(tz=datetime.timezone.utc)
                if self.file_last_modified is None or self.file_last_modified &lt;= this_file_last_modified:
                    client = self.get_client()
                    story, status, headers = client.story.story_id_file_post_with_http_info(self.story_id, file=fpath, replace_existing=True, obsolete_id=self.document_ooxml_id)
                    if status &gt;= 299:
                        raise presalytics.lib.exceptions.ApiError()
                    self.previous_ooxml_version = {
                        &#34;document_ooxml_id&#34;: self.document_ooxml_id,
                        &#34;object_ooxml_id&#34;: self.object_ooxml_id
                    }
                    new_outline = presalytics.story.outline.StoryOutline.load(story.outline)
                    for page in new_outline.pages:
                        found = False
                        for widget in page.widgets:
                            if widget.name == self.object_name:
                                self.document_ooxml_id = widget.data[&#34;document_ooxml_id&#34;]
                                found = True
                                break
                        if found:
                            break
                    if not found:
                        message = &#34;Unable to find widget object name {0} in new story outline.  Has this widget been deleted?&#34;.format(self.object_name)
                        raise presalytics.lib.exceptions.ValidationError(message)

                    # Get object tree, compare to object name
                    child_tree = client.ooxml_automation.documents_childobjects_get_id(self.document_ooxml_id)
                    target_dto = None

                    try:
                        target_dto = next(x for x in child_tree if x.entity_name == self.object_name)
                    except StopIteration:
                        pass
                    # if name not in object or _object_name is none, get first item of type in end_point id
                    if not target_dto:
                        try:
                            target_dto = next(x for x in child_tree if x.object_type.split(&#34;.&#34;)[1] == self.endpoint_map.endpoint_id)
                        except StopIteration:
                            message = &#34;Child tree of document {0} does not have a child object of type {1} or name {2}.&#34;.format(self.ooxml_id, self.endpoint_map.endpoint_id, self.object_name)
                            raise presalytics.lib.exceptions.InvalidConfigurationError(message)
                    # set widget parameters for recreation server-side (without file)
                    self.object_ooxml_id = target_dto.entity_id
                    self.file_last_modified = presalytics.lib.util.roundup_date_modified(this_file_last_modified)


    @classmethod
    def deserialize(cls, component, **kwargs):
        init_args = {
            &#34;filename&#34;: component.data[&#34;filename&#34;],
            &#34;endpoint_map&#34;: OoxmlEndpointMap(component.data[&#34;endpoint_id&#34;]),
            &#34;object_name&#34;: component.data[&#34;object_name&#34;],
            &#34;name&#34;: component.name,
        }
        if &#34;document_ooxml_id&#34; in component.data:
            init_args.update(
                {
                    &#34;document_ooxml_id&#34;: component.data[&#34;document_ooxml_id&#34;]
                }
            )
        if &#34;object_ooxml_id&#34; in component.data:
            init_args.update(
                {
                    &#34;object_ooxml_id&#34;: component.data[&#34;object_ooxml_id&#34;]
                }
            )
        if &#34;file_last_modified&#34; in component.data:
            init_args.update(
                {
                    &#34;file_last_modified&#34;: dateutil.parser.parse(component.data[&#34;file_last_modified&#34;]).replace(tzinfo=datetime.timezone.utc)
                }
            )
        if &#34;previous_ooxml_version&#34; in component.data:
            init_args.update(
                {
                    &#34;previous_ooxml_version&#34;: component.data[&#34;previous_ooxml_version&#34;]
                }
            )
        if &#34;story_id&#34; in component.data:
            init_args.update(
                {
                    &#34;story_id&#34;: component.data[&#34;story_id&#34;]
                }
            )
        if len(kwargs.keys()) &gt; 0:
            init_args.update(kwargs)
        return cls(**init_args)

    def serialize(self):
        self.update()
        data = {
            &#34;filename&#34;: self.filename,
            &#34;object_name&#34;: self.object_name,
            &#34;endpoint_id&#34;: self.endpoint_map.endpoint_id,
            &#34;document_ooxml_id&#34;: self.document_ooxml_id,
            &#34;object_ooxml_id&#34;: self.object_ooxml_id,
            &#34;story_id&#34;: self.story_id
        }
        if self.file_last_modified:
            data.update(
                {
                    &#34;file_last_modified&#34;: self.file_last_modified.isoformat()
                }
            )
        if self.previous_ooxml_version:
            data.update(
                {
                    &#34;previous_ooxml_version&#34;: self.previous_ooxml_version
                }
            )
        widget = presalytics.story.outline.Widget(
            name=self.name,
            kind=self.__component_kind__,
            data=data,
            plugins=None
        )
        return widget</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase">OoxmlWidgetBase</a></li>
<li><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="presalytics.lib.widgets.ooxml.OoxmlFileWidget.update"><code class="name flex">
<span>def <span class="ident">update</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>If the file is available locally, this renders that updated file and pushes
the updated rendering data to the server</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L487-L544" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def update(self):
    &#34;&#34;&#34;
    If the file is available locally, this renders that updated file and pushes
    the updated rendering data to the server
    &#34;&#34;&#34;
    story: &#39;ApiStory&#39;
    page: &#39;Page&#39;
    widget: &#39;Widget&#39;

    search_paths = list(set(presalytics.autodiscover_paths))
    if os.getcwd() not in search_paths:
        search_paths.append(os.getcwd())
    for path in search_paths:
        fpath = os.path.join(path, self.filename)
        if os.path.exists(fpath):
            # update only the file has been modified sine last time
            this_file_last_modified = datetime.datetime.utcfromtimestamp(os.path.getmtime(fpath)).astimezone(tz=datetime.timezone.utc)
            if self.file_last_modified is None or self.file_last_modified &lt;= this_file_last_modified:
                client = self.get_client()
                story, status, headers = client.story.story_id_file_post_with_http_info(self.story_id, file=fpath, replace_existing=True, obsolete_id=self.document_ooxml_id)
                if status &gt;= 299:
                    raise presalytics.lib.exceptions.ApiError()
                self.previous_ooxml_version = {
                    &#34;document_ooxml_id&#34;: self.document_ooxml_id,
                    &#34;object_ooxml_id&#34;: self.object_ooxml_id
                }
                new_outline = presalytics.story.outline.StoryOutline.load(story.outline)
                for page in new_outline.pages:
                    found = False
                    for widget in page.widgets:
                        if widget.name == self.object_name:
                            self.document_ooxml_id = widget.data[&#34;document_ooxml_id&#34;]
                            found = True
                            break
                    if found:
                        break
                if not found:
                    message = &#34;Unable to find widget object name {0} in new story outline.  Has this widget been deleted?&#34;.format(self.object_name)
                    raise presalytics.lib.exceptions.ValidationError(message)

                # Get object tree, compare to object name
                child_tree = client.ooxml_automation.documents_childobjects_get_id(self.document_ooxml_id)
                target_dto = None

                try:
                    target_dto = next(x for x in child_tree if x.entity_name == self.object_name)
                except StopIteration:
                    pass
                # if name not in object or _object_name is none, get first item of type in end_point id
                if not target_dto:
                    try:
                        target_dto = next(x for x in child_tree if x.object_type.split(&#34;.&#34;)[1] == self.endpoint_map.endpoint_id)
                    except StopIteration:
                        message = &#34;Child tree of document {0} does not have a child object of type {1} or name {2}.&#34;.format(self.ooxml_id, self.endpoint_map.endpoint_id, self.object_name)
                        raise presalytics.lib.exceptions.InvalidConfigurationError(message)
                # set widget parameters for recreation server-side (without file)
                self.object_ooxml_id = target_dto.entity_id
                self.file_last_modified = presalytics.lib.util.roundup_date_modified(this_file_last_modified)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase">OoxmlWidgetBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.create_container" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.create_container">create_container</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg">get_svg</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg_file" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg_file">get_svg_file</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.render" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.render">render</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.serialize">serialize</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.to_html" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.to_html">to_html</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.lib.widgets.ooxml.UpdaterWidgetBase"><code class="flex name class">
<span>class <span class="ident">UpdaterWidgetBase</span></span>
<span>(</span><span>name, story_id, object_id, endpoint_map, dto=None, data_table=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Abstract class for create simple interfaces to update widgets from a simple data table. </p>
<p>This class simplifies updates to Ooxml Automation service endpoints, allowing updates to
ooxml object data and its underlying xml via simple data transfer objects definted in the
Presalytics Ooxml Automation server.
</p>
<p>Inheriting classes must override the <code>_get_dto_class</code>, <code>_get_endpoint_path</code>, and <code>_get_dto_table_name</code>
methods</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>name</code></strong> :&ensp;<code>str</code></dt>
<dd>The widget name.
If not provided, will be the <code>object_name</code> or <code>filename</code></dd>
<dt><strong><code>story_id</code></strong> :&ensp;<code>str</code></dt>
<dd>The the id of the story in the Presalytics API Story service.
If not provided,
a new story will be created.
Do not supply if this object has not yet been created.</dd>
<dt><strong><code>object_id</code></strong> :&ensp;<code>str</code></dt>
<dd>The identifier of the Ooxml Automation service object bound the Story. Do not supply if this
object has not yet been created.</dd>
<dt><strong><code>endpoint_map</code></strong> :&ensp;<a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap"><code>OoxmlEndpointMap</code></a></dt>
<dd>Reference to the Presalytics API Ooxml Automation service endpoint and object type
that for the object of interest</dd>
<dt><strong><code>dto</code></strong> :&ensp;<code>object</code>, optional</dt>
<dd>A an instance of the data transfer object model. The class of this object is defined by the
<code>_get_dto_class()</code> method.
Represents the current state of the data of the data in the service.</dd>
<dt><strong><code>data_table</code></strong> :&ensp;<code>list</code> of <code>lists</code>, optional</dt>
<dd>A representation of a data table that will be incorporates into a dto object's property defined by
the subclass' <code>_get_dto_table_name</code> method.</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L620-L769" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class UpdaterWidgetBase(OoxmlWidgetBase):
    &#34;&#34;&#34;
    Abstract class for create simple interfaces to update widgets from a simple data table. 

    This class simplifies updates to Ooxml Automation service endpoints, allowing updates to 
    ooxml object data and its underlying xml via simple data transfer objects definted in the 
    Presalytics Ooxml Automation server.  

    Inheriting classes must override the `_get_dto_class`, `_get_endpoint_path`, and `_get_dto_table_name`
    methods

    Parameters
    ----------
    name : str
        The widget name.  If not provided, will be the `object_name` or `filename`

    story_id : str
        The the id of the story in the Presalytics API Story service.  If not provided, 
        a new story will be created.  Do not supply if this object has not yet been created. 
    
    object_id : str
        The identifier of the Ooxml Automation service object bound the Story. Do not supply if this 
        object has not yet been created.

    endpoint_map : presalytics.lib.widgets.ooxml.OoxmlEndpointMap
        Reference to the Presalytics API Ooxml Automation service endpoint and object type
        that for the object of interest

    dto: object, optional
        A an instance of the data transfer object model. The class of this object is defined by the
        `_get_dto_class()` method.  Represents the current state of the data of the data in the service.

    data_table: list of lists, optional
        A representation of a data table that will be incorporates into a dto object&#39;s property defined by
        the subclass&#39; `_get_dto_table_name` method.

    &#34;&#34;&#34;
    def __init__(self, 
                name,
                story_id: str,
                object_id: str,
                endpoint_map: OoxmlEndpointMap,
                dto=None, 
                data_table=None,
                **kwargs):
        super(UpdaterWidgetBase, self).__init__(name, story_id, object_id, endpoint_map, **kwargs)
        self.dto = dto
        self.data_table = data_table
        self.object_id = object_id
    
    
    @abc.abstractmethod
    def _get_dto_class(self) -&gt; typing.Type:
        &#34;&#34;&#34;
        Returns the Class of instances that will used for dtos
        &#34;&#34;&#34;
        return NotImplemented

    @abc.abstractmethod
    def _get_endpoint_path(self) -&gt; str:
        &#34;&#34;&#34;
        Returns the relative path to the the endpoint used , starting from the `root_url` of the 
        `presalytics.lib.widgets.ooxml.OoxmlEndpointMap` object. 
        &#34;&#34;&#34;
        return NotImplemented

    @abc.abstractmethod
    def _get_dto_table_name(self) -&gt; str:
        &#34;&#34;&#34;
        Returns the attribute name in the object returned by `_get_dto_class()` that the `data_table` parameter
        should be mapped to.
        &#34;&#34;&#34;
        return NotImplemented

    def build_endpoint(self) -&gt; str:
        &#34;&#34;&#34;
        Returns the endpoints used for Api calls
        &#34;&#34;&#34;
        return posixpath.join(self.endpoint_map.root_url, self._get_endpoint_path(), self.object_ooxml_id)
    
    def get_dto(self):
        &#34;&#34;&#34;
        Returns an instance of the dto object from the OoxmlAutomation Service API
        &#34;&#34;&#34;
        client = self.get_client()
        headers = client.get_auth_header()
        headers.update(client.get_request_id_header())
        resp = requests.get(self.build_endpoint(), headers=headers)
        if resp.status_code &gt; 299:
            raise presalytics.lib.exceptions.ApiError(message=resp.text)
        dto = client.ooxml_automation.api_client._ApiClient__deserialize(resp.json(), self._get_dto_class())
        self.dto = dto
        return dto

    def _put_dto(self, dto):
        &#34;&#34;&#34;
        Updates the Endpoint in the Ooxml Automation Service from a dto object
        &#34;&#34;&#34;
        client = self.get_client()
        headers = client.get_auth_header()
        headers.update(client.get_request_id_header())
        data = client.ooxml_automation.api_client.sanitize_for_serialization(dto)
        resp = requests.put(self.build_endpoint(), json=data, headers=headers)
        if resp.status_code &gt; 299:
            raise presalytics.lib.exceptions.ApiError(message=resp.text)
        else:
            self.dto = dto

    def update_from_dto(self, dto):
        &#34;&#34;&#34;
        Updates the Endpoint in the Ooxml Automation Service from a dto object, and updates
        the `svg_html` attribute
        &#34;&#34;&#34;
        self._put_dto(dto)
        self.svg_html = self.create_container()

    def update_from_data_table(self, data_table):
        &#34;&#34;&#34;
        Updates the Endpoint in the Ooxml Automation Service from a the `data_table`, and updates
        the `svg_html` attribute
        &#34;&#34;&#34;
        dto = self.get_dto()
        setattr(dto, self._get_dto_table_name(), data_table)
        self.put_dto(dto)

    def serialize(self):
        data = {
            &#34;story_id&#34;: self.story_id,
            &#34;object_id&#34;: self.object_ooxml_id,
            &#34;dto&#34;: self.dto.to_dict(),
            &#34;data_table&#34;: self.data_table
        }
        widget = presalytics.story.outline.Widget(
            name=self.name,
            kind=self.__component_kind__,
            data=data,
            plugins=None
        )
        return widget

    @classmethod
    def deserialize(cls, component, **kwargs):
        return cls(
            component.name, 
            component.data[&#34;story_id&#34;], 
            component.data[&#34;object_id&#34;],
            component.data.get(&#34;dto&#34;, None),
            component.data.get(&#34;data_table&#34;, None),
            **kwargs
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase">OoxmlWidgetBase</a></li>
<li><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="presalytics.lib.widgets.ooxml.ChartUpdaterWidget" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.ChartUpdaterWidget">ChartUpdaterWidget</a></li>
<li><a title="presalytics.lib.widgets.ooxml.TableUpdaterWidget" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.TableUpdaterWidget">TableUpdaterWidget</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.build_endpoint"><code class="name flex">
<span>def <span class="ident">build_endpoint</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Returns the endpoints used for Api calls</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L694-L698" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def build_endpoint(self) -&gt; str:
    &#34;&#34;&#34;
    Returns the endpoints used for Api calls
    &#34;&#34;&#34;
    return posixpath.join(self.endpoint_map.root_url, self._get_endpoint_path(), self.object_ooxml_id)</code></pre>
</details>
</dd>
<dt id="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.get_dto"><code class="name flex">
<span>def <span class="ident">get_dto</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Returns an instance of the dto object from the OoxmlAutomation Service API</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L700-L712" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_dto(self):
    &#34;&#34;&#34;
    Returns an instance of the dto object from the OoxmlAutomation Service API
    &#34;&#34;&#34;
    client = self.get_client()
    headers = client.get_auth_header()
    headers.update(client.get_request_id_header())
    resp = requests.get(self.build_endpoint(), headers=headers)
    if resp.status_code &gt; 299:
        raise presalytics.lib.exceptions.ApiError(message=resp.text)
    dto = client.ooxml_automation.api_client._ApiClient__deserialize(resp.json(), self._get_dto_class())
    self.dto = dto
    return dto</code></pre>
</details>
</dd>
<dt id="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.update_from_dto"><code class="name flex">
<span>def <span class="ident">update_from_dto</span></span>(<span>self, dto)</span>
</code></dt>
<dd>
<section class="desc"><p>Updates the Endpoint in the Ooxml Automation Service from a dto object, and updates
the <code>svg_html</code> attribute</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L728-L734" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def update_from_dto(self, dto):
    &#34;&#34;&#34;
    Updates the Endpoint in the Ooxml Automation Service from a dto object, and updates
    the `svg_html` attribute
    &#34;&#34;&#34;
    self._put_dto(dto)
    self.svg_html = self.create_container()</code></pre>
</details>
</dd>
<dt id="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.update_from_data_table"><code class="name flex">
<span>def <span class="ident">update_from_data_table</span></span>(<span>self, data_table)</span>
</code></dt>
<dd>
<section class="desc"><p>Updates the Endpoint in the Ooxml Automation Service from a the <code>data_table</code>, and updates
the <code>svg_html</code> attribute</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L736-L743" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def update_from_data_table(self, data_table):
    &#34;&#34;&#34;
    Updates the Endpoint in the Ooxml Automation Service from a the `data_table`, and updates
    the `svg_html` attribute
    &#34;&#34;&#34;
    dto = self.get_dto()
    setattr(dto, self._get_dto_table_name(), data_table)
    self.put_dto(dto)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase">OoxmlWidgetBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.create_container" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.create_container">create_container</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg">get_svg</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg_file" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg_file">get_svg_file</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.render" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.render">render</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.serialize">serialize</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.to_html" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.to_html">to_html</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.lib.widgets.ooxml.ChartUpdaterWidget"><code class="flex name class">
<span>class <span class="ident">ChartUpdaterWidget</span></span>
<span>(</span><span>name, story_id, chart_id, dto=None, data_table=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Updates a Chart in the Ooxml Automation service API at the the endpoint '/Chart/ChartUpdate/'</p>
<p>This class simplifies chart updates, for charts residing in the Ooxml Automation Service,
allowing updates to ooxml object data and its underlying xml either via a list of lists or
the <a title="presalytics.client.presalytics_ooxml_automation.models.chart_chart_data_dto.ChartChartDataDTO" href="/python-client/presalytics/client/presalytics_ooxml_automation/models/chart_chart_data_dto.html#presalytics.client.presalytics_ooxml_automation.models.chart_chart_data_dto.ChartChartDataDTO"><code>ChartChartDataDTO</code></a>
object.
</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>name</code></strong> :&ensp;<code>str</code></dt>
<dd>A name for the widget.</dd>
<dt><strong><code>story_id</code></strong> :&ensp;<code>str</code></dt>
<dd>The the id of the story in the Presalytics API Story service.</dd>
<dt><strong><code>chart_id</code></strong> :&ensp;<code>str</code></dt>
<dd>The identifier of the Ooxml Automation Chart service object.</dd>
<dt><strong><code>dto</code></strong> :&ensp;<a title="presalytics.client.presalytics_ooxml_automation.models.chart_chart_data_dto.ChartChartDataDTO" href="/python-client/presalytics/client/presalytics_ooxml_automation/models/chart_chart_data_dto.html#presalytics.client.presalytics_ooxml_automation.models.chart_chart_data_dto.ChartChartDataDTO"><code>ChartChartDataDTO</code></a>, optional</dt>
<dd>A an instance of the data transfer object model. The class of this object is defined by the
<code>_get_dto_class()</code> method.
Represents the current state of the data of the data in the service.</dd>
<dt><strong><code>data_table</code></strong> :&ensp;<code>list</code> of <code>lists</code>, optional</dt>
<dd>A representation of a data table that will be incorporates into a dto object's property defined by
the subclass' <code>_get_dto_table_name</code> method.</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L772-L845" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class ChartUpdaterWidget(UpdaterWidgetBase):
    &#34;&#34;&#34;
    Updates a Chart in the Ooxml Automation service API at the the endpoint &#39;/Chart/ChartUpdate/&#39;

    This class simplifies chart updates, for charts residing in the Ooxml Automation Service, 
    allowing updates to ooxml object data and its underlying xml either via a list of lists or
    the `presalytics.client.presalytics_ooxml_automation.models.chart_chart_data_dto.ChartChartDataDTO`
    object.  

    Parameters
    ----------
    name : str
        A name for the widget.

    story_id : str
        The the id of the story in the Presalytics API Story service. 
    
    chart_id : str
        The identifier of the Ooxml Automation Chart service object. 

    dto: presalytics.client.presalytics_ooxml_automation.models.chart_chart_data_dto.ChartChartDataDTO, optional
        A an instance of the data transfer object model. The class of this object is defined by the
        `_get_dto_class()` method.  Represents the current state of the data of the data in the service.

    data_table: list of lists, optional
        A representation of a data table that will be incorporates into a dto object&#39;s property defined by
        the subclass&#39; `_get_dto_table_name` method.

    &#34;&#34;&#34;
    __component_kind__ = &#34;chart-updater&#34;
    
    def __init__(self, 
                name,
                story_id: str,
                chart_id: str,
                dto: &#39;ChartChartDataDTO&#39; = None, 
                data_table: typing.Sequence[typing.Sequence] = None,
                **kwargs):
        super().__init__(name, story_id, chart_id, OoxmlEndpointMap.chart(), dto=dto, data_table=data_table, **kwargs)
        self.chart_id = chart_id


    def _get_dto_class(self):
        return presalytics.client.presalytics_ooxml_automation.models.chart_chart_data_dto.ChartChartDataDTO

    def _get_endpoint_path(self):
        return &#34;ChartUpdate&#34;

    def _get_dto_table_name(self):
        return &#34;data_points&#34;

    def get_dataframe(self) -&gt; pandas.DataFrame:
        &#34;&#34;&#34;
        Returns a panda datagrame of the 
        &#34;&#34;&#34;
        data: collections.OrderedDict
        
        if not self.dto:
            self.dto = self.get_dto()
        data = collections.OrderedDict()
        for i in range(0, len(self.dto.series_names)):
            data.update({
                self.dto.series_names[i]: pandas.Series(self.dto.data_points[i], self.dto.category_names)
            })
        return pandas.DataFrame(data)
    
    def put_dataframe(self, df: pandas.DataFrame):
        data_dict = df.to_dict(&#39;split&#39;)
        data_points = list(map(list, zip(*data_dict[&#39;data&#39;])))
        dto = self._get_dto_class()(chart_id=self.chart_id, 
                                 series_names=data_dict[&#34;columns&#34;], 
                                 category_names=data_dict[&#34;index&#34;],
                                 data_points=data_points)
        self._put_dto(dto)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase">UpdaterWidgetBase</a></li>
<li><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase">OoxmlWidgetBase</a></li>
<li><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="presalytics.lib.widgets.ooxml.ChartUpdaterWidget.get_dataframe"><code class="name flex">
<span>def <span class="ident">get_dataframe</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Returns a panda datagrame of the</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L823-L836" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_dataframe(self) -&gt; pandas.DataFrame:
    &#34;&#34;&#34;
    Returns a panda datagrame of the 
    &#34;&#34;&#34;
    data: collections.OrderedDict
    
    if not self.dto:
        self.dto = self.get_dto()
    data = collections.OrderedDict()
    for i in range(0, len(self.dto.series_names)):
        data.update({
            self.dto.series_names[i]: pandas.Series(self.dto.data_points[i], self.dto.category_names)
        })
    return pandas.DataFrame(data)</code></pre>
</details>
</dd>
<dt id="presalytics.lib.widgets.ooxml.ChartUpdaterWidget.put_dataframe"><code class="name flex">
<span>def <span class="ident">put_dataframe</span></span>(<span>self, df)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L838-L845" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def put_dataframe(self, df: pandas.DataFrame):
    data_dict = df.to_dict(&#39;split&#39;)
    data_points = list(map(list, zip(*data_dict[&#39;data&#39;])))
    dto = self._get_dto_class()(chart_id=self.chart_id, 
                             series_names=data_dict[&#34;columns&#34;], 
                             category_names=data_dict[&#34;index&#34;],
                             data_points=data_points)
    self._put_dto(dto)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase">UpdaterWidgetBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.build_endpoint" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase.build_endpoint">build_endpoint</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.create_container" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.create_container">create_container</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.get_dto" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase.get_dto">get_dto</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.get_svg" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg">get_svg</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.get_svg_file" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg_file">get_svg_file</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.render" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.render">render</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.serialize">serialize</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.to_html" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.to_html">to_html</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.update_from_data_table" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase.update_from_data_table">update_from_data_table</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.update_from_dto" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase.update_from_dto">update_from_dto</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="presalytics.lib.widgets.ooxml.TableUpdaterWidget"><code class="flex name class">
<span>class <span class="ident">TableUpdaterWidget</span></span>
<span>(</span><span>name, story_id, table_id, dto=None, data_table=None, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Updates a Table in the Ooxml Automation service API at the the endpoint '/Table/TableUpdate/'</p>
<p>This class simplifies table updates, for tables residing in the Ooxml Automation Service,
allowing updates to ooxml object data and its underlying xml either via a list of lists or
the <a title="presalytics.client.presalytics_ooxml_automation.models.table_table_data_dto.TableTableDataDTO" href="/python-client/presalytics/client/presalytics_ooxml_automation/models/table_table_data_dto.html#presalytics.client.presalytics_ooxml_automation.models.table_table_data_dto.TableTableDataDTO"><code>TableTableDataDTO</code></a>
object.
</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>name</code></strong> :&ensp;<code>str</code></dt>
<dd>A name for the widget.</dd>
<dt><strong><code>story_id</code></strong> :&ensp;<code>str</code></dt>
<dd>The the id of the story in the Presalytics API Story service.</dd>
<dt><strong><code>table_id</code></strong> :&ensp;<code>str</code></dt>
<dd>The identifier of the Ooxml Automation Table service object.</dd>
<dt><strong><code>dto</code></strong> :&ensp;<a title="presalytics.client.presalytics_ooxml_automation.models.table_table_data_dto.TableTableDataDTO" href="/python-client/presalytics/client/presalytics_ooxml_automation/models/table_table_data_dto.html#presalytics.client.presalytics_ooxml_automation.models.table_table_data_dto.TableTableDataDTO"><code>TableTableDataDTO</code></a>, optional</dt>
<dd>A an instance of the data transfer object model. The class of this object is defined by the
<code>_get_dto_class()</code> method.
Represents the current state of the data of the data in the service.</dd>
<dt><strong><code>data_table</code></strong> :&ensp;<code>list</code> of <code>lists</code>, optional</dt>
<dd>A representation of a data table that will be incorporates into a dto object's property defined by
the subclass' <code>_get_dto_table_name</code> method.</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/presalytics/python-client/blob/master/presalytics/lib/widgets/ooxml.py#L849-L898" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class TableUpdaterWidget(UpdaterWidgetBase):
    &#34;&#34;&#34;
    Updates a Table in the Ooxml Automation service API at the the endpoint &#39;/Table/TableUpdate/&#39;

    This class simplifies table updates, for tables residing in the Ooxml Automation Service, 
    allowing updates to ooxml object data and its underlying xml either via a list of lists or
    the `presalytics.client.presalytics_ooxml_automation.models.table_table_data_dto.TableTableDataDTO`
    object.  

    Parameters
    ----------
    name : str
        A name for the widget.

    story_id : str
        The the id of the story in the Presalytics API Story service. 
    
    table_id : str
        The identifier of the Ooxml Automation Table service object. 

    dto: presalytics.client.presalytics_ooxml_automation.models.table_table_data_dto.TableTableDataDTO, optional
        A an instance of the data transfer object model. The class of this object is defined by the
        `_get_dto_class()` method.  Represents the current state of the data of the data in the service.

    data_table: list of lists, optional
        A representation of a data table that will be incorporates into a dto object&#39;s property defined by
        the subclass&#39; `_get_dto_table_name` method.

    &#34;&#34;&#34;
    __component_kind__ = &#34;table-updater&#34;
    
    def __init__(self, 
                name,
                story_id: str,
                table_id: str,
                dto: &#39;TableTableDataDTO&#39; = None, 
                data_table: typing.Sequence[typing.Sequence] = None,
                **kwargs):
        super().__init__(name, story_id, table_id, OoxmlEndpointMap.table(), dto=dto, data_table=data_table, **kwargs)
        self.table_id = table_id


    def _get_dto_class(self):
        return presalytics.client.presalytics_ooxml_automation.models.table_table_data_dto.TableTableDataDTO

    def _get_endpoint_path(self):
        return &#34;TableUpdate&#34;

    def _get_dto_table_name(self):
        return &#34;table_data&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase">UpdaterWidgetBase</a></li>
<li><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase">OoxmlWidgetBase</a></li>
<li><a title="presalytics.story.components.WidgetBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase">WidgetBase</a></li>
<li><a title="presalytics.story.components.ComponentBase" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase">ComponentBase</a></li>
<li>abc.ABC</li>
</ul>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase">UpdaterWidgetBase</a></b></code>:
<ul class="hlist">
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.build_endpoint" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase.build_endpoint">build_endpoint</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.create_container" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.create_container">create_container</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.deserialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.deserialize">deserialize</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.get_client" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.get_client">get_client</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.get_dto" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase.get_dto">get_dto</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.get_svg" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg">get_svg</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.get_svg_file" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg_file">get_svg_file</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.render" href="/python-client/presalytics/story/components.html#presalytics.story.components.ComponentBase.render">render</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.serialize" href="/python-client/presalytics/story/components.html#presalytics.story.components.WidgetBase.serialize">serialize</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.to_html" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.to_html">to_html</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.update_from_data_table" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase.update_from_data_table">update_from_data_table</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.update_from_dto" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase.update_from_dto">update_from_dto</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="presalytics.lib.widgets" href="/python-client/presalytics/lib/widgets/index.html">presalytics.lib.widgets</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap">OoxmlEndpointMap</a></code></h4>
<ul class="two-column">
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.connection_shape" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap.connection_shape">connection_shape</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.chart" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap.chart">chart</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.document" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap.document">document</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.group" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap.group">group</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.image" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap.image">image</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.shape" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap.shape">shape</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.shapetree" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap.shapetree">shapetree</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.slide" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap.slide">slide</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.table" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap.table">table</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.theme" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap.theme">theme</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.get_object_type" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap.get_object_type">get_object_type</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.get_id_url" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap.get_id_url">get_id_url</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.get_svg_url" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap.get_svg_url">get_svg_url</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlEndpointMap.get_xml_url" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlEndpointMap.get_xml_url">get_xml_url</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase">OoxmlWidgetBase</a></code></h4>
<ul class="">
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.create_container" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.create_container">create_container</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.to_html" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.to_html">to_html</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg">get_svg</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg_file" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlWidgetBase.get_svg_file">get_svg_file</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.lib.widgets.ooxml.OoxmlFileWidget" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlFileWidget">OoxmlFileWidget</a></code></h4>
<ul class="">
<li><code><a title="presalytics.lib.widgets.ooxml.OoxmlFileWidget.update" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.OoxmlFileWidget.update">update</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase">UpdaterWidgetBase</a></code></h4>
<ul class="">
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.build_endpoint" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase.build_endpoint">build_endpoint</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.get_dto" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase.get_dto">get_dto</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.update_from_dto" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase.update_from_dto">update_from_dto</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.UpdaterWidgetBase.update_from_data_table" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.UpdaterWidgetBase.update_from_data_table">update_from_data_table</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.lib.widgets.ooxml.ChartUpdaterWidget" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.ChartUpdaterWidget">ChartUpdaterWidget</a></code></h4>
<ul class="">
<li><code><a title="presalytics.lib.widgets.ooxml.ChartUpdaterWidget.get_dataframe" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.ChartUpdaterWidget.get_dataframe">get_dataframe</a></code></li>
<li><code><a title="presalytics.lib.widgets.ooxml.ChartUpdaterWidget.put_dataframe" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.ChartUpdaterWidget.put_dataframe">put_dataframe</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="presalytics.lib.widgets.ooxml.TableUpdaterWidget" href="/python-client/presalytics/lib/widgets/ooxml.html#presalytics.lib.widgets.ooxml.TableUpdaterWidget">TableUpdaterWidget</a></code></h4>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.7.4</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>